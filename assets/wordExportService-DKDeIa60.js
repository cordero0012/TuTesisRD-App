import{r as f,P as r,A as i,H as p,T as g,a as E,F as y,b as T,c as h,d as b,e as m,B as c,W as w}from"./doc-vendor-45wm4pqv.js";const d={MAX_TEXT_LENGTH:5e3,MAX_TABLE_ROWS:500},l=t=>{if(!t)return"";let e=t.replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F]/g,"");return e.length>d.MAX_TEXT_LENGTH&&(e=e.substring(0,d.MAX_TEXT_LENGTH)+" [TRUNCADO POR SEGURIDAD]"),e},D=t=>{const e=[];if(e.push({type:"heading1",content:"Diagnóstico Global"}),t.analysisWarnings&&t.analysisWarnings.length>0&&(e.push({type:"text",content:"ADVERTENCIA: ANÁLISIS PARCIAL",styling:{bold:!0,color:"#b91c1c",align:"center",size:14}}),e.push({type:"text",content:"El siguiente reporte contiene secciones generadas automáticamente que podrían estar incompletas. Verifique los siguientes puntos:",styling:{color:"#b91c1c",align:"justify",size:10}}),t.analysisWarnings.forEach(n=>{e.push({type:"text",content:`- ${l(n)}`,styling:{color:"#dc2626",size:9}})}),e.push({type:"text",content:""})),t.globalDiagnosis&&(t.globalDiagnosis.score&&e.push({type:"text",content:`Puntuación General: ${t.globalDiagnosis.score}/100`,styling:{bold:!0,align:"center",color:"#2563eb"}}),e.push({type:"text",content:l(t.globalDiagnosis.summary||t.globalDiagnosis.auditSummary),styling:{align:"justify"}})),t.consistencyMatrix&&t.consistencyMatrix.length>0){e.push({type:"page_break"}),e.push({type:"heading1",content:"Matriz de Consistencia"});const n=["Elemento","Nivel","Observación Técnica"],s=t.consistencyMatrix.slice(0,d.MAX_TABLE_ROWS).map(o=>[l(o.element),l(o.coherenceLevel),l(o.technicalObservation)]);e.push({type:"table",tableData:{headers:n,rows:s,isMatrix:!0}})}return{metadata:{title:"Informe de Matriz de Consistencia",subtitle:"Evaluación de Coherencia Metodológica",date:new Date().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),brandingColor:"ea580c"},sections:e}},L=t=>{var n,s,o,a;const e=[];return e.push({type:"heading1",content:"Resultado de Auditoría"}),e.push({type:"text",content:`Probabilidad de IA: ${(t.score*100).toFixed(1)}%`,styling:{bold:!0,align:"center",size:24,color:t.score>.6?"#dc2626":t.score>.3?"#f59e0b":"#16a34a",isCritical:t.score>.6}}),e.push({type:"heading2",content:"Métricas Forenses"}),e.push({type:"list",content:`Burstiness: ${((s=(n=t.metrics)==null?void 0:n.burstiness)==null?void 0:s.toFixed(2))||"N/A"}`}),e.push({type:"list",content:`Perplejidad: ${((a=(o=t.metrics)==null?void 0:o.perplexityProxy)==null?void 0:a.toFixed(2))||"N/A"}`}),{metadata:{title:"Informe de Auditoría Forense",date:new Date().toLocaleDateString(),brandingColor:"#64748b"},sections:e}};var A=f();const I=(t,e={})=>new r({children:[new g({text:t,bold:e.bold,size:e.size?e.size*2:24,color:e.color?e.color.replace("#",""):"1e293b",font:"Arial"})],alignment:e.align==="center"?i.CENTER:e.align==="right"?i.RIGHT:e.align==="justify"?i.JUSTIFIED:i.LEFT,spacing:{before:120,after:120}}),x=t=>{const e=new h({tableHeader:!0,children:t.headers.map(s=>new b({children:[new r({children:[new g({text:s,bold:!0,color:"ffffff"})],alignment:i.CENTER})],shading:{fill:"475569"},verticalAlign:"center",margins:{top:100,bottom:100,left:100,right:100}}))}),n=t.rows.map(s=>new h({children:s.map(o=>new b({children:[new r(o)],margins:{top:100,bottom:100,left:100,right:100}}))}));return new m({width:{size:100,type:w.PERCENTAGE},rows:[e,...n],borders:{top:{style:c.SINGLE,size:1,color:"e2e8f0"},bottom:{style:c.SINGLE,size:1,color:"e2e8f0"},left:{style:c.SINGLE,size:1,color:"e2e8f0"},right:{style:c.SINGLE,size:1,color:"e2e8f0"},insideHorizontal:{style:c.SINGLE,size:1,color:"e2e8f0"},insideVertical:{style:c.SINGLE,size:1,color:"e2e8f0"}}})},N=async(t,e="export.docx")=>{const n=[];n.push(new r({text:t.metadata.title.toUpperCase(),heading:p.TITLE,alignment:i.CENTER,spacing:{after:200}})),n.push(new r({children:[new g({text:`Generado por ${t.metadata.creator} | ${t.metadata.date}`,size:20,color:"94a3b8"})],alignment:i.CENTER,spacing:{after:600}})),t.sections.forEach(a=>{var u;switch(a.type){case"heading1":n.push(new r({text:(u=a.content)==null?void 0:u.toUpperCase(),heading:p.HEADING_1,spacing:{before:400,after:200}}));break;case"heading2":n.push(new r({text:a.content,heading:p.HEADING_2,spacing:{before:300,after:150}}));break;case"text":a.content&&n.push(I(a.content,a.styling));break;case"list":a.content&&n.push(new r({text:"• "+a.content,spacing:{before:50,after:50},indent:{left:720,hanging:360}}));break;case"table":a.tableData&&(n.push(x(a.tableData)),n.push(new r("")));break;case"page_break":n.push(new r({children:[new E]}));break}});const s=new y({creator:t.metadata.creator,title:t.metadata.title,description:t.metadata.subtitle,sections:[{properties:{},children:n}]}),o=await T.toBlob(s);A.saveAs(o,e)},z={generateWordDocument:N};export{D as a,L as m,z as w};
