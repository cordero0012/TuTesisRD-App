import{E as F,a as C}from"./pdf-vendor-DgDjaYZr.js";const x={top:20,bottom:20,left:25,right:20},l={primary:"helvetica",style:{regular:"normal",bold:"bold"}},u={heading1:16,body:11,small:9},e={primary:[19,91,236],text:{main:[40,44,52],secondary:[100,100,100],light:[150,150,150]},status:{success:[16,185,129],warning:[245,158,11],error:[239,68,68]},bg:{header:[247,248,250],accent:[240,244,255]}},E=(g,t,o)=>{const s=g.internal.pageSize.height,a=g.internal.pageSize.width;g.setFont(l.primary,l.style.regular),g.setFontSize(u.small),g.setTextColor(e.text.light[0],e.text.light[1],e.text.light[2]),g.setDrawColor(220,220,220),g.line(x.left,s-x.bottom+5,a-x.right,s-x.bottom+5);const r=new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"});g.text("Tu Tesis RD – Informe Académico",x.left,s-x.bottom+10),g.text(r,a/2,s-x.bottom+10,{align:"center"}),g.text(`Página ${t} de ${o}`,a-x.right,s-x.bottom+10,{align:"right"})},A=(g,t,o,s,a)=>{const r=g.splitTextToSize(t,a);return g.text(r,o,s),s+r.length*6},f=(g,t,o)=>{const s=g.internal.pageSize.height;return t+o>s-x.bottom-10?(g.addPage(),x.top):t};class I{getTitle(){return"INFORME DE"}getSubTitle(){return"CONSISTENCIA METODOLÓGICA"}generate(t,o){var S;const s=t.internal.pageSize.width,a=t.internal.pageSize.height,r=25;let i=135;const y=(n,p)=>{t.setFontSize(11),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.secondary[0],e.text.secondary[1],e.text.secondary[2]),t.text(n,40,i),t.setFont(l.primary,l.style.regular),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(p,80,i),i+=8};y("DOCUMENTO:",o.documentType||"Tesis de Grado"),y("ENFOQUE:",o.methodologicalApproach||"No identificado"),y("ÁREA:",o.disciplinaryArea||"Multidisciplinar"),y("NORMATIVA:",o.applicableStandards.join(", ")||"Estándar General"),t.addPage(),i=30,t.setFontSize(16),t.setFont(l.primary,l.style.bold),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("1. DIAGNÓSTICO GLOBAL",r,i),i+=15;const m=(n,p,h)=>{t.setFillColor(e.bg.header[0],e.bg.header[1],e.bg.header[2]),t.roundedRect(h,i,50,25,3,3,"F"),t.setFontSize(8),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.secondary[0],e.text.secondary[1],e.text.secondary[2]),t.text(n.toUpperCase(),h+25,i+8,{align:"center"}),t.setFontSize(14),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(String(p),h+25,i+18,{align:"center"})};m("Nivel General",o.globalDiagnosis.level,r),m("Consistencia",`${o.globalDiagnosis.internalConsistencyDegree}%`,r+40),m("APA 7",`${((S=o.normativeCompliance)==null?void 0:S.apa7Score)||0}%`,r+80),m("Publicabilidad",`${o.globalDiagnosis.publishabilityLevel}%`,r+120),i+=40,t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("2. MATRIZ DE ALINEACIÓN",r,i),i+=5,C(t,{startY:i,head:[["Componente","Contenido Detectado","Estado","Observación"]],body:o.consistencyMatrix.map(n=>[n.element,n.description||"No detectado",n.coherenceLevel.toUpperCase(),n.technicalObservation||"Sin observaciones"]),theme:"plain",headStyles:{fillColor:[240,240,240],textColor:[40,44,52],fontStyle:"bold"},styles:{fontSize:9,cellPadding:4,textColor:[40,44,52]},columnStyles:{0:{fontStyle:"bold",cellWidth:35},1:{cellWidth:65},2:{halign:"center",cellWidth:25},3:{cellWidth:"auto"}},didParseCell:n=>{if(n.section==="body"&&n.column.index===2){const p=n.cell.raw;n.cell.styles.textColor=p==="BAJA"||p==="INEXISTENTE"?e.status.error:p==="MEDIA"?e.status.warning:e.status.success}}}),i=t.lastAutoTable.finalY+15,o.sourceConsistencySubMatrix&&(i>a-60&&(t.addPage(),i=30),t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("2.5 SUB-MATRIZ DE FUENTES (APA 7)",r,i),i+=10,C(t,{startY:i,head:[["Cita en Texto","En Bibliografía","Página"]],body:o.sourceConsistencySubMatrix.citationsFound.map(n=>[n.citation,n.inBibliography?"SÍ":"NO",n.page]),theme:"striped",headStyles:{fillColor:[70,70,70],textColor:[255,255,255]},styles:{fontSize:8},didParseCell:n=>{if(n.section==="body"&&n.column.index===1){const p=n.cell.raw;n.cell.styles.textColor=p==="NO"?e.status.error:e.status.success,n.cell.styles.fontStyle="bold"}}}),i=t.lastAutoTable.finalY+15),i>a-50&&(t.addPage(),i=30),t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("3. PLAN DE ACCIÓN",r,i),i+=15,o.prioritizedRecommendations.forEach((n,p)=>{i>a-40&&(t.addPage(),i=30);const h=`${p+1}. ${n.what} (${n.priority})`;t.setFontSize(11),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(h,r,i),i+=6,t.setFont(l.primary,l.style.regular),t.setFontSize(9);const c=t.splitTextToSize(`Por qué: ${n.why}`,s-r*2);t.text(c,r,i),i+=c.length*5+2;const T=t.splitTextToSize(`Cómo: ${n.how}`,s-r*2);t.text(T,r,i),i+=T.length*5+8}),o.actionableFeedback&&o.actionableFeedback.length>0&&(t.addPage(),i=30,t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("4. FEEDBACK DE MEJORA DIRECTA",r,i),i+=15,o.actionableFeedback.forEach((n,p)=>{i>a-50&&(t.addPage(),i=30),t.setFontSize(10),t.setFont(l.primary,l.style.bold),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text(`Hallazgo: ${n.finding}`,r,i),i+=6,t.setFont(l.primary,l.style.regular),t.setFontSize(9),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),[["Evidencia:",n.evidence],["Justificación:",n.whyItMatters],["Corrección:",n.howToFix],["Ejemplo:",n.example]].forEach(([c,T])=>{const b=t.splitTextToSize(`${c} ${T}`,s-r*2-5);t.text(b,r+5,i),i+=b.length*5}),i+=8}))}}class z{getTitle(){return"INFORME DE"}getSubTitle(){return"REFERENCIAS BIBLIOGRÁFICAS"}generate(t,o){if(!Array.isArray(o))return;const s=o;let a=140;t.addPage(),a=x.top,t.setFontSize(u.heading1),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("LISTADO DE REFERENCIAS",x.left,a),a+=15;const r=t.internal.pageSize.width-x.left-x.right;s.forEach((i,y)=>{a=f(t,a,25);const m=i.reference||{},S=m.title||"Sin título",n=m.authors&&Array.isArray(m.authors)?m.authors.join(", "):"Autor desconocido",p=m.publicationYear||"s.f.";t.setFontSize(u.body),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(`[${y+1}]`,x.left,a),t.setFont(l.primary,l.style.regular);const h=`${n} (${p}). ${S}.`;a=A(t,h,x.left+10,a,r-10),a+=2,t.setFontSize(u.small);const c=i.status==="verified"?"✓ VERIFICADO":"⚠ SIN VERIFICAR",T=i.status==="verified"?e.status.success:e.status.error;t.setTextColor(T[0],T[1],T[2]),t.text(c,x.left+10,a),a+=10})}}class D{getTitle(){return"INFORME DE"}getSubTitle(){return"AUDITORÍA DE PRENSA IA"}generate(t,o){const s=o;if(typeof s.score!="number")return;const a=25;t.addPage();let r=30;t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text(`PROBABILIDAD DE IA: ${(s.score*100).toFixed(1)}%`,a,r),r+=15,s.signals&&s.signals.length>0&&(t.setFontSize(14),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text("Señales Detectadas",a,r),r+=10,s.signals.forEach(i=>{t.setFontSize(11),t.text(`• ${i}`,a+5,r),r+=7}),r+=10),s.heatmap&&(t.setFontSize(14),t.text("Análisis de Segmentos",a,r),r+=10,s.heatmap.forEach(i=>{const y=i.probability,m=`[${(y*100).toFixed(0)}%] ${i.text.substring(0,100)}...`;r>t.internal.pageSize.height-20&&(t.addPage(),r=30),t.setFontSize(10),y>.7?t.setTextColor(e.status.error[0],e.status.error[1],e.status.error[2]):y>.4?t.setTextColor(e.status.warning[0],e.status.warning[1],e.status.warning[2]):t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(m,a,r),r+=6}))}}class d{getTitle(){return"TRANSCRIPCIÓN"}getSubTitle(){return"ENTREVISTA DE INVESTIGACIÓN"}generate(t,o){const s=o;if(!s.segments)return;t.addPage(),C(t,{startY:30,head:[["Tiempo","Contenido"]],body:s.segments.map(r=>[`${Math.floor(r.start/60)}:${Math.floor(r.start%60).toString().padStart(2,"0")}`,r.text]),columnStyles:{0:{cellWidth:20,fontStyle:"bold"},1:{cellWidth:"auto"}}})}}const R=(g,t,o="Reporte")=>{let s;switch(g){case"consistency":s=new I;break;case"references":s=new z;break;case"audit":s=new D;break;case"transcription":s=new d;break;default:console.error("Unknown export type");return}const a=new F({orientation:"portrait",unit:"mm",format:"letter"}),r=a.internal.pageSize.width,i=a.internal.pageSize.height;a.setFillColor(e.bg.accent[0],e.bg.accent[1],e.bg.accent[2]),a.rect(0,0,r,i,"F"),a.setFillColor(255,255,255),a.roundedRect(20,20,r-40,i-40,5,5,"F");let y=80;a.setFont(l.primary,l.style.bold),a.setFontSize(24),a.setTextColor(e.primary[0],e.primary[1],e.primary[2]),a.text("TU TESIS RD",r/2,y,{align:"center"}),y+=10,a.setFontSize(10),a.setFont(l.primary,l.style.regular),a.setTextColor(e.text.secondary[0],e.text.secondary[1],e.text.secondary[2]),a.text("SISTEMA DE AUDITORÍA ACADÉMICA",r/2,y,{align:"center"}),y+=50,a.setFontSize(28),a.setFont(l.primary,l.style.bold),a.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),a.text(s.getTitle(),r/2,y,{align:"center"}),y+=12,a.text(s.getSubTitle(),r/2,y,{align:"center"}),s.generate(a,t);const m=a.getNumberOfPages();for(let S=1;S<=m;S++)a.setPage(S),S>1&&E(a,S,m);a.save(`${o}_${new Date().getTime()}.pdf`)},N=(g,t)=>{R("consistency",g,t)};export{R as exportToPDF,N as generateConsistencyMatrixPDF};
