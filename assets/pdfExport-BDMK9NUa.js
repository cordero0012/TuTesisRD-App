import{E as C}from"./jspdf.es.min-VsqFO-Fk.js";import{autoTable as h}from"./jspdf.plugin.autotable-EgdT048U.js";import"./index-Bbth2Izj.js";const g={top:20,bottom:20,left:25,right:20},l={primary:"helvetica",style:{regular:"normal",bold:"bold"}},S={heading1:16,body:11,small:9},e={primary:[19,91,236],text:{main:[40,44,52],secondary:[100,100,100],light:[150,150,150]},status:{success:[16,185,129],warning:[245,158,11],error:[239,68,68]},bg:{header:[247,248,250],accent:[240,244,255]}},A=(s,t,o)=>{const i=s.internal.pageSize.height,r=s.internal.pageSize.width;s.setFont(l.primary,l.style.regular),s.setFontSize(S.small),s.setTextColor(e.text.light[0],e.text.light[1],e.text.light[2]),s.setDrawColor(220,220,220),s.line(g.left,i-g.bottom+5,r-g.right,i-g.bottom+5);const a=new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"});s.text("Tu Tesis RD – Informe Académico",g.left,i-g.bottom+10),s.text(a,r/2,i-g.bottom+10,{align:"center"}),s.text(`Página ${t} de ${o}`,r-g.right,i-g.bottom+10,{align:"right"})},F=(s,t,o,i,r)=>{const a=s.splitTextToSize(t,r);return s.text(a,o,i),i+a.length*6},f=(s,t,o)=>{const i=s.internal.pageSize.height;return t+o>i-g.bottom-10?(s.addPage(),g.top):t};class E{getTitle(){return"INFORME DE"}getSubTitle(){return"CONSISTENCIA METODOLÓGICA"}generate(t,o){t.internal.pageSize.width;const i=t.internal.pageSize.height,r=25;let a=135;const p=(n,x)=>{t.setFontSize(11),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.secondary[0],e.text.secondary[1],e.text.secondary[2]),t.text(n,40,a),t.setFont(l.primary,l.style.regular),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(x,80,a),a+=8};p("DOCUMENTO:",o.documentType||"Tesis de Grado"),p("ENFOQUE:",o.methodologicalApproach||"No identificado"),p("ÁREA:",o.disciplinaryArea||"Multidisciplinar"),p("NORMATIVA:",o.applicableStandards.join(", ")||"Estándar General"),t.addPage(),a=30,t.setFontSize(16),t.setFont(l.primary,l.style.bold),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("1. DIAGNÓSTICO GLOBAL",r,a),a+=15;const m=(n,x,y)=>{t.setFillColor(e.bg.header[0],e.bg.header[1],e.bg.header[2]),t.roundedRect(y,a,50,25,3,3,"F"),t.setFontSize(8),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.secondary[0],e.text.secondary[1],e.text.secondary[2]),t.text(n.toUpperCase(),y+25,a+8,{align:"center"}),t.setFontSize(14),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(String(x),y+25,a+18,{align:"center"})};m("Nivel General",o.globalDiagnosis.level,r),m("Consistencia",`${o.globalDiagnosis.internalConsistencyDegree}%`,r+55),m("Publicabilidad",`${o.globalDiagnosis.publishabilityLevel}%`,r+110),a+=40,t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("2. MATRIZ DE ALINEACIÓN",r,a),a+=5,h(t,{startY:a,head:[["Componente","Contenido Detectado","Estado","Observación"]],body:o.consistencyMatrix.map(n=>[n.element,n.description||"No detectado",n.coherenceLevel.toUpperCase(),n.technicalObservation||"Sin observaciones"]),theme:"plain",headStyles:{fillColor:[240,240,240],textColor:[40,44,52],fontStyle:"bold"},styles:{fontSize:9,cellPadding:4,textColor:[40,44,52]},columnStyles:{0:{fontStyle:"bold",cellWidth:35},1:{cellWidth:65},2:{halign:"center",cellWidth:25},3:{cellWidth:"auto"}},didParseCell:n=>{if(n.section==="body"&&n.column.index===2){const x=n.cell.raw;n.cell.styles.textColor=x==="BAJA"||x==="INEXISTENTE"?e.status.error:x==="MEDIA"?e.status.warning:e.status.success}}}),a=t.lastAutoTable.finalY+15,a>i-50&&(t.addPage(),a=30),t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("3. PLAN DE ACCIÓN",r,a),a+=15,o.prioritizedRecommendations.forEach((n,x)=>{a>i-40&&(t.addPage(),a=30);const y=`${x+1}. ${n.what} (${n.priority})`;t.setFontSize(11),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(y,r,a),a+=8})}}class I{getTitle(){return"INFORME DE"}getSubTitle(){return"REFERENCIAS BIBLIOGRÁFICAS"}generate(t,o){if(!Array.isArray(o))return;const i=o;let r=140;t.addPage(),r=g.top,t.setFontSize(S.heading1),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text("LISTADO DE REFERENCIAS",g.left,r),r+=15;const a=t.internal.pageSize.width-g.left-g.right;i.forEach((p,m)=>{r=f(t,r,25);const n=p.reference||{},x=n.title||"Sin título",y=n.authors&&Array.isArray(n.authors)?n.authors.join(", "):"Autor desconocido",u=n.publicationYear||"s.f.";t.setFontSize(S.body),t.setFont(l.primary,l.style.bold),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(`[${m+1}]`,g.left,r),t.setFont(l.primary,l.style.regular);const T=`${y} (${u}). ${x}.`;r=F(t,T,g.left+10,r,a-10),r+=2,t.setFontSize(S.small);const b=p.status==="verified"?"✓ VERIFICADO":"⚠ SIN VERIFICAR",c=p.status==="verified"?e.status.success:e.status.error;t.setTextColor(c[0],c[1],c[2]),t.text(b,g.left+10,r),r+=10})}}class d{getTitle(){return"INFORME DE"}getSubTitle(){return"AUDITORÍA DE PRENSA IA"}generate(t,o){const i=o;if(typeof i.score!="number")return;const r=25;t.addPage();let a=30;t.setFontSize(16),t.setTextColor(e.primary[0],e.primary[1],e.primary[2]),t.text(`PROBABILIDAD DE IA: ${(i.score*100).toFixed(1)}%`,r,a),a+=15,i.signals&&i.signals.length>0&&(t.setFontSize(14),t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text("Señales Detectadas",r,a),a+=10,i.signals.forEach(p=>{t.setFontSize(11),t.text(`• ${p}`,r+5,a),a+=7}),a+=10),i.heatmap&&(t.setFontSize(14),t.text("Análisis de Segmentos",r,a),a+=10,i.heatmap.forEach(p=>{const m=p.probability,n=`[${(m*100).toFixed(0)}%] ${p.text.substring(0,100)}...`;a>t.internal.pageSize.height-20&&(t.addPage(),a=30),t.setFontSize(10),m>.7?t.setTextColor(e.status.error[0],e.status.error[1],e.status.error[2]):m>.4?t.setTextColor(e.status.warning[0],e.status.warning[1],e.status.warning[2]):t.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),t.text(n,r,a),a+=6}))}}class D{getTitle(){return"TRANSCRIPCIÓN"}getSubTitle(){return"ENTREVISTA DE INVESTIGACIÓN"}generate(t,o){const i=o;if(!i.segments)return;t.addPage(),h(t,{startY:30,head:[["Tiempo","Contenido"]],body:i.segments.map(a=>[`${Math.floor(a.start/60)}:${Math.floor(a.start%60).toString().padStart(2,"0")}`,a.text]),columnStyles:{0:{cellWidth:20,fontStyle:"bold"},1:{cellWidth:"auto"}}})}}const R=(s,t,o="Reporte")=>{let i;switch(s){case"consistency":i=new E;break;case"references":i=new I;break;case"audit":i=new d;break;case"transcription":i=new D;break;default:console.error("Unknown export type");return}const r=new C({orientation:"portrait",unit:"mm",format:"letter"}),a=r.internal.pageSize.width,p=r.internal.pageSize.height;r.setFillColor(e.bg.accent[0],e.bg.accent[1],e.bg.accent[2]),r.rect(0,0,a,p,"F"),r.setFillColor(255,255,255),r.roundedRect(20,20,a-40,p-40,5,5,"F");let m=80;r.setFont(l.primary,l.style.bold),r.setFontSize(24),r.setTextColor(e.primary[0],e.primary[1],e.primary[2]),r.text("TU TESIS RD",a/2,m,{align:"center"}),m+=10,r.setFontSize(10),r.setFont(l.primary,l.style.regular),r.setTextColor(e.text.secondary[0],e.text.secondary[1],e.text.secondary[2]),r.text("SISTEMA DE AUDITORÍA ACADÉMICA",a/2,m,{align:"center"}),m+=50,r.setFontSize(28),r.setFont(l.primary,l.style.bold),r.setTextColor(e.text.main[0],e.text.main[1],e.text.main[2]),r.text(i.getTitle(),a/2,m,{align:"center"}),m+=12,r.text(i.getSubTitle(),a/2,m,{align:"center"}),i.generate(r,t);const n=r.getNumberOfPages();for(let x=1;x<=n;x++)r.setPage(x),x>1&&A(r,x,n);r.save(`${o}_${new Date().getTime()}.pdf`)},O=(s,t)=>{R("consistency",s,t)};export{R as exportToPDF,O as generateConsistencyMatrixPDF};
