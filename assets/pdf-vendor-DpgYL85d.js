const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-Cxktuana.js","assets/react-vendor-CxjHvgps.js"])))=>i.map(i=>d[i]);
var Ux=Object.defineProperty;var Ry=r=>{throw TypeError(r)};var Hx=(r,t,e)=>t in r?Ux(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var bt=(r,t,e)=>Hx(r,typeof t!="symbol"?t+"":t,e),l5=(r,t,e)=>t.has(r)||Ry("Cannot "+e);var l=(r,t,e)=>(l5(r,t,"read from private field"),e?e.call(r):t.get(r)),C=(r,t,e)=>t.has(r)?Ry("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),_=(r,t,e,i)=>(l5(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),E=(r,t,e)=>(l5(r,t,"access private method"),e);var cn=(r,t,e,i)=>({set _(n){_(r,t,n,e)},get _(){return l(r,t,i)}});const qx="modulepreload",zx=function(r){return"/TuTesisRD-App/"+r},Dy={},h5=function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=a(e.map(c=>{if(c=zx(c),c in Dy)return;Dy[c]=!0;const u=c.endsWith(".css"),p=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":qx,u||(g.as="script"),g.crossOrigin="",g.href=c,h&&g.setAttribute("nonce",h),document.head.appendChild(g),u)return new Promise((f,A)=>{g.addEventListener("load",f),g.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},hs=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),W5=[.001,0,0,.001,0,0],c5=1.35,Qs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},tl={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Xp="pdfjs_internal_editor_",ce={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},IA={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},G5={TRIANGLES:1,LATTICE:2},un={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Up={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Wi={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Hu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},X1={ERRORS:0,WARNINGS:1,INFOS:5},If={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},dp={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},FA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let A2=X1.WARNINGS;function Wx(r){Number.isInteger(r)&&(A2=r)}function Gx(){return A2}function _2(r){A2>=X1.INFOS&&console.info(`Info: ${r}`)}function ue(r){A2>=X1.WARNINGS&&console.warn(`Warning: ${r}`)}function hi(r){throw new Error(r)}function Me(r,t){r||hi(t)}function Vx(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Lv(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"){if(e.addDefaultProtocol&&r.startsWith("www.")){const n=r.match(/\./g);(n==null?void 0:n.length)>=2&&(r=`http://${r}`)}if(e.tryConvertEncoding)try{r=Jx(r)}catch{}}const i=t?URL.parse(r,t):URL.parse(r);return Vx(i)?i:null}function Ev(r,t,e=!1){const i=URL.parse(r);return i?(i.hash=t,i.href):e&&Lv(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function le(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const wu=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class Oy extends wu{constructor(t,e){super(t,"PasswordException"),this.code=e}}class u5 extends wu{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Om extends wu{constructor(t){super(t,"InvalidPDFException")}}class Yp extends wu{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class $x extends wu{constructor(t){super(t,"FormatError")}}class rl extends wu{constructor(t){super(t,"AbortException")}}function MA(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&hi("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let n=0;n<t;n+=e){const s=Math.min(n+e,t),a=r.subarray(n,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Y1(r){typeof r!="string"&&hi("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function Xx(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function Yx(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function Kx(){try{return new Function(""),!0}catch{return!1}}class en{static get isLittleEndian(){return le(this,"isLittleEndian",Yx())}static get isEvalSupported(){return le(this,"isEvalSupported",Kx())}static get isOffscreenCanvasSupported(){return le(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return le(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return le(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return le(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return le(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return le(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const d5=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var il,im,V5;class Mt{static makeHexColor(t,e,i){return`#${d5[t]}${d5[e]}${d5[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const n=t[i],s=t[i+1];t[i]=n*e[0]+s*e[2]+e[4],t[i+1]=n*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const n=e[0],s=e[1],a=e[2],o=e[3],h=e[4],c=e[5];for(let u=0;u<6;u+=2){const p=t[i+u],g=t[i+u+1];t[i+u]=p*n+g*a+h,t[i+u+1]=p*s+g*o+c}}static applyInverseTransform(t,e){const i=t[0],n=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-n*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-i*e[1]+n*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,i){const n=e[0],s=e[1],a=e[2],o=e[3],h=e[4],c=e[5],u=t[0],p=t[1],g=t[2],f=t[3];let A=n*u+h,v=A,S=n*g+h,w=S,k=o*p+c,L=k,P=o*f+c,D=P;if(s!==0||a!==0){const H=s*u,X=s*g,$=a*p,B=a*f;A+=$,w+=$,S+=B,v+=B,k+=H,D+=H,P+=X,L+=X}i[0]=Math.min(i[0],A,S,v,w),i[1]=Math.min(i[1],k,P,L,D),i[2]=Math.max(i[2],A,S,v,w),i[3]=Math.max(i[3],k,P,L,D)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],n=t[1],s=t[2],a=t[3],o=i**2+n**2,h=i*s+n*a,c=s**2+a**2,u=(o+c)/2,p=Math.sqrt(u**2-(o*c-h**2));e[0]=Math.sqrt(u+p||1),e[1]=Math.sqrt(u-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>a?null:[i,s,n,a]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,n,s){s[0]=Math.min(s[0],t,i),s[1]=Math.min(s[1],e,n),s[2]=Math.max(s[2],t,i),s[3]=Math.max(s[3],e,n)}static bezierBoundingBox(t,e,i,n,s,a,o,h,c){c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,h),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,h),E(this,il,V5).call(this,t,i,s,o,e,n,a,h,3*(-t+3*(i-s)+o),6*(t-2*i+s),3*(i-t),c),E(this,il,V5).call(this,t,i,s,o,e,n,a,h,3*(-e+3*(n-a)+h),6*(e-2*n+a),3*(n-e),c)}}il=new WeakSet,im=function(t,e,i,n,s,a,o,h,c,u){if(c<=0||c>=1)return;const p=1-c,g=c*c,f=g*c,A=p*(p*(p*t+3*c*e)+3*g*i)+f*n,v=p*(p*(p*s+3*c*a)+3*g*o)+f*h;u[0]=Math.min(u[0],A),u[1]=Math.min(u[1],v),u[2]=Math.max(u[2],A),u[3]=Math.max(u[3],v)},V5=function(t,e,i,n,s,a,o,h,c,u,p,g){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&E(this,il,im).call(this,t,e,i,n,s,a,o,h,-p/u,g);return}const f=u**2-4*p*c;if(f<0)return;const A=Math.sqrt(f),v=2*c;E(this,il,im).call(this,t,e,i,n,s,a,o,h,(-u+A)/v,g),E(this,il,im).call(this,t,e,i,n,s,a,o,h,(-u-A)/v,g)},C(Mt,il);function Jx(r){return decodeURIComponent(escape(r))}let f5=null,By=null;function RA(r){return f5||(f5=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,By=new Map([["ﬅ","ſt"]])),r.replaceAll(f5,(t,e,i)=>e?e.normalize("NFKC"):By.get(i))}function kv(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),MA(r)}const Ju="pdfjs_internal_id_";function Zx(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,n,...s]=e;if(!r(i)&&!Number.isInteger(i)||!t(n))return!1;const a=s.length;let o=!0;switch(n.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const h of s)if(!(typeof h=="number"||o&&h===null))return!1;return!0}function Qn(r,t,e){return Math.min(Math.max(r,t),e)}function DA(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(MA(r))}function Qx(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):Y1(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...t){return new Promise(e=>{e(r(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});class Kp{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(s){var h;if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(Kp.shouldBuildText(o))(h=s==null?void 0:s.attributes)!=null&&h.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&e.push({str:a}),!!s.children)for(const c of s.children)n(c)}return n(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Pv{static setupStorage(t,e,i,n,s){const a=n.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),s==="print")break;t.addEventListener("input",o=>{n.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",o=>{n.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),s==="print")break;t.addEventListener("input",o=>{n.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const h=o.target.options,c=h.selectedIndex===-1?"":h[h.selectedIndex].value;n.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:s}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[h,c]of Object.entries(a))if(c!=null)switch(h){case"class":c.length&&t.setAttribute(h,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,c)}o&&s.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var p,g;const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,s=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:s,linkService:i});const o=s!=="richText",h=t.div;if(h.append(a),t.viewport){const f=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=f}o&&h.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const f=document.createTextNode(n.value);a.append(f),o&&Kp.shouldBuildText(n.name)&&c.push(f)}return{textDivs:c}}const u=[[n,-1,a]];for(;u.length>0;){const[f,A,v]=u.at(-1);if(A+1===f.children.length){u.pop();continue}const S=f.children[++u.at(-1)[1]];if(S===null)continue;const{name:w}=S;if(w==="#text"){const L=document.createTextNode(S.value);c.push(L),v.append(L);continue}const k=(p=S==null?void 0:S.attributes)!=null&&p.xmlns?document.createElementNS(S.attributes.xmlns,w):document.createElement(w);if(v.append(k),S.attributes&&this.setAttributes({html:k,element:S,storage:e,intent:s,linkService:i}),((g=S.children)==null?void 0:g.length)>0)u.push([S,-1,k]);else if(S.value){const L=document.createTextNode(S.value);o&&Kp.shouldBuildText(w)&&c.push(L),k.append(L)}}for(const f of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const po="http://www.w3.org/2000/svg",Xh=class Xh{};bt(Xh,"CSS",96),bt(Xh,"PDF",72),bt(Xh,"PDF_TO_CSS_UNITS",Xh.CSS/Xh.PDF);let al=Xh;async function Rf(r,t="text"){if(yp(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}i(new Error(n.statusText))}},n.send(null)})}class K1{constructor({viewBox:t,userUnit:e,scale:i,rotation:n,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=n,this.offsetX=s,this.offsetY=a,i*=e;const h=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let u,p,g,f;switch(n%=360,n<0&&(n+=360),n){case 180:u=-1,p=0,g=0,f=1;break;case 90:u=0,p=1,g=1,f=0;break;case 270:u=0,p=-1,g=-1,f=0;break;case 0:u=1,p=0,g=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(g=-g,f=-f);let A,v,S,w;u===0?(A=Math.abs(c-t[1])*i+s,v=Math.abs(h-t[0])*i+a,S=(t[3]-t[1])*i,w=(t[2]-t[0])*i):(A=Math.abs(h-t[0])*i+s,v=Math.abs(c-t[1])*i+a,S=(t[2]-t[0])*i,w=(t[3]-t[1])*i),this.transform=[u*i,p*i,g*i,f*i,A-u*i*h-g*i*c,v-p*i*h-f*i*c],this.width=S,this.height=w}get rawDims(){const t=this.viewBox;return le(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new K1({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}convertToViewportPoint(t,e){const i=[t,e];return Mt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];Mt.applyTransform(e,this.transform);const i=[t[2],t[3]];return Mt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return Mt.applyInverseTransform(i,this.transform),i}}class S2 extends wu{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function J1(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function x2(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function OA(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function BA(r,t="document.pdf"){if(typeof r!="string")return t;if(J1(r))return ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(r);if(!i)return t;const n=o=>{try{let h=decodeURIComponent(o);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:o):h}catch{return o}},s=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(s.test(a))return n(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const c of o)if(s.test(c))return n(c);const h=Array.from(i.searchParams.keys()).reverse();for(const c of h)if(s.test(c))return n(c)}if(i.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(h)return n(h[0])}return t}class jy{constructor(){bt(this,"started",Object.create(null));bt(this,"times",[])}time(t){t in this.started&&ue(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ue(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-n}ms
`);return t.join("")}}function yp(r,t){const e=t?URL.parse(r,t):URL.parse(r);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function sr(r){r.preventDefault()}function ki(r){r.preventDefault(),r.stopPropagation()}function t4(r){console.log("Deprecated API usage: "+r)}var sg;class Jp{static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;l(this,sg)||_(this,sg,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=l(this,sg).exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const c=e[7]||"Z";let u=parseInt(e[8],10);u=u>=0&&u<=23?u:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,c==="-"?(a+=u,o+=p):c==="+"&&(a-=u,o-=p),new Date(Date.UTC(i,n,s,a,o,h))}}sg=new WeakMap,C(Jp,sg);function jA(r,{scale:t=1,rotation:e=0}){const{width:i,height:n}=r.attributes.style,s=[0,0,parseInt(i),parseInt(n)];return new K1({viewBox:s,userUnit:1,scale:t,rotation:e})}function Df(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ue(`Not a valid color format: "${r}"`),[0,0,0])}function e4(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,Df(i))}t.remove()}function Ei(r){const{a:t,b:e,c:i,d:n,e:s,f:a}=r.getTransform();return[t,e,i,n,s,a]}function ga(r){const{a:t,b:e,c:i,d:n,e:s,f:a}=r.getTransform().invertSelf();return[t,e,i,n,s,a]}function _h(r,t,e=!1,i=!0){if(t instanceof K1){const{pageWidth:n,pageHeight:s}=t.rawDims,{style:a}=r,o=en.isCSSRoundSupported,h=`var(--total-scale-factor) * ${n}px`,c=`var(--total-scale-factor) * ${s}px`,u=o?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,p=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!e||t.rotation%180===0?(a.width=u,a.height=p):(a.width=p,a.height=u)}i&&r.setAttribute("data-main-rotation",t.rotation)}class ea{constructor(){const{pixelRatio:t}=ea;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,n,s=-1){let a=1/0,o=1/0,h=1/0;i=ea.capPixels(i,s),i>0&&(a=Math.sqrt(i/(t*e))),n!==-1&&(o=n/t,h=n/e);const c=Math.min(a,o,h);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const Bm=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class i4{static get isDarkMode(){var t;return le(this,"isDarkMode",!!((t=window==null?void 0:window.matchMedia)!=null&&t.call(window,"(prefers-color-scheme: dark)").matches))}}class UA{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),le(this,"commentForegroundColor",Df(i))}}function HA(r,t,e,i){i=Math.min(Math.max(i??1,0),1);const n=255*(1-i);return r=Math.round(r*i+n),t=Math.round(t*i+n),e=Math.round(e*i+n),[r,t,e]}function Uy(r,t){const e=r[0]/255,i=r[1]/255,n=r[2]/255,s=Math.max(e,i,n),a=Math.min(e,i,n),o=(s+a)/2;if(s===a)t[0]=t[1]=0;else{const h=s-a;switch(t[1]=o<.5?h/(s+a):h/(2-s-a),s){case e:t[0]=((i-n)/h+(i<n?6:0))*60;break;case i:t[0]=((n-e)/h+2)*60;break;case n:t[0]=((e-i)/h+4)*60;break}}t[2]=o}function $5(r,t){const e=r[0],i=r[1],n=r[2],s=(1-Math.abs(2*n-1))*i,a=s*(1-Math.abs(e/60%2-1)),o=n-s/2;switch(Math.floor(e/60)){case 0:t[0]=s+o,t[1]=a+o,t[2]=o;break;case 1:t[0]=a+o,t[1]=s+o,t[2]=o;break;case 2:t[0]=o,t[1]=s+o,t[2]=a+o;break;case 3:t[0]=o,t[1]=a+o,t[2]=s+o;break;case 4:t[0]=a+o,t[1]=o,t[2]=s+o;break;case 5:case 6:t[0]=s+o,t[1]=o,t[2]=a+o;break}}function Hy(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function qy(r,t,e){$5(r,e),e.map(Hy);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];$5(t,e),e.map(Hy);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)}const zy=new Map;function qA(r,t){const e=r[0]+r[1]*256+r[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=zy.get(e);if(i)return i;const n=new Float32Array(9),s=n.subarray(0,3),a=n.subarray(3,6);Uy(r,a);const o=n.subarray(6,9);Uy(t,o);const h=o[2]<.5,c=h?12:4.5;if(a[2]=h?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),qy(a,o,s)<c){let u,p;h?(u=a[2],p=1):(u=0,p=a[2]);const g=.005;for(;p-u>g;){const f=a[2]=(u+p)/2;h===qy(a,o,s)<c?u=f:p=f}a[2]=h?p:u}return $5(a,s),i=Mt.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),zy.set(e,i),i}function Nv({html:r,dir:t,className:e},i){const n=document.createDocumentFragment();if(typeof r=="string"){const s=document.createElement("p");s.dir=t||"auto";const a=r.split(/(?:\r\n?|\n)/);for(let o=0,h=a.length;o<h;++o){const c=a[o];s.append(document.createTextNode(c)),o<h-1&&s.append(document.createElement("br"))}n.append(s)}else Pv.render({xfaHtml:r,div:n,intent:"richText"});n.firstElementChild.classList.add("richText",e),i.append(n)}function zA(r){const t=new Path2D;if(!r)return t;for(let e=0,i=r.length;e<i;)switch(r[e++]){case dp.moveTo:t.moveTo(r[e++],r[e++]);break;case dp.lineTo:t.lineTo(r[e++],r[e++]);break;case dp.curveTo:t.bezierCurveTo(r[e++],r[e++],r[e++],r[e++],r[e++],r[e++]);break;case dp.quadraticCurveTo:t.quadraticCurveTo(r[e++],r[e++],r[e++],r[e++]);break;case dp.closePath:t.closePath();break;default:ue(`Unrecognized drawing path operator: ${r[e-1]}`);break}return t}var Nl,Tl,mr,br,rg,Il,rd,ad,ag,i2,WA,jn,GA,VA,qu,wp;const bo=class bo{constructor(t){C(this,jn);C(this,Nl,null);C(this,Tl,null);C(this,mr);C(this,br,null);C(this,rg,null);C(this,Il,null);C(this,rd,null);C(this,ad,null);_(this,mr,t),l(bo,ag)||_(bo,ag,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=_(this,Nl,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=l(this,mr)._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",sr,{signal:e}),t.addEventListener("pointerdown",E(bo,i2,WA),{signal:e}));const i=_(this,br,document.createElement("div"));i.className="buttons",t.append(i);const n=l(this,mr).toolbarPosition;if(n){const{style:s}=t,a=l(this,mr)._uiManager.direction==="ltr"?1-n[0]:n[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return l(this,Nl)}hide(){var t;l(this,Nl).classList.add("hidden"),(t=l(this,Tl))==null||t.hideDropdown()}show(){var t,e;l(this,Nl).classList.remove("hidden"),(t=l(this,rg))==null||t.shown(),(e=l(this,Il))==null||e.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=l(this,mr),i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",l(bo,ag)[t]),E(this,jn,qu).call(this,i)&&i.addEventListener("click",n=>{e.delete()},{signal:e._signal}),l(this,br).append(i)}async addAltText(t){const e=await t.render();E(this,jn,qu).call(this,e),l(this,br).append(e,l(this,jn,wp)),_(this,rg,t)}addComment(t,e=null){if(l(this,Il))return;const i=t.renderForToolbar();if(!i)return;E(this,jn,qu).call(this,i);const n=_(this,rd,l(this,jn,wp));e?(l(this,br).insertBefore(i,e),l(this,br).insertBefore(n,e)):l(this,br).append(i,n),_(this,Il,t),t.toolbar=this}addColorPicker(t){if(l(this,Tl))return;_(this,Tl,t);const e=t.renderButton();E(this,jn,qu).call(this,e),l(this,br).append(e,l(this,jn,wp))}async addEditSignatureButton(t){const e=_(this,ad,await t.renderEditButton(l(this,mr)));E(this,jn,qu).call(this,e),l(this,br).append(e,l(this,jn,wp))}removeButton(t){var e,i;switch(t){case"comment":(e=l(this,Il))==null||e.removeToolbarCommentButton(),_(this,Il,null),(i=l(this,rd))==null||i.remove(),_(this,rd,null);break}}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const n=l(this,br).querySelector(i);n&&t==="comment"&&this.addComment(e,n)}updateEditSignatureButton(t){l(this,ad)&&(l(this,ad).title=t)}remove(){var t;l(this,Nl).remove(),(t=l(this,Tl))==null||t.destroy(),_(this,Tl,null)}};Nl=new WeakMap,Tl=new WeakMap,mr=new WeakMap,br=new WeakMap,rg=new WeakMap,Il=new WeakMap,rd=new WeakMap,ad=new WeakMap,ag=new WeakMap,i2=new WeakSet,WA=function(t){t.stopPropagation()},jn=new WeakSet,GA=function(t){l(this,mr)._focusEventsAllowed=!1,ki(t)},VA=function(t){l(this,mr)._focusEventsAllowed=!0,ki(t)},qu=function(t){const e=l(this,mr)._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",E(this,jn,GA).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",E(this,jn,VA).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",sr,{signal:e}),!0)},wp=function(){const t=document.createElement("div");return t.className="divider",t},C(bo,i2),C(bo,ag,null);let X5=bo;var og,Zh,wo,ll,$A,XA,Y5;class n4{constructor(t){C(this,ll);C(this,og,null);C(this,Zh,null);C(this,wo);_(this,wo,t)}show(t,e,i){const[n,s]=E(this,ll,XA).call(this,e,i),{style:a}=l(this,Zh)||_(this,Zh,E(this,ll,$A).call(this));t.append(l(this,Zh)),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,Zh).remove()}}og=new WeakMap,Zh=new WeakMap,wo=new WeakMap,ll=new WeakSet,$A=function(){const t=_(this,Zh,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar");const e=l(this,wo)._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",sr,{signal:e});const i=_(this,og,document.createElement("div"));return i.className="buttons",t.append(i),l(this,wo).hasCommentManager()&&E(this,ll,Y5).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{l(this,wo).commentSelection("floating_button")}),E(this,ll,Y5).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{l(this,wo).highlightSelection("floating_button")}),t},XA=function(t,e){let i=0,n=0;for(const s of t){const a=s.y+s.height;if(a<i)continue;const o=s.x+(e?s.width:0);if(a>i){n=o,i=a;continue}e?o>n&&(n=o):o<n&&(n=o)}return[e?1-n:n,i]},Y5=function(t,e,i,n){const s=document.createElement("button");s.classList.add("basic",t),s.tabIndex=0,s.setAttribute("data-l10n-id",e);const a=document.createElement("span");s.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",i);const o=l(this,wo)._signal;o instanceof AbortSignal&&!o.aborted&&(s.addEventListener("contextmenu",sr,{signal:o}),s.addEventListener("click",n,{signal:o})),l(this,og).append(s)};function YA(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}var Qh,tc,od,ec;const Je=class Je{static initializeAndAddPointerId(t){(l(Je,tc)||_(Je,tc,new Set)).add(t)}static setPointer(t,e){l(Je,Qh)||_(Je,Qh,e),l(Je,ec)??_(Je,ec,t)}static setTimeStamp(t){_(Je,od,t)}static isSamePointerId(t){return l(Je,Qh)===t}static isSamePointerIdOrRemove(t){var e;return l(Je,Qh)===t?!0:((e=l(Je,tc))==null||e.delete(t),!1)}static isSamePointerType(t){return l(Je,ec)===t}static isInitializedAndDifferentPointerType(t){return l(Je,ec)!==null&&!Je.isSamePointerType(t)}static isSameTimeStamp(t){return l(Je,od)===t}static isUsingMultiplePointers(){var t;return((t=l(Je,tc))==null?void 0:t.size)>=1}static clearPointerType(){_(Je,ec,null)}static clearPointerIds(){_(Je,Qh,NaN),_(Je,tc,null)}static clearTimeStamp(){_(Je,od,NaN)}};Qh=new WeakMap,tc=new WeakMap,od=new WeakMap,ec=new WeakMap,C(Je,Qh,NaN),C(Je,tc,null),C(Je,od,NaN),C(Je,ec,null);let $n=Je;var n2;class s4{constructor(){C(this,n2,0)}get id(){return`${Xp}${cn(this,n2)._++}`}}n2=new WeakMap;var ld,lg,Xn,hd,nm;const Vv=class Vv{constructor(){C(this,hd);C(this,ld,kv());C(this,lg,0);C(this,Xn,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const s=n.decode().then(()=>(i.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return le(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:i,size:n,type:s}=t;return E(this,hd,nm).call(this,`${e}_${i}_${n}_${s}`,t)}async getFromUrl(t){return E(this,hd,nm).call(this,t,t)}async getFromBlob(t,e){const i=await e;return E(this,hd,nm).call(this,t,i)}async getFromId(t){l(this,Xn)||_(this,Xn,new Map);const e=l(this,Xn).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){l(this,Xn)||_(this,Xn,new Map);let i=l(this,Xn).get(t);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),i={bitmap:n.transferToImageBitmap(),id:`image_${l(this,ld)}_${cn(this,lg)._++}`,refCounter:1,isSvg:!1},l(this,Xn).set(t,i),l(this,Xn).set(i.id,i),i}getSvgUrl(t){const e=l(this,Xn).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var n;l(this,Xn)||_(this,Xn,new Map);const e=l(this,Xn).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=s.convertToBlob()}(n=i.close)==null||n.call(i),e.bitmap=null}isValidId(t){return t.startsWith(`image_${l(this,ld)}_`)}};ld=new WeakMap,lg=new WeakMap,Xn=new WeakMap,hd=new WeakSet,nm=async function(t,e){l(this,Xn)||_(this,Xn,new Map);let i=l(this,Xn).get(t);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${l(this,ld)}_${cn(this,lg)._++}`,refCounter:0,isSvg:!1});let n;if(typeof e=="string"?(i.url=e,n=await Rf(e,"blob")):e instanceof File?n=i.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const s=Vv._isSVGFittingCanvas,a=new FileReader,o=new Image,h=new Promise((c,u)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const p=i.svgUrl=a.result;o.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},o.onerror=a.onerror=u});a.readAsDataURL(n),await h}else i.bitmap=await createImageBitmap(n);i.refCounter=1}catch(n){ue(n),i=null}return l(this,Xn).set(t,i),i&&l(this,Xn).set(i.id,i),i};let K5=Vv;var Gi,Fl,hg,Li;class r4{constructor(t=128){C(this,Gi,[]);C(this,Fl,!1);C(this,hg);C(this,Li,-1);_(this,hg,t)}add({cmd:t,undo:e,post:i,mustExec:n,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(n&&t(),l(this,Fl))return;const h={cmd:t,undo:e,post:i,type:s};if(l(this,Li)===-1){l(this,Gi).length>0&&(l(this,Gi).length=0),_(this,Li,0),l(this,Gi).push(h);return}if(a&&l(this,Gi)[l(this,Li)].type===s){o&&(h.undo=l(this,Gi)[l(this,Li)].undo),l(this,Gi)[l(this,Li)]=h;return}const c=l(this,Li)+1;c===l(this,hg)?l(this,Gi).splice(0,1):(_(this,Li,c),c<l(this,Gi).length&&l(this,Gi).splice(c)),l(this,Gi).push(h)}undo(){if(l(this,Li)===-1)return;_(this,Fl,!0);const{undo:t,post:e}=l(this,Gi)[l(this,Li)];t(),e==null||e(),_(this,Fl,!1),_(this,Li,l(this,Li)-1)}redo(){if(l(this,Li)<l(this,Gi).length-1){_(this,Li,l(this,Li)+1),_(this,Fl,!0);const{cmd:t,post:e}=l(this,Gi)[l(this,Li)];t(),e==null||e(),_(this,Fl,!1)}}hasSomethingToUndo(){return l(this,Li)!==-1}hasSomethingToRedo(){return l(this,Li)<l(this,Gi).length-1}cleanType(t){if(l(this,Li)!==-1){for(let e=l(this,Li);e>=0;e--)if(l(this,Gi)[e].type!==t){l(this,Gi).splice(e+1,l(this,Li)-e),_(this,Li,e);return}l(this,Gi).length=0,_(this,Li,-1)}}destroy(){_(this,Gi,null)}}Gi=new WeakMap,Fl=new WeakMap,hg=new WeakMap,Li=new WeakMap;var s2,KA;class Z1{constructor(t){C(this,s2);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=en.platform;for(const[i,n,s={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(E(this,s2,KA).call(this,e));if(!i)return;const{callback:n,options:{bubbles:s=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(n.bind(t,...a,e)(),s||ki(e))}}s2=new WeakSet,KA=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const r2=class r2{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return e4(t),le(this,"_colors",t)}convert(t){const e=Df(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every((s,a)=>s===e[a]))return r2._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?Mt.makeHexColor(...e):t}};bt(r2,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let J5=r2;var cd,Ms,ud,Fi,fn,dd,vr,fd,yr,Yn,Ml,Rl,pd,Dl,wa,wr,ic,cg,ug,gd,dg,Aa,Ol,md,Bl,_a,a2,jl,bd,fg,Ul,nc,vd,Hl,pg,tn,Xe,Ao,ql,zl,gg,yd,mg,Wl,Sa,_o,bg,vg,Ar,Nt,sm,Z5,JA,ZA,Ap,QA,t_,e_,Q5,i_,n_,s_,r_,ss,go,a_,o_,tb,l_,_p,eb;const Qu=class Qu{constructor(t,e,i,n,s,a,o,h,c,u,p,g,f,A,v,S){C(this,Nt);C(this,cd,new AbortController);C(this,Ms,null);C(this,ud,null);C(this,Fi,new Map);C(this,fn,new Map);C(this,dd,null);C(this,vr,null);C(this,fd,null);C(this,yr,new r4);C(this,Yn,null);C(this,Ml,null);C(this,Rl,null);C(this,pd,0);C(this,Dl,new Set);C(this,wa,null);C(this,wr,null);C(this,ic,new Set);bt(this,"_editorUndoBar",null);C(this,cg,!1);C(this,ug,!1);C(this,gd,!1);C(this,dg,null);C(this,Aa,null);C(this,Ol,null);C(this,md,null);C(this,Bl,!1);C(this,_a,null);C(this,a2,new s4);C(this,jl,!1);C(this,bd,!1);C(this,fg,!1);C(this,Ul,null);C(this,nc,null);C(this,vd,null);C(this,Hl,null);C(this,pg,null);C(this,tn,ce.NONE);C(this,Xe,new Set);C(this,Ao,null);C(this,ql,null);C(this,zl,null);C(this,gg,null);C(this,yd,null);C(this,mg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});C(this,Wl,[0,0]);C(this,Sa,null);C(this,_o,null);C(this,bg,null);C(this,vg,null);C(this,Ar,null);const w=this._signal=l(this,cd).signal;_(this,_o,t),_(this,bg,e),_(this,vg,i),_(this,dd,n),_(this,Yn,s),_(this,ql,a),_(this,yd,h),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:w}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:w}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:w}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:w}),o._on("setpreference",this.onSetPreference.bind(this),{signal:w}),o._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:w}),window.addEventListener("pointerdown",()=>{_(this,bd,!0)},{capture:!0,signal:w}),window.addEventListener("pointerup",()=>{_(this,bd,!1)},{capture:!0,signal:w}),E(this,Nt,QA).call(this),E(this,Nt,r_).call(this),E(this,Nt,Q5).call(this),_(this,vr,h.annotationStorage),_(this,dg,h.filterFactory),_(this,zl,c),_(this,md,u||null),_(this,cg,p),_(this,ug,g),_(this,gd,f),_(this,pg,A||null),this.viewParameters={realScale:al.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=S!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const t=Qu.prototype,e=a=>l(a,_o).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:h}=o;return h!=="text"&&h!=="number"}return!0},n=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return le(this,"_keyboardManager",new Z1([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,_o).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,_o).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e,i,n,s,a,o,h,c;(t=l(this,Ar))==null||t.resolve(),_(this,Ar,null),(e=l(this,cd))==null||e.abort(),_(this,cd,null),this._signal=null;for(const u of l(this,fn).values())u.destroy();l(this,fn).clear(),l(this,Fi).clear(),l(this,ic).clear(),(i=l(this,Hl))==null||i.clear(),_(this,Ms,null),l(this,Xe).clear(),l(this,yr).destroy(),(n=l(this,dd))==null||n.destroy(),(s=l(this,Yn))==null||s.destroy(),(a=l(this,ql))==null||a.destroy(),(o=l(this,_a))==null||o.hide(),_(this,_a,null),(h=l(this,vd))==null||h.destroy(),_(this,vd,null),_(this,ud,null),l(this,Aa)&&(clearTimeout(l(this,Aa)),_(this,Aa,null)),l(this,Sa)&&(clearTimeout(l(this,Sa)),_(this,Sa,null)),(c=this._editorUndoBar)==null||c.destroy(),_(this,yd,null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return l(this,pg)}get useNewAltTextFlow(){return l(this,ug)}get useNewAltTextWhenAddingImage(){return l(this,gd)}get hcmFilter(){return le(this,"hcmFilter",l(this,zl)?l(this,dg).addHCMFilter(l(this,zl).foreground,l(this,zl).background):"none")}get direction(){return le(this,"direction",getComputedStyle(l(this,_o)).direction)}get _highlightColors(){return le(this,"_highlightColors",l(this,md)?new Map(l(this,md).split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return le(this,"highlightColors",null);const e=new Map,i=!!l(this,zl);for(const[n,s]of t){const a=n.endsWith("_HCM");if(i&&a){e.set(n.replace("_HCM",""),s);continue}!i&&!a&&e.set(n,s)}return le(this,"highlightColors",e)}get highlightColorNames(){return le(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),_(this,Rl,t)}setMainHighlightColorPicker(t){_(this,vd,t)}editAltText(t,e=!1){var i;(i=l(this,dd))==null||i.editAltText(this,t,e)}hasCommentManager(){return!!l(this,Yn)}editComment(t,e,i,n){var s;(s=l(this,Yn))==null||s.showDialog(this,t,e,i,n)}selectComment(t,e){const i=l(this,fn).get(t),n=i==null?void 0:i.getEditorByUID(e);n==null||n.toggleComment(!0,!0)}updateComment(t){var e;(e=l(this,Yn))==null||e.updateComment(t.getData())}updatePopupColor(t){var e;(e=l(this,Yn))==null||e.updatePopupColor(t)}removeComment(t){var e;(e=l(this,Yn))==null||e.removeComments([t.uid])}toggleComment(t,e,i=void 0){var n;(n=l(this,Yn))==null||n.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){var i;return t&&((i=l(this,Yn))==null?void 0:i.makeCommentColor(t,e))||null}getCommentDialogElement(){var t;return((t=l(this,Yn))==null?void 0:t.dialogElement)||null}async waitForEditorsRendered(t){if(l(this,fn).has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),n=s=>{s.pageNumber===t&&(this._eventBus._off("editorsrendered",n),e())};this._eventBus.on("editorsrendered",n),await i}getSignature(t){var e;(e=l(this,ql))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return l(this,ql)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":_(this,gd,e);break}}onPageChanging({pageNumber:t}){_(this,pd,t-1)}focusMainContainer(){l(this,_o).focus()}findParent(t,e){for(const i of l(this,fn).values()){const{x:n,y:s,width:a,height:o}=i.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=s&&e<=s+o)return i}return null}disableUserSelect(t=!1){l(this,bg).classList.toggle("noUserSelect",t)}addShouldRescale(t){l(this,ic).add(t)}removeShouldRescale(t){l(this,ic).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*al.PDF_TO_CSS_UNITS;for(const i of l(this,ic))i.onScaleChanging();(e=l(this,Rl))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:o}=i,h=i.toString(),u=E(this,Nt,sm).call(this,i).closest(".textLayer"),p=this.getSelectionBoxes(u);if(!p)return;i.empty();const g=E(this,Nt,Z5).call(this,u),f=l(this,tn)===ce.NONE,A=()=>{const v=g==null?void 0:g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:o,text:h});f&&this.showAllEditors("highlight",!0,!0),e&&(v==null||v.editComment())};if(f){this.switchToMode(ce.HIGHLIGHT,A);return}A()}commentSelection(t=""){this.highlightSelection(t,!0)}getAndRemoveDataFromAnnotationStorage(t){if(!l(this,vr))return null;const e=`${Xp}${t}`,i=l(this,vr).getRawValue(e);return i&&l(this,vr).remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&l(this,vr)&&!l(this,vr).has(t.id)&&l(this,vr).setValue(t.id,t)}a11yAlert(t,e=null){const i=l(this,vg);i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,l(this,Bl)&&(_(this,Bl,!1),E(this,Nt,Ap).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of l(this,Xe))if(e.div.contains(t)){_(this,nc,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!l(this,nc))return;const[t,e]=l(this,nc);_(this,nc,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){E(this,Nt,Q5).call(this),this.setEditingState(!0)}removeEditListeners(){E(this,Nt,i_).call(this),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of l(this,wr))if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of l(this,wr))if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var i;if(t.preventDefault(),(i=l(this,Ms))==null||i.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of l(this,Xe)){const s=n.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const a of l(this,wr))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){ue(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const s=[];for(const h of i){const c=await n.deserialize(h);if(!c)return;s.push(c)}const a=()=>{for(const h of s)E(this,Nt,tb).call(this,h);E(this,Nt,eb).call(this,s)},o=()=>{for(const h of s)h.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){ue(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,tn)!==ce.NONE&&!this.isEditorHandlingKeyboard&&Qu._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Bl)&&(_(this,Bl,!1),E(this,Nt,Ap).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(t){t?(E(this,Nt,t_).call(this),E(this,Nt,n_).call(this),E(this,Nt,ss).call(this,{isEditing:l(this,tn)!==ce.NONE,isEmpty:E(this,Nt,_p).call(this),hasSomethingToUndo:l(this,yr).hasSomethingToUndo(),hasSomethingToRedo:l(this,yr).hasSomethingToRedo(),hasSelectedEditor:!1})):(E(this,Nt,e_).call(this),E(this,Nt,s_).call(this),E(this,Nt,ss).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!l(this,wr)){_(this,wr,t);for(const e of l(this,wr))E(this,Nt,go).call(this,e.defaultPropertiesToUpdate)}}getId(){return l(this,a2).id}get currentLayer(){return l(this,fn).get(l(this,pd))}getLayer(t){return l(this,fn).get(t)}get currentPageIndex(){return l(this,pd)}addLayer(t){l(this,fn).set(t.pageIndex,t),l(this,jl)?t.enable():t.disable()}removeLayer(t){l(this,fn).delete(t.pageIndex)}async updateMode(t,e=null,i=!1,n=!1,s=!1,a=!1){var o,h,c,u,p,g;if(l(this,tn)!==t&&!(l(this,Ar)&&(await l(this,Ar).promise,!l(this,Ar)))){if(_(this,Ar,Promise.withResolvers()),(o=l(this,Rl))==null||o.commitOrRemove(),l(this,tn)===ce.POPUP&&((h=l(this,Yn))==null||h.hideSidebar()),(c=l(this,Yn))==null||c.destroyPopup(),_(this,tn,t),t===ce.NONE){this.setEditingState(!1),E(this,Nt,o_).call(this);for(const f of l(this,Fi).values())f.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),l(this,Ar).resolve();return}for(const f of l(this,Fi).values())f.addStandaloneCommentButton();t===ce.SIGNATURE&&await((p=l(this,ql))==null?void 0:p.loadSignatures()),i&&$n.clearPointerType(),this.setEditingState(!0),await E(this,Nt,a_).call(this),this.unselectAll();for(const f of l(this,fn).values())f.updateMode(t);if(t===ce.POPUP){l(this,ud)||_(this,ud,await l(this,yd).getAnnotationsByType(new Set(l(this,wr).map(v=>v._editorType))));const f=new Set,A=[];for(const v of l(this,Fi).values()){const{annotationElementId:S,hasComment:w,deleted:k}=v;S&&f.add(S),w&&!k&&A.push(v.getData())}for(const v of l(this,ud)){const{id:S,popupRef:w,contentsObj:k}=v;w&&(k!=null&&k.str)&&!f.has(S)&&!l(this,Dl).has(S)&&A.push(v)}(g=l(this,Yn))==null||g.showSidebar(A)}if(!e){n&&this.addNewEditorFromKeyboard(),l(this,Ar).resolve();return}for(const f of l(this,Fi).values())f.uid===e?(this.setSelected(f),a?f.editComment():s?f.enterInEditMode():f.focus()):f.unselect();l(this,Ar).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==l(this,tn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(l(this,wr)){switch(t){case Te.CREATE:this.currentLayer.addNewEditor(e);return;case Te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,gg)||_(this,gg,new Map)).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of l(this,Xe))i.updateParams(t,e);else for(const i of l(this,wr))i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var s;for(const a of l(this,Fi).values())a.editorType===t&&a.show(e);(((s=l(this,gg))==null?void 0:s.get(Te.HIGHLIGHT_SHOW_ALL))??!0)!==e&&E(this,Nt,go).call(this,[[Te.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(l(this,fg)!==t){_(this,fg,t);for(const e of l(this,fn).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}*getEditors(t){for(const e of l(this,Fi).values())e.pageIndex===t&&(yield e)}getEditor(t){return l(this,Fi).get(t)}addEditor(t){l(this,Fi).set(t.id,t)}removeEditor(t){var e,i;t.div.contains(document.activeElement)&&(l(this,Aa)&&clearTimeout(l(this,Aa)),_(this,Aa,setTimeout(()=>{this.focusMainContainer(),_(this,Aa,null)},0))),l(this,Fi).delete(t.id),t.annotationElementId&&((e=l(this,Hl))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!l(this,Dl).has(t.annotationElementId))&&((i=l(this,vr))==null||i.remove(t.id))}addDeletedAnnotationElement(t){l(this,Dl).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return l(this,Dl).has(t)}removeDeletedAnnotationElement(t){l(this,Dl).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){l(this,Ms)!==t&&(_(this,Ms,t),t&&E(this,Nt,go).call(this,t.propertiesToUpdate))}updateUI(t){l(this,Nt,l_)===t&&E(this,Nt,go).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){E(this,Nt,go).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(l(this,Xe).has(t)){l(this,Xe).delete(t),t.unselect(),E(this,Nt,ss).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,Xe).add(t),t.select(),E(this,Nt,go).call(this,t.propertiesToUpdate),E(this,Nt,ss).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;this.updateToolbar({mode:t.mode,editId:t.uid}),(e=l(this,Rl))==null||e.commitOrRemove();for(const i of l(this,Xe))i!==t&&i.unselect();l(this,Xe).clear(),l(this,Xe).add(t),t.select(),E(this,Nt,go).call(this,t.propertiesToUpdate),E(this,Nt,ss).call(this,{hasSelectedEditor:!0})}isSelected(t){return l(this,Xe).has(t)}get firstSelectedEditor(){return l(this,Xe).values().next().value}unselect(t){t.unselect(),l(this,Xe).delete(t),E(this,Nt,ss).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,Xe).size!==0}get isEnterHandled(){return l(this,Xe).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;l(this,yr).undo(),E(this,Nt,ss).call(this,{hasSomethingToUndo:l(this,yr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:E(this,Nt,_p).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){l(this,yr).redo(),E(this,Nt,ss).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,yr).hasSomethingToRedo(),isEmpty:E(this,Nt,_p).call(this)})}addCommands(t){l(this,yr).add(t),E(this,Nt,ss).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:E(this,Nt,_p).call(this)})}cleanUndoStack(t){l(this,yr).cleanType(t)}delete(){var s;this.commitOrRemove();const t=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...l(this,Xe)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(n,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},n=()=>{for(const a of e)E(this,Nt,tb).call(this,a)};this.addCommands({cmd:i,undo:n,mustExec:!0})}commitOrRemove(){var t;(t=l(this,Ms))==null||t.commitOrRemove()}hasSomethingToControl(){return l(this,Ms)||this.hasSelection}selectAll(){for(const t of l(this,Xe))t.commit();E(this,Nt,eb).call(this,l(this,Fi).values())}unselectAll(){var t;if(!(l(this,Ms)&&(l(this,Ms).commitOrRemove(),l(this,tn)!==ce.NONE))&&!((t=l(this,Rl))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of l(this,Xe))e.unselect();l(this,Xe).clear(),E(this,Nt,ss).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;l(this,Wl)[0]+=t,l(this,Wl)[1]+=e;const[n,s]=l(this,Wl),a=[...l(this,Xe)],o=1e3;l(this,Sa)&&clearTimeout(l(this,Sa)),_(this,Sa,setTimeout(()=>{_(this,Sa,null),l(this,Wl)[0]=l(this,Wl)[1]=0,this.addCommands({cmd:()=>{for(const h of a)l(this,Fi).has(h.id)&&(h.translateInPage(n,s),h.translationDone())},undo:()=>{for(const h of a)l(this,Fi).has(h.id)&&(h.translateInPage(-n,-s),h.translationDone())},mustExec:!1})},o));for(const h of a)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,wa,new Map);for(const t of l(this,Xe))l(this,wa).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,wa))return!1;this.disableUserSelect(!1);const t=l(this,wa);_(this,wa,null);let e=!1;for(const[{x:n,y:s,pageIndex:a},o]of t)o.newX=n,o.newY=s,o.newPageIndex=a,e||(e=n!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(n,s,a,o)=>{if(l(this,Fi).has(n.id)){const h=l(this,fn).get(o);h?n._setParentAndPosition(h,s,a):(n.pageIndex=o,n.x=s,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:s,newY:a,newPageIndex:o}]of t)i(n,s,a,o)},undo:()=>{for(const[n,{savedX:s,savedY:a,savedPageIndex:o}]of t)i(n,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(l(this,wa))for(const i of l(this,wa).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||l(this,Xe).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return l(this,Ms)===t}getActive(){return l(this,Ms)}getMode(){return l(this,tn)}isEditingMode(){return l(this,tn)!==ce.NONE}get imageManager(){return le(this,"imageManager",new K5)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,u=e.rangeCount;c<u;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:n,width:s,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,u,p,g)=>({x:(u-n)/a,y:1-(c+p-i)/s,width:g/a,height:p/s});break;case"180":o=(c,u,p,g)=>({x:1-(c+p-i)/s,y:1-(u+g-n)/a,width:p/s,height:g/a});break;case"270":o=(c,u,p,g)=>({x:1-(u+g-n)/a,y:(c-i)/s,width:g/a,height:p/s});break;default:o=(c,u,p,g)=>({x:(c-i)/s,y:(u-n)/a,width:p/s,height:g/a});break}const h=[];for(let c=0,u=e.rangeCount;c<u;c++){const p=e.getRangeAt(c);if(!p.collapsed)for(const{x:g,y:f,width:A,height:v}of p.getClientRects())A===0||v===0||h.push(o(g,f,A,v))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(l(this,fd)||_(this,fd,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=l(this,fd))==null||e.delete(t)}renderAnnotationElement(t){var n;const e=(n=l(this,fd))==null?void 0:n.get(t.data.id);if(!e)return;const i=l(this,vr).getRawValue(e);i&&(l(this,tn)===ce.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){var s;const n=(s=l(this,Hl))==null?void 0:s.get(t);n&&(n.setCanvas(e,i),l(this,Hl).delete(t))}addMissingCanvas(t,e){(l(this,Hl)||_(this,Hl,new Map)).set(t,e)}};cd=new WeakMap,Ms=new WeakMap,ud=new WeakMap,Fi=new WeakMap,fn=new WeakMap,dd=new WeakMap,vr=new WeakMap,fd=new WeakMap,yr=new WeakMap,Yn=new WeakMap,Ml=new WeakMap,Rl=new WeakMap,pd=new WeakMap,Dl=new WeakMap,wa=new WeakMap,wr=new WeakMap,ic=new WeakMap,cg=new WeakMap,ug=new WeakMap,gd=new WeakMap,dg=new WeakMap,Aa=new WeakMap,Ol=new WeakMap,md=new WeakMap,Bl=new WeakMap,_a=new WeakMap,a2=new WeakMap,jl=new WeakMap,bd=new WeakMap,fg=new WeakMap,Ul=new WeakMap,nc=new WeakMap,vd=new WeakMap,Hl=new WeakMap,pg=new WeakMap,tn=new WeakMap,Xe=new WeakMap,Ao=new WeakMap,ql=new WeakMap,zl=new WeakMap,gg=new WeakMap,yd=new WeakMap,mg=new WeakMap,Wl=new WeakMap,Sa=new WeakMap,_o=new WeakMap,bg=new WeakMap,vg=new WeakMap,Ar=new WeakMap,Nt=new WeakSet,sm=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Z5=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of l(this,fn).values())if(i.hasTextLayer(t))return i;return null},JA=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=E(this,Nt,sm).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(l(this,_a)||_(this,_a,new n4(this)),l(this,_a).show(i,n,this.direction==="ltr"))},ZA=function(){var s,a,o;const t=document.getSelection();if(!t||t.isCollapsed){l(this,Ao)&&((s=l(this,_a))==null||s.hide(),_(this,Ao,null),E(this,Nt,ss).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===l(this,Ao))return;const n=E(this,Nt,sm).call(this,t).closest(".textLayer");if(!n){l(this,Ao)&&((a=l(this,_a))==null||a.hide(),_(this,Ao,null),E(this,Nt,ss).call(this,{hasSelectedText:!1}));return}if((o=l(this,_a))==null||o.hide(),_(this,Ao,e),E(this,Nt,ss).call(this,{hasSelectedText:!0}),!(l(this,tn)!==ce.HIGHLIGHT&&l(this,tn)!==ce.NONE)&&(l(this,tn)===ce.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,Bl,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=l(this,tn)===ce.HIGHLIGHT?E(this,Nt,Z5).call(this,n):null;if(h==null||h.toggleDrawing(),l(this,bd)){const c=new AbortController,u=this.combinedSignal(c),p=g=>{g.type==="pointerup"&&g.button!==0||(c.abort(),h==null||h.toggleDrawing(!0),g.type==="pointerup"&&E(this,Nt,Ap).call(this,"main_toolbar"))};window.addEventListener("pointerup",p,{signal:u}),window.addEventListener("blur",p,{signal:u})}else h==null||h.toggleDrawing(!0),E(this,Nt,Ap).call(this,"main_toolbar")}},Ap=function(t=""){l(this,tn)===ce.HIGHLIGHT?this.highlightSelection(t):l(this,cg)&&E(this,Nt,JA).call(this)},QA=function(){document.addEventListener("selectionchange",E(this,Nt,ZA).bind(this),{signal:this._signal})},t_=function(){if(l(this,Ol))return;_(this,Ol,new AbortController);const t=this.combinedSignal(l(this,Ol));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},e_=function(){var t;(t=l(this,Ol))==null||t.abort(),_(this,Ol,null)},Q5=function(){if(l(this,Ul))return;_(this,Ul,new AbortController);const t=this.combinedSignal(l(this,Ul));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},i_=function(){var t;(t=l(this,Ul))==null||t.abort(),_(this,Ul,null)},n_=function(){if(l(this,Ml))return;_(this,Ml,new AbortController);const t=this.combinedSignal(l(this,Ml));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},s_=function(){var t;(t=l(this,Ml))==null||t.abort(),_(this,Ml,null)},r_=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},ss=function(t){Object.entries(t).some(([i,n])=>l(this,mg)[i]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,mg),t)}),l(this,tn)===ce.HIGHLIGHT&&t.hasSelectedEditor===!1&&E(this,Nt,go).call(this,[[Te.HIGHLIGHT_FREE,!0]]))},go=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},a_=async function(){if(!l(this,jl)){_(this,jl,!0);const t=[];for(const e of l(this,fn).values())t.push(e.enable());await Promise.all(t);for(const e of l(this,Fi).values())e.enable()}},o_=function(){if(this.unselectAll(),l(this,jl)){_(this,jl,!1);for(const t of l(this,fn).values())t.disable();for(const t of l(this,Fi).values())t.disable()}},tb=function(t){const e=l(this,fn).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},l_=function(){let t=null;for(t of l(this,Xe));return t},_p=function(){if(l(this,Fi).size===0)return!0;if(l(this,Fi).size===1)for(const t of l(this,Fi).values())return t.isEmpty();return!1},eb=function(t){for(const e of l(this,Xe))e.unselect();l(this,Xe).clear();for(const e of t)e.isEmpty()||(l(this,Xe).add(e),e.select());E(this,Nt,ss).call(this,{hasSelectedEditor:this.hasSelection})},bt(Qu,"TRANSLATE_SMALL",1),bt(Qu,"TRANSLATE_BIG",10);let Sh=Qu;var vn,xa,qr,wd,Ca,Rs,Ad,La,ms,So,sc,Ea,Gl,ta,Sp,rm;const rs=class rs{constructor(t){C(this,ta);C(this,vn,null);C(this,xa,!1);C(this,qr,null);C(this,wd,null);C(this,Ca,null);C(this,Rs,null);C(this,Ad,!1);C(this,La,null);C(this,ms,null);C(this,So,null);C(this,sc,null);C(this,Ea,!1);_(this,ms,t),_(this,Ea,t._uiManager.useNewAltTextFlow),l(rs,Gl)||_(rs,Gl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){rs._l10n??(rs._l10n=t)}async render(){const t=_(this,qr,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=_(this,wd,document.createElement("span"));t.append(e),l(this,Ea)?(t.classList.add("new"),t.setAttribute("data-l10n-id",l(rs,Gl).missing),e.setAttribute("data-l10n-id",l(rs,Gl)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=l(this,ms)._uiManager._signal;t.addEventListener("contextmenu",sr,{signal:i}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const n=s=>{s.preventDefault(),l(this,ms)._uiManager.editAltText(l(this,ms)),l(this,Ea)&&l(this,ms)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,ta,Sp)}})};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(_(this,Ad,!0),n(s))},{signal:i}),await E(this,ta,rm).call(this),t}finish(){l(this,qr)&&(l(this,qr).focus({focusVisible:l(this,Ad)}),_(this,Ad,!1))}isEmpty(){return l(this,Ea)?l(this,vn)===null:!l(this,vn)&&!l(this,xa)}hasData(){return l(this,Ea)?l(this,vn)!==null||!!l(this,So):this.isEmpty()}get guessedText(){return l(this,So)}async setGuessedText(t){l(this,vn)===null&&(_(this,So,t),_(this,sc,await rs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),E(this,ta,rm).call(this))}toggleAltTextBadge(t=!1){var e;if(!l(this,Ea)||l(this,vn)){(e=l(this,La))==null||e.remove(),_(this,La,null);return}if(!l(this,La)){const i=_(this,La,document.createElement("div"));i.className="noAltTextBadge",l(this,ms).div.append(i)}l(this,La).classList.toggle("hidden",!t)}serialize(t){let e=l(this,vn);return!t&&l(this,So)===e&&(e=l(this,sc)),{altText:e,decorative:l(this,xa),guessedText:l(this,So),textWithDisclaimer:l(this,sc)}}get data(){return{altText:l(this,vn),decorative:l(this,xa)}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:n,cancel:s=!1}){i&&(_(this,So,i),_(this,sc,n)),!(l(this,vn)===t&&l(this,xa)===e)&&(s||(_(this,vn,t),_(this,xa,e)),E(this,ta,rm).call(this))}toggle(t=!1){l(this,qr)&&(!t&&l(this,Rs)&&(clearTimeout(l(this,Rs)),_(this,Rs,null)),l(this,qr).disabled=!t)}shown(){l(this,ms)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,ta,Sp)}})}destroy(){var t,e;(t=l(this,qr))==null||t.remove(),_(this,qr,null),_(this,wd,null),_(this,Ca,null),(e=l(this,La))==null||e.remove(),_(this,La,null)}};vn=new WeakMap,xa=new WeakMap,qr=new WeakMap,wd=new WeakMap,Ca=new WeakMap,Rs=new WeakMap,Ad=new WeakMap,La=new WeakMap,ms=new WeakMap,So=new WeakMap,sc=new WeakMap,Ea=new WeakMap,Gl=new WeakMap,ta=new WeakSet,Sp=function(){return l(this,vn)&&"added"||l(this,vn)===null&&this.guessedText&&"review"||"missing"},rm=async function(){var n,s,a;const t=l(this,qr);if(!t)return;if(l(this,Ea)){if(t.classList.toggle("done",!!l(this,vn)),t.setAttribute("data-l10n-id",l(rs,Gl)[l(this,ta,Sp)]),(n=l(this,wd))==null||n.setAttribute("data-l10n-id",l(rs,Gl)[`${l(this,ta,Sp)}-label`]),!l(this,vn)){(s=l(this,Ca))==null||s.remove();return}}else{if(!l(this,vn)&&!l(this,xa)){t.classList.remove("done"),(a=l(this,Ca))==null||a.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=l(this,Ca);if(!e){_(this,Ca,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${l(this,ms).id}`;const o=100,h=l(this,ms)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(l(this,Rs)),_(this,Rs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{_(this,Rs,setTimeout(()=>{_(this,Rs,null),l(this,Ca).classList.add("show"),l(this,ms)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:h}),t.addEventListener("mouseleave",()=>{var c;l(this,Rs)&&(clearTimeout(l(this,Rs)),_(this,Rs,null)),(c=l(this,Ca))==null||c.classList.remove("show")},{signal:h})}l(this,xa)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=l(this,vn)),e.parentNode||t.append(e);const i=l(this,ms).getElementForAltText();i==null||i.setAttribute("aria-describedby",e.id)},C(rs,Gl,null),bt(rs,"_l10n",null);let jm=rs;var In,_r,rc,pi,yg,ac,zr,oc,lc,hc,wg,ib;class B0{constructor(t){C(this,wg);C(this,In,null);C(this,_r,null);C(this,rc,!1);C(this,pi,null);C(this,yg,null);C(this,ac,null);C(this,zr,null);C(this,oc,null);C(this,lc,!1);C(this,hc,null);_(this,pi,t)}renderForToolbar(){const t=_(this,_r,document.createElement("button"));return t.className="comment",E(this,wg,ib).call(this,t,!1)}renderForStandalone(){const t=_(this,In,document.createElement("button"));t.className="annotationCommentButton";const e=l(this,pi).commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(l(this,pi)._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const n=l(this,pi).commentButtonColor;n&&(i.backgroundColor=n)}return E(this,wg,ib).call(this,t,!0)}focusButton(){setTimeout(()=>{var t;(t=l(this,In)??l(this,_r))==null||t.focus()},0)}onUpdatedColor(){if(!l(this,In))return;const t=l(this,pi).commentButtonColor;t&&(l(this,In).style.backgroundColor=t),l(this,pi)._uiManager.updatePopupColor(l(this,pi))}get commentButtonWidth(){var t;return(((t=l(this,In))==null?void 0:t.getBoundingClientRect().width)??0)/l(this,pi).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(l(this,hc))return l(this,hc);if(!l(this,In))return null;const{x:t,y:e,height:i}=l(this,In).getBoundingClientRect(),{x:n,y:s,width:a,height:o}=l(this,pi).parent.boundingClientRect;return[(t-n)/a,(e+i-s)/o]}set commentPopupPositionInLayer(t){_(this,hc,t)}hasDefaultPopupPosition(){return l(this,hc)===null}removeStandaloneCommentButton(){var t;(t=l(this,In))==null||t.remove(),_(this,In,null)}removeToolbarCommentButton(){var t;(t=l(this,_r))==null||t.remove(),_(this,_r,null)}setCommentButtonStates({selected:t,hasPopup:e}){l(this,In)&&(l(this,In).classList.toggle("selected",t),l(this,In).ariaExpanded=e)}edit(t){const e=this.commentPopupPositionInLayer;let i,n;if(e)[i,n]=e;else{[i,n]=l(this,pi).commentButtonPosition;const{width:u,height:p,x:g,y:f}=l(this,pi);i=g+i*u,n=f+n*p}const s=l(this,pi).parent.boundingClientRect,{x:a,y:o,width:h,height:c}=s;l(this,pi)._uiManager.editComment(l(this,pi),a+i*h,o+n*c,{...t,parentDimensions:s})}finish(){l(this,_r)&&(l(this,_r).focus({focusVisible:l(this,rc)}),_(this,rc,!1))}isDeleted(){return l(this,lc)||l(this,zr)===""}isEmpty(){return l(this,zr)===null}hasBeenEdited(){return this.isDeleted()||l(this,zr)!==l(this,yg)}serialize(){return this.data}get data(){return{text:l(this,zr),richText:l(this,ac),date:l(this,oc),deleted:this.isDeleted()}}set data(t){if(t!==l(this,zr)&&_(this,ac,null),t===null){_(this,zr,""),_(this,lc,!0);return}_(this,zr,t),_(this,oc,new Date),_(this,lc,!1)}setInitialText(t,e=null){_(this,yg,t),this.data=t,_(this,oc,null),_(this,ac,e)}shown(){}destroy(){var t,e;(t=l(this,_r))==null||t.remove(),_(this,_r,null),(e=l(this,In))==null||e.remove(),_(this,In,null),_(this,zr,""),_(this,ac,null),_(this,oc,null),_(this,pi,null),_(this,rc,!1),_(this,lc,!1)}}In=new WeakMap,_r=new WeakMap,rc=new WeakMap,pi=new WeakMap,yg=new WeakMap,ac=new WeakMap,zr=new WeakMap,oc=new WeakMap,lc=new WeakMap,hc=new WeakMap,wg=new WeakSet,ib=function(t,e){if(!l(this,pi)._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[l(this,pi)._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=l(this,pi)._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",sr,{signal:i}),e&&(t.addEventListener("focusin",s=>{l(this,pi)._focusEventsAllowed=!1,ki(s)},{capture:!0,signal:i}),t.addEventListener("focusout",s=>{l(this,pi)._focusEventsAllowed=!0,ki(s)},{capture:!0,signal:i})),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const n=s=>{s.preventDefault(),t===l(this,_r)?this.edit():l(this,pi).toggleComment(!0)};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(_(this,rc,!0),n(s))},{signal:i}),t.addEventListener("pointerenter",()=>{l(this,pi).toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{l(this,pi).toggleComment(!1,!1)},{signal:i}),t};var _d,cc,Ag,_g,Sg,xg,Cg,xo,uc,Co,dc,Lo,Ch,h_,c_,u_;const $v=class $v{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:n=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){C(this,Ch);C(this,_d);C(this,cc,!1);C(this,Ag,null);C(this,_g);C(this,Sg);C(this,xg);C(this,Cg);C(this,xo,null);C(this,uc);C(this,Co,null);C(this,dc);C(this,Lo,null);_(this,_d,t),_(this,Ag,i),_(this,_g,e),_(this,Sg,n),_(this,xg,s),_(this,Cg,a),_(this,dc,new AbortController),_(this,uc,AbortSignal.any([o,l(this,dc).signal])),t.addEventListener("touchstart",E(this,Ch,h_).bind(this),{passive:!1,signal:l(this,uc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ea.pixelRatio}destroy(){var t,e;(t=l(this,dc))==null||t.abort(),_(this,dc,null),(e=l(this,xo))==null||e.abort(),_(this,xo,null)}};_d=new WeakMap,cc=new WeakMap,Ag=new WeakMap,_g=new WeakMap,Sg=new WeakMap,xg=new WeakMap,Cg=new WeakMap,xo=new WeakMap,uc=new WeakMap,Co=new WeakMap,dc=new WeakMap,Lo=new WeakMap,Ch=new WeakSet,h_=function(t){var n,s,a;if((n=l(this,_g))!=null&&n.call(this))return;if(t.touches.length===1){if(l(this,xo))return;const o=_(this,xo,new AbortController),h=AbortSignal.any([l(this,uc),o.signal]),c=l(this,_d),u={capture:!0,signal:h,passive:!1},p=g=>{var f;g.pointerType==="touch"&&((f=l(this,xo))==null||f.abort(),_(this,xo,null))};c.addEventListener("pointerdown",g=>{g.pointerType==="touch"&&(ki(g),p(g))},u),c.addEventListener("pointerup",p,u),c.addEventListener("pointercancel",p,u);return}if(!l(this,Lo)){_(this,Lo,new AbortController);const o=AbortSignal.any([l(this,uc),l(this,Lo).signal]),h=l(this,_d),c={signal:o,capture:!1,passive:!1};h.addEventListener("touchmove",E(this,Ch,c_).bind(this),c);const u=E(this,Ch,u_).bind(this);h.addEventListener("touchend",u,c),h.addEventListener("touchcancel",u,c),c.capture=!0,h.addEventListener("pointerdown",ki,c),h.addEventListener("pointermove",ki,c),h.addEventListener("pointercancel",ki,c),h.addEventListener("pointerup",ki,c),(s=l(this,Sg))==null||s.call(this)}if(ki(t),t.touches.length!==2||(a=l(this,Ag))!=null&&a.call(this)){_(this,Co,null);return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),_(this,Co,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY})},c_=function(t){var P;if(!l(this,Co)||t.touches.length!==2)return;ki(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:n,screenY:s}=e,{screenX:a,screenY:o}=i,h=l(this,Co),{touch0X:c,touch0Y:u,touch1X:p,touch1Y:g}=h,f=p-c,A=g-u,v=a-n,S=o-s,w=Math.hypot(v,S)||1,k=Math.hypot(f,A)||1;if(!l(this,cc)&&Math.abs(k-w)<=$v.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=n,h.touch0Y=s,h.touch1X=a,h.touch1Y=o,!l(this,cc)){_(this,cc,!0);return}const L=[(n+a)/2,(s+o)/2];(P=l(this,xg))==null||P.call(this,L,k,w)},u_=function(t){var e;t.touches.length>=2||(l(this,Lo)&&(l(this,Lo).abort(),_(this,Lo,null),(e=l(this,Cg))==null||e.call(this)),l(this,Co)&&(ki(t),_(this,Co,null),_(this,cc,!1)))};let Zp=$v;var fc,Wr,Si,ri,Eo,Sd,Vl,Lg,Fn,pc,ko,Sr,$l,Eg,gc,Ds,kg,mc,Po,ka,xd,Cd,xr,bc,Pg,o2,ee,nb,Ng,sb,am,d_,f_,rb,om,ab,p_,g_,m_,ob,b_,lb,v_,y_,w_,hb,xp;const ge=class ge{constructor(t){C(this,ee);C(this,fc,null);C(this,Wr,null);C(this,Si,null);C(this,ri,null);C(this,Eo,null);C(this,Sd,!1);C(this,Vl,null);C(this,Lg,"");C(this,Fn,null);C(this,pc,null);C(this,ko,null);C(this,Sr,null);C(this,$l,null);C(this,Eg,"");C(this,gc,!1);C(this,Ds,null);C(this,kg,!1);C(this,mc,!1);C(this,Po,!1);C(this,ka,null);C(this,xd,0);C(this,Cd,0);C(this,xr,null);C(this,bc,null);bt(this,"isSelected",!1);bt(this,"_isCopy",!1);bt(this,"_editToolbar",null);bt(this,"_initialOptions",Object.create(null));bt(this,"_initialData",null);bt(this,"_isVisible",!0);bt(this,"_uiManager",null);bt(this,"_focusEventsAllowed",!0);C(this,Pg,!1);C(this,o2,ge._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[s,a];const[o,h]=this.parentDimensions;this.x=t.x/o,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=ge.prototype._resizeWithKeyboard,e=Sh.TRANSLATE_SMALL,i=Sh.TRANSLATE_BIG;return le(this,"_resizerKeyboardManager",new Z1([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],ge.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return le(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new a4({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(ge._l10n??(ge._l10n=t),ge._l10nResizer||(ge._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ge._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ge._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){hi("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,Pg)}set _isDraggable(t){var e;_(this,Pg,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,o2)}setParent(t){var e;t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(E(this,ee,xp).call(this),(e=l(this,Sr))==null||e.remove(),_(this,Sr,null)),this.parent=t}focusin(t){this._focusEventsAllowed&&(l(this,gc)?_(this,gc,!1):this.parent.setSelected(this))}focusout(t){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[s,a]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/s,this.y=(e+n)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n),this._onTranslated()}translate(t,e){E(this,ee,nb).call(this,this.parentDimensions,t,e)}translateInPage(t,e){l(this,Ds)||_(this,Ds,[this.x,this.y,this.width,this.height]),E(this,ee,nb).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){l(this,Ds)||_(this,Ds,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[n,s]}=this;if(this.x+=t/n,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:g}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,g)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[h,c]=this.getBaseTranslation();a+=h,o+=c;const{style:u}=i;u.left=`${(100*a).toFixed(2)}%`,u.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!l(this,Ds)&&(l(this,Ds)[0]!==this.x||l(this,Ds)[1]!==this.y)}get _hasBeenResized(){return!!l(this,Ds)&&(l(this,Ds)[2]!==this.width||l(this,Ds)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=ge,n=i/t,s=i/e;switch(this.rotation){case 90:return[-n,s];case 180:return[n,s];case 270:return[n,-s];default:return[-n,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,n]}=this;let{x:s,y:a,width:o,height:h}=this;if(o*=i,h*=n,s*=i,a*=n,this._mustFixPosition)switch(t){case 0:s=Qn(s,0,i-o),a=Qn(a,0,n-h);break;case 90:s=Qn(s,0,i-h),a=Qn(a,o,n);break;case 180:s=Qn(s,o,i),a=Qn(a,h,n);break;case 270:s=Qn(s,h,i),a=Qn(a,0,n-o);break}this.x=s/=i,this.y=a/=n;const[c,u]=this.getBaseTranslation();s+=c,a+=u,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return E(i=ge,Ng,sb).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return E(i=ge,Ng,sb).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=l(this,Si))==null||t.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||l(this,mc))return this._editToolbar;this._editToolbar=new X5(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var t;(t=this._editToolbar)==null||t.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var t;(t=this._editToolbar)==null||t.removeButton("comment")}removeEditToolbar(){var t,e;(t=this._editToolbar)==null||t.remove(),this._editToolbar=null,(e=l(this,Si))==null||e.destroy()}addContainer(t){var i;const e=(i=this._editToolbar)==null?void 0:i.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return l(this,Si)||(jm.initialize(ge._l10n),_(this,Si,new jm(this)),l(this,fc)&&(l(this,Si).data=l(this,fc),_(this,fc,null))),l(this,Si)}get altTextData(){var t;return(t=l(this,Si))==null?void 0:t.data}set altTextData(t){l(this,Si)&&(l(this,Si).data=t)}get guessedAltText(){var t;return(t=l(this,Si))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=l(this,Si))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=l(this,Si))==null?void 0:e.serialize(t)}hasAltText(){return!!l(this,Si)&&!l(this,Si).isEmpty()}hasAltTextData(){var t;return((t=l(this,Si))==null?void 0:t.hasData())??!1}focusCommentButton(){var t;(t=l(this,ri))==null||t.focusButton()}addCommentButton(){return this.canAddComment?l(this,ri)||_(this,ri,new B0(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(l(this,Eo)){this._uiManager.isEditingMode()&&l(this,Eo).classList.remove("hidden");return}this.hasComment&&(_(this,Eo,l(this,ri).renderForStandalone()),this.div.append(l(this,Eo)))}}removeStandaloneCommentButton(){l(this,ri).removeStandaloneCommentButton(),_(this,Eo,null)}hideStandaloneCommentButton(){var t;(t=l(this,Eo))==null||t.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:n}}=l(this,ri);return{text:e,richText:t,date:i,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){l(this,ri)||_(this,ri,new B0(this)),l(this,ri).data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(l(this,ri)||_(this,ri,new B0(this)),l(this,ri).setInitialText(t,i),!this.annotationElementId))return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){var t;return(t=l(this,ri))==null?void 0:t.hasBeenEdited()}get hasDeletedComment(){var t;return(t=l(this,ri))==null?void 0:t.isDeleted()}get hasComment(){return!!l(this,ri)&&!l(this,ri).isEmpty()&&!l(this,ri).isDeleted()}async editComment(t){l(this,ri)||_(this,ri,new B0(this)),l(this,ri).edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){l(this,ri).setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,n]=t.rect,[s]=this.pageDimensions,[a]=this.pageTranslation,o=a+s+1,h=n-100,c=o+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,h,c,n]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){l(this,ri).data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=l(this,Sd)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),E(this,ee,lb).call(this);const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[n,s]=this.getInitialTranslation();return this.translate(n,s),YA(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,bc)||_(this,bc,new Zp({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:E(this,ee,p_).bind(this),onPinching:E(this,ee,g_).bind(this),onPinchEnd:E(this,ee,m_).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),t}pointerdown(t){const{isMac:e}=en.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(_(this,gc,!0),this._isDraggable){E(this,ee,b_).call(this,t);return}E(this,ee,ob).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,ka)&&clearTimeout(l(this,ka)),_(this,ka,setTimeout(()=>{var t;_(this,ka,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const n=this.parentScale,[s,a]=this.pageDimensions,[o,h]=this.pageTranslation,c=t/n,u=e/n,p=this.x*s,g=this.y*a,f=this.width*s,A=this.height*a;switch(i){case 0:return[p+c+o,a-g-u-A+h,p+c+f+o,a-g-u+h];case 90:return[p+u+o,a-g+c+h,p+u+A+o,a-g+c+f+h];case 180:return[p-c-f+o,a-g+u+h,p-c+o,a-g+u+A+h];case 270:return[p-u-A+o,a-g-c-f+h,p-u+o,a-g-c+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,s,a]=t,o=s-i,h=a-n;switch(this.rotation){case 0:return[i,e-a,o,h];case 90:return[i,e-n,h,o];case 180:return[s,e-n,o,h];case 270:return[s,e-a,h,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ge._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var t;(t=l(this,ri))==null||t.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:n,deleted:s,richText:a},uid:o,pageIndex:h,creationDate:c,modificationDate:u}=this;return{id:o,pageIndex:h,rect:this.getPDFRect(),richText:a,contentsObj:{str:t},creationDate:c,modificationDate:i||u,popupRef:!s,color:e,opacity:n}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),_(this,mc,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),_(this,mc,!1),!0):!1}isInEditMode(){return l(this,mc)}shouldGetKeyboardEvents(){return l(this,Po)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:n}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return e<a&&n>0&&t<s&&i>0}rebuild(){E(this,ee,lb).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){var i;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((i=this._initialData)==null?void 0:i.popupRef)||""}}static async deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});n.rotation=t.rotation,_(n,fc,t.accessibilityData),n._isCopy=t.isCopy||!1;const[s,a]=n.pageDimensions,[o,h,c,u]=n.getRectInCurrentCoords(t.rect,a);return n.x=o/s,n.y=h/a,n.width=c/s,n.height=u/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e,i;if((t=l(this,$l))==null||t.abort(),_(this,$l,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),l(this,ka)&&(clearTimeout(l(this,ka)),_(this,ka,null)),E(this,ee,xp).call(this),this.removeEditToolbar(),l(this,xr)){for(const n of l(this,xr).values())clearTimeout(n);_(this,xr,null)}this.parent=null,(e=l(this,bc))==null||e.destroy(),_(this,bc,null),(i=l(this,Sr))==null||i.remove(),_(this,Sr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(E(this,ee,d_).call(this),l(this,Fn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,n,s,a]=this.getPDFRect();return[ge._round(i+(s-i)*t),ge._round(n+(a-n)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return l(this,ri).commentPopupPositionInLayer}set commentPopupPosition(t){l(this,ri).commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return l(this,ri).hasDefaultPopupPosition()}get commentButtonWidth(){return l(this,ri).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){var e;(e=l(this,ri))==null||e.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),_(this,ko,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=l(this,Fn).children;if(!l(this,Wr)){_(this,Wr,Array.from(e));const a=E(this,ee,v_).bind(this),o=E(this,ee,y_).bind(this),h=this._uiManager._signal;for(const c of l(this,Wr)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:h}),c.addEventListener("blur",o,{signal:h}),c.addEventListener("focus",E(this,ee,w_).bind(this,u),{signal:h}),c.setAttribute("data-l10n-id",ge._l10nResizer[u])}}const i=l(this,Wr)[0];let n=0;for(const a of e){if(a===i)break;n++}const s=(360-this.rotation+this.parentRotation)%360/90*(l(this,Wr).length/4);if(s!==n){if(s<n)for(let o=0;o<n-s;o++)l(this,Fn).append(l(this,Fn).firstElementChild);else if(s>n)for(let o=0;o<s-n;o++)l(this,Fn).firstElementChild.before(l(this,Fn).lastElementChild);let a=0;for(const o of e){const c=l(this,Wr)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ge._l10nResizer[c])}}E(this,ee,hb).call(this,0),_(this,Po,!0),l(this,Fn).firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){l(this,Po)&&E(this,ee,ab).call(this,l(this,Eg),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){E(this,ee,xp).call(this),this.div.focus()}select(){var t,e,i;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,s;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(e=this._editToolbar)==null||e.show(),(i=l(this,Si))==null||i.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var t;return(t=this.div)==null?void 0:t.focus({preventScroll:!0})},0)}unselect(){var t,e,i,n,s;this.isSelected&&(this.isSelected=!1,(t=l(this,Fn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(s=l(this,Si))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return l(this,kg)}set isEditing(t){_(this,kg,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){l(this,xr)||_(this,xr,new Map);const{action:i}=t;let n=l(this,xr).get(i);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),l(this,xr).delete(i),l(this,xr).size===0&&_(this,xr,null)},ge._telemetryTimeout),l(this,xr).set(i,n);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),_(this,Sd,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,Sd,!0)}updateFakeAnnotationElement(t){if(!l(this,Sr)&&!this.deleted){_(this,Sr,t.addFakeAnnotation(this));return}if(this.deleted){l(this,Sr).remove(),_(this,Sr,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&l(this,Sr).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};fc=new WeakMap,Wr=new WeakMap,Si=new WeakMap,ri=new WeakMap,Eo=new WeakMap,Sd=new WeakMap,Vl=new WeakMap,Lg=new WeakMap,Fn=new WeakMap,pc=new WeakMap,ko=new WeakMap,Sr=new WeakMap,$l=new WeakMap,Eg=new WeakMap,gc=new WeakMap,Ds=new WeakMap,kg=new WeakMap,mc=new WeakMap,Po=new WeakMap,ka=new WeakMap,xd=new WeakMap,Cd=new WeakMap,xr=new WeakMap,bc=new WeakMap,Pg=new WeakMap,o2=new WeakMap,ee=new WeakSet,nb=function([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Ng=new WeakSet,sb=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},am=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},d_=function(){if(l(this,Fn))return;_(this,Fn,document.createElement("div")),l(this,Fn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const n=document.createElement("div");l(this,Fn).append(n),n.classList.add("resizer",i),n.setAttribute("data-resizer-name",i),n.addEventListener("pointerdown",E(this,ee,f_).bind(this,i),{signal:e}),n.addEventListener("contextmenu",sr,{signal:e}),n.tabIndex=-1}this.div.prepend(l(this,Fn))},f_=function(t,e){var u;e.preventDefault();const{isMac:i}=en.platform;if(e.button!==0||e.ctrlKey&&i)return;(u=l(this,Si))==null||u.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,_(this,pc,[e.screenX,e.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",E(this,ee,ab).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ki,{passive:!1,signal:a}),window.addEventListener("contextmenu",sr,{signal:a}),_(this,ko,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const c=()=>{var p;s.abort(),this.parent.togglePointerEvents(!0),(p=l(this,Si))==null||p.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=o,this.div.style.cursor=h,E(this,ee,om).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},rb=function(t,e,i,n){this.width=i,this.height=n,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()},om=function(){if(!l(this,ko))return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=l(this,ko);_(this,ko,null);const s=this.x,a=this.y,o=this.width,h=this.height;s===t&&a===e&&o===i&&h===n||this.addCommands({cmd:E(this,ee,rb).bind(this,s,a,o,h),undo:E(this,ee,rb).bind(this,t,e,i,n),mustExec:!0})},ab=function(t,e){const[i,n]=this.parentDimensions,s=this.x,a=this.y,o=this.width,h=this.height,c=ge.MIN_SIZE/i,u=ge.MIN_SIZE/n,p=E(this,ee,am).call(this,this.rotation),g=(rt,lt)=>[p[0]*rt+p[2]*lt,p[1]*rt+p[3]*lt],f=E(this,ee,am).call(this,360-this.rotation),A=(rt,lt)=>[f[0]*rt+f[2]*lt,f[1]*rt+f[3]*lt];let v,S,w=!1,k=!1;switch(t){case"topLeft":w=!0,v=(rt,lt)=>[0,0],S=(rt,lt)=>[rt,lt];break;case"topMiddle":v=(rt,lt)=>[rt/2,0],S=(rt,lt)=>[rt/2,lt];break;case"topRight":w=!0,v=(rt,lt)=>[rt,0],S=(rt,lt)=>[0,lt];break;case"middleRight":k=!0,v=(rt,lt)=>[rt,lt/2],S=(rt,lt)=>[0,lt/2];break;case"bottomRight":w=!0,v=(rt,lt)=>[rt,lt],S=(rt,lt)=>[0,0];break;case"bottomMiddle":v=(rt,lt)=>[rt/2,lt],S=(rt,lt)=>[rt/2,0];break;case"bottomLeft":w=!0,v=(rt,lt)=>[0,lt],S=(rt,lt)=>[rt,0];break;case"middleLeft":k=!0,v=(rt,lt)=>[0,lt/2],S=(rt,lt)=>[rt,lt/2];break}const L=v(o,h),P=S(o,h);let D=g(...P);const H=ge._round(s+D[0]),X=ge._round(a+D[1]);let $=1,B=1,Z,I;if(e.fromKeyboard)({deltaX:Z,deltaY:I}=e);else{const{screenX:rt,screenY:lt}=e,[st,ft]=l(this,pc);[Z,I]=this.screenToPageTranslation(rt-st,lt-ft),l(this,pc)[0]=rt,l(this,pc)[1]=lt}if([Z,I]=A(Z/i,I/n),w){const rt=Math.hypot(o,h);$=B=Math.max(Math.min(Math.hypot(P[0]-L[0]-Z,P[1]-L[1]-I)/rt,1/o,1/h),c/o,u/h)}else k?$=Qn(Math.abs(P[0]-L[0]-Z),c,1)/o:B=Qn(Math.abs(P[1]-L[1]-I),u,1)/h;const j=ge._round(o*$),K=ge._round(h*B);D=g(...S(j,K));const Y=H-D[0],ot=X-D[1];l(this,Ds)||_(this,Ds,[this.x,this.y,this.width,this.height]),this.width=j,this.height=K,this.x=Y,this.y=ot,this.setDims(),this.fixAndSetPosition(),this._onResizing()},p_=function(){var t;_(this,ko,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=l(this,Si))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},g_=function(t,e,i){let s=.7*(i/e)+1-.7;if(s===1)return;const a=E(this,ee,am).call(this,this.rotation),o=(H,X)=>[a[0]*H+a[2]*X,a[1]*H+a[3]*X],[h,c]=this.parentDimensions,u=this.x,p=this.y,g=this.width,f=this.height,A=ge.MIN_SIZE/h,v=ge.MIN_SIZE/c;s=Math.max(Math.min(s,1/g,1/f),A/g,v/f);const S=ge._round(g*s),w=ge._round(f*s);if(S===g&&w===f)return;l(this,Ds)||_(this,Ds,[u,p,g,f]);const k=o(g/2,f/2),L=ge._round(u+k[0]),P=ge._round(p+k[1]),D=o(S/2,w/2);this.x=L-D[0],this.y=P-D[1],this.width=S,this.height=w,this.setDims(),this.fixAndSetPosition(),this._onResizing()},m_=function(){var t;(t=l(this,Si))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),E(this,ee,om).call(this)},ob=function(t){const{isMac:e}=en.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},b_=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const n=new AbortController,s=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:s},o=c=>{n.abort(),_(this,Vl,null),_(this,gc,!1),this._uiManager.endDragSession()||E(this,ee,ob).call(this,c),i&&this._onStopDragging()};e&&(_(this,xd,t.clientX),_(this,Cd,t.clientY),_(this,Vl,t.pointerId),_(this,Lg,t.pointerType),window.addEventListener("pointermove",c=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:u,clientY:p,pointerId:g}=c;if(g!==l(this,Vl)){ki(c);return}const[f,A]=this.screenToPageTranslation(u-l(this,xd),p-l(this,Cd));_(this,xd,u),_(this,Cd,p),this._uiManager.dragSelectedEditors(f,A)},a),window.addEventListener("touchmove",ki,a),window.addEventListener("pointerdown",c=>{c.pointerType===l(this,Lg)&&(l(this,bc)||c.isPrimary)&&o(c),ki(c)},a));const h=c=>{if(!l(this,Vl)||l(this,Vl)===c.pointerId){o(c);return}ki(c)};window.addEventListener("pointerup",h,{signal:s}),window.addEventListener("blur",h,{signal:s})},lb=function(){if(l(this,$l)||!this.div)return;_(this,$l,new AbortController);const t=this._uiManager.combinedSignal(l(this,$l));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},v_=function(t){ge._resizerKeyboardManager.exec(this,t)},y_=function(t){var e;l(this,Po)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==l(this,Fn)&&E(this,ee,xp).call(this)},w_=function(t){_(this,Eg,l(this,Po)?t:"")},hb=function(t){if(l(this,Wr))for(const e of l(this,Wr))e.tabIndex=t},xp=function(){_(this,Po,!1),E(this,ee,hb).call(this,-1),E(this,ee,om).call(this)},C(ge,Ng),bt(ge,"_l10n",null),bt(ge,"_l10nResizer",null),bt(ge,"_borderLineWidth",-1),bt(ge,"_colorManager",new J5),bt(ge,"_zIndex",1),bt(ge,"_telemetryTimeout",1e3);let gi=ge;class a4 extends gi{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Wy=3285377520,pr=4294901760,ma=65535;class A_{constructor(t){this.h1=t?t&4294967295:Wy,this.h2=t?t&4294967295:Wy}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let v=0,S=t.length;v<S;v++){const w=t.charCodeAt(v);w<=255?e[i++]=w:(e[i++]=w>>>8,e[i++]=w&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=i>>2,s=i-n*4,a=new Uint32Array(e.buffer,0,n);let o=0,h=0,c=this.h1,u=this.h2;const p=3432918353,g=461845907,f=p&ma,A=g&ma;for(let v=0;v<n;v++)v&1?(o=a[v],o=o*p&pr|o*f&ma,o=o<<15|o>>>17,o=o*g&pr|o*A&ma,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(h=a[v],h=h*p&pr|h*f&ma,h=h<<15|h>>>17,h=h*g&pr|h*A&ma,u^=h,u=u<<13|u>>>19,u=u*5+3864292196);switch(o=0,s){case 3:o^=e[n*4+2]<<16;case 2:o^=e[n*4+1]<<8;case 1:o^=e[n*4],o=o*p&pr|o*f&ma,o=o<<15|o>>>17,o=o*g&pr|o*A&ma,n&1?c^=o:u^=o}this.h1=c,this.h2=u}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&pr|t*36045&ma,e=e*4283543511&pr|((e<<16|t>>>16)*2950163797&pr)>>>16,t^=e>>>1,t=t*444984403&pr|t*60499&ma,e=e*3301882366&pr|((e<<16|t>>>16)*3120437893&pr)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const cb=Object.freeze({map:null,hash:"",transfer:void 0});var vc,yc,No,Mn,l2,__;class Tv{constructor(){C(this,l2);C(this,vc,!1);C(this,yc,null);C(this,No,null);C(this,Mn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=l(this,Mn).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return l(this,Mn).get(t)}remove(t){const e=l(this,Mn).get(t);if(e!==void 0&&(e instanceof gi&&l(this,No).delete(e.annotationElementId),l(this,Mn).delete(t),l(this,Mn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of l(this,Mn).values())if(i instanceof gi)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=l(this,Mn).get(t);let n=!1;if(i!==void 0)for(const[s,a]of Object.entries(e))i[s]!==a&&(n=!0,i[s]=a);else n=!0,l(this,Mn).set(t,e);n&&E(this,l2,__).call(this),e instanceof gi&&((l(this,No)||_(this,No,new Map)).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return l(this,Mn).has(t)}get size(){return l(this,Mn).size}resetModified(){l(this,vc)&&(_(this,vc,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S_(this)}get serializable(){if(l(this,Mn).size===0)return cb;const t=new Map,e=new A_,i=[],n=Object.create(null);let s=!1;for(const[a,o]of l(this,Mn)){const h=o instanceof gi?o.serialize(!1,n):o;h&&(t.set(a,h),e.update(`${a}:${JSON.stringify(h)}`),s||(s=!!h.bitmap))}if(s)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:cb}get editorStats(){let t=null;const e=new Map;let i=0,n=0;for(const s of l(this,Mn).values()){if(!(s instanceof gi)){s.popup&&(s.popup.deleted?n+=1:i+=1);continue}s.isCommentDeleted?n+=1:s.hasEditedComment&&(i+=1);const a=s.telemetryFinalData;if(!a)continue;const{type:o}=a;e.has(o)||e.set(o,Object.getPrototypeOf(s).constructor),t||(t=Object.create(null));const h=t[o]||(t[o]=new Map);for(const[c,u]of Object.entries(a)){if(c==="type")continue;let p=h.get(c);p||(p=new Map,h.set(c,p));const g=p.get(u)??0;p.set(u,g+1)}}if((n>0||i>0)&&(t||(t=Object.create(null)),t.comments={deleted:n,edited:i}),!t)return null;for(const[s,a]of e)t[s]=a.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){_(this,yc,null)}updateEditor(t,e){var n;const i=(n=l(this,No))==null?void 0:n.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){var e;return((e=l(this,No))==null?void 0:e.get(t))||null}get modifiedIds(){if(l(this,yc))return l(this,yc);const t=[];if(l(this,No))for(const e of l(this,No).values())e.serialize()&&t.push(e.annotationElementId);return _(this,yc,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return l(this,Mn).entries()}}vc=new WeakMap,yc=new WeakMap,No=new WeakMap,Mn=new WeakMap,l2=new WeakSet,__=function(){l(this,vc)||(_(this,vc,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Tg;class S_ extends Tv{constructor(e){super();C(this,Tg);const{map:i,hash:n,transfer:s}=e.serializable,a=structuredClone(i,s?{transfer:s}:null);_(this,Tg,{map:a,hash:n,transfer:s})}get print(){hi("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,Tg)}get modifiedIds(){return le(this,"modifiedIds",{ids:new Set,hash:""})}}Tg=new WeakMap;var Ld;class o4{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){C(this,Ld,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),l(this,Ld).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||l(this,Ld).has(t.loadedName))){if(Me(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:s,style:a}=t,o=new FontFace(n,s,a);this.addNativeFontFace(o);try{await o.load(),l(this,Ld).add(n),i==null||i(t)}catch{ue(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}hi("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(n){throw ue(`Failed to load font '${i.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const n=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return le(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return le(this,"isSyncFontLoadingSupported",hs||en.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Me(!n.done,"completeRequest() cannot be called twice."),n.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return le(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(P,D){return P.charCodeAt(D)<<24|P.charCodeAt(D+1)<<16|P.charCodeAt(D+2)<<8|P.charCodeAt(D+3)&255}function n(P,D,H,X){const $=P.substring(0,D),B=P.substring(D+H);return $+X+B}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const h=o.getContext("2d");let c=0;function u(P,D){if(++c>30){ue("Load test font never loaded."),D();return}if(h.font="30px "+P,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(u.bind(null,P,D))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=n(g,976,p.length,p);const A=16,v=1482184792;let S=i(g,A);for(s=0,a=p.length-3;s<a;s+=4)S=S-v+i(p,s)|0;s<p.length&&(S=S-v+i(p+"XXX",s)|0),g=n(g,A,4,Xx(S));const w=`url(data:font/opentype;base64,${btoa(g)});`,k=`@font-face {font-family:"${p}";src:${w}}`;this.insertRule(k);const L=this._document.createElement("div");L.style.visibility="hidden",L.style.width=L.style.height="10px",L.style.position="absolute",L.style.top=L.style.left="0px";for(const P of[t.loadedName,p]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=P,L.append(D)}this._document.body.append(L),u(p,()=>{L.remove(),e.complete()})}}Ld=new WeakMap;var Ze;class l4{constructor(t,e=null,i,n){C(this,Ze);this.compiledGlyphs=Object.create(null),_(this,Ze,t),this._inspectFont=e,i&&Object.assign(this,i),n&&(this.charProcOperatorList=n)}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${DA(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return(i=this._inspectFont)==null||i.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let n;try{n=t.get(i)}catch(a){ue(`getPathGenerator - ignoring character: "${a}".`)}const s=zA(n==null?void 0:n.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=s}get black(){return l(this,Ze).black}get bold(){return l(this,Ze).bold}get disableFontFace(){return l(this,Ze).disableFontFace??!1}set disableFontFace(t){le(this,"disableFontFace",!!t)}get fontExtraProperties(){return l(this,Ze).fontExtraProperties??!1}get isInvalidPDFjsFont(){return l(this,Ze).isInvalidPDFjsFont}get isType3Font(){return l(this,Ze).isType3Font}get italic(){return l(this,Ze).italic}get missingFile(){return l(this,Ze).missingFile}get remeasure(){return l(this,Ze).remeasure}get vertical(){return l(this,Ze).vertical}get ascent(){return l(this,Ze).ascent}get defaultWidth(){return l(this,Ze).defaultWidth}get descent(){return l(this,Ze).descent}get bbox(){return l(this,Ze).bbox}set bbox(t){le(this,"bbox",t)}get fontMatrix(){return l(this,Ze).fontMatrix}get fallbackName(){return l(this,Ze).fallbackName}get loadedName(){return l(this,Ze).loadedName}get mimetype(){return l(this,Ze).mimetype}get name(){return l(this,Ze).name}get data(){return l(this,Ze).data}clearData(){l(this,Ze).clearData()}get cssFontInfo(){return l(this,Ze).cssFontInfo}get systemFontInfo(){return l(this,Ze).systemFontInfo}get defaultVMetrics(){return l(this,Ze).defaultVMetrics}}Ze=new WeakMap;var Ed,kd,Ig,Pd,lm;const td=class td{constructor(t){C(this,Pd);C(this,Ed);C(this,kd);C(this,Ig);_(this,Ed,t),_(this,kd,new DataView(l(this,Ed))),_(this,Ig,new TextDecoder)}static write(t){const e=new TextEncoder,i={};let n=0;for(const c of td.strings){const u=e.encode(t[c]);i[c]=u,n+=4+u.length}const s=new ArrayBuffer(n),a=new Uint8Array(s),o=new DataView(s);let h=0;for(const c of td.strings){const u=i[c],p=u.length;o.setUint32(h,p),a.set(u,h+4),h+=4+p}return Me(h===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return E(this,Pd,lm).call(this,0)}get fontWeight(){return E(this,Pd,lm).call(this,1)}get italicAngle(){return E(this,Pd,lm).call(this,2)}};Ed=new WeakMap,kd=new WeakMap,Ig=new WeakMap,Pd=new WeakSet,lm=function(t){Me(t<td.strings.length,"Invalid string index");let e=0;for(let n=0;n<t;n++)e+=l(this,kd).getUint32(e)+4;const i=l(this,kd).getUint32(e);return l(this,Ig).decode(new Uint8Array(l(this,Ed),e+4,i))},bt(td,"strings",["fontFamily","fontWeight","italicAngle"]);let Um=td;var Xl,Pa,wc,Ac,Cp;const ed=class ed{constructor(t){C(this,Ac);C(this,Xl);C(this,Pa);C(this,wc);_(this,Xl,t),_(this,Pa,new DataView(l(this,Xl))),_(this,wc,new TextDecoder)}static write(t){const e=new TextEncoder,i={};let n=0;for(const g of ed.strings){const f=e.encode(t[g]);i[g]=f,n+=4+f.length}n+=4;let s,a,o=1+n;t.style&&(s=e.encode(t.style.style),a=e.encode(t.style.weight),o+=4+s.length+4+a.length);const h=new ArrayBuffer(o),c=new Uint8Array(h),u=new DataView(h);let p=0;u.setUint8(p++,t.guessFallback?1:0),u.setUint32(p,0),p+=4,n=0;for(const g of ed.strings){const f=i[g],A=f.length;n+=4+A,u.setUint32(p,A),c.set(f,p+4),p+=4+A}return u.setUint32(p-n-4,n),t.style&&(u.setUint32(p,s.length),c.set(s,p+4),p+=4+s.length,u.setUint32(p,a.length),c.set(a,p+4),p+=4+a.length),Me(p<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(p)}get guessFallback(){return l(this,Pa).getUint8(0)!==0}get css(){return E(this,Ac,Cp).call(this,0)}get loadedName(){return E(this,Ac,Cp).call(this,1)}get baseFontName(){return E(this,Ac,Cp).call(this,2)}get src(){return E(this,Ac,Cp).call(this,3)}get style(){let t=1;t+=4+l(this,Pa).getUint32(t);const e=l(this,Pa).getUint32(t),i=l(this,wc).decode(new Uint8Array(l(this,Xl),t+4,e));t+=4+e;const n=l(this,Pa).getUint32(t),s=l(this,wc).decode(new Uint8Array(l(this,Xl),t+4,n));return{style:i,weight:s}}};Xl=new WeakMap,Pa=new WeakMap,wc=new WeakMap,Ac=new WeakSet,Cp=function(t){Me(t<ed.strings.length,"Invalid string index");let e=5;for(let n=0;n<t;n++)e+=l(this,Pa).getUint32(e)+4;const i=l(this,Pa).getUint32(e);return l(this,wc).decode(new Uint8Array(l(this,Xl),e+4,i))},bt(ed,"strings",["css","loadedName","baseFontName","src"]);let Hm=ed;var Nd,Td,Id,Fd,Os,Na,Fg,Qe,Bi,Ur,hm,Lp;const ve=class ve{constructor({data:t,extra:e}){C(this,Bi);C(this,Na);C(this,Fg);C(this,Qe);_(this,Na,t),_(this,Fg,new TextDecoder),_(this,Qe,new DataView(l(this,Na))),e&&Object.assign(this,e)}get black(){return E(this,Bi,Ur).call(this,0)}get bold(){return E(this,Bi,Ur).call(this,1)}get disableFontFace(){return E(this,Bi,Ur).call(this,2)}get fontExtraProperties(){return E(this,Bi,Ur).call(this,3)}get isInvalidPDFjsFont(){return E(this,Bi,Ur).call(this,4)}get isType3Font(){return E(this,Bi,Ur).call(this,5)}get italic(){return E(this,Bi,Ur).call(this,6)}get missingFile(){return E(this,Bi,Ur).call(this,7)}get remeasure(){return E(this,Bi,Ur).call(this,8)}get vertical(){return E(this,Bi,Ur).call(this,9)}get ascent(){return E(this,Bi,hm).call(this,0)}get defaultWidth(){return E(this,Bi,hm).call(this,1)}get descent(){return E(this,Bi,hm).call(this,2)}get bbox(){let t=l(ve,Td);if(l(this,Qe).getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<4;n++)i.push(l(this,Qe).getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=l(ve,Id);if(l(this,Qe).getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<6;n++)i.push(l(this,Qe).getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=l(ve,Fd);if(l(this,Qe).getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<3;n++)i.push(l(this,Qe).getInt16(t,!0)),t+=2;return i}get fallbackName(){return E(this,Bi,Lp).call(this,0)}get loadedName(){return E(this,Bi,Lp).call(this,1)}get mimetype(){return E(this,Bi,Lp).call(this,2)}get name(){return E(this,Bi,Lp).call(this,3)}get data(){let t=l(ve,Os);const e=l(this,Qe).getUint32(t);t+=4+e;const i=l(this,Qe).getUint32(t);t+=4+i;const n=l(this,Qe).getUint32(t);t+=4+n;const s=l(this,Qe).getUint32(t);if(s!==0)return new Uint8Array(l(this,Na),t+4,s)}clearData(){let t=l(ve,Os);const e=l(this,Qe).getUint32(t);t+=4+e;const i=l(this,Qe).getUint32(t);t+=4+i;const n=l(this,Qe).getUint32(t);t+=4+n;const s=l(this,Qe).getUint32(t);new Uint8Array(l(this,Na),t+4,s).fill(0),l(this,Qe).setUint32(t,0)}get cssFontInfo(){let t=l(ve,Os);const e=l(this,Qe).getUint32(t);t+=4+e;const i=l(this,Qe).getUint32(t);t+=4+i;const n=l(this,Qe).getUint32(t);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(l(this,Na),t+4,n)),new Um(s.buffer)}get systemFontInfo(){let t=l(ve,Os);const e=l(this,Qe).getUint32(t);t+=4+e;const i=l(this,Qe).getUint32(t);if(i===0)return null;const n=new Uint8Array(i);return n.set(new Uint8Array(l(this,Na),t+4,i)),new Hm(n.buffer)}static write(t){const e=t.systemFontInfo?Hm.write(t.systemFontInfo):null,i=t.cssFontInfo?Um.write(t.cssFontInfo):null,n=new TextEncoder,s={};let a=0;for(const v of ve.strings)s[v]=n.encode(t[v]),a+=4+s[v].length;const o=l(ve,Os)+4+a+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(o),c=new Uint8Array(h),u=new DataView(h);let p=0;const g=ve.bools.length;let f=0,A=0;for(let v=0;v<g;v++){const S=t[ve.bools[v]];f|=(S===void 0?0:S?2:1)<<A,A+=2,(A===8||v===g-1)&&(u.setUint8(p++,f),f=0,A=0)}Me(p===l(ve,Nd),"FontInfo.write: Boolean properties offset mismatch");for(const v of ve.numbers)u.setFloat64(p,t[v]),p+=8;if(Me(p===l(ve,Td),"FontInfo.write: Number properties offset mismatch"),t.bbox){u.setUint8(p++,4);for(const v of t.bbox)u.setInt16(p,v,!0),p+=2}else u.setUint8(p++,0),p+=8;if(Me(p===l(ve,Id),"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){u.setUint8(p++,6);for(const v of t.fontMatrix)u.setFloat64(p,v,!0),p+=8}else u.setUint8(p++,0),p+=48;if(Me(p===l(ve,Fd),"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){u.setUint8(p++,1);for(const v of t.defaultVMetrics)u.setInt16(p,v,!0),p+=2}else u.setUint8(p++,0),p+=6;Me(p===l(ve,Os),"FontInfo.write: DefaultVMetrics properties offset mismatch"),u.setUint32(l(ve,Os),0),p+=4;for(const v of ve.strings){const S=s[v],w=S.length;u.setUint32(p,w),c.set(S,p+4),p+=4+w}if(u.setUint32(l(ve,Os),p-l(ve,Os)-4),!e)u.setUint32(p,0),p+=4;else{const v=e.byteLength;u.setUint32(p,v),Me(p+4+v<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),c.set(new Uint8Array(e),p+4),p+=4+v}if(!i)u.setUint32(p,0),p+=4;else{const v=i.byteLength;u.setUint32(p,v),Me(p+4+v<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),c.set(new Uint8Array(i),p+4),p+=4+v}return t.data===void 0?(u.setUint32(p,0),p+=4):(u.setUint32(p,t.data.length),c.set(t.data,p+4),p+=4+t.data.length),Me(p<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(p)}};Nd=new WeakMap,Td=new WeakMap,Id=new WeakMap,Fd=new WeakMap,Os=new WeakMap,Na=new WeakMap,Fg=new WeakMap,Qe=new WeakMap,Bi=new WeakSet,Ur=function(t){Me(t<ve.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,n=l(this,Qe).getUint8(e)>>i&3;return n===0?void 0:n===2},hm=function(t){return Me(t<ve.numbers.length,"Invalid number index"),l(this,Qe).getFloat64(l(ve,Nd)+t*8)},Lp=function(t){Me(t<ve.strings.length,"Invalid string index");let e=l(ve,Os)+4;for(let s=0;s<t;s++)e+=l(this,Qe).getUint32(e)+4;const i=l(this,Qe).getUint32(e),n=new Uint8Array(i);return n.set(new Uint8Array(l(this,Na),e+4,i)),l(this,Fg).decode(n)},bt(ve,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),bt(ve,"numbers",["ascent","defaultWidth","descent"]),bt(ve,"strings",["fallbackName","loadedName","mimetype","name"]),C(ve,Nd,Math.ceil(ve.bools.length*2/8)),C(ve,Td,l(ve,Nd)+ve.numbers.length*8),C(ve,Id,l(ve,Td)+1+8),C(ve,Fd,l(ve,Id)+1+48),C(ve,Os,l(ve,Fd)+1+6);let ub=ve;var Mg,Rg,Dg,Og,Bg,jg,Ug,Hg;const fi=class fi{constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,n=[],s=[],a=[],o=[],h=null,c=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],a=t[3],e===1?n.push(...t[4],...t[5]):n.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,h=t[1],n=t[2],s=t[3],o=t[4]||[],i=t[6],c=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const u=Math.floor(n.length/2),p=Math.floor(s.length/3),g=a.length,f=o.length;let A=0;for(const D of o)A+=1,A=Math.ceil(A/4)*4,A+=4+D.coords.length*4,A+=4+D.colors.length*4,D.verticesPerRow!==void 0&&(A+=4);const v=20+u*8+p*3+g*8+(i?16:0)+(c?3:0)+A,S=new ArrayBuffer(v),w=new DataView(S),k=new Uint8Array(S);w.setUint8(l(fi,Mg),e),w.setUint8(l(fi,Rg),i?1:0),w.setUint8(l(fi,Dg),c?1:0),w.setUint8(l(fi,Og),h),w.setUint32(l(fi,Bg),u,!0),w.setUint32(l(fi,jg),p,!0),w.setUint32(l(fi,Ug),g,!0),w.setUint32(l(fi,Hg),f,!0);let L=20;new Float32Array(S,L,u*2).set(n),L+=u*8,k.set(s,L),L+=p*3;for(const[D,H]of a)w.setFloat32(L,D,!0),L+=4,w.setUint32(L,parseInt(H.slice(1),16),!0),L+=4;if(i)for(const D of i)w.setFloat32(L,D,!0),L+=4;c&&(k.set(c,L),L+=3);for(let D=0;D<o.length;D++){const H=o[D];w.setUint8(L,H.type),L+=1,L=Math.ceil(L/4)*4,w.setUint32(L,H.coords.length,!0),L+=4,new Int32Array(S,L,H.coords.length).set(H.coords),L+=H.coords.length*4,w.setUint32(L,H.colors.length,!0),L+=4,new Int32Array(S,L,H.colors.length).set(H.colors),L+=H.colors.length*4,H.verticesPerRow!==void 0&&(w.setUint32(L,H.verticesPerRow,!0),L+=4)}return S}getIR(){const t=this.view,e=this.data[l(fi,Mg)],i=!!this.data[l(fi,Rg)],n=!!this.data[l(fi,Dg)],s=t.getUint32(l(fi,Bg),!0),a=t.getUint32(l(fi,jg),!0),o=t.getUint32(l(fi,Ug),!0),h=t.getUint32(l(fi,Hg),!0);let c=20;const u=new Float32Array(this.buffer,c,s*2);c+=s*8;const p=new Uint8Array(this.buffer,c,a*3);c+=a*3;const g=[];for(let S=0;S<o;++S){const w=t.getFloat32(c,!0);c+=4;const k=t.getUint32(c,!0);c+=4,g.push([w,`#${k.toString(16).padStart(6,"0")}`])}let f=null;if(i){f=[];for(let S=0;S<4;++S)f.push(t.getFloat32(c,!0)),c+=4}let A=null;n&&(A=new Uint8Array(this.buffer,c,3),c+=3);const v=[];for(let S=0;S<h;++S){const w=t.getUint8(c);c+=1,c=Math.ceil(c/4)*4;const k=t.getUint32(c,!0);c+=4;const L=new Int32Array(this.buffer,c,k);c+=k*4;const P=t.getUint32(c,!0);c+=4;const D=new Int32Array(this.buffer,c,P);c+=P*4;const H={type:w,coords:L,colors:D};w===G5.LATTICE&&(H.verticesPerRow=t.getUint32(c,!0),c+=4),v.push(H)}if(e===1)return["RadialAxial","axial",f,g,Array.from(u.slice(0,2)),Array.from(u.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",f,g,[u[0],u[1]],[u[3],u[4]],u[2],u[5]];if(e===3){const S=this.data[l(fi,Og)];let w=null;if(u.length>0){let k=u[0],L=u[0],P=u[1],D=u[1];for(let H=0;H<u.length;H+=2){const X=u[H],$=u[H+1];k=k>X?X:k,P=P>$?$:P,L=L<X?X:L,D=D<$?$:D}w=[k,P,L,D]}return["Mesh",S,u,p,v,w,f,A]}throw new Error(`Unsupported pattern kind: ${e}`)}};Mg=new WeakMap,Rg=new WeakMap,Dg=new WeakMap,Og=new WeakMap,Bg=new WeakMap,jg=new WeakMap,Ug=new WeakMap,Hg=new WeakMap,C(fi,Mg,0),C(fi,Rg,1),C(fi,Dg,2),C(fi,Og,3),C(fi,Bg,4),C(fi,jg,8),C(fi,Ug,12),C(fi,Hg,16);let db=fi;var Md;class h4{constructor(t){C(this,Md);_(this,Md,t)}static write(t){let e,i;return en.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}get path(){return en.isFloat16ArraySupported?new Float16Array(l(this,Md)):new Float32Array(l(this,Md))}}Md=new WeakMap;function c4(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(hs)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function u4(r){if(hs&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Y1(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function j0(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const fb=r=>typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0,d4=r=>typeof r=="object"&&typeof(r==null?void 0:r.name)=="string",x_=Zx.bind(null,fb,d4);var To,h2;class f4{constructor(){C(this,To,new Map);C(this,h2,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};l(this,h2).then(()=>{for(const[n]of l(this,To))n.call(this,i)})}addEventListener(t,e,i=null){let n=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:s}=i;if(s.aborted){ue("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);n=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}l(this,To).set(e,n)}removeEventListener(t,e){const i=l(this,To).get(e);i==null||i(),l(this,To).delete(e)}terminate(){for(const[,t]of l(this,To))t==null||t();l(this,To).clear()}}To=new WeakMap,h2=new WeakMap;const U0={DATA:1,ERROR:2},Qi={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Gy(){}function ps(r){if(r instanceof rl||r instanceof Om||r instanceof Oy||r instanceof Yp||r instanceof u5)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||hi('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new rl(r.message);case"InvalidPDFException":return new Om(r.message);case"PasswordException":return new Oy(r.message,r.code);case"ResponseException":return new Yp(r.message,r.status,r.missing);case"UnknownErrorException":return new u5(r.message,r.details)}return new u5(r.message,r.toString())}var Rd,Pr,C_,L_,E_,cm;class Ep{constructor(t,e,i){C(this,Pr);C(this,Rd,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",E(this,Pr,C_).bind(this),{signal:l(this,Rd).signal})}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[n]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(t,e,i,n){const s=this.streamId++,a=this.sourceName,o=this.targetName,h=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:a,targetName:o,action:t,streamId:s,data:e,desiredSize:c.desiredSize},n),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[s].pullCall=u,h.postMessage({sourceName:a,targetName:o,stream:Qi.PULL,streamId:s,desiredSize:c.desiredSize}),u.promise},cancel:c=>{Me(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[s].cancelCall=u,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:a,targetName:o,stream:Qi.CANCEL,streamId:s,reason:ps(c)}),u.promise}},i)}destroy(){var t;(t=l(this,Rd))==null||t.abort(),_(this,Rd,null)}}Rd=new WeakMap,Pr=new WeakSet,C_=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){E(this,Pr,E_).call(this,t);return}if(t.callback){const i=t.callbackId,n=this.callbackCapabilities[i];if(!n)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===U0.DATA)n.resolve(t.data);else if(t.callback===U0.ERROR)n.reject(ps(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,n=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(a){s.postMessage({sourceName:i,targetName:n,callback:U0.DATA,callbackId:t.callbackId,data:a})},function(a){s.postMessage({sourceName:i,targetName:n,callback:U0.ERROR,callbackId:t.callbackId,reason:ps(a)})});return}if(t.streamId){E(this,Pr,L_).call(this,t);return}e(t.data)},L_=function(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,a=this,o=this.actionHandler[t.action],h={enqueue(c,u=1,p){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=u,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:n,stream:Qi.ENQUEUE,streamId:e,chunk:c},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:Qi.CLOSE,streamId:e}),delete a.streamSinks[e])},error(c){Me(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:Qi.ERROR,streamId:e,reason:ps(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(o,t.data,h).then(function(){s.postMessage({sourceName:i,targetName:n,stream:Qi.START_COMPLETE,streamId:e,success:!0})},function(c){s.postMessage({sourceName:i,targetName:n,stream:Qi.START_COMPLETE,streamId:e,reason:ps(c)})})},E_=function(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case Qi.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(ps(t.reason));break;case Qi.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(ps(t.reason));break;case Qi.PULL:if(!o){s.postMessage({sourceName:i,targetName:n,stream:Qi.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,Promise.try(o.onPull||Gy).then(function(){s.postMessage({sourceName:i,targetName:n,stream:Qi.PULL_COMPLETE,streamId:e,success:!0})},function(c){s.postMessage({sourceName:i,targetName:n,stream:Qi.PULL_COMPLETE,streamId:e,reason:ps(c)})});break;case Qi.ENQUEUE:if(Me(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Qi.CLOSE:if(Me(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),E(this,Pr,cm).call(this,a,e);break;case Qi.ERROR:Me(a,"error should have stream controller"),a.controller.error(ps(t.reason)),E(this,Pr,cm).call(this,a,e);break;case Qi.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(ps(t.reason)),E(this,Pr,cm).call(this,a,e);break;case Qi.CANCEL:if(!o)break;const h=ps(t.reason);Promise.try(o.onCancel||Gy,h).then(function(){s.postMessage({sourceName:i,targetName:n,stream:Qi.CANCEL_COMPLETE,streamId:e,success:!0})},function(c){s.postMessage({sourceName:i,targetName:n,stream:Qi.CANCEL_COMPLETE,streamId:e,reason:ps(c)})}),o.sinkCapability.reject(h),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},cm=async function(t,e){var i,n,s;await Promise.allSettled([(i=t.startCall)==null?void 0:i.promise,(n=t.pullCall)==null?void 0:n.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]};var qg;class k_{constructor({enableHWA:t=!1}){C(this,qg,!1);_(this,qg,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!l(this,qg)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){hi("Abstract method `_createCanvas` called.")}}qg=new WeakMap;class p4 extends k_{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class P_{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){hi("Abstract method `_fetch` called.")}}class Vy extends P_{async _fetch(t){const e=await Rf(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Y1(e)}}class N_{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,s){return"none"}destroy(t=!1){}}var _c,Dd,Io,Fo,Kn,Sc,xc,Rt,Vn,kp,zu,um,Wu,T_,pb,Gu,Pp,Np,gb,Tp;class g4 extends N_{constructor({docId:e,ownerDocument:i=globalThis.document}){super();C(this,Rt);C(this,_c);C(this,Dd);C(this,Io);C(this,Fo);C(this,Kn);C(this,Sc);C(this,xc,0);_(this,Fo,e),_(this,Kn,i)}addFilter(e){if(!e)return"none";let i=l(this,Rt,Vn).get(e);if(i)return i;const[n,s,a]=E(this,Rt,um).call(this,e),o=e.length===1?n:`${n}${s}${a}`;if(i=l(this,Rt,Vn).get(o),i)return l(this,Rt,Vn).set(e,i),i;const h=`g_${l(this,Fo)}_transfer_map_${cn(this,xc)._++}`,c=E(this,Rt,Wu).call(this,h);l(this,Rt,Vn).set(e,c),l(this,Rt,Vn).set(o,c);const u=E(this,Rt,Gu).call(this,h);return E(this,Rt,Np).call(this,n,s,a,u),c}addHCMFilter(e,i){var A;const n=`${e}-${i}`,s="base";let a=l(this,Rt,kp).get(s);if((a==null?void 0:a.key)===n||(a?((A=a.filter)==null||A.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},l(this,Rt,kp).set(s,a)),!e||!i))return a.url;const o=E(this,Rt,Tp).call(this,e);e=Mt.makeHexColor(...o);const h=E(this,Rt,Tp).call(this,i);if(i=Mt.makeHexColor(...h),l(this,Rt,zu).style.color="",e==="#000000"&&i==="#ffffff"||e===i)return a.url;const c=new Array(256);for(let v=0;v<=255;v++){const S=v/255;c[v]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const u=c.join(","),p=`g_${l(this,Fo)}_hcm_filter`,g=a.filter=E(this,Rt,Gu).call(this,p);E(this,Rt,Np).call(this,u,u,u,g),E(this,Rt,pb).call(this,g);const f=(v,S)=>{const w=o[v]/255,k=h[v]/255,L=new Array(S+1);for(let P=0;P<=S;P++)L[P]=w+P/S*(k-w);return L.join(",")};return E(this,Rt,Np).call(this,f(0,5),f(1,5),f(2,5),g),a.url=E(this,Rt,Wu).call(this,p),a.url}addAlphaFilter(e){let i=l(this,Rt,Vn).get(e);if(i)return i;const[n]=E(this,Rt,um).call(this,[e]),s=`alpha_${n}`;if(i=l(this,Rt,Vn).get(s),i)return l(this,Rt,Vn).set(e,i),i;const a=`g_${l(this,Fo)}_alpha_map_${cn(this,xc)._++}`,o=E(this,Rt,Wu).call(this,a);l(this,Rt,Vn).set(e,o),l(this,Rt,Vn).set(s,o);const h=E(this,Rt,Gu).call(this,a);return E(this,Rt,gb).call(this,n,h),o}addLuminosityFilter(e){let i=l(this,Rt,Vn).get(e||"luminosity");if(i)return i;let n,s;if(e?([n]=E(this,Rt,um).call(this,[e]),s=`luminosity_${n}`):s="luminosity",i=l(this,Rt,Vn).get(s),i)return l(this,Rt,Vn).set(e,i),i;const a=`g_${l(this,Fo)}_luminosity_map_${cn(this,xc)._++}`,o=E(this,Rt,Wu).call(this,a);l(this,Rt,Vn).set(e,o),l(this,Rt,Vn).set(s,o);const h=E(this,Rt,Gu).call(this,a);return E(this,Rt,T_).call(this,h),e&&E(this,Rt,gb).call(this,n,h),o}addHighlightHCMFilter(e,i,n,s,a){var k;const o=`${i}-${n}-${s}-${a}`;let h=l(this,Rt,kp).get(e);if((h==null?void 0:h.key)===o||(h?((k=h.filter)==null||k.remove(),h.key=o,h.url="none",h.filter=null):(h={key:o,url:"none",filter:null},l(this,Rt,kp).set(e,h)),!i||!n))return h.url;const[c,u]=[i,n].map(E(this,Rt,Tp).bind(this));let p=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),g=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[f,A]=[s,a].map(E(this,Rt,Tp).bind(this));g<p&&([p,g,f,A]=[g,p,A,f]),l(this,Rt,zu).style.color="";const v=(L,P,D)=>{const H=new Array(256),X=(g-p)/D,$=L/255,B=(P-L)/(255*D);let Z=0;for(let I=0;I<=D;I++){const j=Math.round(p+I*X),K=$+I*B;for(let Y=Z;Y<=j;Y++)H[Y]=K;Z=j+1}for(let I=Z;I<256;I++)H[I]=H[Z-1];return H.join(",")},S=`g_${l(this,Fo)}_hcm_${e}_filter`,w=h.filter=E(this,Rt,Gu).call(this,S);return E(this,Rt,pb).call(this,w),E(this,Rt,Np).call(this,v(f[0],A[0],5),v(f[1],A[1],5),v(f[2],A[2],5),w),h.url=E(this,Rt,Wu).call(this,S),h.url}destroy(e=!1){var i,n,s,a;e&&((i=l(this,Sc))!=null&&i.size)||((n=l(this,Io))==null||n.parentNode.parentNode.remove(),_(this,Io,null),(s=l(this,Dd))==null||s.clear(),_(this,Dd,null),(a=l(this,Sc))==null||a.clear(),_(this,Sc,null),_(this,xc,0))}}_c=new WeakMap,Dd=new WeakMap,Io=new WeakMap,Fo=new WeakMap,Kn=new WeakMap,Sc=new WeakMap,xc=new WeakMap,Rt=new WeakSet,Vn=function(){return l(this,Dd)||_(this,Dd,new Map)},kp=function(){return l(this,Sc)||_(this,Sc,new Map)},zu=function(){if(!l(this,Io)){const e=l(this,Kn).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const n=l(this,Kn).createElementNS(po,"svg");n.setAttribute("width",0),n.setAttribute("height",0),_(this,Io,l(this,Kn).createElementNS(po,"defs")),e.append(n),n.append(l(this,Io)),l(this,Kn).body.append(e)}return l(this,Io)},um=function(e){if(e.length===1){const c=e[0],u=new Array(256);for(let g=0;g<256;g++)u[g]=c[g]/255;const p=u.join(",");return[p,p,p]}const[i,n,s]=e,a=new Array(256),o=new Array(256),h=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=n[c]/255,h[c]=s[c]/255;return[a.join(","),o.join(","),h.join(",")]},Wu=function(e){if(l(this,_c)===void 0){_(this,_c,"");const i=l(this,Kn).URL;i!==l(this,Kn).baseURI&&(J1(i)?ue('#createUrl: ignore "data:"-URL for performance reasons.'):_(this,_c,Ev(i,"")))}return`url(${l(this,_c)}#${e})`},T_=function(e){const i=l(this,Kn).createElementNS(po,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},pb=function(e){const i=l(this,Kn).createElementNS(po,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},Gu=function(e){const i=l(this,Kn).createElementNS(po,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),l(this,Rt,zu).append(i),i},Pp=function(e,i,n){const s=l(this,Kn).createElementNS(po,i);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)},Np=function(e,i,n,s){const a=l(this,Kn).createElementNS(po,"feComponentTransfer");s.append(a),E(this,Rt,Pp).call(this,a,"feFuncR",e),E(this,Rt,Pp).call(this,a,"feFuncG",i),E(this,Rt,Pp).call(this,a,"feFuncB",n)},gb=function(e,i){const n=l(this,Kn).createElementNS(po,"feComponentTransfer");i.append(n),E(this,Rt,Pp).call(this,n,"feFuncA",e)},Tp=function(e){return l(this,Rt,zu).style.color=e,Df(getComputedStyle(l(this,Rt,zu)).getPropertyValue("color"))};class I_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){hi("Abstract method `_fetch` called.")}}class $y extends I_{async _fetch(t){const e=await Rf(t,"arraybuffer");return new Uint8Array(e)}}class F_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){hi("Abstract method `_fetch` called.")}}class Xy extends F_{async _fetch(t){const e=await Rf(t,"arraybuffer");return new Uint8Array(e)}}hs&&ue("Please use the `legacy` build in Node.js environments.");async function Iv(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class m4 extends N_{}class b4 extends k_{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class v4 extends P_{async _fetch(t){return Iv(t)}}class y4 extends I_{async _fetch(t){return Iv(t)}}class w4 extends F_{async _fetch(t){return Iv(t)}}const Ou="__forcedDependency",{floor:Yy,ceil:Ky}=Math;function H0(r,t,e,i,n,s){r[t*4+0]=Math.min(r[t*4+0],e),r[t*4+1]=Math.min(r[t*4+1],i),r[t*4+2]=Math.max(r[t*4+2],n),r[t*4+3]=Math.max(r[t*4+3],s)}const mb=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Od,Yl;class A4{constructor(t,e){C(this,Od);C(this,Yl);_(this,Od,t),_(this,Yl,e)}get length(){return l(this,Od).length}isEmpty(t){return l(this,Od)[t]===mb}minX(t){return l(this,Yl)[t*4+0]/256}minY(t){return l(this,Yl)[t*4+1]/256}maxX(t){return(l(this,Yl)[t*4+2]+1)/256}maxY(t){return(l(this,Yl)[t*4+3]+1)/256}}Od=new WeakMap,Yl=new WeakMap;const q0=(r,t)=>{if(!r)return;let e=r.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},r.set(t,e)),e};var bs,vs,Cc,Gr,Lc,Mo,Ye,ti,Ro,ys,zg,Bd,Ec,kc,Do,Jn,Ta,Wg,bb;class _4{constructor(t,e,i=!1){C(this,Wg);C(this,bs,{__proto__:null});C(this,vs,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Ou]:[]});C(this,Cc,new Map);C(this,Gr,[]);C(this,Lc,[]);C(this,Mo,[[1,0,0,1,0,0]]);C(this,Ye,[-1/0,-1/0,1/0,1/0]);C(this,ti,new Float64Array([1/0,1/0,-1/0,-1/0]));C(this,Ro,-1);C(this,ys,new Set);C(this,zg,new Map);C(this,Bd,new Map);C(this,Ec);C(this,kc);C(this,Do);C(this,Jn);C(this,Ta);_(this,Ec,t.width),_(this,kc,t.height),E(this,Wg,bb).call(this,e),i&&_(this,Ta,new Map)}growOperationsCount(t){t>=l(this,Jn).length&&E(this,Wg,bb).call(this,t,l(this,Jn))}save(t){return _(this,bs,{__proto__:l(this,bs)}),_(this,vs,{__proto__:l(this,vs),transform:{__proto__:l(this,vs).transform},moveText:{__proto__:l(this,vs).moveText},sameLineText:{__proto__:l(this,vs).sameLineText},[Ou]:{__proto__:l(this,vs)[Ou]}}),_(this,Ye,{__proto__:l(this,Ye)}),l(this,Gr).push(t),this}restore(t){var n;const e=Object.getPrototypeOf(l(this,bs));if(e===null)return this;_(this,bs,e),_(this,vs,Object.getPrototypeOf(l(this,vs))),_(this,Ye,Object.getPrototypeOf(l(this,Ye)));const i=l(this,Gr).pop();return i!==void 0&&((n=q0(l(this,Ta),t))==null||n.dependencies.add(i),l(this,Jn)[t]=l(this,Jn)[i]),this}recordOpenMarker(t){return l(this,Gr).push(t),this}getOpenMarker(){return l(this,Gr).length===0?null:l(this,Gr).at(-1)}recordCloseMarker(t){var i;const e=l(this,Gr).pop();return e!==void 0&&((i=q0(l(this,Ta),t))==null||i.dependencies.add(e),l(this,Jn)[t]=l(this,Jn)[e]),this}beginMarkedContent(t){return l(this,Lc).push(t),this}endMarkedContent(t){var i;const e=l(this,Lc).pop();return e!==void 0&&((i=q0(l(this,Ta),t))==null||i.dependencies.add(e),l(this,Jn)[t]=l(this,Jn)[e]),this}pushBaseTransform(t){return l(this,Mo).push(Mt.multiplyByDOMMatrix(l(this,Mo).at(-1),t.getTransform())),this}popBaseTransform(){return l(this,Mo).length>1&&l(this,Mo).pop(),this}recordSimpleData(t,e){return l(this,bs)[t]=e,this}recordIncrementalData(t,e){return l(this,vs)[t].push(e),this}resetIncrementalData(t,e){return l(this,vs)[t].length=0,this}recordNamedData(t,e){return l(this,Cc).set(t,e),this}recordSimpleDataFromNamed(t,e,i){l(this,bs)[t]=l(this,Cc).get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Ou,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in l(this,bs)&&this.recordFutureForcedDependency(e,l(this,bs)[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of l(this,ys))this.recordFutureForcedDependency(Ou,t);return this}resetBBox(t){return l(this,Ro)!==t&&(_(this,Ro,t),l(this,ti)[0]=1/0,l(this,ti)[1]=1/0,l(this,ti)[2]=-1/0,l(this,ti)[3]=-1/0),this}recordClipBox(t,e,i,n,s,a){const o=Mt.multiplyByDOMMatrix(l(this,Mo).at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];Mt.axialAlignedBoundingBox([i,s,n,a],o,h);const c=Mt.intersect(l(this,Ye),h);return c?(l(this,Ye)[0]=c[0],l(this,Ye)[1]=c[1],l(this,Ye)[2]=c[2],l(this,Ye)[3]=c[3]):(l(this,Ye)[0]=l(this,Ye)[1]=1/0,l(this,Ye)[2]=l(this,Ye)[3]=-1/0),this}recordBBox(t,e,i,n,s,a){const o=l(this,Ye);if(o[0]===1/0)return this;const h=Mt.multiplyByDOMMatrix(l(this,Mo).at(-1),e.getTransform());if(o[0]===-1/0)return Mt.axialAlignedBoundingBox([i,s,n,a],h,l(this,ti)),this;const c=[1/0,1/0,-1/0,-1/0];return Mt.axialAlignedBoundingBox([i,s,n,a],h,c),l(this,ti)[0]=Math.min(l(this,ti)[0],Math.max(c[0],o[0])),l(this,ti)[1]=Math.min(l(this,ti)[1],Math.max(c[1],o[1])),l(this,ti)[2]=Math.max(l(this,ti)[2],Math.min(c[2],o[2])),l(this,ti)[3]=Math.max(l(this,ti)[3],Math.min(c[3],o[3])),this}recordCharacterBBox(t,e,i,n=1,s=0,a=0,o){const h=i.bbox;let c,u;if(h&&(c=h[2]!==h[0]&&h[3]!==h[1]&&l(this,Bd).get(i),c!==!1&&(u=[0,0,0,0],Mt.axialAlignedBoundingBox(h,i.fontMatrix,u),(n!==1||s!==0||a!==0)&&Mt.scaleMinMax([n,0,0,-n,s,a],u),c)))return this.recordBBox(t,e,u[0],u[2],u[1],u[3]);if(!o)return this.recordFullPageBBox(t);const p=o();return h&&u&&c===void 0&&(c=u[0]<=s-p.actualBoundingBoxLeft&&u[2]>=s+p.actualBoundingBoxRight&&u[1]<=a-p.actualBoundingBoxAscent&&u[3]>=a+p.actualBoundingBoxDescent,l(this,Bd).set(i,c),c)?this.recordBBox(t,e,u[0],u[2],u[1],u[3]):this.recordBBox(t,e,s-p.actualBoundingBoxLeft,s+p.actualBoundingBoxRight,a-p.actualBoundingBoxAscent,a+p.actualBoundingBoxDescent)}recordFullPageBBox(t){return l(this,ti)[0]=Math.max(0,l(this,Ye)[0]),l(this,ti)[1]=Math.max(0,l(this,Ye)[1]),l(this,ti)[2]=Math.min(l(this,Ec),l(this,Ye)[2]),l(this,ti)[3]=Math.min(l(this,kc),l(this,Ye)[3]),this}getSimpleIndex(t){return l(this,bs)[t]}recordDependencies(t,e){const i=l(this,ys),n=l(this,bs),s=l(this,vs);for(const a of e)a in l(this,bs)?i.add(n[a]):a in s&&s[a].forEach(i.add,i);return this}recordNamedDependency(t,e){return l(this,Cc).has(e)&&l(this,ys).add(l(this,Cc).get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Ou]),l(this,Ta)){const i=q0(l(this,Ta),t),{dependencies:n}=i;l(this,ys).forEach(n.add,n),l(this,Gr).forEach(n.add,n),l(this,Lc).forEach(n.add,n),n.delete(t),i.isRenderingOperation=!0}if(l(this,Ro)===t){const i=Yy(l(this,ti)[0]*256/l(this,Ec)),n=Yy(l(this,ti)[1]*256/l(this,kc)),s=Ky(l(this,ti)[2]*256/l(this,Ec)),a=Ky(l(this,ti)[3]*256/l(this,kc));H0(l(this,Do),t,i,n,s,a);for(const o of l(this,ys))o!==t&&H0(l(this,Do),o,i,n,s,a);for(const o of l(this,Gr))o!==t&&H0(l(this,Do),o,i,n,s,a);for(const o of l(this,Lc))o!==t&&H0(l(this,Do),o,i,n,s,a);e||(l(this,ys).clear(),_(this,Ro,-1))}return this}recordShowTextOperation(t,e=!1){const i=Array.from(l(this,ys));this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const n of i)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(t,e=!1){return l(this,Ro)===t&&(_(this,Ro,-1),l(this,Ye)[0]=Math.max(l(this,Ye)[0],l(this,ti)[0]),l(this,Ye)[1]=Math.max(l(this,Ye)[1],l(this,ti)[1]),l(this,Ye)[2]=Math.min(l(this,Ye)[2],l(this,ti)[2]),l(this,Ye)[3]=Math.min(l(this,Ye)[3],l(this,ti)[3]),e||l(this,ys).clear()),this}_takePendingDependencies(){const t=l(this,ys);return _(this,ys,new Set),t}_extractOperation(t){const e=l(this,zg).get(t);return l(this,zg).delete(t),e}_pushPendingDependencies(t){for(const e of t)l(this,ys).add(e)}take(){return l(this,Bd).clear(),new A4(l(this,Jn),l(this,Do))}takeDebugMetadata(){return l(this,Ta)}}bs=new WeakMap,vs=new WeakMap,Cc=new WeakMap,Gr=new WeakMap,Lc=new WeakMap,Mo=new WeakMap,Ye=new WeakMap,ti=new WeakMap,Ro=new WeakMap,ys=new WeakMap,zg=new WeakMap,Bd=new WeakMap,Ec=new WeakMap,kc=new WeakMap,Do=new WeakMap,Jn=new WeakMap,Ta=new WeakMap,Wg=new WeakSet,bb=function(t,e){const i=new ArrayBuffer(t*4);_(this,Do,new Uint8ClampedArray(i)),_(this,Jn,new Uint32Array(i)),e&&e.length>0?(l(this,Jn).set(e),l(this,Jn).fill(mb,e.length)):l(this,Jn).fill(mb)};var ai,Mi,Vr,jd,Ud;const Xv=class Xv{constructor(t,e,i){C(this,ai);C(this,Mi);C(this,Vr);C(this,jd,0);C(this,Ud,0);if(t instanceof Xv&&l(t,Vr)===!!i)return t;_(this,ai,t),_(this,Mi,e),_(this,Vr,!!i)}growOperationsCount(){throw new Error("Unreachable")}save(t){return cn(this,Ud)._++,l(this,ai).save(l(this,Mi)),this}restore(t){return l(this,Ud)>0&&(l(this,ai).restore(l(this,Mi)),cn(this,Ud)._--),this}recordOpenMarker(t){return cn(this,jd)._++,this}getOpenMarker(){return l(this,jd)>0?l(this,Mi):l(this,ai).getOpenMarker()}recordCloseMarker(t){return cn(this,jd)._--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return l(this,ai).pushBaseTransform(t),this}popBaseTransform(){return l(this,ai).popBaseTransform(),this}recordSimpleData(t,e){return l(this,ai).recordSimpleData(t,l(this,Mi)),this}recordIncrementalData(t,e){return l(this,ai).recordIncrementalData(t,l(this,Mi)),this}resetIncrementalData(t,e){return l(this,ai).resetIncrementalData(t,l(this,Mi)),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return l(this,ai).recordSimpleDataFromNamed(t,e,l(this,Mi)),this}recordFutureForcedDependency(t,e){return l(this,ai).recordFutureForcedDependency(t,l(this,Mi)),this}inheritSimpleDataAsFutureForcedDependencies(t){return l(this,ai).inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return l(this,ai).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return l(this,Vr)||l(this,ai).resetBBox(l(this,Mi)),this}recordClipBox(t,e,i,n,s,a){return l(this,Vr)||l(this,ai).recordClipBox(l(this,Mi),e,i,n,s,a),this}recordBBox(t,e,i,n,s,a){return l(this,Vr)||l(this,ai).recordBBox(l(this,Mi),e,i,n,s,a),this}recordCharacterBBox(t,e,i,n,s,a,o){return l(this,Vr)||l(this,ai).recordCharacterBBox(l(this,Mi),e,i,n,s,a,o),this}recordFullPageBBox(t){return l(this,Vr)||l(this,ai).recordFullPageBBox(l(this,Mi)),this}getSimpleIndex(t){return l(this,ai).getSimpleIndex(t)}recordDependencies(t,e){return l(this,ai).recordDependencies(l(this,Mi),e),this}recordNamedDependency(t,e){return l(this,ai).recordNamedDependency(l(this,Mi),e),this}recordOperation(t){return l(this,ai).recordOperation(l(this,Mi),!0),this}recordShowTextOperation(t){return l(this,ai).recordShowTextOperation(l(this,Mi),!0),this}bboxToClipBoxDropOperation(t){return l(this,Vr)||l(this,ai).bboxToClipBoxDropOperation(l(this,Mi),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};ai=new WeakMap,Mi=new WeakMap,Vr=new WeakMap,jd=new WeakMap,Ud=new WeakMap;let qm=Xv;const gr={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},On={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function vb(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,i),r.clip(n)}class Fv{isModifyingCurrentTransform(){return!1}getPattern(){hi("Abstract method `getPattern` called.")}}class S4 extends Fv{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,n=this._p0,s=this._p1;if(e&&(n=n.slice(),s=s.slice(),Mt.applyTransform(n,e),Mt.applyTransform(s,e)),this._type==="axial")i=t.createLinearGradient(n[0],n[1],s[0],s[1]);else if(this._type==="radial"){let a=this._r0,o=this._r1;if(e){const h=new Float32Array(2);Mt.singularValueDecompose2dScale(e,h),a*=h[0],o*=h[0]}i=t.createRadialGradient(n[0],n[1],a,s[0],s[1],o)}for(const a of this._colorStops)i.addColorStop(a[0],a[1]);return i}getPattern(t,e,i,n){let s;if(n===On.STROKE||n===On.FILL){if(this.isOriginBased()){let g=Mt.transform(i,e.baseTransform);this.matrix&&(g=Mt.transform(g,this.matrix));const f=.001,A=Math.hypot(g[0],g[1]),v=Math.hypot(g[2],g[3]),S=(g[0]*g[2]+g[1]*g[3])/(A*v);if(Math.abs(S)<f)if(this.isRadial()){if(Math.abs(A-v)<f)return this._createGradient(t,g)}else return this._createGradient(t,g)}const a=e.current.getClippedPathBoundingBox(n,Ei(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,h=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,h),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),i=Mt.transform(i,[1,0,0,1,a[0],a[1]]),u.transform(...e.baseTransform),this.matrix&&u.transform(...this.matrix),vb(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),s=t.createPattern(c.canvas,"no-repeat");const p=new DOMMatrix(i);s.setTransform(p)}else vb(t,this._bbox),s=this._createGradient(t);return s}}function p5(r,t,e,i,n,s,a,o){const h=t.coords,c=t.colors,u=r.data,p=r.width*4;let g;h[e+1]>h[i+1]&&(g=e,e=i,i=g,g=s,s=a,a=g),h[i+1]>h[n+1]&&(g=i,i=n,n=g,g=a,a=o,o=g),h[e+1]>h[i+1]&&(g=e,e=i,i=g,g=s,s=a,a=g);const f=(h[e]+t.offsetX)*t.scaleX,A=(h[e+1]+t.offsetY)*t.scaleY,v=(h[i]+t.offsetX)*t.scaleX,S=(h[i+1]+t.offsetY)*t.scaleY,w=(h[n]+t.offsetX)*t.scaleX,k=(h[n+1]+t.offsetY)*t.scaleY;if(A>=k)return;const L=c[s],P=c[s+1],D=c[s+2],H=c[a],X=c[a+1],$=c[a+2],B=c[o],Z=c[o+1],I=c[o+2],j=Math.round(A),K=Math.round(k);let Y,ot,rt,lt,st,ft,Ct,At;for(let F=j;F<=K;F++){if(F<S){const at=F<A?0:(A-F)/(A-S);Y=f-(f-v)*at,ot=L-(L-H)*at,rt=P-(P-X)*at,lt=D-(D-$)*at}else{let at;F>k?at=1:S===k?at=0:at=(S-F)/(S-k),Y=v-(v-w)*at,ot=H-(H-B)*at,rt=X-(X-Z)*at,lt=$-($-I)*at}let z;F<A?z=0:F>k?z=1:z=(A-F)/(A-k),st=f-(f-w)*z,ft=L-(L-B)*z,Ct=P-(P-Z)*z,At=D-(D-I)*z;const J=Math.round(Math.min(Y,st)),Q=Math.round(Math.max(Y,st));let it=p*F+J*4;for(let at=J;at<=Q;at++)z=(Y-at)/(Y-st),z<0?z=0:z>1&&(z=1),u[it++]=ot-(ot-ft)*z|0,u[it++]=rt-(rt-Ct)*z|0,u[it++]=lt-(lt-At)*z|0,u[it++]=255}}function x4(r,t,e){const i=t.coords,n=t.colors;let s,a;switch(t.type){case G5.LATTICE:const o=t.verticesPerRow,h=Math.floor(i.length/o)-1,c=o-1;for(s=0;s<h;s++){let u=s*o;for(let p=0;p<c;p++,u++)p5(r,e,i[u],i[u+1],i[u+o],n[u],n[u+1],n[u+o]),p5(r,e,i[u+o+1],i[u+1],i[u+o],n[u+o+1],n[u+1],n[u+o])}break;case G5.TRIANGLES:for(s=0,a=i.length;s<a;s+=3)p5(r,e,i[s],i[s+1],i[s+2],n[s],n[s+1],n[s+2]);break;default:throw new Error("illegal figure")}}class C4 extends Fv{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,u=Math.ceil(this._bounds[3])-h,p=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(u*t[1]*1.1)),3e3),f=c/p,A=u/g,v={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-h,scaleX:1/f,scaleY:1/A},S=p+4,w=g+4,k=i.getCanvas("mesh",S,w),L=k.context,P=L.createImageData(p,g);if(e){const H=P.data;for(let X=0,$=H.length;X<$;X+=4)H[X]=e[0],H[X+1]=e[1],H[X+2]=e[2],H[X+3]=255}for(const H of this._figures)x4(P,H,v);return L.putImageData(P,2,2),{canvas:k.canvas,offsetX:o-2*f,offsetY:h-2*A,scaleX:f,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,n){vb(t,this._bbox);const s=new Float32Array(2);if(n===On.SHADING)Mt.singularValueDecompose2dScale(Ei(t),s);else if(this.matrix){Mt.singularValueDecompose2dScale(this.matrix,s);const[o,h]=s;Mt.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=o,s[1]*=h}else Mt.singularValueDecompose2dScale(e.baseTransform,s);const a=this._createMeshCanvas(s,n===On.SHADING?null:this._background,e.cachedCanvases);return n!==On.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class L4 extends Fv{getPattern(){return"hotpink"}}function E4(r){switch(r[0]){case"RadialAxial":return new S4(r);case"Mesh":return new C4(r);case"Dummy":return new L4}throw new Error(`Unknown IR type: ${r[0]}`)}const Jy={COLORED:1,UNCOLORED:2},c2=class c2{constructor(t,e,i,n){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(t,e){var ft,Ct;const{bbox:i,operatorList:n,paintType:s,tilingType:a,color:o,canvasGraphicsFactory:h}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),_2("TilingType: "+a);const p=i[0],g=i[1],f=i[2],A=i[3],v=f-p,S=A-g,w=new Float32Array(2);Mt.singularValueDecompose2dScale(this.matrix,w);const[k,L]=w;Mt.singularValueDecompose2dScale(this.baseTransform,w);const P=k*w[0],D=L*w[1];let H=v,X=S,$=!1,B=!1;const Z=Math.ceil(c*P),I=Math.ceil(u*D),j=Math.ceil(v*P),K=Math.ceil(S*D);Z>=j?H=c:$=!0,I>=K?X=u:B=!0;const Y=this.getSizeAndScale(H,this.ctx.canvas.width,P),ot=this.getSizeAndScale(X,this.ctx.canvas.height,D),rt=t.cachedCanvases.getCanvas("pattern",Y.size,ot.size),lt=rt.context,st=h.createCanvasGraphics(lt,e);if(st.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(st,s,o),lt.translate(-Y.scale*p,-ot.scale*g),st.transform(0,Y.scale,0,0,ot.scale,0,0),lt.save(),(ft=st.dependencyTracker)==null||ft.save(),this.clipBbox(st,p,g,f,A),st.baseTransform=Ei(st.ctx),st.executeOperatorList(n),st.endDrawing(),(Ct=st.dependencyTracker)==null||Ct.restore(),lt.restore(),$||B){const At=rt.canvas;$&&(H=c),B&&(X=u);const F=this.getSizeAndScale(H,this.ctx.canvas.width,P),z=this.getSizeAndScale(X,this.ctx.canvas.height,D),J=F.size,Q=z.size,it=t.cachedCanvases.getCanvas("pattern-workaround",J,Q),at=it.context,pt=$?Math.floor(v/c):0,gt=B?Math.floor(S/u):0;for(let yt=0;yt<=pt;yt++)for(let Lt=0;Lt<=gt;Lt++)at.drawImage(At,J*yt,Q*Lt,J,Q,0,0,J,Q);return{canvas:it.canvas,scaleX:F.scale,scaleY:z.scale,offsetX:p,offsetY:g}}return{canvas:rt.canvas,scaleX:Y.scale,scaleY:ot.scale,offsetX:p,offsetY:g}}getSizeAndScale(t,e,i){const n=Math.max(c2.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*i);return s>=n?s=n:i=s/t,{scale:i,size:s}}clipBbox(t,e,i,n,s){const a=n-e,o=s-i;t.ctx.rect(e,i,a,o),Mt.axialAlignedBoundingBox([e,i,n,s],Ei(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,s=t.current;switch(e){case Jy.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;n.fillStyle=s.fillColor=a,n.strokeStyle=s.strokeColor=o;break;case Jy.UNCOLORED:n.fillStyle=n.strokeStyle=i,s.fillColor=s.strokeColor=i;break;default:throw new $x(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,n,s){let a=i;n!==On.SHADING&&(a=Mt.transform(a,e.baseTransform),this.matrix&&(a=Mt.transform(a,this.matrix)));const o=this.createPatternCanvas(e,s);let h=new DOMMatrix(a);h=h.translate(o.offsetX,o.offsetY),h=h.scale(1/o.scaleX,1/o.scaleY);const c=t.createPattern(o.canvas,"repeat");return c.setTransform(h),c}};bt(c2,"MAX_PATTERN_SIZE",3e3);let yb=c2;function k4({src:r,srcPos:t=0,dest:e,width:i,height:n,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=en.isLittleEndian?4278190080:255,[h,c]=a?[s,o]:[o,s],u=i>>3,p=i&7,g=r.length;e=new Uint32Array(e.buffer);let f=0;for(let A=0;A<n;A++){for(const S=t+u;t<S;t++){const w=t<g?r[t]:255;e[f++]=w&128?c:h,e[f++]=w&64?c:h,e[f++]=w&32?c:h,e[f++]=w&16?c:h,e[f++]=w&8?c:h,e[f++]=w&4?c:h,e[f++]=w&2?c:h,e[f++]=w&1?c:h}if(p===0)continue;const v=t<g?r[t++]:255;for(let S=0;S<p;S++)e[f++]=v&1<<7-S?c:h}return{srcPos:t,destPos:f}}const Zy=16,Qy=100,P4=15,tw=10,_s=16,g5=new DOMMatrix,tr=new Float32Array(2),Zu=new Float32Array([1/0,1/0,-1/0,-1/0]);function N4(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},r.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},r.transform=function(e,i,n,s,a,o){t.transform(e,i,n,s,a,o),this.__originalTransform(e,i,n,s,a,o)},r.setTransform=function(e,i,n,s,a,o){t.setTransform(e,i,n,s,a,o),this.__originalSetTransform(e,i,n,s,a,o)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,n,s,a,o){t.bezierCurveTo(e,i,n,s,a,o),this.__originalBezierCurveTo(e,i,n,s,a,o)},r.rect=function(e,i,n,s){t.rect(e,i,n,s),this.__originalRect(e,i,n,s)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class T4{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function z0(r,t,e,i,n,s,a,o,h,c){const[u,p,g,f,A,v]=Ei(r);if(p===0&&g===0){const k=a*u+A,L=Math.round(k),P=o*f+v,D=Math.round(P),H=(a+h)*u+A,X=Math.abs(Math.round(H)-L)||1,$=(o+c)*f+v,B=Math.abs(Math.round($)-D)||1;return r.setTransform(Math.sign(u),0,0,Math.sign(f),L,D),r.drawImage(t,e,i,n,s,0,0,X,B),r.setTransform(u,p,g,f,A,v),[X,B]}if(u===0&&f===0){const k=o*g+A,L=Math.round(k),P=a*p+v,D=Math.round(P),H=(o+c)*g+A,X=Math.abs(Math.round(H)-L)||1,$=(a+h)*p+v,B=Math.abs(Math.round($)-D)||1;return r.setTransform(0,Math.sign(p),Math.sign(g),0,L,D),r.drawImage(t,e,i,n,s,0,0,B,X),r.setTransform(u,p,g,f,A,v),[B,X]}r.drawImage(t,e,i,n,s,a,o,h,c);const S=Math.hypot(u,p),w=Math.hypot(g,f);return[S*h,w*c]}class ew{constructor(t,e,i){bt(this,"alphaIsShape",!1);bt(this,"fontSize",0);bt(this,"fontSizeScale",1);bt(this,"textMatrix",null);bt(this,"textMatrixScale",1);bt(this,"fontMatrix",W5);bt(this,"leading",0);bt(this,"x",0);bt(this,"y",0);bt(this,"lineX",0);bt(this,"lineY",0);bt(this,"charSpacing",0);bt(this,"wordSpacing",0);bt(this,"textHScale",1);bt(this,"textRenderingMode",un.FILL);bt(this,"textRise",0);bt(this,"fillColor","#000000");bt(this,"strokeColor","#000000");bt(this,"patternFill",!1);bt(this,"patternStroke",!1);bt(this,"fillAlpha",1);bt(this,"strokeAlpha",1);bt(this,"lineWidth",1);bt(this,"activeSMask",null);bt(this,"transferMaps","none");i==null||i(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Zu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=On.FILL,e=null){const i=this.minMax.slice();if(t===On.STROKE){e||hi("Stroke bounding box must include transform."),Mt.singularValueDecompose2dScale(e,tr);const n=tr[0]*this.lineWidth/2,s=tr[1]*this.lineWidth/2;i[0]-=n,i[1]-=s,i[2]+=n,i[3]+=s}return i}updateClipFromPath(){const t=Mt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Zu,0)}getClippedPathBoundingBox(t=On.FILL,e=null){return Mt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function iw(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,n=e%_s,s=(e-n)/_s,a=n===0?s:s+1,o=r.createImageData(i,_s);let h=0,c;const u=t.data,p=o.data;let g,f,A,v;if(t.kind===Up.GRAYSCALE_1BPP){const S=u.byteLength,w=new Uint32Array(p.buffer,0,p.byteLength>>2),k=w.length,L=i+7>>3,P=4294967295,D=en.isLittleEndian?4278190080:255;for(g=0;g<a;g++){for(A=g<s?_s:n,c=0,f=0;f<A;f++){const H=S-h;let X=0;const $=H>L?i:H*8-7,B=$&-8;let Z=0,I=0;for(;X<B;X+=8)I=u[h++],w[c++]=I&128?P:D,w[c++]=I&64?P:D,w[c++]=I&32?P:D,w[c++]=I&16?P:D,w[c++]=I&8?P:D,w[c++]=I&4?P:D,w[c++]=I&2?P:D,w[c++]=I&1?P:D;for(;X<$;X++)Z===0&&(I=u[h++],Z=128),w[c++]=I&Z?P:D,Z>>=1}for(;c<k;)w[c++]=0;r.putImageData(o,0,g*_s)}}else if(t.kind===Up.RGBA_32BPP){for(f=0,v=i*_s*4,g=0;g<s;g++)p.set(u.subarray(h,h+v)),h+=v,r.putImageData(o,0,f),f+=_s;g<a&&(v=i*n*4,p.set(u.subarray(h,h+v)),r.putImageData(o,0,f))}else if(t.kind===Up.RGB_24BPP)for(A=_s,v=i*A,g=0;g<a;g++){for(g>=s&&(A=n,v=i*A),c=0,f=v;f--;)p[c++]=u[h++],p[c++]=u[h++],p[c++]=u[h++],p[c++]=255;r.putImageData(o,0,g*_s)}else throw new Error(`bad image kind: ${t.kind}`)}function nw(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,n=e%_s,s=(e-n)/_s,a=n===0?s:s+1,o=r.createImageData(i,_s);let h=0;const c=t.data,u=o.data;for(let p=0;p<a;p++){const g=p<s?_s:n;({srcPos:h}=k4({src:c,srcPos:h,dest:u,width:i,height:g,nonBlackColor:0})),r.putImageData(o,0,p*_s)}}function fp(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function W0(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function sw(r,t){if(t)return!0;Mt.singularValueDecompose2dScale(r,tr);const e=Math.fround(ea.pixelRatio*al.PDF_TO_CSS_UNITS);return tr[0]<=e&&tr[1]<=e}const I4=["butt","round","square"],F4=["miter","round","bevel"],M4={},rw={};var na,wb,Ab,_b;const Yv=class Yv{constructor(t,e,i,n,s,{optionalContentConfig:a,markedContentStack:o=null},h,c,u){C(this,na);this.ctx=t,this.current=new ew(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new T4(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=u??null}getObject(t,e,i=null){var n;return typeof e=="string"?((n=this.dependencyTracker)==null||n.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,i){const h=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ei(this.compositeCtx))}this.ctx.save(),W0(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ei(this.ctx)}executeOperatorList(t,e,i,n,s){var w;const a=t.argsArray,o=t.fnArray;let h=e||0;const c=a.length;if(c===h)return h;const u=c-h>tw&&typeof i=="function",p=u?Date.now()+P4:0;let g=0;const f=this.commonObjs,A=this.objs;let v,S;for(;;){if(n!==void 0&&h===n.nextBreakPoint)return n.breakIt(h,i),h;if(!s||s(h))if(v=o[h],S=a[h]??null,v!==If.dependency)S===null?this[v](h):this[v](h,...S);else for(const k of S){(w=this.dependencyTracker)==null||w.recordNamedData(k,h);const L=k.startsWith("g_")?f:A;if(!L.has(k))return L.get(k,i),h}if(h++,h===c)return h;if(u&&++g>tw){if(Date.now()>p)return i(),h;g=0}}}endDrawing(){E(this,na,wb).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),E(this,na,Ab).call(this)}_scaleImage(t,e){const i=t.width??t.displayWidth,n=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,h=n,c="prescale1",u,p;for(;s>2&&o>1||a>2&&h>1;){let g=o,f=h;s>2&&o>1&&(g=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/g),a>2&&h>1&&(f=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,a/=h/f),u=this.cachedCanvases.getCanvas(c,g,f),p=u.context,p.clearRect(0,0,g,f),p.drawImage(t,0,0,o,h,0,0,g,f),t=u.canvas,o=g,h=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:h}}_createMaskCanvas(t,e){var Z,I;const i=this.ctx,{width:n,height:s}=e,a=this.current.fillColor,o=this.current.patternFill,h=Ei(i);let c,u,p,g;if((e.bitmap||e.data)&&e.count>1){const j=e.bitmap||e.data.buffer;u=JSON.stringify(o?h:[h.slice(0,4),a]),c=this._cachedBitmapsMap.get(j),c||(c=new Map,this._cachedBitmapsMap.set(j,c));const K=c.get(u);if(K&&!o){const Y=Math.round(Math.min(h[0],h[2])+h[4]),ot=Math.round(Math.min(h[1],h[3])+h[5]);return(Z=this.dependencyTracker)==null||Z.recordDependencies(t,gr.transformAndFill),{canvas:K,offsetX:Y,offsetY:ot}}p=K}p||(g=this.cachedCanvases.getCanvas("maskCanvas",n,s),nw(g.context,e));let f=Mt.transform(h,[1/n,0,0,-1/s,0,0]);f=Mt.transform(f,[1,0,0,1,0,-s]);const A=Zu.slice();Mt.axialAlignedBoundingBox([0,0,n,s],f,A);const[v,S,w,k]=A,L=Math.round(w-v)||1,P=Math.round(k-S)||1,D=this.cachedCanvases.getCanvas("fillCanvas",L,P),H=D.context,X=v,$=S;H.translate(-X,-$),H.transform(...f),p||(p=this._scaleImage(g.canvas,ga(H)),p=p.img,c&&o&&c.set(u,p)),H.imageSmoothingEnabled=sw(Ei(H),e.interpolate),z0(H,p,0,0,p.width,p.height,0,0,n,s),H.globalCompositeOperation="source-in";const B=Mt.transform(ga(H),[1,0,0,1,-X,-$]);return H.fillStyle=o?a.getPattern(i,this,B,On.FILL,t):a,H.fillRect(0,0,n,s),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,D.canvas)),(I=this.dependencyTracker)==null||I.recordDependencies(t,gr.transformAndFill),{canvas:D.canvas,offsetX:Math.round(X),offsetY:Math.round($)}}setLineWidth(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineCap",t),this.ctx.lineCap=I4[e]}setLineJoin(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineJoin",t),this.ctx.lineJoin=F4[e]}setMiterLimit(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",t);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){var i,n,s,a,o;for(const[h,c]of e)switch(h){case"LW":this.setLineWidth(t,c);break;case"LC":this.setLineCap(t,c);break;case"LJ":this.setLineJoin(t,c);break;case"ML":this.setMiterLimit(t,c);break;case"D":this.setDash(t,c[0],c[1]);break;case"RI":this.setRenderingIntent(t,c);break;case"FL":this.setFlatness(t,c);break;case"Font":this.setFont(t,c[0],c[1]);break;case"CA":(i=this.dependencyTracker)==null||i.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=c;break;case"ca":(n=this.dependencyTracker)==null||n.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=c;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=c;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",t),this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,i);this.suspendedCtx=this.ctx;const a=this.ctx=s.context;a.setTransform(this.suspendedCtx.getTransform()),fp(this.suspendedCtx,a),N4(a,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),fp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const s=n[0],a=n[1],o=n[2]-s,h=n[3]-a;o===0||h===0||(this.genericComposeSMask(e.context,i,o,h,e.subtype,e.backdrop,e.transferMap,s,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,s,a,o,h,c,u,p){let g=t.canvas,f=h-u,A=c-p;if(a)if(f<0||A<0||f+i>g.width||A+n>g.height){const S=this.cachedCanvases.getCanvas("maskExtension",i,n),w=S.context;w.drawImage(g,-f,-A),w.globalCompositeOperation="destination-atop",w.fillStyle=a,w.fillRect(0,0,i,n),w.globalCompositeOperation="source-over",g=S.canvas,f=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(f,A,i,n),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(f,A,i,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const v=new Path2D;v.rect(h,c,i,n),e.clip(v),e.globalCompositeOperation="destination-in",e.drawImage(g,f,A,i,n,h,c,i,n),e.restore()}save(t){var i;this.inSMaskMode&&fp(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),(i=this.dependencyTracker)==null||i.save(t)}restore(t){var e;if((e=this.dependencyTracker)==null||e.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&fp(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,n,s,a,o){var h;(h=this.dependencyTracker)==null||h.recordIncrementalData("transform",t),this.ctx.transform(e,i,n,s,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,n){let[s]=i;if(!n){s||(s=i[0]=new Path2D),this[e](t,s);return}if(this.dependencyTracker!==null){const a=e===If.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,n[0]-a,n[2]+a,n[1]-a,n[3]+a).recordDependencies(t,["transform"])}s instanceof Path2D||(s=i[0]=zA(s)),Mt.axialAlignedBoundingBox(n,Ei(this.ctx),this.current.minMax),this[e](t,s),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){var a;const n=this.ctx,s=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const o=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=s.getPattern(n,this,ga(n),On.STROKE,t),o){const h=new Path2D;h.addPath(e,n.getTransform().invertSelf().multiplySelf(o)),e=h}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);(a=this.dependencyTracker)==null||a.recordDependencies(t,gr.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(On.STROKE,Ei(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){var c,u,p;const n=this.ctx,s=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const g=s.isModifyingCurrentTransform()?n.getTransform():null;if((c=this.dependencyTracker)==null||c.save(t),n.save(),n.fillStyle=s.getPattern(n,this,ga(n),On.FILL,t),g){const f=new Path2D;f.addPath(e,n.getTransform().invertSelf().multiplySelf(g)),e=f}o=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),(u=this.dependencyTracker)==null||u.recordDependencies(t,gr.fill),o&&(n.restore(),(p=this.dependencyTracker)==null||p.restore(t)),i&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){var i;this.ctx.fill(e),(i=this.dependencyTracker)==null||i.recordDependencies(t,gr.rawFillPath).recordOperation(t)}clip(t){var e;(e=this.dependencyTracker)==null||e.recordFutureForcedDependency("clipMode",t),this.pendingClip=M4}eoClip(t){var e;(e=this.dependencyTracker)==null||e.recordFutureForcedDependency("clipMode",t),this.pendingClip=rw}beginText(t){var e;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(e=this.dependencyTracker)==null||e.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;e!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",t),n.recordCloseMarker(t)}if(e!==void 0){const n=new Path2D,s=i.getTransform().invertSelf();for(const{transform:a,x:o,y:h,fontSize:c,path:u}of e)u&&n.addPath(u,new DOMMatrix(a).preMultiplySelf(s).translate(o,h).scale(c,-c));i.clip(n)}delete this.pendingTextPaths}setCharSpacing(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){var p,g;(p=this.dependencyTracker)==null||p.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||W5,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&ue("Invalid font matrix for font "+e),i<0?(i=-i,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=i,n.isType3Font)return;const a=n.loadedName||"sans-serif",o=((g=n.systemFontInfo)==null?void 0:g.css)||`"${a}", ${n.fallbackName}`;let h="normal";n.black?h="900":n.bold&&(h="bold");const c=n.italic?"italic":"normal";let u=i;i<Zy?u=Zy:i>Qy&&(u=Qy),this.current.fontSizeScale=i/u,this.ctx.font=`${c} ${h} ${u}px ${o}`}setTextRenderingMode(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){var n;(n=this.dependencyTracker)==null||n.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){var n;(n=this.dependencyTracker)==null||n.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){var e;this.moveText(t,0,this.current.leading),(e=this.dependencyTracker)==null||e.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}paintChar(t,e,i,n,s,a){var w,k,L,P;const o=this.ctx,h=this.current,c=h.font,u=h.textRenderingMode,p=h.fontSize/h.fontSizeScale,g=u&un.FILL_STROKE_MASK,f=!!(u&un.ADD_TO_PATH_FLAG),A=h.patternFill&&!c.missingFile,v=h.patternStroke&&!c.missingFile;let S;if((c.disableFontFace||f||A||v)&&!c.missingFile&&(S=c.getPathGenerator(this.commonObjs,e)),S&&(c.disableFontFace||A||v)){o.save(),o.translate(i,n),o.scale(p,-p),(w=this.dependencyTracker)==null||w.recordCharacterBBox(t,o,c);let D;if(g===un.FILL||g===un.FILL_STROKE)if(s){D=o.getTransform(),o.setTransform(...s);const H=E(this,na,_b).call(this,S,D,s);o.fill(H)}else o.fill(S);if(g===un.STROKE||g===un.FILL_STROKE)if(a){D||(D=o.getTransform()),o.setTransform(...a);const{a:H,b:X,c:$,d:B}=D,Z=Mt.inverseTransform(a),I=Mt.transform([H,X,$,B,0,0],Z);Mt.singularValueDecompose2dScale(I,tr),o.lineWidth*=Math.max(tr[0],tr[1])/p,o.stroke(E(this,na,_b).call(this,S,D,a))}else o.lineWidth/=p,o.stroke(S);o.restore()}else(g===un.FILL||g===un.FILL_STROKE)&&(o.fillText(e,i,n),(k=this.dependencyTracker)==null||k.recordCharacterBBox(t,o,c,p,i,n,()=>o.measureText(e))),(g===un.STROKE||g===un.FILL_STROKE)&&(this.dependencyTracker&&((L=this.dependencyTracker)==null||L.recordCharacterBBox(t,o,c,p,i,n,()=>o.measureText(e)).recordDependencies(t,gr.stroke)),o.strokeText(e,i,n));f&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ei(o),x:i,y:n,fontSize:p,path:S}),(P=this.dependencyTracker)==null||P.recordCharacterBBox(t,o,c,p,i,n))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return le(this,"isFontSubpixelAAEnabled",i)}showText(t,e){var I,j,K,Y;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,gr.showText).resetBBox(t),this.current.textRenderingMode&un.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,n=i.font;if(n.isType3Font){this.showType3Text(t,e),(I=this.dependencyTracker)==null||I.recordShowTextOperation(t);return}const s=i.fontSize;if(s===0){(j=this.dependencyTracker)==null||j.recordOperation(t);return}const a=this.ctx,o=i.fontSizeScale,h=i.charSpacing,c=i.wordSpacing,u=i.fontDirection,p=i.textHScale*u,g=e.length,f=n.vertical,A=f?1:-1,v=n.defaultVMetrics,S=s*i.fontMatrix[0],w=i.textRenderingMode===un.FILL&&!n.disableFontFace&&!i.patternFill;a.save(),i.textMatrix&&a.transform(...i.textMatrix),a.translate(i.x,i.y+i.textRise),u>0?a.scale(p,-1):a.scale(p,1);let k,L;const P=i.textRenderingMode&un.FILL_STROKE_MASK,D=P===un.FILL||P===un.FILL_STROKE,H=P===un.STROKE||P===un.FILL_STROKE;if(D&&i.patternFill){a.save();const ot=i.fillColor.getPattern(a,this,ga(a),On.FILL,t);k=Ei(a),a.restore(),a.fillStyle=ot}if(H&&i.patternStroke){a.save();const ot=i.strokeColor.getPattern(a,this,ga(a),On.STROKE,t);L=Ei(a),a.restore(),a.strokeStyle=ot}let X=i.lineWidth;const $=i.textMatrixScale;if($===0||X===0?H&&(X=this.getSinglePixelWidth()):X/=$,o!==1&&(a.scale(o,o),X/=o),a.lineWidth=X,n.isInvalidPDFjsFont){const ot=[];let rt=0;for(const st of e)ot.push(st.unicode),rt+=st.width;const lt=ot.join("");if(a.fillText(lt,0,0),this.dependencyTracker!==null){const st=a.measureText(lt);this.dependencyTracker.recordBBox(t,this.ctx,-st.actualBoundingBoxLeft,st.actualBoundingBoxRight,-st.actualBoundingBoxAscent,st.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=rt*S*p,a.restore(),this.compose();return}let B=0,Z;for(Z=0;Z<g;++Z){const ot=e[Z];if(typeof ot=="number"){B+=A*ot*s/1e3;continue}let rt=!1;const lt=(ot.isSpace?c:0)+h,st=ot.fontChar,ft=ot.accent;let Ct,At,F=ot.width;if(f){const Q=ot.vmetric||v,it=-(ot.vmetric?Q[1]:F*.5)*S,at=Q[2]*S;F=Q?-Q[0]:F,Ct=it/o,At=(B+at)/o}else Ct=B/o,At=0;let z;if(n.remeasure&&F>0){z=a.measureText(st);const Q=z.width*1e3/s*o;if(F<Q&&this.isFontSubpixelAAEnabled){const it=F/Q;rt=!0,a.save(),a.scale(it,1),Ct/=it}else F!==Q&&(Ct+=(F-Q)/2e3*s/o)}if(this.contentVisible&&(ot.isInFont||n.missingFile)){if(w&&!ft)a.fillText(st,Ct,At),(K=this.dependencyTracker)==null||K.recordCharacterBBox(t,a,z?{bbox:null}:n,s/o,Ct,At,()=>z??a.measureText(st));else if(this.paintChar(t,st,Ct,At,k,L),ft){const Q=Ct+s*ft.offset.x/o,it=At-s*ft.offset.y/o;this.paintChar(t,ft.fontChar,Q,it,k,L)}}const J=f?F*S-lt*u:F*S+lt*u;B+=J,rt&&a.restore()}f?i.y-=B:i.x+=B*p,a.restore(),this.compose(),(Y=this.dependencyTracker)==null||Y.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,n=this.current,s=n.font,a=n.fontSize,o=n.fontDirection,h=s.vertical?1:-1,c=n.charSpacing,u=n.wordSpacing,p=n.textHScale*o,g=n.fontMatrix||W5,f=e.length,A=n.textRenderingMode===un.INVISIBLE;let v,S,w,k;if(A||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),n.textMatrix&&i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),i.scale(p,o);const L=this.dependencyTracker;for(this.dependencyTracker=L?new qm(L,t):null,v=0;v<f;++v){if(S=e[v],typeof S=="number"){k=h*S*a/1e3,this.ctx.translate(k,0),n.x+=k*p;continue}const P=(S.isSpace?u:0)+c,D=s.charProcOperatorList[S.operatorListId];D?this.contentVisible&&(this.save(),i.scale(a,a),i.transform(...g),this.executeOperatorList(D),this.restore()):ue(`Type3 character "${S.operatorListId}" is not available.`);const H=[S.width,0];Mt.applyTransform(H,g),w=H[0]*a+P,i.translate(w,0),n.x+=w*p}i.restore(),L&&(this.dependencyTracker=L)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,n,s,a,o){var c;const h=new Path2D;h.rect(n,s,a-n,o-s),this.ctx.clip(h),(c=this.dependencyTracker)==null||c.recordBBox(t,this.ctx,n,a,s,o).recordClipBox(t,this.ctx,n,a,s,o),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const n=this.baseTransform||Ei(this.ctx),s={createCanvasGraphics:(a,o)=>new Yv(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new qm(this.dependencyTracker,o,!0):null)};i=new yb(e,this.ctx,s,n)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){var e;(e=this.dependencyTracker)==null||e.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){var e;(e=this.dependencyTracker)==null||e.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=E4(this.getObject(t,e)),this.cachedPatterns.set(e,n)),i&&(n.matrix=i),n}shadingFill(t,e){var a;if(!this.contentVisible)return;const i=this.ctx;this.save(t);const n=this._getPattern(t,e);i.fillStyle=n.getPattern(i,this,ga(i),On.SHADING,t);const s=ga(i);if(s){const{width:o,height:h}=i.canvas,c=Zu.slice();Mt.axialAlignedBoundingBox([0,0,o,h],s,c);const[u,p,g,f]=c;this.ctx.fillRect(u,p,g-u,f-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,gr.transform).recordDependencies(t,gr.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){hi("Should not call beginInlineImage")}beginImageData(){hi("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){var n;if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Ei(this.ctx),i)){Mt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[s,a,o,h]=i,c=new Path2D;c.rect(s,a,o-s,h-a),this.ctx.clip(c),(n=this.dependencyTracker)==null||n.recordClipBox(t,this.ctx,s,o,a,h),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){var L;if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||_2("TODO: Support non-isolated groups."),e.knockout&&ue("Knockout groups not supported.");const n=Ei(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=Zu.slice();Mt.axialAlignedBoundingBox(e.bbox,Ei(i),s);const a=[0,0,i.canvas.width,i.canvas.height];s=Mt.intersect(s,a)||[0,0,0,0];const o=Math.floor(s[0]),h=Math.floor(s[1]),c=Math.max(Math.ceil(s[2])-o,1),u=Math.max(Math.ceil(s[3])-h,1);this.current.startNewPathAndClipBox([0,0,c,u]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(p,c,u),f=g.context;f.translate(-o,-h),f.transform(...n);let A=new Path2D;const[v,S,w,k]=e.bbox;if(A.rect(v,S,w-v,k-S),e.matrix){const P=new Path2D;P.addPath(A,new DOMMatrix(e.matrix)),A=P}f.clip(A),e.smask&&this.smaskStack.push({canvas:g.canvas,context:f,offsetX:o,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(o,h),i.save()),fp(i,f),this.ctx=f,(L=this.dependencyTracker)==null||L.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){var s;if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Ei(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const o=Zu.slice();Mt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,i,n,s,a){if(E(this,na,wb).call(this),W0(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const o=i[2]-i[0],h=i[3]-i[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=i[0],n[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=o,i[3]=h,Mt.singularValueDecompose2dScale(Ei(this.ctx),tr);const{viewportScale:c}=this,u=Math.ceil(o*this.outputScaleX*c),p=Math.ceil(h*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,p);const{canvas:g,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(tr[0],0,0,-tr[1],0,h*tr[1]),W0(this.ctx)}else{W0(this.ctx),this.endPath(t);const c=new Path2D;c.rect(i[0],i[1],o,h),this.ctx.clip(c)}}this.current=new ew(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...n),this.transform(t,...s)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),E(this,na,Ab).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){var o;if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const n=this.ctx,s=this._createMaskCanvas(t,e),a=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,s.offsetX,s.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(t).recordBBox(t,this.ctx,s.offsetX,s.offsetX+a.width,s.offsetY,s.offsetY+a.height).recordOperation(t),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,n=0,s=0,a,o){var p,g,f;if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const c=Ei(h);h.transform(i,n,s,a,0,0);const u=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]),(p=this.dependencyTracker)==null||p.resetBBox(t);for(let A=0,v=o.length;A<v;A+=2){const S=Mt.transform(c,[i,n,s,a,o[A],o[A+1]]);h.drawImage(u.canvas,S[4],S[5]),(g=this.dependencyTracker)==null||g.recordBBox(t,this.ctx,S[4],S[4]+u.canvas.width,S[5],S[5]+u.canvas.height)}h.restore(),this.compose(),(f=this.dependencyTracker)==null||f.recordOperation(t)}paintImageMaskXObjectGroup(t,e){var a,o,h;if(!this.contentVisible)return;const i=this.ctx,n=this.current.fillColor,s=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(t).recordDependencies(t,gr.transformAndFill);for(const c of e){const{data:u,width:p,height:g,transform:f}=c,A=this.cachedCanvases.getCanvas("maskCanvas",p,g),v=A.context;v.save();const S=this.getObject(t,u,c);nw(v,S),v.globalCompositeOperation="source-in",v.fillStyle=s?n.getPattern(v,this,ga(i),On.FILL,t):n,v.fillRect(0,0,p,g),v.restore(),i.save(),i.transform(...f),i.scale(1,-1),z0(i,A.canvas,0,0,p,g,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(t,i,0,p,0,g),i.restore()}this.compose(),(h=this.dependencyTracker)==null||h.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,n,s){if(!this.contentVisible)return;const a=this.getObject(t,e);if(!a){ue("Dependent image isn't ready yet");return}const o=a.width,h=a.height,c=[];for(let u=0,p=s.length;u<p;u+=2)c.push({transform:[i,0,0,n,s[u],s[u+1]],x:0,y:0,w:o,h});this.paintInlineImageXObjectGroup(t,a,c)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:n}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,n),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",s.canvas}paintInlineImageXObject(t,e){var c;if(!this.contentVisible)return;const i=e.width,n=e.height,s=this.ctx;this.save(t);const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none"),s.scale(1/i,-1/n);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,n).context;iw(p,e),o=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(o,ga(s));s.imageSmoothingEnabled=sw(Ei(s),e.interpolate),(c=this.dependencyTracker)==null||c.resetBBox(t).recordBBox(t,s,0,i,-n,0).recordDependencies(t,gr.imageXObject).recordOperation(t),z0(s,h.img,0,0,h.paintWidth,h.paintHeight,0,-n,i,n),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){var a,o,h;if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const c=e.width,u=e.height,g=this.cachedCanvases.getCanvas("inlineImage",c,u).context;iw(g,e),s=this.applyTransferMapsToCanvas(g)}(a=this.dependencyTracker)==null||a.resetBBox(t);for(const c of i)n.save(),n.transform(...c.transform),n.scale(1,-1),z0(n,s,c.x,c.y,c.w,c.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(t,n,0,1,-1,0),n.restore();(h=this.dependencyTracker)==null||h.recordOperation(t),this.compose()}paintSolidColorImageMask(t){var e;this.contentVisible&&((e=this.dependencyTracker)==null||e.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,gr.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){var e;(e=this.dependencyTracker)==null||e.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){var a,o;const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const s=this.ctx;this.pendingClip?(n||(this.pendingClip===rw?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):(o=this.dependencyTracker)==null||o.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ei(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:s}=this.ctx.getTransform();let a,o;if(i===0&&n===0){const h=Math.abs(e),c=Math.abs(s);if(h===c)if(t===0)a=o=1/h;else{const u=h*t;a=o=u<1?1/u:1}else if(t===0)a=1/h,o=1/c;else{const u=h*t,p=c*t;a=u<1?1/u:1,o=p<1?1/p:1}}else{const h=Math.abs(e*s-i*n),c=Math.hypot(e,i),u=Math.hypot(n,s);if(t===0)a=u/h,o=c/h;else{const p=t*h;a=u>p?u/p:1,o=c>p?c/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:n}}=this,[s,a]=this.getScaleForStroking();if(s===a){i.lineWidth=(n||1)*s,i.stroke(t);return}const o=i.getLineDash();e&&i.save(),i.scale(s,a),g5.a=1/s,g5.d=1/a;const h=new Path2D;if(h.addPath(t,g5),o.length>0){const c=Math.max(s,a);i.setLineDash(o.map(u=>u/c)),i.lineDashOffset/=c}i.lineWidth=n||1,i.stroke(h),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};na=new WeakSet,wb=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ab=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},_b=function(t,e,i){const n=new Path2D;return n.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),n};let nd=Yv;for(const r in If)nd.prototype[r]!==void 0&&(nd.prototype[If[r]]=nd.prototype[r]);var Gg,Vg;class qa{static get workerPort(){return l(this,Gg)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");_(this,Gg,t)}static get workerSrc(){return l(this,Vg)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");_(this,Vg,t)}}Gg=new WeakMap,Vg=new WeakMap,C(qa,Gg,null),C(qa,Vg,"");var Hd,$g;class R4{constructor({parsedData:t,rawData:e}){C(this,Hd);C(this,$g);_(this,Hd,t),_(this,$g,e)}getRaw(){return l(this,$g)}get(t){return l(this,Hd).get(t)??null}[Symbol.iterator](){return l(this,Hd).entries()}}Hd=new WeakMap,$g=new WeakMap;const Vu=Symbol("INTERNAL");var Xg,Yg,Kg,qd;class D4{constructor(t,{name:e,intent:i,usage:n,rbGroups:s}){C(this,Xg,!1);C(this,Yg,!1);C(this,Kg,!1);C(this,qd,!0);_(this,Xg,!!(t&Qs.DISPLAY)),_(this,Yg,!!(t&Qs.PRINT)),this.name=e,this.intent=i,this.usage=n,this.rbGroups=s}get visible(){if(l(this,Kg))return l(this,qd);if(!l(this,qd))return!1;const{print:t,view:e}=this.usage;return l(this,Xg)?(e==null?void 0:e.viewState)!=="OFF":l(this,Yg)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==Vu&&hi("Internal method `_setVisible` called."),_(this,Kg,i),_(this,qd,e)}}Xg=new WeakMap,Yg=new WeakMap,Kg=new WeakMap,qd=new WeakMap;var Kl,ei,zd,Wd,Jg,Sb;class O4{constructor(t,e=Qs.DISPLAY){C(this,Jg);C(this,Kl,null);C(this,ei,new Map);C(this,zd,null);C(this,Wd,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,_(this,Wd,t.order);for(const i of t.groups)l(this,ei).set(i.id,new D4(e,i));if(t.baseState==="OFF")for(const i of l(this,ei).values())i._setVisible(Vu,!1);for(const i of t.on)l(this,ei).get(i)._setVisible(Vu,!0);for(const i of t.off)l(this,ei).get(i)._setVisible(Vu,!1);_(this,zd,this.getHash())}}isVisible(t){if(l(this,ei).size===0)return!0;if(!t)return _2("Optional content group not defined."),!0;if(t.type==="OCG")return l(this,ei).has(t.id)?l(this,ei).get(t.id).visible:(ue(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return E(this,Jg,Sb).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!l(this,ei).has(e))return ue(`Optional content group not found: ${e}`),!0;if(l(this,ei).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!l(this,ei).has(e))return ue(`Optional content group not found: ${e}`),!0;if(!l(this,ei).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!l(this,ei).has(e))return ue(`Optional content group not found: ${e}`),!0;if(!l(this,ei).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!l(this,ei).has(e))return ue(`Optional content group not found: ${e}`),!0;if(l(this,ei).get(e).visible)return!1}return!0}return ue(`Unknown optional content policy ${t.policy}.`),!0}return ue(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){var s;const n=l(this,ei).get(t);if(!n){ue(`Optional content group not found: ${t}`);return}if(i&&e&&n.rbGroups.length)for(const a of n.rbGroups)for(const o of a)o!==t&&((s=l(this,ei).get(o))==null||s._setVisible(Vu,!1,!0));n._setVisible(Vu,!!e,!0),_(this,Kl,null)}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const s=l(this,ei).get(n);if(s)switch(i){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!s.visible,e);break}}_(this,Kl,null)}get hasInitialVisibility(){return l(this,zd)===null||this.getHash()===l(this,zd)}getOrder(){return l(this,ei).size?l(this,Wd)?l(this,Wd).slice():[...l(this,ei).keys()]:null}getGroup(t){return l(this,ei).get(t)||null}getHash(){if(l(this,Kl)!==null)return l(this,Kl);const t=new A_;for(const[e,i]of l(this,ei))t.update(`${e}:${i.visible}`);return _(this,Kl,t.hexdigest())}[Symbol.iterator](){return l(this,ei).entries()}}Kl=new WeakMap,ei=new WeakMap,zd=new WeakMap,Wd=new WeakMap,Jg=new WeakSet,Sb=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const s=t[n];let a;if(Array.isArray(s))a=E(this,Jg,Sb).call(this,s);else if(l(this,ei).has(s))a=l(this,ei).get(s).visible;else return ue(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class B4{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Me(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:s,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(s==null?void 0:s.length)>0){const h=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,c)=>{this._onReceiveData({begin:h,chunk:c})}),t.addProgressListener((h,c)=>{this._onProgress({loaded:h,total:c})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const n=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(i),!0)});Me(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,n,s;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(s=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||s.call(n,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Me(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new j4(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new U4(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class j4{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=x2(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class U4{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function H4(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let u=o(e);return u=unescape(u),u=h(u),u=c(u),s(u)}if(e=a(r),e){const u=c(e);return s(u)}if(e=i("filename","i").exec(r),e){e=e[1];let u=o(e);return u=c(u),s(u)}function i(u,p){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function n(u,p){if(u){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const g=new TextDecoder(u,{fatal:!0}),f=Y1(p);p=g.decode(f),t=!1}catch{}}return p}function s(u){return t&&/[\x80-\xff]/.test(u)&&(u=n("utf-8",u),t&&(u=n("iso-8859-1",u))),u}function a(u){const p=[];let g;const f=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=f.exec(u))!==null;){let[,v,S,w]=g;if(v=parseInt(v,10),v in p){if(v===0)break;continue}p[v]=[S,w]}const A=[];for(let v=0;v<p.length&&v in p;++v){let[S,w]=p[v];w=o(w),S&&(w=unescape(w),v===0&&(w=h(w))),A.push(w)}return A.join("")}function o(u){if(u.startsWith('"')){const p=u.slice(1).split('\\"');for(let g=0;g<p.length;++g){const f=p[g].indexOf('"');f!==-1&&(p[g]=p[g].slice(0,f),p.length=g+1),p[g]=p[g].replaceAll(/\\(.)/g,"$1")}u=p.join('"')}return u}function h(u){const p=u.indexOf("'");if(p===-1)return u;const g=u.slice(0,p),A=u.slice(p+1).replace(/^[^']*'/,"");return n(g,A)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,g,f,A){if(f==="q"||f==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,S){return String.fromCharCode(parseInt(S,16))}),n(g,A);try{A=atob(A)}catch{}return n(g,A)})}return""}function M_(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const i in t){const n=t[i];n!==void 0&&e.append(i,n)}return e}function C2(r){var t;return((t=URL.parse(r))==null?void 0:t.origin)??null}function R_({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const n={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(r.get("Content-Length"),10);return!Number.isInteger(s)||(n.suggestedLength=s,s<=2*e)||i||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function D_(r){const t=r.get("Content-Disposition");if(t){let e=H4(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(x2(e))return e}return null}function Q1(r,t){return new Yp(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function O_(r){return r===200||r===206}function B_(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function j_(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ue(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class q4{constructor(t){bt(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=M_(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Me(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new z4(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new W4(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class z4{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),n=e.url;fetch(n,B_(i,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=C2(s.url),!O_(s.status))throw Q1(s.status,n);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:h}=R_({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=h||this._contentLength,this._filename=D_(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new rl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:j_(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class W4{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${i-1}`);const a=n.url;fetch(a,B_(s,this._withCredentials,this._abortController)).then(o=>{const h=C2(o.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!O_(o.status))throw Q1(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:j_(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const m5=200,b5=206;function G4(r){const t=r.response;return typeof t!="string"?t:Y1(t).buffer}class V4{constructor({url:t,httpHeaders:e,withCredentials:i}){bt(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=M_(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,a]of this.headers)e.setRequestHeader(s,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=b5):n.expectedStatus=m5,e.responseType="arraybuffer",Me(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var n;const i=this.pendingRequests[t];i&&((n=i.onProgress)==null||n.call(i,e))}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){i.onError(n.status);return}const s=n.status||m5;if(!(s===m5&&i.expectedStatus===b5)&&s!==i.expectedStatus){i.onError(n.status);return}const o=G4(n);if(s===b5){const h=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);c?i.onDone({begin:parseInt(c[1],10),chunk:o}):(ue('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class $4{constructor(t){this._source=t,this._manager=new V4(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Me(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new X4(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new Y4(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class X4{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=C2(e.responseURL);const i=e.getAllResponseHeaders(),n=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[h,...c]=o.split(": ");return[h,c.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=R_({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=D_(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Q1(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Y4{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=C2((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=Q1(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const K4=/^[a-z][a-z0-9\-+.]+:/i;function J4(r){if(K4.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}class Z4{constructor(t){this.source=t,this.url=J4(t.url),Me(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Me(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Q4(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new tC(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Q4{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=Q1(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new rl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class tC{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const pp=Symbol("INITIAL_DATA");var Bs,Zg,xb;class U_{constructor(){C(this,Zg);C(this,Bs,Object.create(null))}get(t,e=null){if(e){const n=E(this,Zg,xb).call(this,t);return n.promise.then(()=>e(n.data)),null}const i=l(this,Bs)[t];if(!i||i.data===pp)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=l(this,Bs)[t];return!!e&&e.data!==pp}delete(t){const e=l(this,Bs)[t];return!e||e.data===pp?!1:(delete l(this,Bs)[t],!0)}resolve(t,e=null){const i=E(this,Zg,xb).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in l(this,Bs)){const{data:i}=l(this,Bs)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}_(this,Bs,Object.create(null))}*[Symbol.iterator](){for(const t in l(this,Bs)){const{data:e}=l(this,Bs)[t];e!==pp&&(yield[t,e])}}}Bs=new WeakMap,Zg=new WeakSet,xb=function(t){var e;return(e=l(this,Bs))[t]||(e[t]={...Promise.withResolvers(),data:pp})};const eC=1e5,aw=30;var TA,Jl,js,Qg,t1,Pc,Oo,e1,i1,Nc,n1,Gd,Zl,Vd,s1,$d,Tc,r1,a1,Xd,Ic,o1,Yd,Kd,hl,H_,q_,Cb,nr,dm,Lb,z_,W_;const Tn=class Tn{constructor({textContentSource:t,container:e,viewport:i}){C(this,hl);C(this,Jl,Promise.withResolvers());C(this,js,null);C(this,Qg,!1);C(this,t1,!!((TA=globalThis.FontInspector)!=null&&TA.enabled));C(this,Pc,null);C(this,Oo,null);C(this,e1,0);C(this,i1,0);C(this,Nc,null);C(this,n1,null);C(this,Gd,0);C(this,Zl,0);C(this,Vd,Object.create(null));C(this,s1,[]);C(this,$d,null);C(this,Tc,[]);C(this,r1,new WeakMap);C(this,a1,null);var h;if(t instanceof ReadableStream)_(this,$d,t);else if(typeof t=="object")_(this,$d,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');_(this,js,_(this,n1,e)),_(this,Zl,i.scale*ea.pixelRatio),_(this,Gd,i.rotation),_(this,Oo,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:s,pageX:a,pageY:o}=i.rawDims;_(this,a1,[1,0,0,-1,-a,o+s]),_(this,i1,n),_(this,e1,s),E(h=Tn,nr,z_).call(h),e.style.setProperty("--min-font-size",l(Tn,Yd)),_h(e,i),l(this,Jl).promise.finally(()=>{l(Tn,Kd).delete(this),_(this,Oo,null),_(this,Vd,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=en.platform;return le(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{l(this,Nc).read().then(({value:e,done:i})=>{if(i){l(this,Jl).resolve();return}l(this,Pc)??_(this,Pc,e.lang),Object.assign(l(this,Vd),e.styles),E(this,hl,H_).call(this,e.items),t()},l(this,Jl).reject)};return _(this,Nc,l(this,$d).getReader()),l(Tn,Kd).add(this),t(),l(this,Jl).promise}update({viewport:t,onBefore:e=null}){var s;const i=t.scale*ea.pixelRatio,n=t.rotation;if(n!==l(this,Gd)&&(e==null||e(),_(this,Gd,n),_h(l(this,n1),{rotation:n})),i!==l(this,Zl)){e==null||e(),_(this,Zl,i);const a={div:null,properties:null,ctx:E(s=Tn,nr,dm).call(s,l(this,Pc))};for(const o of l(this,Tc))a.properties=l(this,r1).get(o),a.div=o,E(this,hl,Cb).call(this,a)}}cancel(){var e;const t=new rl("TextLayer task cancelled.");(e=l(this,Nc))==null||e.cancel(t).catch(()=>{}),_(this,Nc,null),l(this,Jl).reject(t)}get textDivs(){return l(this,Tc)}get textContentItemsStr(){return l(this,s1)}static cleanup(){if(!(l(this,Kd).size>0)){l(this,Xd).clear();for(const{canvas:t}of l(this,Ic).values())t.remove();l(this,Ic).clear()}}};Jl=new WeakMap,js=new WeakMap,Qg=new WeakMap,t1=new WeakMap,Pc=new WeakMap,Oo=new WeakMap,e1=new WeakMap,i1=new WeakMap,Nc=new WeakMap,n1=new WeakMap,Gd=new WeakMap,Zl=new WeakMap,Vd=new WeakMap,s1=new WeakMap,$d=new WeakMap,Tc=new WeakMap,r1=new WeakMap,a1=new WeakMap,Xd=new WeakMap,Ic=new WeakMap,o1=new WeakMap,Yd=new WeakMap,Kd=new WeakMap,hl=new WeakSet,H_=function(t){var n,s;if(l(this,Qg))return;(s=l(this,Oo)).ctx??(s.ctx=E(n=Tn,nr,dm).call(n,l(this,Pc)));const e=l(this,Tc),i=l(this,s1);for(const a of t){if(e.length>eC){ue("Ignoring additional textDivs for performance reasons."),_(this,Qg,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,js);_(this,js,document.createElement("span")),l(this,js).classList.add("markedContent"),a.id&&l(this,js).setAttribute("id",`${a.id}`),o.append(l(this,js))}else a.type==="endMarkedContent"&&_(this,js,l(this,js).parentNode);continue}i.push(a.str),E(this,hl,q_).call(this,a)}},q_=function(t){var A;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};l(this,Tc).push(e);const n=Mt.transform(l(this,a1),t.transform);let s=Math.atan2(n[1],n[0]);const a=l(this,Vd)[t.fontName];a.vertical&&(s+=Math.PI/2);let o=l(this,t1)&&a.fontSubstitution||a.fontFamily;o=Tn.fontFamilyMap.get(o)||o;const h=Math.hypot(n[2],n[3]),c=h*E(A=Tn,nr,W_).call(A,o,a,l(this,Pc));let u,p;s===0?(u=n[4],p=n[5]-c):(u=n[4]+c*Math.sin(s),p=n[5]-c*Math.cos(s));const g=e.style;g.left=`${(100*u/l(this,i1)).toFixed(2)}%`,g.top=`${(100*p/l(this,e1)).toFixed(2)}%`,g.setProperty("--font-height",`${h.toFixed(2)}px`),g.fontFamily=o,i.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,l(this,t1)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),s!==0&&(i.angle=s*(180/Math.PI));let f=!1;if(t.str.length>1)f=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const v=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);v!==S&&Math.max(v,S)/Math.min(v,S)>1.5&&(f=!0)}if(f&&(i.canvasWidth=a.vertical?t.height:t.width),l(this,r1).set(e,i),l(this,Oo).div=e,l(this,Oo).properties=i,E(this,hl,Cb).call(this,l(this,Oo)),i.hasText&&l(this,js).append(e),i.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),l(this,js).append(v)}},Cb=function(t){var a;const{div:e,properties:i,ctx:n}=t,{style:s}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=s,{canvasWidth:h,fontSize:c}=i;E(a=Tn,nr,Lb).call(a,n,c*l(this,Zl),o);const{width:u}=n.measureText(e.textContent);u>0&&s.setProperty("--scale-x",h*l(this,Zl)/u)}i.angle!==0&&s.setProperty("--rotate",`${i.angle}deg`)},nr=new WeakSet,dm=function(t=null){let e=l(this,Ic).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Ic).set(t,e),l(this,o1).set(e,{size:0,family:""})}return e},Lb=function(t,e,i){const n=l(this,o1).get(t);e===n.size&&i===n.family||(t.font=`${e}px ${i}`,n.size=e,n.family=i)},z_=function(){if(l(this,Yd)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),_(this,Yd,t.getBoundingClientRect().height),t.remove()},W_=function(t,e,i){const n=l(this,Xd).get(t);if(n)return n;const s=E(this,nr,dm).call(this,i);s.canvas.width=s.canvas.height=aw,E(this,nr,Lb).call(this,s,aw,t);const a=s.measureText(""),o=a.fontBoundingBoxAscent,h=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let c=.8;return o?c=o/(o+h):(en.platform.isFirefox&&ue("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?c=e.ascent:e.descent&&(c=1+e.descent)),l(this,Xd).set(t,c),c},C(Tn,nr),C(Tn,Xd,new Map),C(Tn,Ic,new Map),C(Tn,o1,new WeakMap),C(Tn,Yd,null),C(Tn,Kd,new Set);let Ff=Tn;const iC=100;function G_(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new Eb,{docId:e}=t,i=r.url?c4(r.url):null,n=r.data?u4(r.data):null,s=r.httpHeaders||null,a=r.withCredentials===!0,o=r.password??null,h=r.range instanceof Mv?r.range:null,c=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let u=r.worker instanceof Mf?r.worker:null;const p=r.verbosity,g=typeof r.docBaseUrl=="string"&&!J1(r.docBaseUrl)?r.docBaseUrl:null,f=j0(r.cMapUrl),A=r.cMapPacked!==!1,v=r.CMapReaderFactory||(hs?v4:Vy),S=j0(r.iccUrl),w=j0(r.standardFontDataUrl),k=r.StandardFontDataFactory||(hs?y4:$y),L=j0(r.wasmUrl),P=r.WasmFactory||(hs?w4:Xy),D=r.stopAtErrors!==!0,H=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,X=r.isEvalSupported!==!1,$=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!hs,B=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!hs&&(en.platform.isFirefox||!globalThis.chrome),Z=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,I=typeof r.disableFontFace=="boolean"?r.disableFontFace:hs,j=r.fontExtraProperties===!0,K=r.enableXfa===!0,Y=r.ownerDocument||globalThis.document,ot=r.disableRange===!0,rt=r.disableStream===!0,lt=r.disableAutoFetch===!0,st=r.pdfBug===!0,ft=r.CanvasFactory||(hs?b4:p4),Ct=r.FilterFactory||(hs?m4:g4),At=r.enableHWA===!0,F=r.useWasm!==!1,z=h?h.length:r.length??NaN,J=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!hs&&!I,Q=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(v===Vy&&k===$y&&P===Xy&&f&&w&&L&&yp(f,document.baseURI)&&yp(w,document.baseURI)&&yp(L,document.baseURI)),it=null;Wx(p);const at={canvasFactory:new ft({ownerDocument:Y,enableHWA:At}),filterFactory:new Ct({docId:e,ownerDocument:Y}),cMapReaderFactory:Q?null:new v({baseUrl:f,isCompressed:A}),standardFontDataFactory:Q?null:new k({baseUrl:w}),wasmFactory:Q?null:new P({baseUrl:L})};u||(u=Mf.create({verbosity:p,port:qa.workerPort}),t._worker=u);const pt={docId:e,apiVersion:"5.4.530",data:n,password:o,disableAutoFetch:lt,rangeChunkSize:c,length:z,docBaseUrl:g,enableXfa:K,evaluatorOptions:{maxImageSize:H,disableFontFace:I,ignoreErrors:D,isEvalSupported:X,isOffscreenCanvasSupported:$,isImageDecoderSupported:B,canvasMaxAreaInBytes:Z,fontExtraProperties:j,useSystemFonts:J,useWasm:F,useWorkerFetch:Q,cMapUrl:f,iccUrl:S,standardFontDataUrl:w,wasmUrl:L}},gt={ownerDocument:Y,pdfBug:st,styleElement:it,loadingParams:{disableAutoFetch:lt,enableXfa:K}};return u.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const yt=u.messageHandler.sendWithPromise("GetDocRequest",pt,n?[n.buffer]:null);let Lt;if(h)Lt=new B4(h,{disableRange:ot,disableStream:rt});else if(!n){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Tt=yp(i)?q4:hs?Z4:$4;Lt=new Tt({url:i,length:z,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:ot,disableStream:rt})}return yt.then(Tt=>{if(t.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const It=new Ep(e,Tt,u.port),Xt=new rC(It,t,Lt,gt,at,At);t._transport=Xt,It.send("Ready",null)})}).catch(t._capability.reject),t}var u2;const d2=class d2{constructor(){bt(this,"_capability",Promise.withResolvers());bt(this,"_transport",null);bt(this,"_worker",null);bt(this,"docId",`d${cn(d2,u2)._++}`);bt(this,"destroyed",!1);bt(this,"onPassword",null);bt(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,i,n;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,(n=this._worker)==null||n.destroy(),this._worker=null}async getData(){return this._transport.getData()}};u2=new WeakMap,C(d2,u2,0);let Eb=d2;var Fc,l1,h1,c1,u1;class Mv{constructor(t,e,i=!1,n=null){C(this,Fc,Promise.withResolvers());C(this,l1,[]);C(this,h1,[]);C(this,c1,[]);C(this,u1,[]);this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n}addRangeListener(t){l(this,u1).push(t)}addProgressListener(t){l(this,c1).push(t)}addProgressiveReadListener(t){l(this,h1).push(t)}addProgressiveDoneListener(t){l(this,l1).push(t)}onDataRange(t,e){for(const i of l(this,u1))i(t,e)}onDataProgress(t,e){l(this,Fc).promise.then(()=>{for(const i of l(this,c1))i(t,e)})}onDataProgressiveRead(t){l(this,Fc).promise.then(()=>{for(const e of l(this,h1))e(t)})}onDataProgressiveDone(){l(this,Fc).promise.then(()=>{for(const t of l(this,l1))t()})}transportReady(){l(this,Fc).resolve()}requestDataRange(t,e){hi("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Fc=new WeakMap,l1=new WeakMap,h1=new WeakMap,c1=new WeakMap,u1=new WeakMap;class nC{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Bo,Mc,Ip;class sC{constructor(t,e,i,n=!1){C(this,Mc);C(this,Bo,!1);this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new jy:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new U_,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:s=!1}={}){return new K1({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:n="display",annotationMode:s=tl.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:h=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:p=null,isEditing:g=!1,recordOperations:f=!1,operationsFilter:A=null}){var B,Z,I;(B=this._stats)==null||B.time("Overall");const v=this._transport.getRenderingIntent(n,s,p,g),{renderingIntent:S,cacheKey:w}=v;_(this,Bo,!1),h||(h=this._transport.getOptionalContentConfig(S));let k=this._intentStates.get(w);k||(k=Object.create(null),this._intentStates.set(w,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const L=!!(S&Qs.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Z=this._stats)==null||Z.time("Page Request"),this._pumpOperatorList(v));const P=!!(this._pdfBug&&((I=globalThis.StepperManager)!=null&&I.enabled)),D=!this.recordedBBoxes&&(f||P),H=j=>{var K,Y;if(k.renderTasks.delete(X),D){const ot=(K=X.gfx)==null?void 0:K.dependencyTracker.take();ot&&(X.stepper&&X.stepper.setOperatorBBoxes(ot,X.gfx.dependencyTracker.takeDebugMetadata()),f&&(this.recordedBBoxes=ot))}L&&_(this,Bo,!0),E(this,Mc,Ip).call(this),j?(X.capability.reject(j),this._abortOperatorList({intentState:k,reason:j instanceof Error?j:new Error(j)})):X.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(Y=globalThis.Stats)!=null&&Y.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},X=new kb({callback:H,params:{canvas:e,canvasContext:t,dependencyTracker:D?new _4(e,k.operatorList.length,P):null,viewport:i,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!L,pdfBug:this._pdfBug,pageColors:u,enableHWA:this._transport.enableHWA,operationsFilter:A});(k.renderTasks||(k.renderTasks=new Set)).add(X);const $=X.task;return Promise.all([k.displayReadyCapability.promise,h]).then(([j,K])=>{var Y;if(this.destroyed){H();return}if((Y=this._stats)==null||Y.time("Rendering"),!(K.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");X.initializeGraphics({transparency:j,optionalContentConfig:K}),X.operatorListChanged()}).catch(H),$}getOperatorList({intent:t="display",annotationMode:e=tl.ENABLE,printAnnotationStorage:i=null,isEditing:n=!1}={}){var c;function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(h))}const a=this._transport.getRenderingIntent(t,e,i,n,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let h;return o.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(h),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Kp.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,n){function s(){a.read().then(function({value:h,done:c}){if(c){i(o);return}o.lang??(o.lang=h.lang),Object.assign(o.styles,h.styles),o.items.push(...h.items),s()},n)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),_(this,Bo,!1),Promise.all(t)}cleanup(t=!1){_(this,Bo,!0);const e=E(this,Mc,Ip).call(this);return t&&e&&this._stats&&(this._stats=new jy),e}_startRenderPage(t,e){var n,s;const i=this._intentStates.get(e);i&&((n=this._stats)==null||n.timeEnd("Page Request"),(s=i.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&E(this,Mc,Ip).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:n}){const{map:s,transfer:a}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:n},a).getReader(),c=this._intentStates.get(e);c.streamReader=h;const u=()=>{h.read().then(({value:p,done:g})=>{if(g){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,c),u())},p=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const g of c.renderTasks)g.operatorListChanged();E(this,Mc,Ip).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(p);else if(c.opListReadCapability)c.opListReadCapability.reject(p);else throw p}})};u()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof S2){let n=iC;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new rl(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,s]of this._intentStates)if(s===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}Bo=new WeakMap,Mc=new WeakSet,Ip=function(){if(!l(this,Bo)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,Bo,!1),!0};var Ql,$r,jo,Rc,f2,Dc,Oc,cs,fm,V_,$_,Fp,Jd,pm;const _i=class _i{constructor({name:t=null,port:e=null,verbosity:i=Gx()}={}){C(this,cs);C(this,Ql,Promise.withResolvers());C(this,$r,null);C(this,jo,null);C(this,Rc,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(l(_i,Oc).has(e))throw new Error("Cannot use more than one PDFWorker per port.");l(_i,Oc).set(e,this),E(this,cs,V_).call(this,e)}else E(this,cs,$_).call(this)}get promise(){return l(this,Ql).promise}get port(){return l(this,jo)}get messageHandler(){return l(this,$r)}destroy(){var t,e;this.destroyed=!0,(t=l(this,Rc))==null||t.terminate(),_(this,Rc,null),l(_i,Oc).delete(l(this,jo)),_(this,jo,null),(e=l(this,$r))==null||e.destroy(),_(this,$r,null)}static create(t){const e=l(this,Oc).get(t==null?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new _i(t)}static get workerSrc(){if(qa.workerSrc)return qa.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return le(this,"_setupFakeWorkerGlobal",(async()=>l(this,Jd,pm)?l(this,Jd,pm):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ql=new WeakMap,$r=new WeakMap,jo=new WeakMap,Rc=new WeakMap,f2=new WeakMap,Dc=new WeakMap,Oc=new WeakMap,cs=new WeakSet,fm=function(){l(this,Ql).resolve(),l(this,$r).send("configure",{verbosity:this.verbosity})},V_=function(t){_(this,jo,t),_(this,$r,new Ep("main","worker",t)),l(this,$r).on("ready",()=>{}),E(this,cs,fm).call(this)},$_=function(){if(l(_i,Dc)||l(_i,Jd,pm)){E(this,cs,Fp).call(this);return}let{workerSrc:t}=_i;try{_i._isSameOrigin(window.location,t)||(t=_i._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Ep("main","worker",e),n=()=>{s.abort(),i.destroy(),e.terminate(),this.destroyed?l(this,Ql).reject(new Error("Worker was destroyed")):E(this,cs,Fp).call(this)},s=new AbortController;e.addEventListener("error",()=>{l(this,Rc)||n()},{signal:s.signal}),i.on("test",o=>{if(s.abort(),this.destroyed||!o){n();return}_(this,$r,i),_(this,jo,e),_(this,Rc,e),E(this,cs,fm).call(this)}),i.on("ready",o=>{if(s.abort(),this.destroyed){n();return}try{a()}catch{E(this,cs,Fp).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{_2("The worker has been disabled.")}E(this,cs,Fp).call(this)},Fp=function(){l(_i,Dc)||(ue("Setting up fake worker."),_(_i,Dc,!0)),_i._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){l(this,Ql).reject(new Error("Worker was destroyed"));return}const e=new f4;_(this,jo,e);const i=`fake${cn(_i,f2)._++}`,n=new Ep(i+"_worker",i,e);t.setup(n,e),_(this,$r,new Ep(i,i+"_worker",e)),E(this,cs,fm).call(this)}).catch(t=>{l(this,Ql).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Jd=new WeakSet,pm=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},C(_i,Jd),C(_i,f2,0),C(_i,Dc,!1),C(_i,Oc,new WeakMap),hs&&(_(_i,Dc,!0),qa.workerSrc||(qa.workerSrc="./pdf.worker.mjs")),_i._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const n=new URL(e,i);return i.origin===n.origin},_i._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},_i.fromPort=t=>{if(t4("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return _i.create(t)};let Mf=_i;var Uo,Ia,Zd,Qd,Ho,Bc,Mp;class rC{constructor(t,e,i,n,s,a){C(this,Bc);C(this,Uo,new Map);C(this,Ia,new Map);C(this,Zd,new Map);C(this,Qd,new Map);C(this,Ho,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new U_,this.fontLoader=new o4({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return le(this,"annotationStorage",new Tv)}getRenderingIntent(t,e=tl.ENABLE,i=null,n=!1,s=!1){let a=Qs.DISPLAY,o=cb;switch(t){case"any":a=Qs.ANY;break;case"display":break;case"print":a=Qs.PRINT;break;default:ue(`getRenderingIntent - invalid intent: ${t}`)}const h=a&Qs.PRINT&&i instanceof S_?i:this.annotationStorage;switch(e){case tl.DISABLE:a+=Qs.ANNOTATIONS_DISABLE;break;case tl.ENABLE:break;case tl.ENABLE_FORMS:a+=Qs.ANNOTATIONS_FORMS;break;case tl.ENABLE_STORAGE:a+=Qs.ANNOTATIONS_STORAGE,o=h.serializable;break;default:ue(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(a+=Qs.IS_EDITING),s&&(a+=Qs.OPLIST);const{ids:c,hash:u}=h.modifiedIds,p=[a,o.hash,u];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=l(this,Ho))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of l(this,Ia).values())t.push(n._destroy());l(this,Ia).clear(),l(this,Zd).clear(),l(this,Qd).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var n,s;this.commonObjs.clear(),this.fontLoader.clear(),l(this,Uo).clear(),this.filterFactory.destroy(),Ff.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new rl("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,n)=>{Me(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},n.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){n.close();return}Me(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{n.error(s)})},n.onCancel=s=>{this._fullReader.cancel(s),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:s,contentLength:a}=this._fullReader;return(!n||!s)&&(this._lastProgress&&((o=e.onProgress)==null||o.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var c;(c=e.onProgress)==null||c.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:n,isRangeSupported:s,contentLength:a}}),t.on("GetRangeReader",(i,n)=>{Me(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){n.close();return}n.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){n.close();return}Me(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{s.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new nC(i,this))}),t.on("DocException",i=>{e._capability.reject(ps(i))}),t.on("PasswordRequest",i=>{_(this,Ho,Promise.withResolvers());try{if(!e.onPassword)throw ps(i);const n=s=>{s instanceof Error?l(this,Ho).reject(s):l(this,Ho).resolve({password:s})};e.onPassword(n,i.code)}catch(n){l(this,Ho).reject(n)}return l(this,Ho).promise}),t.on("DataLoaded",i=>{var n;(n=e.onProgress)==null||n.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;l(this,Ia).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,n,s])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(n){case"Font":if("error"in s){const g=s.error;ue(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const o=new ub(s),h=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(g,f)=>globalThis.FontInspector.fontAdded(g,f):null,c=new l4(o,h,s.extra,s.charProcOperatorList);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!c.fontExtraProperties&&c.data&&c.clearData(),this.commonObjs.resolve(i,c)});break;case"CopyLocalImage":const{imageRef:u}=s;Me(u,"The imageRef must be defined.");for(const g of l(this,Ia).values())for(const[,f]of g.objs)if((f==null?void 0:f.ref)===u)return f.dataLen?(this.commonObjs.resolve(i,structuredClone(f)),f.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new h4(s));break;case"Image":this.commonObjs.resolve(i,s);break;case"Pattern":const p=new db(s);this.commonObjs.resolve(i,p.getIR());break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([i,n,s,a])=>{var h;if(this.destroyed)return;const o=l(this,Ia).get(n);if(!o.objs.has(i)){if(o._intentStates.size===0){(h=a==null?void 0:a.bitmap)==null||h.close();return}switch(s){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",i=>{var n;this.destroyed||(n=e.onProgress)==null||n.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[i.type];if(!n)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((i=this._fullReader)==null?void 0:i.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=l(this,Zd).get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&l(this,Qd).set(s.refStr,t);const a=new sC(e,s,this,this._params.pdfBug);return l(this,Ia).set(e,a),a});return l(this,Zd).set(e,n),n}getPageIndex(t){return fb(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return E(this,Bc,Mp).call(this,"GetFieldObjects")}hasJSActions(){return E(this,Bc,Mp).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return E(this,Bc,Mp).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return E(this,Bc,Mp).call(this,"GetOptionalContentConfig").then(e=>new O4(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=l(this,Uo).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(n=>{var s,a;return{info:n[0],metadata:n[1]?new R4(n[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null,hasStructTree:n[2]}});return l(this,Uo).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of l(this,Ia).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),l(this,Uo).clear(),this.filterFactory.destroy(!0),Ff.cleanup()}}cachedPageNumber(t){if(!fb(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return l(this,Qd).get(e)??null}}Uo=new WeakMap,Ia=new WeakMap,Zd=new WeakMap,Qd=new WeakMap,Ho=new WeakMap,Bc=new WeakSet,Mp=function(t,e=null){const i=l(this,Uo).get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return l(this,Uo).set(t,n),n};var th;class aC{constructor(t){C(this,th,null);bt(this,"onContinue",null);bt(this,"onError",null);_(this,th,t)}get promise(){return l(this,th).capability.promise}cancel(t=0){l(this,th).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=l(this,th).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=l(this,th);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}th=new WeakMap;var eh,jc;const Yh=class Yh{constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:h,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:p=!1,pageColors:g=null,enableHWA:f=!1,operationsFilter:A=null}){C(this,eh,null);this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=h,this.filterFactory=c,this._pdfBug=p,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new aC(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=f,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var h,c;if(this.cancelled)return;if(this._canvas){if(l(Yh,jc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(Yh,jc).add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:n,background:s,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new nd(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:n,viewport:i,transparency:t,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(t=null,e=0){var i,n,s;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),l(this,eh)&&(window.cancelAnimationFrame(l(this,eh)),_(this,eh,null)),l(Yh,jc).delete(this._canvas),t||(t=new S2(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(s=(n=this.task).onError)==null||s.call(n,t)}operatorListChanged(){var t,e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.gfx.dependencyTracker)==null||t.growOperationsCount(this.operatorList.fnArray.length),(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?_(this,eh,window.requestAnimationFrame(()=>{_(this,eh,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(Yh,jc).delete(this._canvas),this.callback())))}};eh=new WeakMap,jc=new WeakMap,C(Yh,jc,new WeakSet);let kb=Yh;const X_="5.4.530",Y_="50cc4adac";var Us,Uc,tf,pn,d1,ef,qo,f1,ih,Xr,p1,ii,Pb,Nb,Tb,Wh,K_,kl;const gs=class gs{constructor({editor:t=null,uiManager:e=null}){C(this,ii);C(this,Us,null);C(this,Uc,null);C(this,tf);C(this,pn,null);C(this,d1,!1);C(this,ef,!1);C(this,qo,null);C(this,f1);C(this,ih,null);C(this,Xr,null);var i,n;t?(_(this,ef,!1),_(this,qo,t)):_(this,ef,!0),_(this,Xr,(t==null?void 0:t._uiManager)||e),_(this,f1,l(this,Xr)._eventBus),_(this,tf,((i=t==null?void 0:t.color)==null?void 0:i.toUpperCase())||((n=l(this,Xr))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),l(gs,p1)||_(gs,p1,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return le(this,"_keyboardManager",new Z1([[["Escape","mac+Escape"],gs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],gs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],gs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],gs.prototype._moveToPrevious],[["Home","mac+Home"],gs.prototype._moveToBeginning],[["End","mac+End"],gs.prototype._moveToEnd]]))}renderButton(){const t=_(this,Us,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",l(this,qo)&&(t.ariaControls=`${l(this,qo).id}_colorpicker_dropdown`);const e=l(this,Xr)._signal;t.addEventListener("click",E(this,ii,Wh).bind(this),{signal:e}),t.addEventListener("keydown",E(this,ii,Tb).bind(this),{signal:e});const i=_(this,Uc,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=l(this,tf),t.append(i),t}renderMainDropdown(){const t=_(this,pn,E(this,ii,Pb).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===l(this,Us)){E(this,ii,Wh).call(this,t);return}const e=t.target.getAttribute("data-color");e&&E(this,ii,Nb).call(this,e,t)}_moveToNext(t){var e,i;if(!l(this,ii,kl)){E(this,ii,Wh).call(this,t);return}if(t.target===l(this,Us)){(e=l(this,pn).firstElementChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=l(this,pn))==null?void 0:e.firstElementChild)||t.target===l(this,Us)){l(this,ii,kl)&&this._hideDropdownFromKeyboard();return}l(this,ii,kl)||E(this,ii,Wh).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!l(this,ii,kl)){E(this,ii,Wh).call(this,t);return}(e=l(this,pn).firstElementChild)==null||e.focus()}_moveToEnd(t){var e;if(!l(this,ii,kl)){E(this,ii,Wh).call(this,t);return}(e=l(this,pn).lastElementChild)==null||e.focus()}hideDropdown(){var t,e;(t=l(this,pn))==null||t.classList.add("hidden"),l(this,Us).ariaExpanded="false",(e=l(this,ih))==null||e.abort(),_(this,ih,null)}_hideDropdownFromKeyboard(){var t;if(!l(this,ef)){if(!l(this,ii,kl)){(t=l(this,qo))==null||t.unselect();return}this.hideDropdown(),l(this,Us).focus({preventScroll:!0,focusVisible:l(this,d1)})}}updateColor(t){if(l(this,Uc)&&(l(this,Uc).style.backgroundColor=t),!l(this,pn))return;const e=l(this,Xr).highlightColors.values();for(const i of l(this,pn).children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){var t,e;(t=l(this,Us))==null||t.remove(),_(this,Us,null),_(this,Uc,null),(e=l(this,pn))==null||e.remove(),_(this,pn,null)}};Us=new WeakMap,Uc=new WeakMap,tf=new WeakMap,pn=new WeakMap,d1=new WeakMap,ef=new WeakMap,qo=new WeakMap,f1=new WeakMap,ih=new WeakMap,Xr=new WeakMap,p1=new WeakMap,ii=new WeakSet,Pb=function(){const t=document.createElement("div"),e=l(this,Xr)._signal;t.addEventListener("contextmenu",sr,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),l(this,qo)&&(t.id=`${l(this,qo).id}_colorpicker_dropdown`);for(const[i,n]of l(this,Xr).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",n),s.title=i,s.setAttribute("data-l10n-id",l(gs,p1)[i]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=n,s.ariaSelected=n===l(this,tf),s.addEventListener("click",E(this,ii,Nb).bind(this,n),{signal:e}),t.append(s)}return t.addEventListener("keydown",E(this,ii,Tb).bind(this),{signal:e}),t},Nb=function(t,e){e.stopPropagation(),l(this,f1).dispatch("switchannotationeditorparams",{source:this,type:Te.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)},Tb=function(t){gs._keyboardManager.exec(this,t)},Wh=function(t){if(l(this,ii,kl)){this.hideDropdown();return}if(_(this,d1,t.detail===0),l(this,ih)||(_(this,ih,new AbortController),window.addEventListener("pointerdown",E(this,ii,K_).bind(this),{signal:l(this,Xr).combinedSignal(l(this,ih))})),l(this,Us).ariaExpanded="true",l(this,pn)){l(this,pn).classList.remove("hidden");return}const e=_(this,pn,E(this,ii,Pb).call(this));l(this,Us).append(e)},K_=function(t){var e;(e=l(this,pn))!=null&&e.contains(t.target)||this.hideDropdown()},kl=function(){return l(this,pn)&&!l(this,pn).classList.contains("hidden")},C(gs,p1,null);let Qp=gs;var Fa,g1,nf,m1;const Kh=class Kh{constructor(t){C(this,Fa,null);C(this,g1,null);C(this,nf,null);_(this,g1,t),_(this,nf,t._uiManager),l(Kh,m1)||_(Kh,m1,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(l(this,Fa))return l(this,Fa);const{editorType:t,colorType:e,color:i}=l(this,g1),n=_(this,Fa,document.createElement("input"));return n.type="color",n.value=i||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",l(Kh,m1)[t]),n.addEventListener("input",()=>{l(this,nf).updateParams(e,n.value)},{signal:l(this,nf)._signal}),n}update(t){l(this,Fa)&&(l(this,Fa).value=t)}destroy(){var t;(t=l(this,Fa))==null||t.remove(),_(this,Fa,null)}hideDropdown(){}};Fa=new WeakMap,g1=new WeakMap,nf=new WeakMap,m1=new WeakMap,C(Kh,m1,null);let zm=Kh;function ow(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function gp(r){return Math.max(0,Math.min(255,255*r))}class lw{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=gp(t),[t,t,t]}static G_HTML([t]){const e=ow(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(gp)}static RGB_HTML(t){return`#${t.map(ow).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[gp(1-Math.min(1,t+n)),gp(1-Math.min(1,i+n)),gp(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,s=1-e,a=1-i,o=Math.min(n,s,a);return["CMYK",n,s,a,o]}}class oC{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){hi("Abstract method `_createSVG` called.")}}class tg extends oC{_createSVG(t){return document.createElementNS(po,t)}}const lC=9,bu=new WeakSet,hC=new Date().getTimezoneOffset()*60*1e3;class v5{static create(t){switch(t.data.annotationType){case Wi.LINK:return new Rv(t);case Wi.TEXT:return new uC(t);case Wi.WIDGET:switch(t.data.fieldType){case"Tx":return new dC(t);case"Btn":return t.data.radioButton?new Q_(t):t.data.checkBox?new pC(t):new gC(t);case"Ch":return new mC(t);case"Sig":return new fC(t)}return new Au(t);case Wi.POPUP:return new Fb(t);case Wi.FREETEXT:return new sS(t);case Wi.LINE:return new vC(t);case Wi.SQUARE:return new yC(t);case Wi.CIRCLE:return new wC(t);case Wi.POLYLINE:return new rS(t);case Wi.CARET:return new _C(t);case Wi.INK:return new Dv(t);case Wi.POLYGON:return new AC(t);case Wi.HIGHLIGHT:return new aS(t);case Wi.UNDERLINE:return new SC(t);case Wi.SQUIGGLY:return new xC(t);case Wi.STRIKEOUT:return new CC(t);case Wi.STAMP:return new oS(t);case Wi.FILEATTACHMENT:return new LC(t);default:return new Pi(t)}}}var Hc,sf,Cr,b1,Ib;const Kv=class Kv{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){C(this,b1);C(this,Hc,null);C(this,sf,!1);C(this,Cr,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t!=null&&t.str||e!=null&&e.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Kv._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var i;const{data:t}=this,e=(i=this.annotationStorage)==null?void 0:i.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const t=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:n}=this.data;let s=-1/0,a=-1/0;if((e==null?void 0:e.length)>=8){for(let h=0;h<e.length;h+=8)e[h+1]>a?(a=e[h+1],s=e[h+2]):e[h+1]===a&&(s=Math.max(s,e[h+2]));return[s,a]}if((i==null?void 0:i.length)>=1){for(const h of i)for(let c=0,u=h.length;c<u;c+=2)h[c+1]>a?(a=h[c+1],s=h[c]):h[c+1]===a&&(s=Math.max(s,h[c]));if(s!==1/0)return[s,a]}return n?[n[2],n[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:s,pageY:a}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-s)/i,t[1]=100*(t[1]-a)/n,t}get commentText(){var e,i,n;const{data:t}=this;return((i=(e=this.annotationStorage.getRawValue(`${Xp}${t.id}`))==null?void 0:e.popup)==null?void 0:i.contents)||((n=t.contentsObj)==null?void 0:n.str)||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Xp}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){var t,e;(e=((t=l(this,Cr))==null?void 0:t.popup)||this.popup)==null||e.remove(),_(this,Cr,this.popup=null)}updateEdited(t){var s;if(!this.container)return;t.rect&&(l(this,Hc)||_(this,Hc,{rect:this.data.rect.slice(0)}));const{rect:e,popup:i}=t;e&&E(this,b1,Ib).call(this,e);let n=((s=l(this,Cr))==null?void 0:s.popup)||this.popup;!n&&(i!=null&&i.text)&&(this._createPopup(i),n=l(this,Cr).popup),n&&(n.updateEdited(t),i!=null&&i.deleted&&(n.remove(),_(this,Cr,null),this.popup=null))}resetEdited(){var t;l(this,Hc)&&(E(this,b1,Ib).call(this,l(this,Hc).rect),(t=l(this,Cr))==null||t.popup.resetEdited(),_(this,Hc,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),!(this instanceof Au)&&!(this instanceof Rv)&&(s.tabIndex=0);const{style:a}=s;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof Fb){const{rotation:v}=e;return!e.hasOwnCanvas&&v!==0&&this.setRotation(v,s),s}const{width:o,height:h}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const v=e.borderStyle.horizontalCornerRadius,S=e.borderStyle.verticalCornerRadius;if(v>0||S>0){const k=`calc(${v}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;a.borderRadius=k}else if(this instanceof Q_){const k=`calc(${o}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;a.borderRadius=k}switch(e.borderStyle.style){case Hu.SOLID:a.borderStyle="solid";break;case Hu.DASHED:a.borderStyle="dashed";break;case Hu.BEVELED:ue("Unimplemented border style: beveled");break;case Hu.INSET:ue("Unimplemented border style: inset");break;case Hu.UNDERLINE:a.borderBottomStyle="solid";break}const w=e.borderColor||null;w?(_(this,sf,!0),a.borderColor=Mt.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):a.borderWidth=0}const c=Mt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:u,pageHeight:p,pageX:g,pageY:f}=n.rawDims;a.left=`${100*(c[0]-g)/u}%`,a.top=`${100*(c[1]-f)/p}%`;const{rotation:A}=e;return e.hasOwnCanvas||A===0?(a.width=`${100*o/u}%`,a.height=`${100*h/p}%`):this.setRotation(A,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims;let{width:s,height:a}=this;t%180!==0&&([s,a]=[a,s]),e.style.width=`${100*s/i}%`,e.style.height=`${100*a/n}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,n)=>{const s=n.detail[e],a=s[0],o=s.slice(1);n.target.style[i]=lw[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:lw[`${a}_rgb`](o)})};return le(this,"_commonActions",{display:e=>{const{display:i}=e.detail,n=i%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail)){const s=t[n]||i[n];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,s]of Object.entries(e)){const a=i[n];if(a){const o={detail:{[n]:s},target:t};a(o),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,s]=this.data.rect.map(v=>Math.fround(v));if(t.length===8){const[v,S,w,k]=t.subarray(2,6);if(n===v&&s===S&&e===w&&i===k)return}const{style:a}=this.container;let o;if(l(this,sf)){const{borderColor:v,borderWidth:S}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const h=n-e,c=s-i,{svgFactory:u}=this,p=u.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const g=u.createElement("defs");p.append(g);const f=u.createElement("clipPath"),A=`clippath_${this.data.id}`;f.setAttribute("id",A),f.setAttribute("clipPathUnits","objectBoundingBox"),g.append(f);for(let v=2,S=t.length;v<S;v+=8){const w=t[v],k=t[v+1],L=t[v+2],P=t[v+3],D=u.createElement("rect"),H=(L-e)/h,X=(s-k)/c,$=(w-L)/h,B=(k-P)/c;D.setAttribute("x",H),D.setAttribute("y",X),D.setAttribute("width",$),D.setAttribute("height",B),f.append(D),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${X}" width="${$}" height="${B}"/>`)}l(this,sf)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(p),this.container.style.clipPath=`url(#${A})`}_createPopup(t=null){const{data:e}=this;let i,n;t?(i={str:t.text},n=t.date):(i=e.contentsObj,n=e.modificationDate),_(this,Cr,new Fb({data:{color:e.color,titleObj:e.titleObj,modificationDate:n,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(l(this,Cr)||this.popup||this.data.popupRef)}get extraPopupElement(){return l(this,Cr)}render(){hi("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:s,id:a,exportValues:o}of n){if(s===-1||a===e)continue;const h=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!bu.has(c)){ue(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:h,domElement:c})}return i}for(const n of document.getElementsByName(t)){const{exportValue:s}=n,a=n.getAttribute("data-element-id");a!==e&&bu.has(n)&&i.push({id:a,exportValue:s,domElement:n})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Hc=new WeakMap,sf=new WeakMap,Cr=new WeakMap,b1=new WeakSet,Ib=function(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:h}}}}=this;i==null||i.splice(0,4,...t),e.left=`${100*(t[0]-o)/s}%`,e.top=`${100*(a-t[3]+h)/a}%`,n===0?(e.width=`${100*(t[2]-t[0])/s}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(n)};let Pi=Kv;class cC extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var er,Gh,J_,Z_;class Rv extends Pi{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});C(this,er);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(i.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(E(this,er,J_).call(this,n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(E(this,er,Z_).call(this,n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=n,this.container.append(n)),this.container}_bindLink(e,i,n=""){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&E(this,er,Gh).call(this),n&&(e.title=n)}_bindNamedAction(e,i,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),n&&(e.title=n),E(this,er,Gh).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(i.actions)){const a=n.get(s);a&&(e[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:s}}),!1})}i.overlaidText&&(e.title=i.overlaidText),e.onclick||(e.onclick=()=>!1),E(this,er,Gh).call(this)}_bindResetFormAction(e,i){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),E(this,er,Gh).call(this),!this._fieldObjects){ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{var p;n==null||n();const{fields:s,refs:a,include:o}=i,h=[];if(s.length!==0||a.length!==0){const g=new Set(a);for(const f of s){const A=this._fieldObjects[f]||[];for(const{id:v}of A)g.add(v)}for(const f of Object.values(this._fieldObjects))for(const A of f)g.has(A.id)===o&&h.push(A)}else for(const g of Object.values(this._fieldObjects))h.push(...g);const c=this.annotationStorage,u=[];for(const g of h){const{id:f}=g;switch(u.push(f),g.type){case"text":{const v=g.defaultValue||"";c.setValue(f,{value:v});break}case"checkbox":case"radiobutton":{const v=g.defaultValue===g.exportValues;c.setValue(f,{value:v});break}case"combobox":case"listbox":{const v=g.defaultValue||"";c.setValue(f,{value:v});break}default:continue}const A=document.querySelector(`[data-element-id="${f}"]`);if(A){if(!bu.has(A)){ue(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;A.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}er=new WeakSet,Gh=function(){this.container.setAttribute("data-internal-link","")},J_=function(e,i,n="",s=null){e.href=this.linkService.getAnchorUrl(""),i.description?e.title=i.description:n&&(e.title=n),e.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(i.content,i.filename,s),!1},E(this,er,Gh).call(this)},Z_=function(e,i,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),n&&(e.title=n),E(this,er,Gh).call(this)};class uC extends Pi{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class Au extends Pi{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return en.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,s){i.includes("mouse")?t.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var o;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}s&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a)}}))})}_setEventListeners(t,e,i,n){var s,a,o;for(const[h,c]of i)(c==="Action"||(s=this.data.actions)!=null&&s[c])&&((c==="Focus"||c==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,c,n),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Mt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||lC,s=t.style;let a;const o=2,h=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),u=Math.round(c/(c5*n))||1,p=c/u;a=Math.min(n,h(p/c5))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(n,h(c/c5))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=Mt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class dC extends Au{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const s=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),s.setValue(a.id,{[n]:i})}render(){var n,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let o=a.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&o.length>h&&(o=o.slice(0,h));let c=a.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),bu.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:p,datetimeType:g,timeStep:f}=this.data,A=!!g&&this.enableScripting;p&&(i.title=p),this._setRequired(i,this.data.required),h&&(i.maxLength=h),i.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(i,"value",S.target.value,"value"),u.formattedValue=null}),i.addEventListener("resetform",S=>{const w=this.data.defaultFieldValue??"";i.value=u.userValue=w,u.formattedValue=null});let v=S=>{const{formattedValue:w}=u;w!=null&&(S.target.value=w),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",w=>{var L;if(u.focused)return;const{target:k}=w;if(A&&(k.type=g,f&&(k.step=f)),u.userValue){const P=u.userValue;if(A)if(g==="time"){const D=new Date(P),H=[D.getHours(),D.getMinutes(),D.getSeconds()];k.value=H.map(X=>X.toString().padStart(2,"0")).join(":")}else k.value=new Date(P-hC).toISOString().split(g==="date"?"T":".",1)[0];else k.value=P}u.lastCommittedValue=k.value,u.commitKey=1,(L=this.data.actions)!=null&&L.Focus||(u.focused=!0)}),i.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const k={value(L){u.userValue=L.detail.value??"",A||t.setValue(e,{value:u.userValue.toString()}),L.target.value=u.userValue},formattedValue(L){const{formattedValue:P}=L.detail;u.formattedValue=P,P!=null&&L.target!==document.activeElement&&(L.target.value=P);const D={formattedValue:P};A&&(D.value=P),t.setValue(e,D)},selRange(L){L.target.setSelectionRange(...L.detail.selRange)},charLimit:L=>{var X;const{charLimit:P}=L.detail,{target:D}=L;if(P===0){D.removeAttribute("maxLength");return}D.setAttribute("maxLength",P);let H=u.userValue;!H||H.length<=P||(H=H.slice(0,P),D.value=u.userValue=H,t.setValue(e,{value:H}),(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:H,willCommit:!0,commitKey:1,selStart:D.selectionStart,selEnd:D.selectionEnd}}))}};this._dispatchEventFromSandbox(k,w)}),i.addEventListener("keydown",w=>{var P;u.commitKey=1;let k=-1;if(w.key==="Escape"?k=0:w.key==="Enter"&&!this.data.multiLine?k=2:w.key==="Tab"&&(u.commitKey=3),k===-1)return;const{value:L}=w.target;u.lastCommittedValue!==L&&(u.lastCommittedValue=L,u.userValue=L,(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:L,willCommit:!0,commitKey:k,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const S=v;v=null,i.addEventListener("blur",w=>{var P,D;if(!u.focused||!w.relatedTarget)return;(P=this.data.actions)!=null&&P.Blur||(u.focused=!1);const{target:k}=w;let{value:L}=k;if(A){if(L&&g==="time"){const H=L.split(":").map(X=>parseInt(X,10));L=new Date(2e3,0,1,H[0],H[1],H[2]||0).valueOf(),k.step=""}else L.includes("T")||(L=`${L}T00:00`),L=new Date(L).valueOf();k.type="text"}u.userValue=L,u.lastCommittedValue!==L&&((D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:L,willCommit:!0,commitKey:u.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}})),S(w)}),(s=this.data.actions)!=null&&s.Keystroke&&i.addEventListener("beforeinput",w=>{var B;u.lastCommittedValue=null;const{data:k,target:L}=w,{value:P,selectionStart:D,selectionEnd:H}=L;let X=D,$=H;switch(w.inputType){case"deleteWordBackward":{const Z=P.substring(0,D).match(/\w*[^\w]*$/);Z&&(X-=Z[0].length);break}case"deleteWordForward":{const Z=P.substring(D).match(/^[^\w]*\w*/);Z&&($+=Z[0].length);break}case"deleteContentBackward":D===H&&(X-=1);break;case"deleteContentForward":D===H&&($+=1);break}w.preventDefault(),(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:P,change:k||"",willCommit:!1,selStart:X,selEnd:$}})}),this._setEventListeners(i,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(v&&i.addEventListener("blur",v),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/h;i.classList.add("comb"),i.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class fC extends Au{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class pC extends Au{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return bu.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:h}=a.target;for(const c of this._getElementsByName(o,i)){const u=h&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=u),t.setValue(c.id,{value:u})}t.setValue(i,{value:h})}),s.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Q_ extends Au{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const s=document.createElement("input");if(bu.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:h}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:h})}),s.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;s.addEventListener("updatefromsandbox",o=>{const h={value:c=>{const u=a===c.detail.value;for(const p of this._getElementsByName(c.target.name)){const g=u&&p.id===i;p.domElement&&(p.domElement.checked=g),t.setValue(p.id,{value:g})}}};this._dispatchEventFromSandbox(h,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class gC extends Rv{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class mC extends Au{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");bu.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",u=>{const p=this.data.defaultFieldValue;for(const g of n.options)g.selected=g.value===p});for(const u of this.data.options){const p=document.createElement("option");p.textContent=u.displayValue,p.value=u.exportValue,i.value.includes(u.exportValue)&&(p.setAttribute("selected",!0),s=!1),n.append(p)}let a=null;if(s){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),n.prepend(u),a=()=>{u.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const o=u=>{const p=u?"value":"textContent",{options:g,multiple:f}=n;return f?Array.prototype.filter.call(g,A=>A.selected).map(A=>A[p]):g.selectedIndex===-1?null:g[g.selectedIndex][p]};let h=o(!1);const c=u=>{const p=u.target.options;return Array.prototype.map.call(p,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",u=>{const p={value(g){a==null||a();const f=g.detail.value,A=new Set(Array.isArray(f)?f:[f]);for(const v of n.options)v.selected=A.has(v.value);t.setValue(e,{value:o(!0)}),h=o(!1)},multipleSelection(g){n.multiple=!0},remove(g){const f=n.options,A=g.detail.remove;f[A].selected=!1,n.remove(A),f.length>0&&Array.prototype.findIndex.call(f,S=>S.selected)===-1&&(f[0].selected=!0),t.setValue(e,{value:o(!0),items:c(g)}),h=o(!1)},clear(g){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),h=o(!1)},insert(g){const{index:f,displayValue:A,exportValue:v}=g.detail.insert,S=n.children[f],w=document.createElement("option");w.textContent=A,w.value=v,S?S.before(w):n.append(w),t.setValue(e,{value:o(!0),items:c(g)}),h=o(!1)},items(g){const{items:f}=g.detail;for(;n.length!==0;)n.remove(0);for(const A of f){const{displayValue:v,exportValue:S}=A,w=document.createElement("option");w.textContent=v,w.value=S,n.append(w)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(g)}),h=o(!1)},indices(g){const f=new Set(g.detail.indices);for(const A of g.target.options)A.selected=f.has(A.index);t.setValue(e,{value:o(!0)}),h=o(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(p,u)}),n.addEventListener("input",u=>{var f;const p=o(!0),g=o(!1);t.setValue(e,{value:p}),u.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:g,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):n.addEventListener("input",function(u){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}var v1,Mb;class Fb extends Pi{constructor(e){const{data:i,elements:n,parent:s}=e,a=!!s._commentManager;super(e,{isRenderable:!a&&Pi._hasPopupData(i)});C(this,v1);if(this.elements=n,a&&Pi._hasPopupData(i)){const o=this.popup=E(this,v1,Mb).call(this);for(const h of n)h.popup=o}else this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const i=this.popup=E(this,v1,Mb).call(this),n=[];for(const s of this.elements)s.popup=i,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${Ju}${s}`).join(",")),this.container}}v1=new WeakSet,Mb=function(){return new bC({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Hs,nh,p2,g2,rf,af,Ri,Ma,sh,qc,of,lf,Ra,qs,zo,Wo,Di,Go,rh,y1,Vo,hf,zc,ah,yn,oh,_e,gm,Rb,Db,Ob,mm,Bb,tS,eS,iS,nS,bm,vm,jb;class bC{constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:s,contentsObj:a,richText:o,parent:h,rect:c,parentRect:u,open:p,commentManager:g=null}){C(this,_e);C(this,Hs,null);C(this,nh,E(this,_e,iS).bind(this));C(this,p2,E(this,_e,jb).bind(this));C(this,g2,E(this,_e,vm).bind(this));C(this,rf,E(this,_e,bm).bind(this));C(this,af,null);C(this,Ri,null);C(this,Ma,null);C(this,sh,null);C(this,qc,null);C(this,of,null);C(this,lf,null);C(this,Ra,!1);C(this,qs,null);C(this,zo,null);C(this,Wo,null);C(this,Di,null);C(this,Go,null);C(this,rh,null);C(this,y1,null);C(this,Vo,null);C(this,hf,null);C(this,zc,null);C(this,ah,!1);C(this,yn,null);C(this,oh,null);_(this,Ri,t),_(this,hf,n),_(this,Ma,a),_(this,Vo,o),_(this,of,h),_(this,af,e),_(this,y1,c),_(this,lf,u),_(this,qc,i),_(this,Hs,g),_(this,yn,i[0]),_(this,sh,Jp.toDateObject(s)),this.trigger=i.flatMap(f=>f.getElementsToTriggerPopup()),g||(E(this,_e,gm).call(this),l(this,Ri).hidden=!0,p&&E(this,_e,bm).call(this))}renderCommentButton(){if(l(this,Di)){l(this,Di).parentNode||l(this,yn).container.after(l(this,Di));return}if(l(this,Go)||E(this,_e,Rb).call(this),!l(this,Go))return;const{signal:t}=_(this,zo,new AbortController),e=l(this,yn).hasOwnCommentButton,i=()=>{l(this,Hs).toggleCommentPopup(this,!0,void 0,!e)},n=()=>{l(this,Hs).toggleCommentPopup(this,!1,!0,!e)},s=()=>{l(this,Hs).toggleCommentPopup(this,!1,!1)};if(e){_(this,Di,l(this,yn).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",l(this,nh),{signal:t}),a.addEventListener("click",i,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",s,{signal:t}),a.classList.add("popupTriggerArea")}else{const a=_(this,Di,document.createElement("button"));a.className="annotationCommentButton";const o=l(this,yn).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),E(this,_e,Ob).call(this),E(this,_e,Db).call(this),a.addEventListener("keydown",l(this,nh),{signal:t}),a.addEventListener("click",i,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",s,{signal:t}),o.after(a)}}get commentButtonColor(){const{color:t,opacity:e}=l(this,yn).commentData;return t?l(this,of)._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{var t;(t=l(this,Di))==null||t.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:n,modificationDate:s}=l(this,yn).commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:n,modificationDate:s}}get elementBeforePopup(){return l(this,Di)}get comment(){return l(this,oh)||_(this,oh,l(this,yn).commentText),l(this,oh)}set comment(t){t!==this.comment&&(l(this,yn).commentText=_(this,oh,t))}focus(){var t;(t=l(this,yn).container)==null||t.focus()}get parentBoundingClientRect(){return l(this,yn).layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){l(this,Di)&&(l(this,Di).classList.toggle("selected",t),l(this,Di).ariaExpanded=e)}setSelectedCommentButton(t){l(this,Di).classList.toggle("selected",t)}get commentPopupPosition(){if(l(this,rh))return l(this,rh);const{x:t,y:e,height:i}=l(this,Di).getBoundingClientRect(),{x:n,y:s,width:a,height:o}=l(this,yn).layer.getBoundingClientRect();return[(t-n)/a,(e+i-s)/o]}set commentPopupPosition(t){_(this,rh,t)}hasDefaultPopupPosition(){return l(this,rh)===null}get commentButtonPosition(){return l(this,Go)}get commentButtonWidth(){return l(this,Di).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=l(this,rh)||this.commentButtonPosition.map(c=>c/100),n=this.parentBoundingClientRect,{x:s,y:a,width:o,height:h}=n;l(this,Hs).showDialog(null,this,s+e*o,a+i*h,{...t,parentDimensions:n})}render(){var i,n;if(l(this,qs))return;const t=_(this,qs,document.createElement("div"));if(t.className="popup",l(this,af)){const s=t.style.outlineColor=Mt.makeHexColor(...l(this,af));t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",(i=l(this,hf))!=null&&i.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=l(this,hf)}if(t.append(e),l(this,sh)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,sh).valueOf()})),s.dateTime=l(this,sh).toISOString(),e.append(s)}Nv({html:l(this,_e,mm)||l(this,Ma).str,dir:(n=l(this,Ma))==null?void 0:n.dir,className:"popupContent"},t),l(this,Ri).append(t)}updateEdited({rect:t,popup:e,deleted:i}){var n;if(l(this,Hs)){i?(this.remove(),_(this,oh,null)):e&&(e.deleted?this.remove():(E(this,_e,Ob).call(this),_(this,oh,e.text))),t&&(_(this,Go,null),E(this,_e,Rb).call(this),E(this,_e,Db).call(this));return}if(i||e!=null&&e.deleted){this.remove();return}E(this,_e,gm).call(this),l(this,zc)||_(this,zc,{contentsObj:l(this,Ma),richText:l(this,Vo)}),t&&_(this,Wo,null),e&&e.text&&(_(this,Vo,E(this,_e,eS).call(this,e.text)),_(this,sh,Jp.toDateObject(e.date)),_(this,Ma,null)),(n=l(this,qs))==null||n.remove(),_(this,qs,null)}resetEdited(){var t;l(this,zc)&&({contentsObj:cn(this,Ma)._,richText:cn(this,Vo)._}=l(this,zc),_(this,zc,null),(t=l(this,qs))==null||t.remove(),_(this,qs,null),_(this,Wo,null))}remove(){var t,e,i;if((t=l(this,zo))==null||t.abort(),_(this,zo,null),(e=l(this,qs))==null||e.remove(),_(this,qs,null),_(this,ah,!1),_(this,Ra,!1),(i=l(this,Di))==null||i.remove(),_(this,Di,null),this.trigger)for(const n of this.trigger)n.classList.remove("popupTriggerArea")}forceHide(){_(this,ah,this.isVisible),l(this,ah)&&(l(this,Ri).hidden=!0)}maybeShow(){l(this,Hs)||(E(this,_e,gm).call(this),l(this,ah)&&(l(this,qs)||E(this,_e,vm).call(this),_(this,ah,!1),l(this,Ri).hidden=!1))}get isVisible(){return l(this,Hs)?!1:l(this,Ri).hidden===!1}}Hs=new WeakMap,nh=new WeakMap,p2=new WeakMap,g2=new WeakMap,rf=new WeakMap,af=new WeakMap,Ri=new WeakMap,Ma=new WeakMap,sh=new WeakMap,qc=new WeakMap,of=new WeakMap,lf=new WeakMap,Ra=new WeakMap,qs=new WeakMap,zo=new WeakMap,Wo=new WeakMap,Di=new WeakMap,Go=new WeakMap,rh=new WeakMap,y1=new WeakMap,Vo=new WeakMap,hf=new WeakMap,zc=new WeakMap,ah=new WeakMap,yn=new WeakMap,oh=new WeakMap,_e=new WeakSet,gm=function(){var e;if(l(this,zo))return;_(this,zo,new AbortController);const{signal:t}=l(this,zo);for(const i of this.trigger)i.addEventListener("click",l(this,rf),{signal:t}),i.addEventListener("pointerenter",l(this,g2),{signal:t}),i.addEventListener("pointerleave",l(this,p2),{signal:t}),i.classList.add("popupTriggerArea");for(const i of l(this,qc))(e=i.container)==null||e.addEventListener("keydown",l(this,nh),{signal:t})},Rb=function(){const t=l(this,qc).find(e=>e.hasCommentButton);t&&_(this,Go,t._normalizePoint(t.commentButtonPosition))},Db=function(){if(l(this,yn).extraPopupElement&&!l(this,yn).editor)return;l(this,Di)||this.renderCommentButton();const[t,e]=l(this,Go),{style:i}=l(this,Di);i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`},Ob=function(){l(this,yn).extraPopupElement||(l(this,Di)||this.renderCommentButton(),l(this,Di).style.backgroundColor=this.commentButtonColor||"")},mm=function(){const t=l(this,Vo),e=l(this,Ma);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&l(this,Vo).html||null},Bb=function(){var t,e,i;return((i=(e=(t=l(this,_e,mm))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.fontSize)||0},tS=function(){var t,e,i;return((i=(e=(t=l(this,_e,mm))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.color)||null},eS=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:l(this,_e,tS),fontSize:l(this,_e,Bb)?`calc(${l(this,_e,Bb)}px * var(--total-scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:n});return i},iS=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&l(this,Ra))&&E(this,_e,bm).call(this)},nS=function(){if(l(this,Wo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:s}}}=l(this,of);let a=!!l(this,lf),o=a?l(this,lf):l(this,y1);for(const A of l(this,qc))if(!o||Mt.intersect(A.data.rect,o)!==null){o=A.data.rect,a=!0;break}const h=Mt.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),u=a?o[2]-o[0]+5:0,p=h[0]+u,g=h[1];_(this,Wo,[100*(p-n)/e,100*(g-s)/i]);const{style:f}=l(this,Ri);f.left=`${l(this,Wo)[0]}%`,f.top=`${l(this,Wo)[1]}%`},bm=function(){if(l(this,Hs)){l(this,Hs).toggleCommentPopup(this,!1);return}_(this,Ra,!l(this,Ra)),l(this,Ra)?(E(this,_e,vm).call(this),l(this,Ri).addEventListener("click",l(this,rf)),l(this,Ri).addEventListener("keydown",l(this,nh))):(E(this,_e,jb).call(this),l(this,Ri).removeEventListener("click",l(this,rf)),l(this,Ri).removeEventListener("keydown",l(this,nh)))},vm=function(){l(this,qs)||this.render(),this.isVisible?l(this,Ra)&&l(this,Ri).classList.add("focused"):(E(this,_e,nS).call(this),l(this,Ri).hidden=!1,l(this,Ri).style.zIndex=parseInt(l(this,Ri).style.zIndex)+1e3)},jb=function(){l(this,Ri).classList.remove("focused"),!(l(this,Ra)||!this.isVisible)&&(l(this,Ri).hidden=!0,l(this,Ri).style.zIndex=parseInt(l(this,Ri).style.zIndex)-1e3)};class sS extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=ce.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var w1;class vC extends Pi{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});C(this,w1,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:i,height:n}=this,s=this.svgFactory.create(i,n,!0),a=_(this,w1,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return l(this,w1)}addHighlightArea(){this.container.classList.add("highlightArea")}}w1=new WeakMap;var A1;class yC extends Pi{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});C(this,A1,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:i,height:n}=this,s=this.svgFactory.create(i,n,!0),a=e.borderStyle.width,o=_(this,A1,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",n-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return l(this,A1)}addHighlightArea(){this.container.classList.add("highlightArea")}}A1=new WeakMap;var _1;class wC extends Pi{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});C(this,_1,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:i,height:n}=this,s=this.svgFactory.create(i,n,!0),a=e.borderStyle.width,o=_(this,_1,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",n/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",n/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return l(this,_1)}addHighlightArea(){this.container.classList.add("highlightArea")}}_1=new WeakMap;var S1;class rS extends Pi{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});C(this,S1,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:i,borderStyle:n,popupRef:s},width:a,height:o}=this;if(!i)return this.container;const h=this.svgFactory.create(a,o,!0);let c=[];for(let p=0,g=i.length;p<g;p+=2){const f=i[p]-e[0],A=e[3]-i[p+1];c.push(`${f},${A}`)}c=c.join(" ");const u=_(this,S1,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",n.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),h.append(u),this.container.append(h),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return l(this,S1)}addHighlightArea(){this.container.classList.add("highlightArea")}}S1=new WeakMap;class AC extends rS{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _C extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var x1,Wc,C1,Ub;class Dv extends Pi{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});C(this,C1);C(this,x1,null);C(this,Wc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ce.HIGHLIGHT:ce.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:i,inkLists:n,borderStyle:s,popupRef:a}}=this,{transform:o,width:h,height:c}=E(this,C1,Ub).call(this,i,e),u=this.svgFactory.create(h,c,!0),p=_(this,x1,this.svgFactory.createElement("svg:g"));u.append(p),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let g=0,f=n.length;g<f;g++){const A=this.svgFactory.createElement(this.svgElementName);l(this,Wc).push(A),A.setAttribute("points",n[g].join(",")),p.append(A)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:i,points:n,rect:s}=e,a=l(this,x1);if(i>=0&&a.setAttribute("stroke-width",i||1),n)for(let o=0,h=l(this,Wc).length;o<h;o++)l(this,Wc)[o].setAttribute("points",n[o].join(","));if(s){const{transform:o,width:h,height:c}=E(this,C1,Ub).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${h} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,Wc)}addHighlightArea(){this.container.classList.add("highlightArea")}}x1=new WeakMap,Wc=new WeakMap,C1=new WeakSet,Ub=function(e,i){switch(e){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class aS extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ce.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class SC extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class xC extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class CC extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class oS extends Pi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ce.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var L1,E1,Hb;class LC extends Pi{constructor(e){var n;super(e,{isRenderable:!0});C(this,E1);C(this,L1,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let n;i.hasAppearance||i.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),n.addEventListener("dblclick",E(this,E1,Hb).bind(this)),_(this,L1,n);const{isMac:s}=en.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&E(this,E1,Hb).call(this)}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return l(this,L1)}addHighlightArea(){this.container.classList.add("highlightArea")}}L1=new WeakMap,E1=new WeakSet,Hb=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Gc,Vc,cf,lh,k1,$c,zs,P1,nl,ym,qb;const Jv=class Jv{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:s,viewport:a,structTreeLayer:o,commentManager:h,linkService:c,annotationStorage:u}){C(this,nl);C(this,Gc,null);C(this,Vc,null);C(this,cf,null);C(this,lh,new Map);C(this,k1,null);C(this,$c,null);C(this,zs,[]);C(this,P1,!1);this.div=t,_(this,Gc,e),_(this,Vc,i),_(this,k1,o||null),_(this,$c,c||null),_(this,cf,u||new Tv),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=h||null}hasEditableAnnotations(){return l(this,lh).size>0}async render(t){var o;const{annotations:e}=t,i=this.div;_h(i,this.viewport);const n=new Map,s=[],a={data:null,layer:i,linkService:l(this,$c),downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new tg,annotationStorage:l(this,cf),enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const h of e){if(h.noHTML)continue;const c=h.annotationType===Wi.POPUP;if(c){const g=n.get(h.id);if(!g)continue;if(!this._commentManager){s.push(h);continue}a.elements=g}else if(h.rect[2]===h.rect[0]||h.rect[3]===h.rect[1])continue;a.data=h;const u=v5.create(a);if(!u.isRenderable)continue;if(!c&&(l(this,zs).push(u),h.popupRef)){const g=n.get(h.popupRef);g?g.push(u):n.set(h.popupRef,[u])}const p=u.render();h.hidden&&(p.style.visibility="hidden"),u._isEditable&&(l(this,lh).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}await E(this,nl,ym).call(this);for(const h of s){const c=a.elements=n.get(h.id);a.data=h;const u=v5.create(a);if(!u.isRenderable)continue;const p=u.render();u.contentElement.id=`${Ju}${h.id}`,h.hidden&&(p.style.visibility="hidden"),c.at(-1).container.after(p)}E(this,nl,qb).call(this)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:l(this,$c),svgFactory:new tg,parent:this};for(const i of t){i.borderStyle||(i.borderStyle=Jv._defaultBorderStyle),e.data=i;const n=v5.create(e);n.isRenderable&&(n.render(),n.contentElement.id=`${Ju}${i.id}`,l(this,zs).push(n))}await E(this,nl,ym).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,_h(e,{rotation:t.rotation}),E(this,nl,qb).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(l(this,lh).values())}getEditableAnnotation(t){return l(this,lh).get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:n}=t,s=new cC({data:{id:i,rect:t.getPDFRect(),rotation:n},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:l(this,$c),annotationStorage:l(this,cf)});return s.render(),s.contentElement.id=`${Ju}${i}`,s.createOrUpdatePopup(),l(this,zs).push(s),s}removeAnnotation(t){var n;const e=l(this,zs).findIndex(s=>s.data.id===t);if(e<0)return;const[i]=l(this,zs).splice(e,1);(n=l(this,Gc))==null||n.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);E(this,nl,ym).call(this)}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return le(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Hu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Gc=new WeakMap,Vc=new WeakMap,cf=new WeakMap,lh=new WeakMap,k1=new WeakMap,$c=new WeakMap,zs=new WeakMap,P1=new WeakMap,nl=new WeakSet,ym=async function(){var i,n,s;if(l(this,zs).length===0)return;this.div.replaceChildren();const t=[];if(!l(this,P1)){_(this,P1,!0);for(const{contentElement:a,data:{id:o}}of l(this,zs)){const h=a.id=`${Ju}${o}`;t.push((i=l(this,k1))==null?void 0:i.getAriaAttributes(h).then(c=>{if(c)for(const[u,p]of c)a.setAttribute(u,p)}))}}l(this,zs).sort(({data:{rect:[a,o,h,c]}},{data:{rect:[u,p,g,f]}})=>{if(a===h&&o===c)return 1;if(u===g&&p===f)return-1;const A=c,v=o,S=(o+c)/2,w=f,k=p,L=(p+f)/2;if(S>=w&&L<=v)return-1;if(L>=A&&S<=k)return 1;const P=(a+h)/2,D=(u+g)/2;return P-D});const e=document.createDocumentFragment();for(const a of l(this,zs))e.append(a.container),this._commentManager?(s=((n=a.extraPopupElement)==null?void 0:n.popup)||a.popup)==null||s.renderCommentButton():a.extraPopupElement&&e.append(a.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),l(this,Gc))for(const a of l(this,zs))l(this,Gc).addPointerInTextLayer(a.contentElement,!1)},qb=function(){var e;if(!l(this,Vc))return;const t=this.div;for(const[i,n]of l(this,Vc)){const s=t.querySelector(`[data-annotation-id="${i}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n);const o=l(this,lh).get(i);o&&(o._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(i,s.id,n),o._hasNoCanvas=!1):o.canvas=n)}l(this,Vc).clear()};let Wm=Jv;const G0=/\r\n?|\n/g;var Ws,N1,Xc,Gs,nn,lS,hS,cS,wm,sl,Am,_m,uS,Wb,dS;const bi=class bi extends gi{constructor(e){super({...e,name:"freeTextEditor"});C(this,nn);C(this,Ws,"");C(this,N1,`${this.id}-editor`);C(this,Xc,null);C(this,Gs);bt(this,"_colorPicker",null);this.color=e.color||bi._defaultColor||gi._defaultLineColor,_(this,Gs,e.fontSize||bi._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const e=bi.prototype,i=a=>a.isEmpty(),n=Sh.TRANSLATE_SMALL,s=Sh.TRANSLATE_BIG;return le(this,"_keyboardManager",new Z1([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}]]))}static initialize(e,i){gi.initialize(e,i);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case Te.FREETEXT_SIZE:bi._defaultFontSize=i;break;case Te.FREETEXT_COLOR:bi._defaultColor=i;break}}updateParams(e,i){switch(e){case Te.FREETEXT_SIZE:E(this,nn,lS).call(this,i);break;case Te.FREETEXT_COLOR:E(this,nn,hS).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Te.FREETEXT_SIZE,bi._defaultFontSize],[Te.FREETEXT_COLOR,bi._defaultColor||gi._defaultLineColor]]}get propertiesToUpdate(){return[[Te.FREETEXT_SIZE,l(this,Gs)],[Te.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new zm(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Te.FREETEXT_COLOR}onUpdatedColor(){var e;this.editorDiv.style.color=this.color,(e=this._colorPicker)==null||e.update(this.color),super.onUpdatedColor()}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-bi._internalPadding*e,-(bi._internalPadding+l(this,Gs))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),_(this,Xc,new AbortController);const e=this._uiManager.combinedSignal(l(this,Xc));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,N1)),this._isDraggable=!0,(e=l(this,Xc))==null||e.abort(),_(this,Xc,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var i;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=l(this,Ws),i=_(this,Ws,E(this,nn,cS).call(this).trimEnd());if(e===i)return;const n=s=>{if(_(this,Ws,s),!s){this.remove();return}E(this,nn,_m).call(this),this._uiManager.rebuild(this),E(this,nn,wm).call(this)};this.addCommands({cmd:()=>{n(i)},undo:()=>{n(e)},mustExec:!1}),E(this,nn,wm).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){bi._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,i;(this._isCopy||this.annotationElementId)&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,N1)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${l(this,Gs)}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[h,c]=this.getInitialTranslation();[h,c]=this.pageTranslationToScreen(h,c);const[u,p]=this.pageDimensions,[g,f]=this.pageTranslation;let A,v;switch(this.rotation){case 0:A=e+(o[0]-g)/u,v=i+this.height-(o[1]-f)/p;break;case 90:A=e+(o[0]-g)/u,v=i-(o[1]-f)/p,[h,c]=[c,-h];break;case 180:A=e-this.width+(o[0]-g)/u,v=i-(o[1]-f)/p,[h,c]=[-h,-c];break;case 270:A=e+(o[0]-g-this.height*p)/u,v=i+(o[1]-f-this.width*u)/p,[h,c]=[-c,h];break}this.setAt(A*s,v*a,h,c)}else this._moveAfterPaste(e,i);E(this,nn,_m).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var A,v,S;const i=e.clipboardData||window.clipboardData,{types:n}=i;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=E(A=bi,sl,Wb).call(A,i.getData("text")||"").replaceAll(G0,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:h,startOffset:c}=o,u=[],p=[];if(h.nodeType===Node.TEXT_NODE){const w=h.parentElement;if(p.push(h.nodeValue.slice(c).replaceAll(G0,"")),w!==this.editorDiv){let k=u;for(const L of this.editorDiv.childNodes){if(L===w){k=p;continue}k.push(E(v=bi,sl,Am).call(v,L))}}u.push(h.nodeValue.slice(0,c).replaceAll(G0,""))}else if(h===this.editorDiv){let w=u,k=0;for(const L of this.editorDiv.childNodes)k++===c&&(w=p),w.push(E(S=bi,sl,Am).call(S,L))}_(this,Ws,`${u.join(`
`)}${s}${p.join(`
`)}`),E(this,nn,_m).call(this);const g=new Range;let f=Math.sumPrecise(u.map(w=>w.length));for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const k=w.nodeValue.length;if(f<=k){g.setStart(w,f),g.setEnd(w,f);break}f-=k}a.removeAllRanges(),a.addRange(g)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=bi._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,i,n){var o;let s=null;if(e instanceof sS){const{data:{defaultAppearanceData:{fontSize:h,fontColor:c},rect:u,rotation:p,id:g,popupRef:f,richText:A,contentsObj:v,creationDate:S,modificationDate:w},textContent:k,textPosition:L,parent:{page:{pageNumber:P}}}=e;if(!k||k.length===0)return null;s=e={annotationType:ce.FREETEXT,color:Array.from(c),fontSize:h,value:k.join(`
`),position:L,pageIndex:P-1,rect:u.slice(0),rotation:p,annotationElementId:g,id:g,deleted:!1,popupRef:f,comment:(v==null?void 0:v.str)||null,richText:A,creationDate:S,modificationDate:w}}const a=await super.deserialize(e,i,n);return _(a,Gs,e.fontSize),a.color=Mt.makeHexColor(...e.color),_(a,Ws,E(o=bi,sl,Wb).call(o,e.value)),a._initialData=s,e.comment&&a.setCommentData(e),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=gi._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:i,fontSize:l(this,Gs),value:E(this,nn,uS).call(this)});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!E(this,nn,dS).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(!i)return null;const{style:n}=i;n.fontSize=`calc(${l(this,Gs)}px * var(--total-scale-factor))`,n.color=this.color,i.replaceChildren();for(const s of l(this,Ws).split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),i.append(a)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:l(this,Ws)}}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ws=new WeakMap,N1=new WeakMap,Xc=new WeakMap,Gs=new WeakMap,nn=new WeakSet,lS=function(e){const i=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-l(this,Gs))*this.parentScale),_(this,Gs,s),E(this,nn,wm).call(this)},n=l(this,Gs);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},hS=function(e){const i=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},cS=function(){var n;const e=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(E(n=bi,sl,Am).call(n,s)),i=s);return e.join(`
`)},wm=function(){const[e,i]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,h=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/i):(this.width=n.height/e,this.height=n.width/i),this.fixAndSetPosition()},sl=new WeakSet,Am=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(G0,"")},_m=function(){if(this.editorDiv.replaceChildren(),!!l(this,Ws))for(const e of l(this,Ws).split(`
`)){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},uS=function(){return l(this,Ws).replaceAll(" "," ")},Wb=function(e){return e.replaceAll(" "," ")},dS=function(e){const{value:i,fontSize:n,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==i||e.fontSize!==n||e.color.some((o,h)=>o!==s[h])||e.pageIndex!==a},C(bi,sl),bt(bi,"_freeTextDefaultContent",""),bt(bi,"_internalPadding",0),bt(bi,"_defaultColor",null),bt(bi,"_defaultFontSize",10),bt(bi,"_type","freetext"),bt(bi,"_editorType",ce.FREETEXT);let zb=bi;class Dt{toSVGPath(){hi("Abstract method `toSVGPath` must be implemented.")}get box(){hi("Abstract getter `box` must be implemented.")}serialize(t,e){hi("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,n,s,a){a||(a=new Float32Array(t.length));for(let o=0,h=t.length;o<h;o+=2)a[o]=e+t[o]*n,a[o+1]=i+t[o+1]*s;return a}static _rescaleAndSwap(t,e,i,n,s,a){a||(a=new Float32Array(t.length));for(let o=0,h=t.length;o<h;o+=2)a[o]=e+t[o+1]*n,a[o+1]=i+t[o]*s;return a}static _translate(t,e,i,n){n||(n=new Float32Array(t.length));for(let s=0,a=t.length;s<a;s+=2)n[s]=e+t[s],n[s+1]=i+t[s+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,n,s){switch(s){case 90:return[1-e/i,t/n];case 180:return[1-t/i,1-e/n];case 270:return[e/i,1-t/n];default:return[t/i,e/n]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,n,s,a){return[(t+5*i)/6,(e+5*n)/6,(5*i+s)/6,(5*n+a)/6,(i+s)/2,(n+a)/2]}}bt(Dt,"PRECISION",1e-4);var Vs,Yr,uf,df,Da,Ee,Yc,Kc,T1,I1,ff,pf,hh,F1,m2,b2,mn,Rp,fS,pS,gS,mS,bS,vS;const vo=class vo{constructor({x:t,y:e},i,n,s,a,o=0){C(this,mn);C(this,Vs);C(this,Yr,[]);C(this,uf);C(this,df);C(this,Da,[]);C(this,Ee,new Float32Array(18));C(this,Yc);C(this,Kc);C(this,T1);C(this,I1);C(this,ff);C(this,pf);C(this,hh,[]);_(this,Vs,i),_(this,pf,s*n),_(this,df,a),l(this,Ee).set([NaN,NaN,NaN,NaN,t,e],6),_(this,uf,o),_(this,I1,l(vo,F1)*n),_(this,T1,l(vo,b2)*n),_(this,ff,n),l(this,hh).push(t,e)}isEmpty(){return isNaN(l(this,Ee)[8])}add({x:t,y:e}){var B;_(this,Yc,t),_(this,Kc,e);const[i,n,s,a]=l(this,Vs);let[o,h,c,u]=l(this,Ee).subarray(8,12);const p=t-c,g=e-u,f=Math.hypot(p,g);if(f<l(this,T1))return!1;const A=f-l(this,I1),v=A/f,S=v*p,w=v*g;let k=o,L=h;o=c,h=u,c+=S,u+=w,(B=l(this,hh))==null||B.push(t,e);const P=-w/A,D=S/A,H=P*l(this,pf),X=D*l(this,pf);return l(this,Ee).set(l(this,Ee).subarray(2,8),0),l(this,Ee).set([c+H,u+X],4),l(this,Ee).set(l(this,Ee).subarray(14,18),12),l(this,Ee).set([c-H,u-X],16),isNaN(l(this,Ee)[6])?(l(this,Da).length===0&&(l(this,Ee).set([o+H,h+X],2),l(this,Da).push(NaN,NaN,NaN,NaN,(o+H-i)/s,(h+X-n)/a),l(this,Ee).set([o-H,h-X],14),l(this,Yr).push(NaN,NaN,NaN,NaN,(o-H-i)/s,(h-X-n)/a)),l(this,Ee).set([k,L,o,h,c,u],6),!this.isEmpty()):(l(this,Ee).set([k,L,o,h,c,u],6),Math.abs(Math.atan2(L-h,k-o)-Math.atan2(w,S))<Math.PI/2?([o,h,c,u]=l(this,Ee).subarray(2,6),l(this,Da).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/s,((h+u)/2-n)/a),[o,h,k,L]=l(this,Ee).subarray(14,18),l(this,Yr).push(NaN,NaN,NaN,NaN,((k+o)/2-i)/s,((L+h)/2-n)/a),!0):([k,L,o,h,c,u]=l(this,Ee).subarray(0,6),l(this,Da).push(((k+5*o)/6-i)/s,((L+5*h)/6-n)/a,((5*o+c)/6-i)/s,((5*h+u)/6-n)/a,((o+c)/2-i)/s,((h+u)/2-n)/a),[c,u,o,h,k,L]=l(this,Ee).subarray(12,18),l(this,Yr).push(((k+5*o)/6-i)/s,((L+5*h)/6-n)/a,((5*o+c)/6-i)/s,((5*h+u)/6-n)/a,((o+c)/2-i)/s,((h+u)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=l(this,Da),e=l(this,Yr);if(isNaN(l(this,Ee)[6])&&!this.isEmpty())return E(this,mn,fS).call(this);const i=[];i.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?i.push(`L${t[n+4]} ${t[n+5]}`):i.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);E(this,mn,gS).call(this,i);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?i.push(`L${e[n+4]} ${e[n+5]}`):i.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return E(this,mn,pS).call(this,i),i.join(" ")}newFreeDrawOutline(t,e,i,n,s,a){return new yS(t,e,i,n,s,a)}getOutlines(){var p;const t=l(this,Da),e=l(this,Yr),i=l(this,Ee),[n,s,a,o]=l(this,Vs),h=new Float32Array((((p=l(this,hh))==null?void 0:p.length)??0)+2);for(let g=0,f=h.length-2;g<f;g+=2)h[g]=(l(this,hh)[g]-n)/a,h[g+1]=(l(this,hh)[g+1]-s)/o;if(h[h.length-2]=(l(this,Yc)-n)/a,h[h.length-1]=(l(this,Kc)-s)/o,isNaN(i[6])&&!this.isEmpty())return E(this,mn,mS).call(this,h);const c=new Float32Array(l(this,Da).length+24+l(this,Yr).length);let u=t.length;for(let g=0;g<u;g+=2){if(isNaN(t[g])){c[g]=c[g+1]=NaN;continue}c[g]=t[g],c[g+1]=t[g+1]}u=E(this,mn,vS).call(this,c,u);for(let g=e.length-6;g>=6;g-=6)for(let f=0;f<6;f+=2){if(isNaN(e[g+f])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=e[g+f],c[u+1]=e[g+f+1],u+=2}return E(this,mn,bS).call(this,c,u),this.newFreeDrawOutline(c,h,l(this,Vs),l(this,ff),l(this,uf),l(this,df))}};Vs=new WeakMap,Yr=new WeakMap,uf=new WeakMap,df=new WeakMap,Da=new WeakMap,Ee=new WeakMap,Yc=new WeakMap,Kc=new WeakMap,T1=new WeakMap,I1=new WeakMap,ff=new WeakMap,pf=new WeakMap,hh=new WeakMap,F1=new WeakMap,m2=new WeakMap,b2=new WeakMap,mn=new WeakSet,Rp=function(){const t=l(this,Ee).subarray(4,6),e=l(this,Ee).subarray(16,18),[i,n,s,a]=l(this,Vs);return[(l(this,Yc)+(t[0]-e[0])/2-i)/s,(l(this,Kc)+(t[1]-e[1])/2-n)/a,(l(this,Yc)+(e[0]-t[0])/2-i)/s,(l(this,Kc)+(e[1]-t[1])/2-n)/a]},fS=function(){const[t,e,i,n]=l(this,Vs),[s,a,o,h]=E(this,mn,Rp).call(this);return`M${(l(this,Ee)[2]-t)/i} ${(l(this,Ee)[3]-e)/n} L${(l(this,Ee)[4]-t)/i} ${(l(this,Ee)[5]-e)/n} L${s} ${a} L${o} ${h} L${(l(this,Ee)[16]-t)/i} ${(l(this,Ee)[17]-e)/n} L${(l(this,Ee)[14]-t)/i} ${(l(this,Ee)[15]-e)/n} Z`},pS=function(t){const e=l(this,Yr);t.push(`L${e[4]} ${e[5]} Z`)},gS=function(t){const[e,i,n,s]=l(this,Vs),a=l(this,Ee).subarray(4,6),o=l(this,Ee).subarray(16,18),[h,c,u,p]=E(this,mn,Rp).call(this);t.push(`L${(a[0]-e)/n} ${(a[1]-i)/s} L${h} ${c} L${u} ${p} L${(o[0]-e)/n} ${(o[1]-i)/s}`)},mS=function(t){const e=l(this,Ee),[i,n,s,a]=l(this,Vs),[o,h,c,u]=E(this,mn,Rp).call(this),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/s,(e[3]-n)/a,NaN,NaN,NaN,NaN,(e[4]-i)/s,(e[5]-n)/a,NaN,NaN,NaN,NaN,o,h,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(e[16]-i)/s,(e[17]-n)/a,NaN,NaN,NaN,NaN,(e[14]-i)/s,(e[15]-n)/a],0),this.newFreeDrawOutline(p,t,l(this,Vs),l(this,ff),l(this,uf),l(this,df))},bS=function(t,e){const i=l(this,Yr);return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6},vS=function(t,e){const i=l(this,Ee).subarray(4,6),n=l(this,Ee).subarray(16,18),[s,a,o,h]=l(this,Vs),[c,u,p,g]=E(this,mn,Rp).call(this);return t.set([NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/h,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,(n[0]-s)/o,(n[1]-a)/h],e),e+=24},C(vo,F1,8),C(vo,m2,2),C(vo,b2,l(vo,F1)+l(vo,m2));let Gm=vo;var gf,Jc,$o,M1,$s,R1,Vi,v2,wS;class yS extends Dt{constructor(e,i,n,s,a,o){super();C(this,v2);C(this,gf);C(this,Jc,new Float32Array(4));C(this,$o);C(this,M1);C(this,$s);C(this,R1);C(this,Vi);_(this,Vi,e),_(this,$s,i),_(this,gf,n),_(this,R1,s),_(this,$o,a),_(this,M1,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],E(this,v2,wS).call(this,o);const[h,c,u,p]=l(this,Jc);for(let g=0,f=e.length;g<f;g+=2)e[g]=(e[g]-h)/u,e[g+1]=(e[g+1]-c)/p;for(let g=0,f=i.length;g<f;g+=2)i[g]=(i[g]-h)/u,i[g+1]=(i[g+1]-c)/p}toSVGPath(){const e=[`M${l(this,Vi)[4]} ${l(this,Vi)[5]}`];for(let i=6,n=l(this,Vi).length;i<n;i+=6){if(isNaN(l(this,Vi)[i])){e.push(`L${l(this,Vi)[i+4]} ${l(this,Vi)[i+5]}`);continue}e.push(`C${l(this,Vi)[i]} ${l(this,Vi)[i+1]} ${l(this,Vi)[i+2]} ${l(this,Vi)[i+3]} ${l(this,Vi)[i+4]} ${l(this,Vi)[i+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,i,n,s],a){const o=n-e,h=s-i;let c,u;switch(a){case 0:c=Dt._rescale(l(this,Vi),e,s,o,-h),u=Dt._rescale(l(this,$s),e,s,o,-h);break;case 90:c=Dt._rescaleAndSwap(l(this,Vi),e,i,o,h),u=Dt._rescaleAndSwap(l(this,$s),e,i,o,h);break;case 180:c=Dt._rescale(l(this,Vi),n,i,-o,h),u=Dt._rescale(l(this,$s),n,i,-o,h);break;case 270:c=Dt._rescaleAndSwap(l(this,Vi),n,s,-o,-h),u=Dt._rescaleAndSwap(l(this,$s),n,s,-o,-h);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return l(this,Jc)}newOutliner(e,i,n,s,a,o=0){return new Gm(e,i,n,s,a,o)}getNewOutline(e,i){const[n,s,a,o]=l(this,Jc),[h,c,u,p]=l(this,gf),g=a*u,f=o*p,A=n*u+h,v=s*p+c,S=this.newOutliner({x:l(this,$s)[0]*g+A,y:l(this,$s)[1]*f+v},l(this,gf),l(this,R1),e,l(this,M1),i??l(this,$o));for(let w=2;w<l(this,$s).length;w+=2)S.add({x:l(this,$s)[w]*g+A,y:l(this,$s)[w+1]*f+v});return S.getOutlines()}}gf=new WeakMap,Jc=new WeakMap,$o=new WeakMap,M1=new WeakMap,$s=new WeakMap,R1=new WeakMap,Vi=new WeakMap,v2=new WeakSet,wS=function(e){const i=l(this,Vi);let n=i[4],s=i[5];const a=[n,s,n,s];let o=n,h=s,c=n,u=s;const p=e?Math.max:Math.min,g=new Float32Array(4);for(let A=6,v=i.length;A<v;A+=6){const S=i[A+4],w=i[A+5];isNaN(i[A])?(Mt.pointBoundingBox(S,w,a),h>w?(o=S,h=w):h===w&&(o=p(o,S)),u<w?(c=S,u=w):u===w&&(c=p(c,S))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,Mt.bezierBoundingBox(n,s,...i.slice(A,A+6),g),Mt.rectBoundingBox(g[0],g[1],g[2],g[3],a),h>g[1]?(o=g[0],h=g[1]):h===g[1]&&(o=p(o,g[0])),u<g[3]?(c=g[2],u=g[3]):u===g[3]&&(c=p(c,g[2]))),n=S,s=w}const f=l(this,Jc);f[0]=a[0]-l(this,$o),f[1]=a[1]-l(this,$o),f[2]=a[2]-a[0]+2*l(this,$o),f[3]=a[3]-a[1]+2*l(this,$o),this.firstPoint=[o,h],this.lastPoint=[c,u]};var D1,O1,B1,ch,Kr,us,AS,Sm,_S,SS,Vb;class Gb{constructor(t,e=0,i=0,n=!0){C(this,us);C(this,D1);C(this,O1);C(this,B1);C(this,ch,[]);C(this,Kr,[]);const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:v,y:S,width:w,height:k}of t){const L=Math.floor((v-e)/a)*a,P=Math.ceil((v+w+e)/a)*a,D=Math.floor((S-e)/a)*a,H=Math.ceil((S+k+e)/a)*a,X=[L,D,H,!0],$=[P,D,H,!1];l(this,ch).push(X,$),Mt.rectBoundingBox(L,D,P,H,s)}const o=s[2]-s[0]+2*i,h=s[3]-s[1]+2*i,c=s[0]-i,u=s[1]-i;let p=n?-1/0:1/0,g=1/0;const f=l(this,ch).at(n?-1:-2),A=[f[0],f[2]];for(const v of l(this,ch)){const[S,w,k,L]=v;!L&&n?w<g?(g=w,p=S):w===g&&(p=Math.max(p,S)):L&&!n&&(w<g?(g=w,p=S):w===g&&(p=Math.min(p,S))),v[0]=(S-c)/o,v[1]=(w-u)/h,v[2]=(k-u)/h}_(this,D1,new Float32Array([c,u,o,h])),_(this,O1,[p,g]),_(this,B1,A)}getOutlines(){l(this,ch).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of l(this,ch))e[3]?(t.push(...E(this,us,Vb).call(this,e)),E(this,us,_S).call(this,e)):(E(this,us,SS).call(this,e),t.push(...E(this,us,Vb).call(this,e)));return E(this,us,AS).call(this,t)}}D1=new WeakMap,O1=new WeakMap,B1=new WeakMap,ch=new WeakMap,Kr=new WeakMap,us=new WeakSet,AS=function(t){const e=[],i=new Set;for(const a of t){const[o,h,c]=a;e.push([o,h,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const h=e[a][2],c=e[a+1][2];h.push(c),c.push(h),i.add(h),i.add(c)}const n=[];let s;for(;i.size>0;){const a=i.values().next().value;let[o,h,c,u,p]=a;i.delete(a);let g=o,f=h;for(s=[o,c],n.push(s);;){let A;if(i.has(u))A=u;else if(i.has(p))A=p;else break;i.delete(A),[o,h,c,u,p]=A,g!==o&&(s.push(g,f,o,f===h?h:c),g=o),f=f===h?c:h}s.push(g,f)}return new EC(n,l(this,D1),l(this,O1),l(this,B1))},Sm=function(t){const e=l(this,Kr);let i=0,n=e.length-1;for(;i<=n;){const s=i+n>>1,a=e[s][0];if(a===t)return s;a<t?i=s+1:n=s-1}return n+1},_S=function([,t,e]){const i=E(this,us,Sm).call(this,t);l(this,Kr).splice(i,0,[t,e])},SS=function([,t,e]){const i=E(this,us,Sm).call(this,t);for(let n=i;n<l(this,Kr).length;n++){const[s,a]=l(this,Kr)[n];if(s!==t)break;if(s===t&&a===e){l(this,Kr).splice(n,1);return}}for(let n=i-1;n>=0;n--){const[s,a]=l(this,Kr)[n];if(s!==t)break;if(s===t&&a===e){l(this,Kr).splice(n,1);return}}},Vb=function(t){const[e,i,n]=t,s=[[e,i,n]],a=E(this,us,Sm).call(this,n);for(let o=0;o<a;o++){const[h,c]=l(this,Kr)[o];for(let u=0,p=s.length;u<p;u++){const[,g,f]=s[u];if(!(c<=g||f<=h)){if(g>=h){if(f>c)s[u][1]=c;else{if(p===1)return[];s.splice(u,1),u--,p--}continue}s[u][2]=h,f>c&&s.push([e,c,f])}}}return s};var j1,mf;class EC extends Dt{constructor(e,i,n,s){super();C(this,j1);C(this,mf);_(this,mf,e),_(this,j1,i),this.firstPoint=n,this.lastPoint=s}toSVGPath(){const e=[];for(const i of l(this,mf)){let[n,s]=i;e.push(`M${n} ${s}`);for(let a=2;a<i.length;a+=2){const o=i[a],h=i[a+1];o===n?(e.push(`V${h}`),s=h):h===s&&(e.push(`H${o}`),n=o)}e.push("Z")}return e.join(" ")}serialize([e,i,n,s],a){const o=[],h=n-e,c=s-i;for(const u of l(this,mf)){const p=new Array(u.length);for(let g=0;g<u.length;g+=2)p[g]=e+u[g]*h,p[g+1]=s-u[g+1]*c;o.push(p)}return o}get box(){return l(this,j1)}get classNamesForOutlining(){return["highlightOutline"]}}j1=new WeakMap,mf=new WeakMap;class $b extends Gm{newFreeDrawOutline(t,e,i,n,s,a){return new kC(t,e,i,n,s,a)}}class kC extends yS{newOutliner(t,e,i,n,s,a=0){return new $b(t,e,i,n,s,a)}}var bf,U1,Xo,Zc,H1,ws,q1,z1,Qc,Xs,Ys,Rn,vf,yf,Zn,wf,Lr,W1,Ae,Xb,xm,xS,CS,LS,Yb,Vh,kr,$u,ES,Cm,Lm,kS,PS,NS,TS,IS;const He=class He extends gi{constructor(e){super({...e,name:"highlightEditor"});C(this,Ae);C(this,bf,null);C(this,U1,0);C(this,Xo);C(this,Zc,null);C(this,H1,null);C(this,ws,null);C(this,q1,null);C(this,z1,0);C(this,Qc,null);C(this,Xs,null);C(this,Ys,null);C(this,Rn,!1);C(this,vf,null);C(this,yf,null);C(this,Zn,null);C(this,wf,"");C(this,Lr);C(this,W1,"");this.color=e.color||He._defaultColor,_(this,Lr,e.thickness||He._defaultThickness),this.opacity=e.opacity||He._defaultOpacity,_(this,Xo,e.boxes||null),_(this,W1,e.methodOfCreation||""),_(this,wf,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(_(this,Rn,!0),E(this,Ae,xm).call(this,e),E(this,Ae,Vh).call(this)):l(this,Xo)&&(_(this,bf,e.anchorNode),_(this,U1,e.anchorOffset),_(this,q1,e.focusNode),_(this,z1,e.focusOffset),E(this,Ae,Xb).call(this),E(this,Ae,Vh).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=He.prototype;return le(this,"_keyboardManager",new Z1([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,Rn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:l(this,Lr),methodOfCreation:l(this,W1)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){var n;gi.initialize(e,i),He._defaultColor||(He._defaultColor=((n=i.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,i){switch(e){case Te.HIGHLIGHT_COLOR:He._defaultColor=i;break;case Te.HIGHLIGHT_THICKNESS:He._defaultThickness=i;break}}translateInPage(e,i){}get toolbarPosition(){return l(this,yf)}get commentButtonPosition(){return l(this,vf)}updateParams(e,i){switch(e){case Te.HIGHLIGHT_COLOR:E(this,Ae,xS).call(this,i);break;case Te.HIGHLIGHT_THICKNESS:E(this,Ae,CS).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,He._defaultColor],[Te.HIGHLIGHT_THICKNESS,He._defaultThickness]]}get propertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,this.color||He._defaultColor],[Te.HIGHLIGHT_THICKNESS,l(this,Lr)||He._defaultThickness],[Te.HIGHLIGHT_FREE,l(this,Rn)]]}onUpdatedColor(){var e,i;(e=this.parent)==null||e.drawLayer.updateProperties(l(this,Ys),{root:{fill:this.color,"fill-opacity":this.opacity}}),(i=l(this,H1))==null||i.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",_(this,H1,new Qp({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(E(this,Ae,Lm).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,E(this,Ae,Lm).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){E(this,Ae,Yb).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(E(this,Ae,Vh).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let i=!1;this.parent&&!e?E(this,Ae,Yb).call(this):e&&(E(this,Ae,Vh).call(this,e),i=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var s,a,o;const{drawLayer:i}=this.parent;let n;l(this,Rn)?(e=(e-this.rotation+360)%360,n=E(s=He,kr,$u).call(s,l(this,Xs).box,e)):n=E(a=He,kr,$u).call(a,[this.x,this.y,this.width,this.height],e),i.updateProperties(l(this,Ys),{bbox:n,root:{"data-main-rotation":e}}),i.updateProperties(l(this,Zn),{bbox:E(o=He,kr,$u).call(o,l(this,ws).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();l(this,wf)&&(e.setAttribute("aria-label",l(this,wf)),e.setAttribute("role","mark")),l(this,Rn)?e.classList.add("free"):this.div.addEventListener("keydown",E(this,Ae,ES).bind(this),{signal:this._uiManager._signal});const i=_(this,Qc,document.createElement("div"));return e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=l(this,Zc),this.setDims(),YA(this,l(this,Qc),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(l(this,Zn),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(l(this,Zn),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:E(this,Ae,Cm).call(this,!0);break;case 1:case 3:E(this,Ae,Cm).call(this,!1);break}}select(){var e;super.select(),l(this,Zn)&&((e=this.parent)==null||e.drawLayer.updateProperties(l(this,Zn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),l(this,Zn)&&((e=this.parent)==null||e.drawLayer.updateProperties(l(this,Zn),{rootClass:{selected:!1}}),l(this,Rn)||E(this,Ae,Cm).call(this,!1))}get _mustFixPosition(){return!l(this,Rn)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Ys),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(l(this,Zn),{rootClass:{hidden:!e}}))}static startHighlighting(e,i,{target:n,x:s,y:a}){const{x:o,y:h,width:c,height:u}=n.getBoundingClientRect(),p=new AbortController,g=e.combinedSignal(p),f=A=>{p.abort(),E(this,kr,TS).call(this,e,A)};window.addEventListener("blur",f,{signal:g}),window.addEventListener("pointerup",f,{signal:g}),window.addEventListener("pointerdown",ki,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",sr,{signal:g}),n.addEventListener("pointermove",E(this,kr,NS).bind(this,e),{signal:g}),this._freeHighlight=new $b({x:s,y:a},[o,h,c,u],e.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,i,n){var v,S,w,k;let s=null;if(e instanceof aS){const{data:{quadPoints:L,rect:P,rotation:D,id:H,color:X,opacity:$,popupRef:B,richText:Z,contentsObj:I,creationDate:j,modificationDate:K},parent:{page:{pageNumber:Y}}}=e;s=e={annotationType:ce.HIGHLIGHT,color:Array.from(X),opacity:$,quadPoints:L,boxes:null,pageIndex:Y-1,rect:P.slice(0),rotation:D,annotationElementId:H,id:H,deleted:!1,popupRef:B,richText:Z,comment:(I==null?void 0:I.str)||null,creationDate:j,modificationDate:K}}else if(e instanceof Dv){const{data:{inkLists:L,rect:P,rotation:D,id:H,color:X,borderStyle:{rawWidth:$},popupRef:B,richText:Z,contentsObj:I,creationDate:j,modificationDate:K},parent:{page:{pageNumber:Y}}}=e;s=e={annotationType:ce.HIGHLIGHT,color:Array.from(X),thickness:$,inkLists:L,boxes:null,pageIndex:Y-1,rect:P.slice(0),rotation:D,annotationElementId:H,id:H,deleted:!1,popupRef:B,richText:Z,comment:(I==null?void 0:I.str)||null,creationDate:j,modificationDate:K}}const{color:a,quadPoints:o,inkLists:h,opacity:c}=e,u=await super.deserialize(e,i,n);u.color=Mt.makeHexColor(...a),u.opacity=c||1,h&&_(u,Lr,e.thickness),u._initialData=s,e.comment&&u.setCommentData(e);const[p,g]=u.pageDimensions,[f,A]=u.pageTranslation;if(o){const L=_(u,Xo,[]);for(let P=0;P<o.length;P+=8)L.push({x:(o[P]-f)/p,y:1-(o[P+1]-A)/g,width:(o[P+2]-o[P])/p,height:(o[P+1]-o[P+5])/g});E(v=u,Ae,Xb).call(v),E(S=u,Ae,Vh).call(S),u.rotate(u.rotation)}else if(h){_(u,Rn,!0);const L=h[0],P={x:L[0]-f,y:g-(L[1]-A)},D=new $b(P,[0,0,p,g],1,l(u,Lr)/2,!0,.001);for(let $=0,B=L.length;$<B;$+=2)P.x=L[$]-f,P.y=g-(L[$+1]-A),D.add(P);const{id:H,clipPathId:X}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:D.toSVGPath()}},!0,!0);E(w=u,Ae,xm).call(w,{highlightOutlines:D.getOutlines(),highlightId:H,clipPathId:X}),E(k=u,Ae,Vh).call(k),u.rotate(u.parentRotation)}return u}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const i=gi._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:i,opacity:this.opacity,thickness:l(this,Lr),quadPoints:E(this,Ae,kS).call(this),outlines:E(this,Ae,PS).call(this,n.rect)}),this.addComment(n),this.annotationElementId&&!E(this,Ae,IS).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};bf=new WeakMap,U1=new WeakMap,Xo=new WeakMap,Zc=new WeakMap,H1=new WeakMap,ws=new WeakMap,q1=new WeakMap,z1=new WeakMap,Qc=new WeakMap,Xs=new WeakMap,Ys=new WeakMap,Rn=new WeakMap,vf=new WeakMap,yf=new WeakMap,Zn=new WeakMap,wf=new WeakMap,Lr=new WeakMap,W1=new WeakMap,Ae=new WeakSet,Xb=function(){const e=new Gb(l(this,Xo),.001);_(this,Xs,e.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,Xs).box;const i=new Gb(l(this,Xo),.0025,.001,this._uiManager.direction==="ltr");_(this,ws,i.getOutlines());const{firstPoint:n}=l(this,Xs);_(this,vf,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]);const{lastPoint:s}=l(this,ws);_(this,yf,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},xm=function({highlightOutlines:e,highlightId:i,clipPathId:n}){var g,f;if(_(this,Xs,e),_(this,ws,e.getNewOutline(l(this,Lr)/2+1.5,.0025)),i>=0)_(this,Ys,i),_(this,Zc,n),this.parent.drawLayer.finalizeDraw(i,{bbox:e.box,path:{d:e.toSVGPath()}}),_(this,Zn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,ws).box,path:{d:l(this,ws).toSVGPath()}},!0));else if(this.parent){const A=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Ys),{bbox:E(g=He,kr,$u).call(g,l(this,Xs).box,(A-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Zn),{bbox:E(f=He,kr,$u).call(f,l(this,ws).box,A),path:{d:l(this,ws).toSVGPath()}})}const[a,o,h,c]=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=h,this.height=c;break;case 90:{const[A,v]=this.parentDimensions;this.x=o,this.y=1-a,this.width=h*v/A,this.height=c*A/v;break}case 180:this.x=1-a,this.y=1-o,this.width=h,this.height=c;break;case 270:{const[A,v]=this.parentDimensions;this.x=1-o,this.y=a,this.width=h*v/A,this.height=c*A/v;break}}const{firstPoint:u}=e;_(this,vf,[(u[0]-a)/h,(u[1]-o)/c]);const{lastPoint:p}=l(this,ws);_(this,yf,[(p[0]-a)/h,(p[1]-o)/c])},xS=function(e){const i=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:i.bind(this,e,He._defaultOpacity),undo:i.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)},CS=function(e){const i=l(this,Lr),n=s=>{_(this,Lr,s),E(this,Ae,LS).call(this,s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},LS=function(e){l(this,Rn)&&(E(this,Ae,xm).call(this,{highlightOutlines:l(this,Xs).getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())},Yb=function(){l(this,Ys)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Ys)),_(this,Ys,null),this.parent.drawLayer.remove(l(this,Zn)),_(this,Zn,null))},Vh=function(e=this.parent){l(this,Ys)===null&&({id:cn(this,Ys)._,clipPathId:cn(this,Zc)._}=e.drawLayer.draw({bbox:l(this,Xs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:l(this,Rn)},path:{d:l(this,Xs).toSVGPath()}},!1,!0),_(this,Zn,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,Rn)},bbox:l(this,ws).box,path:{d:l(this,ws).toSVGPath()}},l(this,Rn))),l(this,Qc)&&(l(this,Qc).style.clipPath=l(this,Zc)))},kr=new WeakSet,$u=function([e,i,n,s],a){switch(a){case 90:return[1-i-s,e,s,n];case 180:return[1-e-n,1-i-s,n,s];case 270:return[i,1-e-n,s,n]}return[e,i,n,s]},ES=function(e){He._keyboardManager.exec(this,e)},Cm=function(e){if(!l(this,bf))return;const i=window.getSelection();e?i.setPosition(l(this,bf),l(this,U1)):i.setPosition(l(this,q1),l(this,z1))},Lm=function(){return l(this,Rn)?this.rotation:0},kS=function(){if(l(this,Rn))return null;const[e,i]=this.pageDimensions,[n,s]=this.pageTranslation,a=l(this,Xo),o=new Float32Array(a.length*8);let h=0;for(const{x:c,y:u,width:p,height:g}of a){const f=c*e+n,A=(1-u)*i+s;o[h]=o[h+4]=f,o[h+1]=o[h+3]=A,o[h+2]=o[h+6]=f+p*e,o[h+5]=o[h+7]=A-g*i,h+=8}return o},PS=function(e){return l(this,Xs).serialize(e,E(this,Ae,Lm).call(this))},NS=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},TS=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},IS=function(e){const{color:i}=this._initialData;return this.hasEditedComment||e.color.some((n,s)=>n!==i[s])},C(He,kr),bt(He,"_defaultColor",null),bt(He,"_defaultOpacity",1),bt(He,"_defaultThickness",12),bt(He,"_type","highlight"),bt(He,"_editorType",ce.HIGHLIGHT),bt(He,"_freeHighlightId",-1),bt(He,"_freeHighlight",null),bt(He,"_freeHighlightClipId","");let Vm=He;var tu;class FS{constructor(){C(this,tu,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){l(this,tu)[t]=e}toSVGProperties(){const t=l(this,tu);return _(this,tu,Object.create(null)),{root:t}}reset(){_(this,tu,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){hi("Not implemented")}}tu=new WeakMap;var Ks,Af,wn,eu,iu,je,Kb,Jb,Zb,Dp,MS,Em,Op,Xu;const Ne=class Ne extends gi{constructor(e){super(e);C(this,je);C(this,Ks,null);C(this,Af);bt(this,"_colorPicker",null);bt(this,"_drawId",null);_(this,Af,e.mustBeCommitted||!1),this._addOutlines(e)}onUpdatedColor(){var e;(e=this._colorPicker)==null||e.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(E(this,je,Kb).call(this,e),E(this,je,Dp).call(this))}static _mergeSVGProperties(e,i){const n=new Set(Object.keys(e));for(const[s,a]of Object.entries(i))n.has(s)?Object.assign(e[s],a):e[s]=a;return e}static getDefaultDrawingOptions(e){hi("Not implemented")}static get typesMap(){hi("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,i){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,i),this._currentParent&&(l(Ne,wn).updateProperty(n,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,i){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,i)}static get defaultPropertiesToUpdate(){const e=[],i=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,i[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:i}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,i[s]]);return e}_updateProperty(e,i,n){const s=this._drawingOptions,a=s[i],o=h=>{var u;s.updateProperty(i,h);const c=l(this,Ks).updateProperty(i,h);c&&E(this,je,Op).call(this,c),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Ne._mergeSVGProperties(l(this,Ks).getPathResizingSVGProperties(E(this,je,Em).call(this)),{bbox:E(this,je,Xu).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Ne._mergeSVGProperties(l(this,Ks).getPathResizedSVGProperties(E(this,je,Em).call(this)),{bbox:E(this,je,Xu).call(this)}))}_onTranslating(e,i){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{bbox:E(this,je,Xu).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Ne._mergeSVGProperties(l(this,Ks).getPathTranslatedSVGProperties(E(this,je,Em).call(this),this.parentDimensions),{bbox:E(this,je,Xu).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,Af)&&(_(this,Af,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){E(this,je,Zb).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(E(this,je,Dp).call(this),E(this,je,Op).call(this,l(this,Ks).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let i=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),E(this,je,Zb).call(this)):e&&(this._uiManager.addShouldRescale(this),E(this,je,Dp).call(this,e),i=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ne._mergeSVGProperties({bbox:E(this,je,Xu).call(this)},l(this,Ks).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&E(this,je,Op).call(this,l(this,Ks).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,i;this._isCopy&&(e=this.x,i=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,i),n}static createDrawerInstance(e,i,n,s,a){hi("Not implemented")}static startDrawing(e,i,n,s){var S;const{target:a,offsetX:o,offsetY:h,pointerId:c,pointerType:u}=s;if($n.isInitializedAndDifferentPointerType(u))return;const{viewport:{rotation:p}}=e,{width:g,height:f}=a.getBoundingClientRect(),A=_(Ne,eu,new AbortController),v=e.combinedSignal(A);if($n.setPointer(u,c),window.addEventListener("pointerup",w=>{$n.isSamePointerIdOrRemove(w.pointerId)&&this._endDraw(w)},{signal:v}),window.addEventListener("pointercancel",w=>{$n.isSamePointerIdOrRemove(w.pointerId)&&this._currentParent.endDrawingSession()},{signal:v}),window.addEventListener("pointerdown",w=>{$n.isSamePointerType(w.pointerType)&&($n.initializeAndAddPointerId(w.pointerId),l(Ne,wn).isCancellable()&&(l(Ne,wn).removeLastElement(),l(Ne,wn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",sr,{signal:v}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),a.addEventListener("touchmove",w=>{$n.isSameTimeStamp(w.timeStamp)&&ki(w)},{signal:v}),e.toggleDrawing(),(S=i._editorUndoBar)==null||S.hide(),l(Ne,wn)){e.drawLayer.updateProperties(this._currentDrawId,l(Ne,wn).startNew(o,h,g,f,p));return}i.updateUIForDefaultProperties(this),_(Ne,wn,this.createDrawerInstance(o,h,g,f,p)),_(Ne,iu,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(l(Ne,iu).toSVGProperties(),l(Ne,wn).defaultSVGProperties),!0,!1)}static _drawMove(e){if($n.isSameTimeStamp(e.timeStamp),!l(Ne,wn))return;const{offsetX:i,offsetY:n,pointerId:s}=e;if($n.isSamePointerId(s)){if($n.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(Ne,wn).add(i,n)),$n.setTimeStamp(e.timeStamp),ki(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,_(Ne,wn,null),_(Ne,iu,null),$n.clearTimeStamp()),l(Ne,eu)&&(l(Ne,eu).abort(),_(Ne,eu,null),$n.clearPointerIds())}static _endDraw(e){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,l(Ne,wn).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=l(Ne,wn),s=this._currentDrawId,a=n.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(s,n.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Te.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Te.DRAW_STEP),!l(Ne,wn).isEmpty()){const{pageDimensions:[n,s],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(Ne,wn).getOutlines(n*a,s*a,a,this._INNER_MARGIN),drawingOptions:l(Ne,iu),mustBeCommitted:!e});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,i,n,s,a,o){hi("Not implemented")}static async deserialize(e,i,n){var p,g;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:h}}=i.viewport,c=this.deserializeDraw(o,h,s,a,this._INNER_MARGIN,e),u=await super.deserialize(e,i,n);return u.createDrawingOptions(e),E(p=u,je,Kb).call(p,{drawOutlines:c}),E(g=u,je,Dp).call(g),u.onScaleChanging(),u.rotate(),u}serializeDraw(e){const[i,n]=this.pageTranslation,[s,a]=this.pageDimensions;return l(this,Ks).serialize([i,n,s,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Ks=new WeakMap,Af=new WeakMap,wn=new WeakMap,eu=new WeakMap,iu=new WeakMap,je=new WeakSet,Kb=function({drawOutlines:e,drawId:i,drawingOptions:n}){_(this,Ks,e),this._drawingOptions||(this._drawingOptions=n),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,e.defaultProperties)):this._drawId=E(this,je,Jb).call(this,e,this.parent),E(this,je,Op).call(this,e.box)},Jb=function(e,i){const{id:n}=i.drawLayer.draw(Ne._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n},Zb=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Dp=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=E(this,je,Jb).call(this,l(this,Ks),e)}},MS=function([e,i,n,s]){const{parentDimensions:[a,o],rotation:h}=this;switch(h){case 90:return[i,1-e,n*(o/a),s*(a/o)];case 180:return[1-e,1-i,n,s];case 270:return[1-i,e,n*(o/a),s*(a/o)];default:return[e,i,n,s]}},Em=function(){const{x:e,y:i,width:n,height:s,parentDimensions:[a,o],rotation:h}=this;switch(h){case 90:return[1-i,e,n*(a/o),s*(o/a)];case 180:return[1-e,1-i,n,s];case 270:return[i,1-e,n*(a/o),s*(o/a)];default:return[e,i,n,s]}},Op=function(e){[this.x,this.y,this.width,this.height]=E(this,je,MS).call(this,e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Xu=function(){const{x:e,y:i,width:n,height:s,rotation:a,parentRotation:o,parentDimensions:[h,c]}=this;switch((a*4+o)/90){case 1:return[1-i-s,e,s,n];case 2:return[1-e-n,1-i-s,n,s];case 3:return[i,1-e-n,s,n];case 4:return[e,i-n*(h/c),s*(c/h),n*(h/c)];case 5:return[1-i,e,n*(h/c),s*(c/h)];case 6:return[1-e-s*(c/h),1-i,s*(c/h),n*(h/c)];case 7:return[i-n*(h/c),1-e-s*(c/h),n*(h/c),s*(c/h)];case 8:return[e-n,i-s,n,s];case 9:return[1-i,e-n,s,n];case 10:return[1-e,1-i,n,s];case 11:return[i-s,1-e,s,n];case 12:return[e-s*(c/h),i,s*(c/h),n*(h/c)];case 13:return[1-i-n*(h/c),e-s*(c/h),n*(h/c),s*(c/h)];case 14:return[1-e,1-i-n*(h/c),s*(c/h),n*(h/c)];case 15:return[i,1-e,n*(h/c),s*(c/h)];default:return[e,i,n,s]}},bt(Ne,"_currentDrawId",-1),bt(Ne,"_currentParent",null),C(Ne,wn,null),C(Ne,eu,null),C(Ne,iu,null),bt(Ne,"_INNER_MARGIN",3);let $m=Ne;var Oa,An,_n,nu,_f,as,Dn,Er,su,ru,au,Sf,km;class PC{constructor(t,e,i,n,s,a){C(this,Sf);C(this,Oa,new Float64Array(6));C(this,An);C(this,_n);C(this,nu);C(this,_f);C(this,as);C(this,Dn,"");C(this,Er,0);C(this,su,new t0);C(this,ru);C(this,au);_(this,ru,i),_(this,au,n),_(this,nu,s),_(this,_f,a),[t,e]=E(this,Sf,km).call(this,t,e);const o=_(this,An,[NaN,NaN,NaN,NaN,t,e]);_(this,as,[t,e]),_(this,_n,[{line:o,points:l(this,as)}]),l(this,Oa).set(o,0)}updateProperty(t,e){t==="stroke-width"&&_(this,_f,e)}isEmpty(){return!l(this,_n)||l(this,_n).length===0}isCancellable(){return l(this,as).length<=10}add(t,e){[t,e]=E(this,Sf,km).call(this,t,e);const[i,n,s,a]=l(this,Oa).subarray(2,6),o=t-s,h=e-a;return Math.hypot(l(this,ru)*o,l(this,au)*h)<=2?null:(l(this,as).push(t,e),isNaN(i)?(l(this,Oa).set([s,a,t,e],2),l(this,An).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(l(this,Oa)[0])&&l(this,An).splice(6,6),l(this,Oa).set([i,n,s,a,t,e],0),l(this,An).push(...Dt.createBezierPoints(i,n,s,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(l(this,as).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,n,s){_(this,ru,i),_(this,au,n),_(this,nu,s),[t,e]=E(this,Sf,km).call(this,t,e);const a=_(this,An,[NaN,NaN,NaN,NaN,t,e]);_(this,as,[t,e]);const o=l(this,_n).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,_n).push({line:a,points:l(this,as)}),l(this,Oa).set(a,0),_(this,Er,0),this.toSVGPath(),null}getLastElement(){return l(this,_n).at(-1)}setLastElement(t){return l(this,_n)?(l(this,_n).push(t),_(this,An,t.line),_(this,as,t.points),_(this,Er,0),{path:{d:this.toSVGPath()}}):l(this,su).setLastElement(t)}removeLastElement(){if(!l(this,_n))return l(this,su).removeLastElement();l(this,_n).pop(),_(this,Dn,"");for(let t=0,e=l(this,_n).length;t<e;t++){const{line:i,points:n}=l(this,_n)[t];_(this,An,i),_(this,as,n),_(this,Er,0),this.toSVGPath()}return{path:{d:l(this,Dn)}}}toSVGPath(){const t=Dt.svgRound(l(this,An)[4]),e=Dt.svgRound(l(this,An)[5]);if(l(this,as).length===2)return _(this,Dn,`${l(this,Dn)} M ${t} ${e} Z`),l(this,Dn);if(l(this,as).length<=6){const n=l(this,Dn).lastIndexOf("M");_(this,Dn,`${l(this,Dn).slice(0,n)} M ${t} ${e}`),_(this,Er,6)}if(l(this,as).length===4){const n=Dt.svgRound(l(this,An)[10]),s=Dt.svgRound(l(this,An)[11]);return _(this,Dn,`${l(this,Dn)} L ${n} ${s}`),_(this,Er,12),l(this,Dn)}const i=[];l(this,Er)===0&&(i.push(`M ${t} ${e}`),_(this,Er,6));for(let n=l(this,Er),s=l(this,An).length;n<s;n+=6){const[a,o,h,c,u,p]=l(this,An).slice(n,n+6).map(Dt.svgRound);i.push(`C${a} ${o} ${h} ${c} ${u} ${p}`)}return _(this,Dn,l(this,Dn)+i.join(" ")),_(this,Er,l(this,An).length),l(this,Dn)}getOutlines(t,e,i,n){const s=l(this,_n).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),l(this,su).build(l(this,_n),t,e,i,l(this,nu),l(this,_f),n),_(this,Oa,null),_(this,An,null),_(this,_n,null),_(this,Dn,null),l(this,su)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Oa=new WeakMap,An=new WeakMap,_n=new WeakMap,nu=new WeakMap,_f=new WeakMap,as=new WeakMap,Dn=new WeakMap,Er=new WeakMap,su=new WeakMap,ru=new WeakMap,au=new WeakMap,Sf=new WeakSet,km=function(t,e){return Dt._normalizePoint(t,e,l(this,ru),l(this,au),l(this,nu))};var os,G1,V1,Js,Ba,ja,xf,Cf,ou,Bn,mo,RS,DS,OS;class t0 extends Dt{constructor(){super(...arguments);C(this,Bn);C(this,os);C(this,G1,0);C(this,V1);C(this,Js);C(this,Ba);C(this,ja);C(this,xf);C(this,Cf);C(this,ou)}build(e,i,n,s,a,o,h){_(this,Ba,i),_(this,ja,n),_(this,xf,s),_(this,Cf,a),_(this,ou,o),_(this,V1,h??0),_(this,Js,e),E(this,Bn,DS).call(this)}get thickness(){return l(this,ou)}setLastElement(e){return l(this,Js).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Js).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:i}of l(this,Js)){if(e.push(`M${Dt.svgRound(i[4])} ${Dt.svgRound(i[5])}`),i.length===6){e.push("Z");continue}if(i.length===12&&isNaN(i[6])){e.push(`L${Dt.svgRound(i[10])} ${Dt.svgRound(i[11])}`);continue}for(let n=6,s=i.length;n<s;n+=6){const[a,o,h,c,u,p]=i.subarray(n,n+6).map(Dt.svgRound);e.push(`C${a} ${o} ${h} ${c} ${u} ${p}`)}}return e.join("")}serialize([e,i,n,s],a){const o=[],h=[],[c,u,p,g]=E(this,Bn,RS).call(this);let f,A,v,S,w,k,L,P,D;switch(l(this,Cf)){case 0:D=Dt._rescale,f=e,A=i+s,v=n,S=-s,w=e+c*n,k=i+(1-u-g)*s,L=e+(c+p)*n,P=i+(1-u)*s;break;case 90:D=Dt._rescaleAndSwap,f=e,A=i,v=n,S=s,w=e+u*n,k=i+c*s,L=e+(u+g)*n,P=i+(c+p)*s;break;case 180:D=Dt._rescale,f=e+n,A=i,v=-n,S=s,w=e+(1-c-p)*n,k=i+u*s,L=e+(1-c)*n,P=i+(u+g)*s;break;case 270:D=Dt._rescaleAndSwap,f=e+n,A=i+s,v=-n,S=-s,w=e+(1-u-g)*n,k=i+(1-c-p)*s,L=e+(1-u)*n,P=i+(1-c)*s;break}for(const{line:H,points:X}of l(this,Js))o.push(D(H,f,A,v,S,a?new Array(H.length):null)),h.push(D(X,f,A,v,S,a?new Array(X.length):null));return{lines:o,points:h,rect:[w,k,L,P]}}static deserialize(e,i,n,s,a,{paths:{lines:o,points:h},rotation:c,thickness:u}){const p=[];let g,f,A,v,S;switch(c){case 0:S=Dt._rescale,g=-e/n,f=i/s+1,A=1/n,v=-1/s;break;case 90:S=Dt._rescaleAndSwap,g=-i/s,f=-e/n,A=1/s,v=1/n;break;case 180:S=Dt._rescale,g=e/n+1,f=-i/s,A=-1/n,v=1/s;break;case 270:S=Dt._rescaleAndSwap,g=i/s+1,f=e/n+1,A=-1/s,v=-1/n;break}if(!o){o=[];for(const k of h){const L=k.length;if(L===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(L===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}const P=new Float32Array(3*(L-2));o.push(P);let[D,H,X,$]=k.subarray(0,4);P.set([NaN,NaN,NaN,NaN,D,H],0);for(let B=4;B<L;B+=2){const Z=k[B],I=k[B+1];P.set(Dt.createBezierPoints(D,H,X,$,Z,I),(B-2)*3),[D,H,X,$]=[X,$,Z,I]}}}for(let k=0,L=o.length;k<L;k++)p.push({line:S(o[k].map(P=>P??NaN),g,f,A,v),points:S(h[k].map(P=>P??NaN),g,f,A,v)});const w=new this.prototype.constructor;return w.build(p,n,s,1,c,u,a),w}get box(){return l(this,os)}updateProperty(e,i){return e==="stroke-width"?E(this,Bn,OS).call(this,i):null}updateParentDimensions([e,i],n){const[s,a]=E(this,Bn,mo).call(this);_(this,Ba,e),_(this,ja,i),_(this,xf,n);const[o,h]=E(this,Bn,mo).call(this),c=o-s,u=h-a,p=l(this,os);return p[0]-=c,p[1]-=u,p[2]+=2*c,p[3]+=2*u,p}updateRotation(e){return _(this,G1,e),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,os).map(Dt.svgRound).join(" ")}get defaultProperties(){const[e,i]=l(this,os);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Dt.svgRound(e)} ${Dt.svgRound(i)}`}}}get rotationTransform(){const[,,e,i]=l(this,os);let n=0,s=0,a=0,o=0,h=0,c=0;switch(l(this,G1)){case 90:s=i/e,a=-e/i,h=e;break;case 180:n=-1,o=-1,h=e,c=i;break;case 270:s=-i/e,a=e/i,c=i;break;default:return""}return`matrix(${n} ${s} ${a} ${o} ${Dt.svgRound(h)} ${Dt.svgRound(c)})`}getPathResizingSVGProperties([e,i,n,s]){const[a,o]=E(this,Bn,mo).call(this),[h,c,u,p]=l(this,os);if(Math.abs(u-a)<=Dt.PRECISION||Math.abs(p-o)<=Dt.PRECISION){const S=e+n/2-(h+u/2),w=i+s/2-(c+p/2);return{path:{"transform-origin":`${Dt.svgRound(e)} ${Dt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${w})`}}}const g=(n-2*a)/(u-2*a),f=(s-2*o)/(p-2*o),A=u/n,v=p/s;return{path:{"transform-origin":`${Dt.svgRound(h)} ${Dt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${A} ${v}) translate(${Dt.svgRound(a)} ${Dt.svgRound(o)}) scale(${g} ${f}) translate(${Dt.svgRound(-a)} ${Dt.svgRound(-o)})`}}}getPathResizedSVGProperties([e,i,n,s]){const[a,o]=E(this,Bn,mo).call(this),h=l(this,os),[c,u,p,g]=h;if(h[0]=e,h[1]=i,h[2]=n,h[3]=s,Math.abs(p-a)<=Dt.PRECISION||Math.abs(g-o)<=Dt.PRECISION){const w=e+n/2-(c+p/2),k=i+s/2-(u+g/2);for(const{line:L,points:P}of l(this,Js))Dt._translate(L,w,k,L),Dt._translate(P,w,k,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Dt.svgRound(e)} ${Dt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(n-2*a)/(p-2*a),A=(s-2*o)/(g-2*o),v=-f*(c+a)+e+a,S=-A*(u+o)+i+o;if(f!==1||A!==1||v!==0||S!==0)for(const{line:w,points:k}of l(this,Js))Dt._rescale(w,v,S,f,A,w),Dt._rescale(k,v,S,f,A,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Dt.svgRound(e)} ${Dt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,i],n){const[s,a]=n,o=l(this,os),h=e-o[0],c=i-o[1];if(l(this,Ba)===s&&l(this,ja)===a)for(const{line:u,points:p}of l(this,Js))Dt._translate(u,h,c,u),Dt._translate(p,h,c,p);else{const u=l(this,Ba)/s,p=l(this,ja)/a;_(this,Ba,s),_(this,ja,a);for(const{line:g,points:f}of l(this,Js))Dt._rescale(g,h,c,u,p,g),Dt._rescale(f,h,c,u,p,f);o[2]*=u,o[3]*=p}return o[0]=e,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Dt.svgRound(e)} ${Dt.svgRound(i)}`}}}get defaultSVGProperties(){const e=l(this,os);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Dt.svgRound(e[0])} ${Dt.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}os=new WeakMap,G1=new WeakMap,V1=new WeakMap,Js=new WeakMap,Ba=new WeakMap,ja=new WeakMap,xf=new WeakMap,Cf=new WeakMap,ou=new WeakMap,Bn=new WeakSet,mo=function(e=l(this,ou)){const i=l(this,V1)+e/2*l(this,xf);return l(this,Cf)%180===0?[i/l(this,Ba),i/l(this,ja)]:[i/l(this,ja),i/l(this,Ba)]},RS=function(){const[e,i,n,s]=l(this,os),[a,o]=E(this,Bn,mo).call(this,0);return[e+a,i+o,n-2*a,s-2*o]},DS=function(){const e=_(this,os,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of l(this,Js)){if(s.length<=12){for(let h=4,c=s.length;h<c;h+=6)Mt.pointBoundingBox(s[h],s[h+1],e);continue}let a=s[4],o=s[5];for(let h=6,c=s.length;h<c;h+=6){const[u,p,g,f,A,v]=s.subarray(h,h+6);Mt.bezierBoundingBox(a,o,u,p,g,f,A,v,e),a=A,o=v}}const[i,n]=E(this,Bn,mo).call(this);e[0]=Qn(e[0]-i,0,1),e[1]=Qn(e[1]-n,0,1),e[2]=Qn(e[2]+i,0,1),e[3]=Qn(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]},OS=function(e){const[i,n]=E(this,Bn,mo).call(this);_(this,ou,e);const[s,a]=E(this,Bn,mo).call(this),[o,h]=[s-i,a-n],c=l(this,os);return c[0]-=o,c[1]-=h,c[2]+=2*o,c[3]+=2*h,c};class L2 extends FS{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:gi._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new L2(this._viewParameters);return t.updateAll(this),t}}var y2,BS;const id=class id extends $m{constructor(e){super({...e,name:"inkEditor"});C(this,y2);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,i){gi.initialize(e,i),this._defaultDrawingOptions=new L2(i.viewParameters)}static getDefaultDrawingOptions(e){const i=this._defaultDrawingOptions.clone();return i.updateProperties(e),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return le(this,"typesMap",new Map([[Te.INK_THICKNESS,"stroke-width"],[Te.INK_COLOR,"stroke"],[Te.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,i,n,s,a){return new PC(e,i,n,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,i,n,s,a,o){return t0.deserialize(e,i,n,s,a,o)}static async deserialize(e,i,n){let s=null;if(e instanceof Dv){const{data:{inkLists:o,rect:h,rotation:c,id:u,color:p,opacity:g,borderStyle:{rawWidth:f},popupRef:A,richText:v,contentsObj:S,creationDate:w,modificationDate:k},parent:{page:{pageNumber:L}}}=e;s=e={annotationType:ce.INK,color:Array.from(p),thickness:f,opacity:g,paths:{points:o},boxes:null,pageIndex:L-1,rect:h.slice(0),rotation:c,annotationElementId:u,id:u,deleted:!1,popupRef:A,richText:v,comment:(S==null?void 0:S.str)||null,creationDate:w,modificationDate:k}}const a=await super.deserialize(e,i,n);return a._initialData=s,e.comment&&a.setCommentData(e),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new zm(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Te.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:i,parent:n}=this;i.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:i,opacity:n}){this._drawingOptions=id.getDefaultDrawingOptions({stroke:Mt.makeHexColor(...e),"stroke-width":i,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":o}}=this,h=Object.assign(super.serialize(e),{color:gi._colorManager.convert(s),opacity:a,thickness:o,paths:{lines:i,points:n}});return this.addComment(h),e?(h.isCopy=!0,h):this.annotationElementId&&!E(this,y2,BS).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:i,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}};y2=new WeakSet,BS=function(e){const{color:i,thickness:n,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,h)=>o!==i[h])||e.thickness!==n||e.opacity!==s||e.pageIndex!==a},bt(id,"_type","ink"),bt(id,"_editorType",ce.INK),bt(id,"_defaultDrawingOptions",null);let Qb=id;class tv extends t0{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const V0=8,mp=3;var lu,Ge,ev,Jr,jS,US,iv,Pm,HS,qS,zS,nv,sv,WS;class za{static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:n},s,a,o,h){let c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const p=200,g=u.font=`${i} ${n} ${p}px ${e}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:A,actualBoundingBoxAscent:v,actualBoundingBoxDescent:S,fontBoundingBoxAscent:w,fontBoundingBoxDescent:k,width:L}=u.measureText(t),P=1.5,D=Math.ceil(Math.max(Math.abs(f)+Math.abs(A)||0,L)*P),H=Math.ceil(Math.max(Math.abs(v)+Math.abs(S)||p,Math.abs(w)+Math.abs(k)||p)*P);c=new OffscreenCanvas(D,H),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=g,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,D,H),u.fillStyle="black",u.fillText(t,D*(P-1)/2,H*(3-P)/2);const X=E(this,Ge,nv).call(this,u.getImageData(0,0,D,H).data),$=E(this,Ge,zS).call(this,X),B=E(this,Ge,sv).call(this,$),Z=E(this,Ge,iv).call(this,X,D,H,B);return this.processDrawnLines({lines:{curves:Z,width:D,height:H},pageWidth:s,pageHeight:a,rotation:o,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,i,n,s){const[a,o,h]=E(this,Ge,WS).call(this,t),[c,u]=E(this,Ge,qS).call(this,a,o,h,Math.hypot(o,h)*l(this,lu).sigmaSFactor,l(this,lu).sigmaR,l(this,lu).kernelSize),p=E(this,Ge,sv).call(this,u),g=E(this,Ge,iv).call(this,c,o,h,p);return this.processDrawnLines({lines:{curves:g,width:o,height:h},pageWidth:e,pageHeight:i,rotation:n,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:s,mustSmooth:a,areContours:o}){n%180!==0&&([e,i]=[i,e]);const{curves:h,width:c,height:u}=t,p=t.thickness??0,g=[],f=Math.min(e/c,i/u),A=f/e,v=f/i,S=[];for(const{points:k}of h){const L=a?E(this,Ge,HS).call(this,k):k;if(!L)continue;S.push(L);const P=L.length,D=new Float32Array(P),H=new Float32Array(3*(P===2?2:P-2));if(g.push({line:H,points:D}),P===2){D[0]=L[0]*A,D[1]=L[1]*v,H.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[X,$,B,Z]=L;X*=A,$*=v,B*=A,Z*=v,D.set([X,$,B,Z],0),H.set([NaN,NaN,NaN,NaN,X,$],0);for(let I=4;I<P;I+=2){const j=D[I]=L[I]*A,K=D[I+1]=L[I+1]*v;H.set(Dt.createBezierPoints(X,$,B,Z,j,K),(I-2)*3),[X,$,B,Z]=[B,Z,j,K]}}if(g.length===0)return null;const w=o?new tv:new t0;return w.build(g,e,i,1,n,o?0:p,s),{outline:w,newCurves:S,areContours:o,thickness:p,width:c,height:u}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:n,height:s}){let a=1/0,o=-1/0,h=0;for(const L of t){h+=L.length;for(let P=2,D=L.length;P<D;P++){const H=L[P]-L[P-2];a=Math.min(a,H),o=Math.max(o,H)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const u=t.length,p=V0+mp*u,g=new Uint32Array(p);let f=0;g[f++]=p*Uint32Array.BYTES_PER_ELEMENT+(h-2*u)*c.BYTES_PER_ELEMENT,g[f++]=0,g[f++]=n,g[f++]=s,g[f++]=e?0:1,g[f++]=Math.max(0,Math.floor(i??0)),g[f++]=u,g[f++]=c.BYTES_PER_ELEMENT;for(const L of t)g[f++]=L.length-2,g[f++]=L[0],g[f++]=L[1];const A=new CompressionStream("deflate-raw"),v=A.writable.getWriter();await v.ready,v.write(g);const S=c.prototype.constructor;for(const L of t){const P=new S(L.length-2);for(let D=2,H=L.length;D<H;D++)P[D-2]=L[D]-L[D-2];v.write(P)}v.close();const w=await new Response(A.readable).arrayBuffer(),k=new Uint8Array(w);return DA(k)}static async decompressSignature(t){try{const e=Qx(t),{readable:i,writable:n}=new DecompressionStream("deflate-raw"),s=n.getWriter();await s.ready,s.write(e).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,o=0;for await(const L of i)a||(a=new Uint8Array(new Uint32Array(L.buffer,0,4)[0])),a.set(L,o),o+=L.length;const h=new Uint32Array(a.buffer,0,a.length>>2),c=h[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const u=h[2],p=h[3],g=h[4]===0,f=h[5],A=h[6],v=h[7],S=[],w=(V0+mp*A)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(v){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(a.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(a.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(a.buffer,w);break}o=0;for(let L=0;L<A;L++){const P=h[mp*L+V0],D=new Float32Array(P+2);S.push(D);for(let H=0;H<mp-1;H++)D[H]=h[mp*L+V0+H+1];for(let H=0;H<P;H++)D[H+2]=D[H]+k[o++]}return{areContours:g,thickness:f,outlines:S,width:u,height:p}}catch(e){return ue(`decompressSignature: ${e}`),null}}}lu=new WeakMap,Ge=new WeakSet,ev=function(t,e,i,n){return i-=t,n-=e,i===0?n>0?0:4:i===1?n+6:2-n},Jr=new WeakMap,jS=function(t,e,i,n,s,a,o){const h=E(this,Ge,ev).call(this,i,n,s,a);for(let c=0;c<8;c++){const u=(-c+h-o+16)%8,p=l(this,Jr)[2*u],g=l(this,Jr)[2*u+1];if(t[(i+p)*e+(n+g)]!==0)return u}return-1},US=function(t,e,i,n,s,a,o){const h=E(this,Ge,ev).call(this,i,n,s,a);for(let c=0;c<8;c++){const u=(c+h+o+16)%8,p=l(this,Jr)[2*u],g=l(this,Jr)[2*u+1];if(t[(i+p)*e+(n+g)]!==0)return u}return-1},iv=function(t,e,i,n){const s=t.length,a=new Int32Array(s);for(let u=0;u<s;u++)a[u]=t[u]<=n?1:0;for(let u=1;u<i-1;u++)a[u*e]=a[u*e+e-1]=0;for(let u=0;u<e;u++)a[u]=a[e*i-1-u]=0;let o=1,h;const c=[];for(let u=1;u<i-1;u++){h=1;for(let p=1;p<e-1;p++){const g=u*e+p,f=a[g];if(f===0)continue;let A=u,v=p;if(f===1&&a[g-1]===0)o+=1,v-=1;else if(f>=1&&a[g+1]===0)o+=1,v+=1,f>1&&(h=f);else{f!==1&&(h=Math.abs(f));continue}const S=[p,u],w=v===p+1,k={isHole:w,points:S,id:o,parent:0};c.push(k);let L;for(const I of c)if(I.id===h){L=I;break}L?L.isHole?k.parent=w?L.parent:h:k.parent=w?h:L.parent:k.parent=w?h:0;const P=E(this,Ge,jS).call(this,a,e,u,p,A,v,0);if(P===-1){a[g]=-o,a[g]!==1&&(h=Math.abs(a[g]));continue}let D=l(this,Jr)[2*P],H=l(this,Jr)[2*P+1];const X=u+D,$=p+H;A=X,v=$;let B=u,Z=p;for(;;){const I=E(this,Ge,US).call(this,a,e,B,Z,A,v,1);D=l(this,Jr)[2*I],H=l(this,Jr)[2*I+1];const j=B+D,K=Z+H;S.push(K,j);const Y=B*e+Z;if(a[Y+1]===0?a[Y]=-o:a[Y]===1&&(a[Y]=o),j===u&&K===p&&B===X&&Z===$){a[g]!==1&&(h=Math.abs(a[g]));break}else A=B,v=Z,B=j,Z=K}}}return c},Pm=function(t,e,i,n){if(i-e<=4){for(let X=e;X<i-2;X+=2)n.push(t[X],t[X+1]);return}const s=t[e],a=t[e+1],o=t[i-4]-s,h=t[i-3]-a,c=Math.hypot(o,h),u=o/c,p=h/c,g=u*a-p*s,f=h/o,A=1/c,v=Math.atan(f),S=Math.cos(v),w=Math.sin(v),k=A*(Math.abs(S)+Math.abs(w)),L=A*(1-k+k**2),P=Math.max(Math.atan(Math.abs(w+S)*L),Math.atan(Math.abs(w-S)*L));let D=0,H=e;for(let X=e+2;X<i-2;X+=2){const $=Math.abs(g-u*t[X+1]+p*t[X]);$>D&&(H=X,D=$)}D>(c*P)**2?(E(this,Ge,Pm).call(this,t,e,H+2,n),E(this,Ge,Pm).call(this,t,H,i,n)):n.push(s,a)},HS=function(t){const e=[],i=t.length;return E(this,Ge,Pm).call(this,t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e},qS=function(t,e,i,n,s,a){const o=new Float32Array(a**2),h=-2*n**2,c=a>>1;for(let v=0;v<a;v++){const S=(v-c)**2;for(let w=0;w<a;w++)o[v*a+w]=Math.exp((S+(w-c)**2)/h)}const u=new Float32Array(256),p=-2*s**2;for(let v=0;v<256;v++)u[v]=Math.exp(v**2/p);const g=t.length,f=new Uint8Array(g),A=new Uint32Array(256);for(let v=0;v<i;v++)for(let S=0;S<e;S++){const w=v*e+S,k=t[w];let L=0,P=0;for(let H=0;H<a;H++){const X=v+H-c;if(!(X<0||X>=i))for(let $=0;$<a;$++){const B=S+$-c;if(B<0||B>=e)continue;const Z=t[X*e+B],I=o[H*a+$]*u[Math.abs(Z-k)];L+=Z*I,P+=I}}const D=f[w]=Math.round(L/P);A[D]++}return[f,A]},zS=function(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e},nv=function(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let n=-1/0,s=1/0;for(let o=0,h=i.length;o<h;o++){const c=i[o]=t[o<<2];n=Math.max(n,c),s=Math.min(s,c)}const a=255/(n-s);for(let o=0,h=i.length;o<h;o++)i[o]=(i[o]-s)*a;return i},sv=function(t){let e,i=-1/0,n=-1/0;const s=t.findIndex(h=>h!==0);let a=s,o=s;for(e=s;e<256;e++){const h=t[e];h>i&&(e-a>n&&(n=e-a,o=e-1),i=h,a=e)}for(e=o-1;e>=0&&!(t[e]>t[e+1]);e--);return e},WS=function(t){const e=t,{width:i,height:n}=t,{maxDim:s}=l(this,lu);let a=i,o=n;if(i>s||n>s){let g=i,f=n,A=Math.log2(Math.max(i,n)/s);const v=Math.floor(A);A=A===v?v-1:v;for(let w=0;w<A;w++){a=Math.ceil(g/2),o=Math.ceil(f/2);const k=new OffscreenCanvas(a,o);k.getContext("2d").drawImage(t,0,0,g,f,0,0,a,o),g=a,f=o,t!==e&&t.close(),t=k.transferToImageBitmap()}const S=Math.min(s/a,s/o);a=Math.round(a*S),o=Math.round(o*S)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,a,o),c.filter="grayscale(1)",c.drawImage(t,0,0,t.width,t.height,0,0,a,o);const u=c.getImageData(0,0,a,o).data;return[E(this,Ge,nv).call(this,u),a,o]},C(za,Ge),C(za,lu,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),C(za,Jr,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class Ov extends FS{constructor(){super(),super.updateProperties({fill:gi._defaultLineColor,"stroke-width":0})}clone(){const t=new Ov;return t.updateAll(this),t}}class Bv extends L2{constructor(t){super(t),super.updateProperties({stroke:gi._defaultLineColor,"stroke-width":1})}clone(){const t=new Bv(this._viewParameters);return t.updateAll(this),t}}var uh,Ua,dh,hu;const Fs=class Fs extends $m{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});C(this,uh,!1);C(this,Ua,null);C(this,dh,null);C(this,hu,null);this._willKeepAspectRatio=!0,_(this,dh,e.signatureData||null),_(this,Ua,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,i){gi.initialize(e,i),this._defaultDrawingOptions=new Ov,this._defaultDrawnSignatureOptions=new Bv(i.viewParameters)}static getDefaultDrawingOptions(e){const i=this._defaultDrawingOptions.clone();return i.updateProperties(e),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return le(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!l(this,Ua)}}static computeTelemetryFinalData(e){const i=e.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,i;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,i=this.y),super.render(),this._drawId===null)if(l(this,dh)){const{lines:s,mustSmooth:a,areContours:o,description:h,uuid:c,heightInPage:u}=l(this,dh),{rawDims:{pageWidth:p,pageHeight:g},rotation:f}=this.parent.viewport,A=za.processDrawnLines({lines:s,pageWidth:p,pageHeight:g,rotation:f,innerMargin:Fs._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(A,u,h,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:l(this,Ua)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,i)),this.div}setUuid(e){_(this,hu,e),this.addEditToolbar()}getUuid(){return l(this,hu)}get description(){return l(this,Ua)}set description(e){_(this,Ua,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:i,thickness:n,width:s,height:a}=l(this,dh),o=Math.max(s,a),h=za.processDrawnLines({lines:{curves:e.map(c=>({points:c})),thickness:n,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,i,n,s){const{x:a,y:o}=this,{outline:h}=_(this,dh,e);_(this,uh,h instanceof tv),this.description=n;let c;l(this,uh)?c=Fs.getDefaultDrawingOptions():(c=Fs._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:c});const[,u]=this.pageDimensions;let p=i/u;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:s}=this.parent.viewport;return za.process(e,i,n,s,Fs._INNER_MARGIN)}getFromText(e,i){const{rawDims:{pageWidth:n,pageHeight:s},rotation:a}=this.parent.viewport;return za.extractContoursFromText(e,i,n,s,a,Fs._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:s}=this.parent.viewport;return za.processDrawnLines({lines:e,pageWidth:i,pageHeight:n,rotation:s,innerMargin:Fs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:i}){e?this._drawingOptions=Fs.getDefaultDrawingOptions():(this._drawingOptions=Fs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:i,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(e),{isSignature:!0,areContours:l(this,uh),color:[0,0,0],thickness:l(this,uh)?0:s});return this.addComment(a),e?(a.paths={lines:i,points:n},a.uuid=l(this,hu),a.isCopy=!0):a.lines=i,l(this,Ua)&&(a.accessibilityData={type:"Figure",alt:l(this,Ua)}),a}static deserializeDraw(e,i,n,s,a,o){return o.areContours?tv.deserialize(e,i,n,s,a,o):t0.deserialize(e,i,n,s,a,o)}static async deserialize(e,i,n){var a;const s=await super.deserialize(e,i,n);return _(s,uh,e.areContours),s.description=((a=e.accessibilityData)==null?void 0:a.alt)||"",_(s,hu,e.uuid),s}};uh=new WeakMap,Ua=new WeakMap,dh=new WeakMap,hu=new WeakMap,bt(Fs,"_type","signature"),bt(Fs,"_editorType",ce.SIGNATURE),bt(Fs,"_defaultDrawingOptions",null);let rv=Fs;var xi,Sn,fh,Yo,ph,Lf,Ko,cu,Ha,Zs,Ef,Ue,Bp,jp,Nm,Tm,Im,ov,Fm,GS;class av extends gi{constructor(e){super({...e,name:"stampEditor"});C(this,Ue);C(this,xi,null);C(this,Sn,null);C(this,fh,null);C(this,Yo,null);C(this,ph,null);C(this,Lf,"");C(this,Ko,null);C(this,cu,!1);C(this,Ha,null);C(this,Zs,!1);C(this,Ef,!1);_(this,Yo,e.bitmapUrl),_(this,ph,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,i){gi.initialize(e,i)}static isHandlingMimeForPasting(e){return Bm.includes(e)}static paste(e,i){i.pasteEditor({mode:ce.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const i=e.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(e=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,h=await n.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const c=h.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var e;l(this,Sn)&&(_(this,xi,null),this._uiManager.imageManager.deleteId(l(this,Sn)),(e=l(this,Ko))==null||e.remove(),_(this,Ko,null),l(this,Ha)&&(clearTimeout(l(this,Ha)),_(this,Ha,null))),super.remove()}rebuild(){if(!this.parent){l(this,Sn)&&E(this,Ue,Nm).call(this);return}super.rebuild(),this.div!==null&&(l(this,Sn)&&l(this,Ko)===null&&E(this,Ue,Nm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(l(this,fh)||l(this,xi)||l(this,Yo)||l(this,ph)||l(this,Sn)||l(this,cu))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;return this._isCopy&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),l(this,cu)||(l(this,xi)?E(this,Ue,Tm).call(this):E(this,Ue,Nm).call(this)),this._isCopy&&this._moveAfterPaste(e,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,i){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,i);i.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(_(this,Sn,n),s&&_(this,xi,s),_(this,cu,!1),E(this,Ue,Tm).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,Ha)!==null&&clearTimeout(l(this,Ha)),_(this,Ha,setTimeout(()=>{_(this,Ha,null),E(this,Ue,ov).call(this)},200))}copyCanvas(e,i,n=!1){e||(e=224);const{width:s,height:a}=l(this,xi),o=new ea;let h=l(this,xi),c=s,u=a,p=null;if(i){if(s>i||a>i){const X=Math.min(i/s,i/a);c=Math.floor(s*X),u=Math.floor(a*X)}p=document.createElement("canvas");const f=p.width=Math.ceil(c*o.sx),A=p.height=Math.ceil(u*o.sy);l(this,Zs)||(h=E(this,Ue,Im).call(this,f,A));const v=p.getContext("2d");v.filter=this._uiManager.hcmFilter;let S="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":i4.isDarkMode&&(S="#8f8f9d",w="#42414d");const k=15,L=k*o.sx,P=k*o.sy,D=new OffscreenCanvas(L*2,P*2),H=D.getContext("2d");H.fillStyle=S,H.fillRect(0,0,L*2,P*2),H.fillStyle=w,H.fillRect(0,0,L,P),H.fillRect(L,P,L,P),v.fillStyle=v.createPattern(D,"repeat"),v.fillRect(0,0,f,A),v.drawImage(h,0,0,h.width,h.height,0,0,f,A)}let g=null;if(n){let f,A;if(o.symmetric&&h.width<e&&h.height<e)f=h.width,A=h.height;else if(h=l(this,xi),s>e||a>e){const w=Math.min(e/s,e/a);f=Math.floor(s*w),A=Math.floor(a*w),l(this,Zs)||(h=E(this,Ue,Im).call(this,f,A))}const S=new OffscreenCanvas(f,A).getContext("2d",{willReadFrequently:!0});S.drawImage(h,0,0,h.width,h.height,0,0,f,A),g={width:f,height:A,data:S.getImageData(0,0,f,A).data}}return{canvas:p,width:c,height:u,imageData:g}}static async deserialize(e,i,n){var S;let s=null,a=!1;if(e instanceof oS){const{data:{rect:w,rotation:k,id:L,structParent:P,popupRef:D,richText:H,contentsObj:X,creationDate:$,modificationDate:B},container:Z,parent:{page:{pageNumber:I}},canvas:j}=e;let K,Y;j?(delete e.canvas,{id:K,bitmap:Y}=n.imageManager.getFromCanvas(Z.id,j),j.remove()):(a=!0,e._hasNoCanvas=!0);const ot=((S=await i._structTree.getAriaAttributes(`${Ju}${L}`))==null?void 0:S.get("aria-label"))||"";s=e={annotationType:ce.STAMP,bitmapId:K,bitmap:Y,pageIndex:I-1,rect:w.slice(0),rotation:k,annotationElementId:L,id:L,deleted:!1,accessibilityData:{decorative:!1,altText:ot},isSvg:!1,structParent:P,popupRef:D,richText:H,comment:(X==null?void 0:X.str)||null,creationDate:$,modificationDate:B}}const o=await super.deserialize(e,i,n),{rect:h,bitmap:c,bitmapUrl:u,bitmapId:p,isSvg:g,accessibilityData:f}=e;a?(n.addMissingCanvas(e.id,o),_(o,cu,!0)):p&&n.imageManager.isValidId(p)?(_(o,Sn,p),c&&_(o,xi,c)):_(o,Yo,u),_(o,Zs,g);const[A,v]=o.pageDimensions;return o.width=(h[2]-h[0])/A,o.height=(h[3]-h[1])/v,f&&(o.altTextData=f),o._initialData=s,e.comment&&o.setCommentData(e),_(o,Ef,!!s),o}serialize(e=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:l(this,Sn),isSvg:l(this,Zs)});if(this.addComment(n),e)return n.bitmapUrl=E(this,Ue,Fm).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const h=E(this,Ue,GS).call(this,n);return h.isSame?null:(h.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(i===null)return n;i.stamps||(i.stamps=new Map);const o=l(this,Zs)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!i.stamps.has(l(this,Sn)))i.stamps.set(l(this,Sn),{area:o,serialized:n}),n.bitmap=E(this,Ue,Fm).call(this,!1);else if(l(this,Zs)){const h=i.stamps.get(l(this,Sn));o>h.area&&(h.area=o,h.serialized.bitmap.close(),h.serialized.bitmap=E(this,Ue,Fm).call(this,!1))}return n}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}xi=new WeakMap,Sn=new WeakMap,fh=new WeakMap,Yo=new WeakMap,ph=new WeakMap,Lf=new WeakMap,Ko=new WeakMap,cu=new WeakMap,Ha=new WeakMap,Zs=new WeakMap,Ef=new WeakMap,Ue=new WeakSet,Bp=function(e,i=!1){if(!e){this.remove();return}_(this,xi,e.bitmap),i||(_(this,Sn,e.id),_(this,Zs,e.isSvg)),e.file&&_(this,Lf,e.file.name),E(this,Ue,Tm).call(this)},jp=function(){if(_(this,fh,null),this._uiManager.enableWaiting(!1),!!l(this,Ko)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,xi)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,xi)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Nm=function(){if(l(this,Sn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,Sn)).then(n=>E(this,Ue,Bp).call(this,n,!0)).finally(()=>E(this,Ue,jp).call(this));return}if(l(this,Yo)){const n=l(this,Yo);_(this,Yo,null),this._uiManager.enableWaiting(!0),_(this,fh,this._uiManager.imageManager.getFromUrl(n).then(s=>E(this,Ue,Bp).call(this,s)).finally(()=>E(this,Ue,jp).call(this)));return}if(l(this,ph)){const n=l(this,ph);_(this,ph,null),this._uiManager.enableWaiting(!0),_(this,fh,this._uiManager.imageManager.getFromFile(n).then(s=>E(this,Ue,Bp).call(this,s)).finally(()=>E(this,Ue,jp).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Bm.join(",");const i=this._uiManager._signal;_(this,fh,new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),E(this,Ue,Bp).call(this,s)}n()},{signal:i}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:i})}).finally(()=>E(this,Ue,jp).call(this))),e.click()},Tm=function(){var c;const{div:e}=this;let{width:i,height:n}=l(this,xi);const[s,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*s,n=this.height*a;else if(i>o*s||n>o*a){const u=Math.min(o*s/i,o*a/n);i*=u,n*=u}this._uiManager.enableWaiting(!1);const h=_(this,Ko,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/s,this.height=n/a,this.setDims(),(c=this._initialOptions)!=null&&c.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),E(this,Ue,ov).call(this),l(this,Ef)||(this.parent.addUndoableEditor(this),_(this,Ef,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,Lf)&&this.div.setAttribute("aria-description",l(this,Lf)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Im=function(e,i){const{width:n,height:s}=l(this,xi);let a=n,o=s,h=l(this,xi);for(;a>2*e||o>2*i;){const c=a,u=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(a,o);p.getContext("2d").drawImage(h,0,0,c,u,0,0,a,o),h=p.transferToImageBitmap()}return h},ov=function(){const[e,i]=this.parentDimensions,{width:n,height:s}=this,a=new ea,o=Math.ceil(n*e*a.sx),h=Math.ceil(s*i*a.sy),c=l(this,Ko);if(!c||c.width===o&&c.height===h)return;c.width=o,c.height=h;const u=l(this,Zs)?l(this,xi):E(this,Ue,Im).call(this,o,h),p=c.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(u,0,0,u.width,u.height,0,0,o,h)},Fm=function(e){if(e){if(l(this,Zs)){const s=this._uiManager.imageManager.getSvgUrl(l(this,Sn));if(s)return s}const i=document.createElement("canvas");return{width:i.width,height:i.height}=l(this,xi),i.getContext("2d").drawImage(l(this,xi),0,0),i.toDataURL()}if(l(this,Zs)){const[i,n]=this.pageDimensions,s=Math.round(this.width*i*al.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*al.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(l(this,xi),0,0,l(this,xi).width,l(this,xi).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(l(this,xi))},GS=function(e){var o;const{pageIndex:i,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===i,a=(((o=e.accessibilityData)==null?void 0:o.alt)||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},bt(av,"_type","stamp"),bt(av,"_editorType",ce.STAMP);var uu,kf,gh,mh,Jo,As,bh,Pf,Nf,Zr,Zo,xn,Qo,vh,Tf,zt,yh,li,lv,VS,va,hv,cv,Mm;const Hr=class Hr{constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:n,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:h,viewport:c,l10n:u}){C(this,li);C(this,uu);C(this,kf,!1);C(this,gh,null);C(this,mh,null);C(this,Jo,null);C(this,As,new Map);C(this,bh,!1);C(this,Pf,!1);C(this,Nf,!1);C(this,Zr,null);C(this,Zo,null);C(this,xn,null);C(this,Qo,null);C(this,vh,null);C(this,Tf,-1);C(this,zt);const p=[...l(Hr,yh).values()];if(!Hr._initialized){Hr._initialized=!0;for(const g of p)g.initialize(u,t)}t.registerEditorTypes(p),_(this,zt,t),this.pageIndex=e,this.div=i,_(this,uu,s),_(this,gh,a),this.viewport=c,_(this,xn,h),this.drawLayer=o,this._structTree=n,l(this,zt).addLayer(this)}get isEmpty(){return l(this,As).size===0}get isInvisible(){return this.isEmpty&&l(this,zt).getMode()===ce.NONE}updateToolbar(t){l(this,zt).updateToolbar(t)}updateMode(t=l(this,zt).getMode()){switch(E(this,li,Mm).call(this),t){case ce.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ce.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ce.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===ce.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of l(Hr,yh).values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=l(this,xn))==null?void 0:e.div)}setEditingState(t){l(this,zt).setEditingState(t)}addCommands(t){l(this,zt).addCommands(t)}cleanUndoStack(t){l(this,zt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=l(this,gh))==null||e.togglePointerEvents(t)}async enable(){var i;_(this,Nf,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(i=l(this,vh))==null||i.abort(),_(this,vh,null);const t=new Set;for(const n of l(this,li,lv))n.enableEditing(),n.show(!0),n.annotationElementId&&(l(this,zt).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));const e=l(this,gh);if(e)for(const n of e.getEditableAnnotations()){if(n.hide(),l(this,zt).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}_(this,Nf,!1),l(this,zt)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var n;if(_(this,Pf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),l(this,xn)&&!l(this,vh)){_(this,vh,new AbortController);const s=l(this,zt).combinedSignal(l(this,vh));l(this,xn).div.addEventListener("pointerdown",a=>{const{clientX:h,clientY:c,timeStamp:u}=a,p=l(this,Tf);if(u-p>500){_(this,Tf,u);return}_(this,Tf,-1);const{classList:g}=this.div;g.toggle("getElements",!0);const f=document.elementsFromPoint(h,c);if(g.toggle("getElements",!1),!this.div.contains(f[0]))return;let A;const v=new RegExp(`^${Xp}[0-9]+$`);for(const w of f)if(v.test(w.id)){A=w.id;break}if(!A)return;const S=l(this,As).get(A);(S==null?void 0:S.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),S.dblclick(a))},{signal:s,capture:!0})}const t=l(this,gh),e=[];if(t){const s=new Map,a=new Map;for(const h of l(this,li,lv)){if(h.disableEditing(),!h.annotationElementId){e.push(h);continue}if(h.serialize()!==null){s.set(h.annotationElementId,h);continue}else a.set(h.annotationElementId,h);(n=this.getEditableAnnotation(h.annotationElementId))==null||n.show(),h.remove()}const o=t.getEditableAnnotations();for(const h of o){const{id:c}=h.data;if(l(this,zt).isDeletedAnnotationElement(c)){h.updateEdited({deleted:!0});continue}let u=a.get(c);if(u){u.resetAnnotationElement(h),u.show(!1),h.show();continue}u=s.get(c),u&&(l(this,zt).addChangedExistingAnnotation(u),u.renderAnnotationElement(h)&&u.show(!1)),h.show()}}E(this,li,Mm).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of l(Hr,yh).values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t==null||t.updateFakeAnnotations(e),_(this,Pf,!1)}getEditableAnnotation(t){var e;return((e=l(this,gh))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){l(this,zt).getActive()!==t&&l(this,zt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=l(this,xn))!=null&&t.div&&!l(this,Qo)){_(this,Qo,new AbortController);const e=l(this,zt).combinedSignal(l(this,Qo));l(this,xn).div.addEventListener("pointerdown",E(this,li,VS).bind(this),{signal:e}),l(this,xn).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=l(this,xn))!=null&&t.div&&l(this,Qo)&&(l(this,Qo).abort(),_(this,Qo,null),l(this,xn).div.classList.remove("highlighting"))}enableClick(){if(l(this,mh))return;_(this,mh,new AbortController);const t=l(this,zt).combinedSignal(l(this,mh));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=l(this,mh))==null||t.abort(),_(this,mh,null)}attach(t){l(this,As).set(t.id,t);const{annotationElementId:e}=t;e&&l(this,zt).isDeletedAnnotationElement(e)&&l(this,zt).removeDeletedAnnotationElement(t)}detach(t){var e;l(this,As).delete(t.id),(e=l(this,uu))==null||e.removePointerInTextLayer(t.contentDiv),!l(this,Pf)&&t.annotationElementId&&l(this,zt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),l(this,zt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(l(this,zt).addDeletedAnnotationElement(t),gi.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),l(this,zt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!l(this,Nf)),l(this,zt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var i;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!l(this,Jo)&&(t._focusEventsAllowed=!1,_(this,Jo,setTimeout(()=>{_(this,Jo,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:l(this,zt)._signal}),e.focus())},0))),t._structTreeParentId=(i=l(this,uu))==null?void 0:i.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of l(this,As).values())if(e.uid===t)return e;return null}getNextId(){return l(this,zt).getId()}combinedSignal(t){return l(this,zt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=l(this,li,va))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await l(this,zt).updateMode(t.mode);const{offsetX:i,offsetY:n}=E(this,li,cv).call(this),s=this.getNextId(),a=E(this,li,hv).call(this,{parent:this,id:s,x:i,y:n,uiManager:l(this,zt),isCentered:!0,...e});a&&this.add(a)}async deserialize(t){var e;return await((e=l(Hr,yh).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,l(this,zt)))||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),s=E(this,li,hv).call(this,{parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:l(this,zt),isCentered:e,...i});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(t={}){this.createAndAddNewEditor(E(this,li,cv).call(this),!0,t)}setSelected(t){l(this,zt).setSelected(t)}toggleSelected(t){l(this,zt).toggleSelected(t)}unselect(t){l(this,zt).unselect(t)}pointerup(t){var n;const{isMac:e}=en.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!l(this,bh)||(_(this,bh,!1),(n=l(this,li,va))!=null&&n.isDrawer&&l(this,li,va).supportMultipleDrawings))return;if(!l(this,kf)){_(this,kf,!0);return}const i=l(this,zt).getMode();if(i===ce.STAMP||i===ce.SIGNATURE){l(this,zt).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var n;if(l(this,zt).getMode()===ce.HIGHLIGHT&&this.enableTextSelection(),l(this,bh)){_(this,bh,!1);return}const{isMac:e}=en.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(_(this,bh,!0),(n=l(this,li,va))!=null&&n.isDrawer){this.startDrawingSession(t);return}const i=l(this,zt).getActive();_(this,kf,!i||i.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),l(this,Zr)){l(this,li,va).startDrawing(this,l(this,zt),!1,t);return}l(this,zt).setCurrentDrawingSession(this),_(this,Zr,new AbortController);const e=l(this,zt).combinedSignal(l(this,Zr));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(_(this,Zo,null),this.commitOrRemove())},{signal:e}),l(this,li,va).startDrawing(this,l(this,zt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&_(this,Zo,e);return}l(this,Zo)&&setTimeout(()=>{var e;(e=l(this,Zo))==null||e.focus(),_(this,Zo,null)},0)}endDrawingSession(t=!1){return l(this,Zr)?(l(this,zt).setCurrentDrawingSession(null),l(this,Zr).abort(),_(this,Zr,null),_(this,Zo,null),l(this,li,va).endDrawing(t)):null}findNewParent(t,e,i){const n=l(this,zt).findParent(e,i);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return l(this,Zr)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,Zr)&&l(this,li,va).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=l(this,zt).getActive())==null?void 0:t.parent)===this&&(l(this,zt).commitOrRemove(),l(this,zt).setActiveEditor(null)),l(this,Jo)&&(clearTimeout(l(this,Jo)),_(this,Jo,null));for(const i of l(this,As).values())(e=l(this,uu))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,l(this,As).clear(),l(this,zt).removeLayer(this)}render({viewport:t}){this.viewport=t,_h(this.div,t);for(const e of l(this,zt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){l(this,zt).commitOrRemove(),E(this,li,Mm).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,_h(this.div,{rotation:i}),e!==i)for(const n of l(this,As).values())n.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return l(this,zt).viewParameters.realScale}};uu=new WeakMap,kf=new WeakMap,gh=new WeakMap,mh=new WeakMap,Jo=new WeakMap,As=new WeakMap,bh=new WeakMap,Pf=new WeakMap,Nf=new WeakMap,Zr=new WeakMap,Zo=new WeakMap,xn=new WeakMap,Qo=new WeakMap,vh=new WeakMap,Tf=new WeakMap,zt=new WeakMap,yh=new WeakMap,li=new WeakSet,lv=function(){return l(this,As).size!==0?l(this,As).values():l(this,zt).getEditors(this.pageIndex)},VS=function(t){l(this,zt).unselectAll();const{target:e}=t;if(e===l(this,xn).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&l(this,xn).div.contains(e)){const{isMac:i}=en.platform;if(t.button!==0||t.ctrlKey&&i)return;l(this,zt).showAllEditors("highlight",!0,!0),l(this,xn).div.classList.add("free"),this.toggleDrawing(),Vm.startHighlighting(this,l(this,zt).direction==="ltr",{target:l(this,xn).div,x:t.x,y:t.y}),l(this,xn).div.addEventListener("pointerup",()=>{l(this,xn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,zt)._signal}),t.preventDefault()}},va=function(){return l(Hr,yh).get(l(this,zt).getMode())},hv=function(t){const e=l(this,li,va);return e?new e.prototype.constructor(t):null},cv=function(){const{x:t,y:e,width:i,height:n}=this.boundingClientRect,s=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+i),h=Math.min(window.innerHeight,e+n),c=(s+o)/2-t,u=(a+h)/2-e,[p,g]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:p,offsetY:g}},Mm=function(){for(const t of l(this,As).values())t.isEmpty()&&t.remove()},bt(Hr,"_initialized",!1),C(Hr,yh,new Map([zb,Qb,av,Vm,rv].map(t=>[t._editorType,t])));let Xm=Hr;var Qr,ls,du,$1,w2,$S,Ga,uv,XS,dv;const dn=class dn{constructor({pageIndex:t}){C(this,Ga);C(this,Qr,null);C(this,ls,new Map);C(this,du,new Map);this.pageIndex=t}setParent(t){if(!l(this,Qr)){_(this,Qr,t);return}if(l(this,Qr)!==t){if(l(this,ls).size>0)for(const e of l(this,ls).values())e.remove(),t.append(e);_(this,Qr,t)}}static get _svgFactory(){return le(this,"_svgFactory",new tg)}draw(t,e=!1,i=!1){const n=cn(dn,$1)._++,s=E(this,Ga,uv).call(this),a=dn._svgFactory.createElement("defs");s.append(a);const o=dn._svgFactory.createElement("path");a.append(o);const h=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",h),o.setAttribute("vector-effect","non-scaling-stroke"),e&&l(this,du).set(n,o);const c=i?E(this,Ga,XS).call(this,a,h):null,u=dn._svgFactory.createElement("use");return s.append(u),u.setAttribute("href",`#${h}`),this.updateProperties(s,t),l(this,ls).set(n,s),{id:n,clipPathId:`url(#${c})`}}drawOutline(t,e){const i=cn(dn,$1)._++,n=E(this,Ga,uv).call(this),s=dn._svgFactory.createElement("defs");n.append(s);const a=dn._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const p=dn._svgFactory.createElement("mask");s.append(p),h=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",h),p.setAttribute("maskUnits","objectBoundingBox");const g=dn._svgFactory.createElement("rect");p.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const f=dn._svgFactory.createElement("use");p.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=dn._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${o}`),h&&c.setAttribute("mask",`url(#${h})`);const u=c.cloneNode();return n.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(n,t),l(this,ls).set(i,n),i}finalizeDraw(t,e){l(this,du).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var h;if(!e)return;const{root:i,bbox:n,rootClass:s,path:a}=e,o=typeof t=="number"?l(this,ls).get(t):t;if(o){if(i&&E(this,Ga,dv).call(this,o,i),n&&E(h=dn,w2,$S).call(h,o,n),s){const{classList:c}=o;for(const[u,p]of Object.entries(s))c.toggle(u,p)}if(a){const u=o.firstElementChild.firstElementChild;E(this,Ga,dv).call(this,u,a)}}}updateParent(t,e){if(e===this)return;const i=l(this,ls).get(t);i&&(l(e,Qr).append(i),l(this,ls).delete(t),l(e,ls).set(t,i))}remove(t){l(this,du).delete(t),l(this,Qr)!==null&&(l(this,ls).get(t).remove(),l(this,ls).delete(t))}destroy(){_(this,Qr,null);for(const t of l(this,ls).values())t.remove();l(this,ls).clear(),l(this,du).clear()}};Qr=new WeakMap,ls=new WeakMap,du=new WeakMap,$1=new WeakMap,w2=new WeakSet,$S=function(t,[e,i,n,s]){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*s}%`},Ga=new WeakSet,uv=function(){const t=dn._svgFactory.create(1,1,!0);return l(this,Qr).append(t),t.setAttribute("aria-hidden",!0),t},XS=function(t,e){const i=dn._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const s=dn._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),n},dv=function(t,e){for(const[i,n]of Object.entries(e))n===null?t.removeAttribute(i):t.setAttribute(i,n)},C(dn,w2),C(dn,$1,0);let Ym=dn;globalThis._pdfjsTestingUtils={HighlightOutliner:Gb};globalThis.pdfjsLib={AbortException:rl,AnnotationEditorLayer:Xm,AnnotationEditorParamsType:Te,AnnotationEditorType:ce,AnnotationEditorUIManager:Sh,AnnotationLayer:Wm,AnnotationMode:tl,AnnotationType:Wi,applyOpacity:HA,build:Y_,ColorPicker:Qp,createValidAbsoluteUrl:Lv,CSSConstants:UA,DOMSVGFactory:tg,DrawLayer:Ym,FeatureTest:en,fetchData:Rf,findContrastColor:qA,getDocument:G_,getFilenameFromUrl:OA,getPdfFilenameFromUrl:BA,getRGB:Df,getUuid:kv,getXfaPageViewport:jA,GlobalWorkerOptions:qa,ImageKind:Up,InvalidPDFException:Om,isDataScheme:J1,isPdfFile:x2,isValidExplicitDest:x_,MathClamp:Qn,noContextMenu:sr,normalizeUnicode:RA,OPS:If,OutputScale:ea,PasswordResponses:FA,PDFDataRangeTransport:Mv,PDFDateString:Jp,PDFWorker:Mf,PermissionFlag:IA,PixelsPerInch:al,RenderingCancelledException:S2,renderRichText:Nv,ResponseException:Yp,setLayerDimensions:_h,shadow:le,SignatureExtractor:za,stopEvent:ki,SupportedImageMimeTypes:Bm,TextLayer:Ff,TouchManager:Zp,updateUrlHash:Ev,Util:Mt,VerbosityLevel:X1,version:X_,XfaLayer:Pv};const Z6=Object.freeze(Object.defineProperty({__proto__:null,AbortException:rl,AnnotationEditorLayer:Xm,AnnotationEditorParamsType:Te,AnnotationEditorType:ce,AnnotationEditorUIManager:Sh,AnnotationLayer:Wm,AnnotationMode:tl,AnnotationType:Wi,CSSConstants:UA,ColorPicker:Qp,DOMSVGFactory:tg,DrawLayer:Ym,FeatureTest:en,GlobalWorkerOptions:qa,ImageKind:Up,InvalidPDFException:Om,MathClamp:Qn,OPS:If,OutputScale:ea,PDFDataRangeTransport:Mv,PDFDateString:Jp,PDFWorker:Mf,PasswordResponses:FA,PermissionFlag:IA,PixelsPerInch:al,RenderingCancelledException:S2,ResponseException:Yp,SignatureExtractor:za,SupportedImageMimeTypes:Bm,TextLayer:Ff,TouchManager:Zp,Util:Mt,VerbosityLevel:X1,XfaLayer:Pv,applyOpacity:HA,build:Y_,createValidAbsoluteUrl:Lv,fetchData:Rf,findContrastColor:qA,getDocument:G_,getFilenameFromUrl:OA,getPdfFilenameFromUrl:BA,getRGB:Df,getUuid:kv,getXfaPageViewport:jA,isDataScheme:J1,isPdfFile:x2,isValidExplicitDest:x_,noContextMenu:sr,normalizeUnicode:RA,renderRichText:Nv,setLayerDimensions:_h,shadow:le,stopEvent:ki,updateUrlHash:Ev,version:X_},Symbol.toStringTag,{value:"Module"}));function Ke(r){"@babel/helpers - typeof";return Ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(r)}var ia=Uint8Array,ir=Uint16Array,jv=Int32Array,Uv=new ia([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Hv=new ia([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hw=new ia([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),YS=function(r,t){for(var e=new ir(31),i=0;i<31;++i)e[i]=t+=1<<r[i-1];for(var n=new jv(e[30]),i=1;i<30;++i)for(var s=e[i];s<e[i+1];++s)n[s]=s-e[i]<<5|i;return{b:e,r:n}},KS=YS(Uv,2),NC=KS.b,fv=KS.r;NC[28]=258,fv[258]=28;var TC=YS(Hv,0),cw=TC.r,pv=new ir(32768);for(var vi=0;vi<32768;++vi){var Ll=(vi&43690)>>1|(vi&21845)<<1;Ll=(Ll&52428)>>2|(Ll&13107)<<2,Ll=(Ll&61680)>>4|(Ll&3855)<<4,pv[vi]=((Ll&65280)>>8|(Ll&255)<<8)>>1}var Hp=(function(r,t,e){for(var i=r.length,n=0,s=new ir(t);n<i;++n)r[n]&&++s[r[n]-1];var a=new ir(t);for(n=1;n<t;++n)a[n]=a[n-1]+s[n-1]<<1;var o;if(e){o=new ir(1<<t);var h=15-t;for(n=0;n<i;++n)if(r[n])for(var c=n<<4|r[n],u=t-r[n],p=a[r[n]-1]++<<u,g=p|(1<<u)-1;p<=g;++p)o[pv[p]>>h]=c}else for(o=new ir(i),n=0;n<i;++n)r[n]&&(o[n]=pv[a[r[n]-1]++]>>15-r[n]);return o}),vu=new ia(288);for(var vi=0;vi<144;++vi)vu[vi]=8;for(var vi=144;vi<256;++vi)vu[vi]=9;for(var vi=256;vi<280;++vi)vu[vi]=7;for(var vi=280;vi<288;++vi)vu[vi]=8;var Km=new ia(32);for(var vi=0;vi<32;++vi)Km[vi]=5;var IC=Hp(vu,9,0),FC=Hp(Km,5,0),JS=function(r){return(r+7)/8|0},MC=function(r,t,e){return(e==null||e>r.length)&&(e=r.length),new ia(r.subarray(t,e))},uo=function(r,t,e){e<<=t&7;var i=t/8|0;r[i]|=e,r[i+1]|=e>>8},bp=function(r,t,e){e<<=t&7;var i=t/8|0;r[i]|=e,r[i+1]|=e>>8,r[i+2]|=e>>16},y5=function(r,t){for(var e=[],i=0;i<r.length;++i)r[i]&&e.push({s:i,f:r[i]});var n=e.length,s=e.slice();if(!n)return{t:QS,l:0};if(n==1){var a=new ia(e[0].s+1);return a[e[0].s]=1,{t:a,l:1}}e.sort(function(D,H){return D.f-H.f}),e.push({s:-1,f:25001});var o=e[0],h=e[1],c=0,u=1,p=2;for(e[0]={s:-1,f:o.f+h.f,l:o,r:h};u!=n-1;)o=e[e[c].f<e[p].f?c++:p++],h=e[c!=u&&e[c].f<e[p].f?c++:p++],e[u++]={s:-1,f:o.f+h.f,l:o,r:h};for(var g=s[0].s,i=1;i<n;++i)s[i].s>g&&(g=s[i].s);var f=new ir(g+1),A=gv(e[u-1],f,0);if(A>t){var i=0,v=0,S=A-t,w=1<<S;for(s.sort(function(H,X){return f[X.s]-f[H.s]||H.f-X.f});i<n;++i){var k=s[i].s;if(f[k]>t)v+=w-(1<<A-f[k]),f[k]=t;else break}for(v>>=S;v>0;){var L=s[i].s;f[L]<t?v-=1<<t-f[L]++-1:++i}for(;i>=0&&v;--i){var P=s[i].s;f[P]==t&&(--f[P],++v)}A=t}return{t:new ia(f),l:A}},gv=function(r,t,e){return r.s==-1?Math.max(gv(r.l,t,e+1),gv(r.r,t,e+1)):t[r.s]=e},uw=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new ir(++t),i=0,n=r[0],s=1,a=function(h){e[i++]=h},o=1;o<=t;++o)if(r[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=r[o]}return{c:e.subarray(0,i),n:t}},vp=function(r,t){for(var e=0,i=0;i<t.length;++i)e+=r[i]*t[i];return e},ZS=function(r,t,e){var i=e.length,n=JS(t+2);r[n]=i&255,r[n+1]=i>>8,r[n+2]=r[n]^255,r[n+3]=r[n+1]^255;for(var s=0;s<i;++s)r[n+s+4]=e[s];return(n+4+i)*8},dw=function(r,t,e,i,n,s,a,o,h,c,u){uo(t,u++,e),++n[256];for(var p=y5(n,15),g=p.t,f=p.l,A=y5(s,15),v=A.t,S=A.l,w=uw(g),k=w.c,L=w.n,P=uw(v),D=P.c,H=P.n,X=new ir(19),$=0;$<k.length;++$)++X[k[$]&31];for(var $=0;$<D.length;++$)++X[D[$]&31];for(var B=y5(X,7),Z=B.t,I=B.l,j=19;j>4&&!Z[hw[j-1]];--j);var K=c+5<<3,Y=vp(n,vu)+vp(s,Km)+a,ot=vp(n,g)+vp(s,v)+a+14+3*j+vp(X,Z)+2*X[16]+3*X[17]+7*X[18];if(h>=0&&K<=Y&&K<=ot)return ZS(t,u,r.subarray(h,h+c));var rt,lt,st,ft;if(uo(t,u,1+(ot<Y)),u+=2,ot<Y){rt=Hp(g,f,0),lt=g,st=Hp(v,S,0),ft=v;var Ct=Hp(Z,I,0);uo(t,u,L-257),uo(t,u+5,H-1),uo(t,u+10,j-4),u+=14;for(var $=0;$<j;++$)uo(t,u+3*$,Z[hw[$]]);u+=3*j;for(var At=[k,D],F=0;F<2;++F)for(var z=At[F],$=0;$<z.length;++$){var J=z[$]&31;uo(t,u,Ct[J]),u+=Z[J],J>15&&(uo(t,u,z[$]>>5&127),u+=z[$]>>12)}}else rt=IC,lt=vu,st=FC,ft=Km;for(var $=0;$<o;++$){var Q=i[$];if(Q>255){var J=Q>>18&31;bp(t,u,rt[J+257]),u+=lt[J+257],J>7&&(uo(t,u,Q>>23&31),u+=Uv[J]);var it=Q&31;bp(t,u,st[it]),u+=ft[it],it>3&&(bp(t,u,Q>>5&8191),u+=Hv[it])}else bp(t,u,rt[Q]),u+=lt[Q]}return bp(t,u,rt[256]),u+lt[256]},RC=new jv([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),QS=new ia(0),DC=function(r,t,e,i,n,s){var a=s.z||r.length,o=new ia(i+a+5*(1+Math.ceil(a/7e3))+n),h=o.subarray(i,o.length-n),c=s.l,u=(s.r||0)&7;if(t){u&&(h[0]=s.r>>3);for(var p=RC[t-1],g=p>>13,f=p&8191,A=(1<<e)-1,v=s.p||new ir(32768),S=s.h||new ir(A+1),w=Math.ceil(e/3),k=2*w,L=function(Xt){return(r[Xt]^r[Xt+1]<<w^r[Xt+2]<<k)&A},P=new jv(25e3),D=new ir(288),H=new ir(32),X=0,$=0,B=s.i||0,Z=0,I=s.w||0,j=0;B+2<a;++B){var K=L(B),Y=B&32767,ot=S[K];if(v[Y]=ot,S[K]=Y,I<=B){var rt=a-B;if((X>7e3||Z>24576)&&(rt>423||!c)){u=dw(r,h,0,P,D,H,$,Z,j,B-j,u),Z=X=$=0,j=B;for(var lt=0;lt<286;++lt)D[lt]=0;for(var lt=0;lt<30;++lt)H[lt]=0}var st=2,ft=0,Ct=f,At=Y-ot&32767;if(rt>2&&K==L(B-At))for(var F=Math.min(g,rt)-1,z=Math.min(32767,B),J=Math.min(258,rt);At<=z&&--Ct&&Y!=ot;){if(r[B+st]==r[B+st-At]){for(var Q=0;Q<J&&r[B+Q]==r[B+Q-At];++Q);if(Q>st){if(st=Q,ft=At,Q>F)break;for(var it=Math.min(At,Q-2),at=0,lt=0;lt<it;++lt){var pt=B-At+lt&32767,gt=v[pt],yt=pt-gt&32767;yt>at&&(at=yt,ot=pt)}}}Y=ot,ot=v[Y],At+=Y-ot&32767}if(ft){P[Z++]=268435456|fv[st]<<18|cw[ft];var Lt=fv[st]&31,Tt=cw[ft]&31;$+=Uv[Lt]+Hv[Tt],++D[257+Lt],++H[Tt],I=B+st,++X}else P[Z++]=r[B],++D[r[B]]}}for(B=Math.max(B,I);B<a;++B)P[Z++]=r[B],++D[r[B]];u=dw(r,h,c,P,D,H,$,Z,j,B-j,u),c||(s.r=u&7|h[u/8|0]<<3,u-=7,s.h=S,s.p=v,s.i=B,s.w=I)}else{for(var B=s.w||0;B<a+c;B+=65535){var It=B+65535;It>=a&&(h[u/8|0]=c,It=a),u=ZS(h,u+1,r.subarray(B,It))}s.i=a}return MC(o,0,i+JS(u)+n)},t3=function(){var r=1,t=0;return{p:function(e){for(var i=r,n=t,s=e.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)n+=i+=e[a];i=(i&65535)+15*(i>>16),n=(n&65535)+15*(n>>16)}r=i,t=n},d:function(){return r%=65521,t%=65521,(r&255)<<24|(r&65280)<<8|(t&255)<<8|t>>8}}},OC=function(r,t,e,i,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new ia(s.length+r.length);a.set(s),a.set(r,s.length),r=a,n.w=s.length}return DC(r,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+t.mem,e,i,n)},e3=function(r,t,e){for(;e;++t)r[t]=e,e>>>=8},BC=function(r,t){var e=t.level,i=e==0?0:e<6?1:e==9?3:2;if(r[0]=120,r[1]=i<<6|(t.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,t.dictionary){var n=t3();n.p(t.dictionary),e3(r,2,n.d())}};function mv(r,t){t||(t={});var e=t3();e.p(r);var i=OC(r,t,t.dictionary?6:2,4);return BC(i,t),e3(i,i.length-4,e.d()),i}var jC=typeof TextDecoder<"u"&&new TextDecoder,UC=0;try{jC.decode(QS,{stream:!0}),UC=1}catch{}function HC(r){if(Array.isArray(r))return r}function qC(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var i,n,s,a,o=[],h=!0,c=!1;try{if(s=(e=e.call(r)).next,t!==0)for(;!(h=(i=s.call(e)).done)&&(o.push(i.value),o.length!==t);h=!0);}catch(u){c=!0,n=u}finally{try{if(!h&&e.return!=null&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw n}}return o}}function fw(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,i=Array(t);e<t;e++)i[e]=r[e];return i}function zC(r,t){if(r){if(typeof r=="string")return fw(r,t);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?fw(r,t):void 0}}function WC(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pw(r,t){return HC(r)||qC(r,t)||zC(r,t)||WC()}function gw(r,t="utf8"){return new TextDecoder(t).decode(r)}const GC=new TextEncoder;function VC(r){return GC.encode(r)}const $C=1024*8,XC=(()=>{const r=new Uint8Array(4),t=new Uint32Array(r.buffer);return!((t[0]=1)&r[0])})(),w5={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class qv{constructor(t=$C,e={}){bt(this,"buffer");bt(this,"byteLength");bt(this,"byteOffset");bt(this,"length");bt(this,"offset");bt(this,"lastWrittenByte");bt(this,"littleEndian");bt(this,"_data");bt(this,"_mark");bt(this,"_marks");let i=!1;typeof t=="number"?t=new ArrayBuffer(t):(i=!0,this.lastWrittenByte=t.byteLength);const n=e.offset?e.offset>>>0:0,s=t.byteLength-n;let a=n;(ArrayBuffer.isView(t)||t instanceof qv)&&(t.byteLength!==t.buffer.byteLength&&(a=t.byteOffset+n),t=t.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const i=(this.offset+t)*2,n=new Uint8Array(i);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const i=w5[e].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+i);if(this.littleEndian===XC&&e!=="uint8"&&e!=="int8"){const o=new Uint8Array(this.buffer.slice(n,n+i));o.reverse();const h=new w5[e](o.buffer);return this.offset+=i,h.reverse(),h}const a=new w5[e](s);return this.offset+=i,a}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let i=0;i<t;i++)e+=this.readChar();return e}readUtf8(t=1){return gw(this.readBytes(t))}decodeText(t=1,e="utf8"){return gw(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(VC(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Of(r){let t=r.length;for(;--t>=0;)r[t]=0}const YC=3,KC=258,i3=29,JC=256,ZC=JC+1+i3,n3=30,QC=512,tL=new Array((ZC+2)*2);Of(tL);const eL=new Array(n3*2);Of(eL);const iL=new Array(QC);Of(iL);const nL=new Array(KC-YC+1);Of(nL);const sL=new Array(i3);Of(sL);const rL=new Array(n3);Of(rL);const aL=(r,t,e,i)=>{let n=r&65535|0,s=r>>>16&65535|0,a=0;for(;e!==0;){a=e>2e3?2e3:e,e-=a;do n=n+t[i++]|0,s=s+n|0;while(--a);n%=65521,s%=65521}return n|s<<16|0};var bv=aL;const oL=()=>{let r,t=[];for(var e=0;e<256;e++){r=e;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;t[e]=r}return t},lL=new Uint32Array(oL()),hL=(r,t,e,i)=>{const n=lL,s=i+e;r^=-1;for(let a=i;a<s;a++)r=r>>>8^n[(r^t[a])&255];return r^-1};var ba=hL,vv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},s3={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const cL=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var uL=function(r){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const i in e)cL(e,i)&&(r[i]=e[i])}}return r},dL=r=>{let t=0;for(let i=0,n=r.length;i<n;i++)t+=r[i].length;const e=new Uint8Array(t);for(let i=0,n=0,s=r.length;i<s;i++){let a=r[i];e.set(a,n),n+=a.length}return e},r3={assign:uL,flattenChunks:dL};let a3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a3=!1}const eg=new Uint8Array(256);for(let r=0;r<256;r++)eg[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;eg[254]=eg[254]=1;var fL=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let t,e,i,n,s,a=r.length,o=0;for(n=0;n<a;n++)e=r.charCodeAt(n),(e&64512)===55296&&n+1<a&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),n++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(o),s=0,n=0;s<o;n++)e=r.charCodeAt(n),(e&64512)===55296&&n+1<a&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),n++)),e<128?t[s++]=e:e<2048?(t[s++]=192|e>>>6,t[s++]=128|e&63):e<65536?(t[s++]=224|e>>>12,t[s++]=128|e>>>6&63,t[s++]=128|e&63):(t[s++]=240|e>>>18,t[s++]=128|e>>>12&63,t[s++]=128|e>>>6&63,t[s++]=128|e&63);return t};const pL=(r,t)=>{if(t<65534&&r.subarray&&a3)return String.fromCharCode.apply(null,r.length===t?r:r.subarray(0,t));let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(r[i]);return e};var gL=(r,t)=>{const e=t||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,t));let i,n;const s=new Array(e*2);for(n=0,i=0;i<e;){let a=r[i++];if(a<128){s[n++]=a;continue}let o=eg[a];if(o>4){s[n++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<e;)a=a<<6|r[i++]&63,o--;if(o>1){s[n++]=65533;continue}a<65536?s[n++]=a:(a-=65536,s[n++]=55296|a>>10&1023,s[n++]=56320|a&1023)}return pL(s,n)},mL=(r,t)=>{t=t||r.length,t>r.length&&(t=r.length);let e=t-1;for(;e>=0&&(r[e]&192)===128;)e--;return e<0||e===0?t:e+eg[r[e]]>t?e:t},yv={string2buf:fL,buf2string:gL,utf8border:mL};function bL(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var vL=bL;const $0=16209,yL=16191;var wL=function(t,e){let i,n,s,a,o,h,c,u,p,g,f,A,v,S,w,k,L,P,D,H,X,$,B,Z;const I=t.state;i=t.next_in,B=t.input,n=i+(t.avail_in-5),s=t.next_out,Z=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),h=I.dmax,c=I.wsize,u=I.whave,p=I.wnext,g=I.window,f=I.hold,A=I.bits,v=I.lencode,S=I.distcode,w=(1<<I.lenbits)-1,k=(1<<I.distbits)-1;t:do{A<15&&(f+=B[i++]<<A,A+=8,f+=B[i++]<<A,A+=8),L=v[f&w];e:for(;;){if(P=L>>>24,f>>>=P,A-=P,P=L>>>16&255,P===0)Z[s++]=L&65535;else if(P&16){D=L&65535,P&=15,P&&(A<P&&(f+=B[i++]<<A,A+=8),D+=f&(1<<P)-1,f>>>=P,A-=P),A<15&&(f+=B[i++]<<A,A+=8,f+=B[i++]<<A,A+=8),L=S[f&k];i:for(;;){if(P=L>>>24,f>>>=P,A-=P,P=L>>>16&255,P&16){if(H=L&65535,P&=15,A<P&&(f+=B[i++]<<A,A+=8,A<P&&(f+=B[i++]<<A,A+=8)),H+=f&(1<<P)-1,H>h){t.msg="invalid distance too far back",I.mode=$0;break t}if(f>>>=P,A-=P,P=s-a,H>P){if(P=H-P,P>u&&I.sane){t.msg="invalid distance too far back",I.mode=$0;break t}if(X=0,$=g,p===0){if(X+=c-P,P<D){D-=P;do Z[s++]=g[X++];while(--P);X=s-H,$=Z}}else if(p<P){if(X+=c+p-P,P-=p,P<D){D-=P;do Z[s++]=g[X++];while(--P);if(X=0,p<D){P=p,D-=P;do Z[s++]=g[X++];while(--P);X=s-H,$=Z}}}else if(X+=p-P,P<D){D-=P;do Z[s++]=g[X++];while(--P);X=s-H,$=Z}for(;D>2;)Z[s++]=$[X++],Z[s++]=$[X++],Z[s++]=$[X++],D-=3;D&&(Z[s++]=$[X++],D>1&&(Z[s++]=$[X++]))}else{X=s-H;do Z[s++]=Z[X++],Z[s++]=Z[X++],Z[s++]=Z[X++],D-=3;while(D>2);D&&(Z[s++]=Z[X++],D>1&&(Z[s++]=Z[X++]))}}else if((P&64)===0){L=S[(L&65535)+(f&(1<<P)-1)];continue i}else{t.msg="invalid distance code",I.mode=$0;break t}break}}else if((P&64)===0){L=v[(L&65535)+(f&(1<<P)-1)];continue e}else if(P&32){I.mode=yL;break t}else{t.msg="invalid literal/length code",I.mode=$0;break t}break}}while(i<n&&s<o);D=A>>3,i-=D,A-=D<<3,f&=(1<<A)-1,t.next_in=i,t.next_out=s,t.avail_in=i<n?5+(n-i):5-(i-n),t.avail_out=s<o?257+(o-s):257-(s-o),I.hold=f,I.bits=A};const Bu=15,mw=852,bw=592,vw=0,A5=1,yw=2,AL=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_L=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),SL=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xL=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),CL=(r,t,e,i,n,s,a,o)=>{const h=o.bits;let c=0,u=0,p=0,g=0,f=0,A=0,v=0,S=0,w=0,k=0,L,P,D,H,X,$=null,B;const Z=new Uint16Array(Bu+1),I=new Uint16Array(Bu+1);let j=null,K,Y,ot;for(c=0;c<=Bu;c++)Z[c]=0;for(u=0;u<i;u++)Z[t[e+u]]++;for(f=h,g=Bu;g>=1&&Z[g]===0;g--);if(f>g&&(f=g),g===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,o.bits=1,0;for(p=1;p<g&&Z[p]===0;p++);for(f<p&&(f=p),S=1,c=1;c<=Bu;c++)if(S<<=1,S-=Z[c],S<0)return-1;if(S>0&&(r===vw||g!==1))return-1;for(I[1]=0,c=1;c<Bu;c++)I[c+1]=I[c]+Z[c];for(u=0;u<i;u++)t[e+u]!==0&&(a[I[t[e+u]]++]=u);if(r===vw?($=j=a,B=20):r===A5?($=AL,j=_L,B=257):($=SL,j=xL,B=0),k=0,u=0,c=p,X=s,A=f,v=0,D=-1,w=1<<f,H=w-1,r===A5&&w>mw||r===yw&&w>bw)return 1;for(;;){K=c-v,a[u]+1<B?(Y=0,ot=a[u]):a[u]>=B?(Y=j[a[u]-B],ot=$[a[u]-B]):(Y=96,ot=0),L=1<<c-v,P=1<<A,p=P;do P-=L,n[X+(k>>v)+P]=K<<24|Y<<16|ot|0;while(P!==0);for(L=1<<c-1;k&L;)L>>=1;if(L!==0?(k&=L-1,k+=L):k=0,u++,--Z[c]===0){if(c===g)break;c=t[e+a[u]]}if(c>f&&(k&H)!==D){for(v===0&&(v=f),X+=p,A=c-v,S=1<<A;A+v<g&&(S-=Z[A+v],!(S<=0));)A++,S<<=1;if(w+=1<<A,r===A5&&w>mw||r===yw&&w>bw)return 1;D=k&H,n[D]=f<<24|A<<16|X-s|0}}return k!==0&&(n[X+k]=c-v<<24|64<<16|0),o.bits=f,0};var qp=CL;const LL=0,o3=1,l3=2,{Z_FINISH:ww,Z_BLOCK:EL,Z_TREES:X0,Z_OK:yu,Z_STREAM_END:kL,Z_NEED_DICT:PL,Z_STREAM_ERROR:Nr,Z_DATA_ERROR:h3,Z_MEM_ERROR:c3,Z_BUF_ERROR:NL,Z_DEFLATED:Aw}=s3,E2=16180,_w=16181,Sw=16182,xw=16183,Cw=16184,Lw=16185,Ew=16186,kw=16187,Pw=16188,Nw=16189,Jm=16190,fo=16191,_5=16192,Tw=16193,S5=16194,Iw=16195,Fw=16196,Mw=16197,Rw=16198,Y0=16199,K0=16200,Dw=16201,Ow=16202,Bw=16203,jw=16204,Uw=16205,x5=16206,Hw=16207,qw=16208,Ai=16209,u3=16210,d3=16211,TL=852,IL=592,FL=15,ML=FL,zw=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function RL(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _u=r=>{if(!r)return 1;const t=r.state;return!t||t.strm!==r||t.mode<E2||t.mode>d3?1:0},f3=r=>{if(_u(r))return Nr;const t=r.state;return r.total_in=r.total_out=t.total=0,r.msg="",t.wrap&&(r.adler=t.wrap&1),t.mode=E2,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(TL),t.distcode=t.distdyn=new Int32Array(IL),t.sane=1,t.back=-1,yu},p3=r=>{if(_u(r))return Nr;const t=r.state;return t.wsize=0,t.whave=0,t.wnext=0,f3(r)},g3=(r,t)=>{let e;if(_u(r))return Nr;const i=r.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Nr:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=e,i.wbits=t,p3(r))},m3=(r,t)=>{if(!r)return Nr;const e=new RL;r.state=e,e.strm=r,e.window=null,e.mode=E2;const i=g3(r,t);return i!==yu&&(r.state=null),i},DL=r=>m3(r,ML);let Ww=!0,C5,L5;const OL=r=>{if(Ww){C5=new Int32Array(512),L5=new Int32Array(32);let t=0;for(;t<144;)r.lens[t++]=8;for(;t<256;)r.lens[t++]=9;for(;t<280;)r.lens[t++]=7;for(;t<288;)r.lens[t++]=8;for(qp(o3,r.lens,0,288,C5,0,r.work,{bits:9}),t=0;t<32;)r.lens[t++]=5;qp(l3,r.lens,0,32,L5,0,r.work,{bits:5}),Ww=!1}r.lencode=C5,r.lenbits=9,r.distcode=L5,r.distbits=5},b3=(r,t,e,i)=>{let n;const s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(t.subarray(e-i,e-i+n),s.wnext),i-=n,i?(s.window.set(t.subarray(e-i,e),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},BL=(r,t)=>{let e,i,n,s,a,o,h,c,u,p,g,f,A,v,S=0,w,k,L,P,D,H,X,$;const B=new Uint8Array(4);let Z,I;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_u(r)||!r.output||!r.input&&r.avail_in!==0)return Nr;e=r.state,e.mode===fo&&(e.mode=_5),a=r.next_out,n=r.output,h=r.avail_out,s=r.next_in,i=r.input,o=r.avail_in,c=e.hold,u=e.bits,p=o,g=h,$=yu;t:for(;;)switch(e.mode){case E2:if(e.wrap===0){e.mode=_5;break}for(;u<16;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(e.wrap&2&&c===35615){e.wbits===0&&(e.wbits=15),e.check=0,B[0]=c&255,B[1]=c>>>8&255,e.check=ba(e.check,B,2,0),c=0,u=0,e.mode=_w;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((c&255)<<8)+(c>>8))%31){r.msg="incorrect header check",e.mode=Ai;break}if((c&15)!==Aw){r.msg="unknown compression method",e.mode=Ai;break}if(c>>>=4,u-=4,X=(c&15)+8,e.wbits===0&&(e.wbits=X),X>15||X>e.wbits){r.msg="invalid window size",e.mode=Ai;break}e.dmax=1<<e.wbits,e.flags=0,r.adler=e.check=1,e.mode=c&512?Nw:fo,c=0,u=0;break;case _w:for(;u<16;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(e.flags=c,(e.flags&255)!==Aw){r.msg="unknown compression method",e.mode=Ai;break}if(e.flags&57344){r.msg="unknown header flags set",e.mode=Ai;break}e.head&&(e.head.text=c>>8&1),e.flags&512&&e.wrap&4&&(B[0]=c&255,B[1]=c>>>8&255,e.check=ba(e.check,B,2,0)),c=0,u=0,e.mode=Sw;case Sw:for(;u<32;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}e.head&&(e.head.time=c),e.flags&512&&e.wrap&4&&(B[0]=c&255,B[1]=c>>>8&255,B[2]=c>>>16&255,B[3]=c>>>24&255,e.check=ba(e.check,B,4,0)),c=0,u=0,e.mode=xw;case xw:for(;u<16;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}e.head&&(e.head.xflags=c&255,e.head.os=c>>8),e.flags&512&&e.wrap&4&&(B[0]=c&255,B[1]=c>>>8&255,e.check=ba(e.check,B,2,0)),c=0,u=0,e.mode=Cw;case Cw:if(e.flags&1024){for(;u<16;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}e.length=c,e.head&&(e.head.extra_len=c),e.flags&512&&e.wrap&4&&(B[0]=c&255,B[1]=c>>>8&255,e.check=ba(e.check,B,2,0)),c=0,u=0}else e.head&&(e.head.extra=null);e.mode=Lw;case Lw:if(e.flags&1024&&(f=e.length,f>o&&(f=o),f&&(e.head&&(X=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(s,s+f),X)),e.flags&512&&e.wrap&4&&(e.check=ba(e.check,i,f,s)),o-=f,s+=f,e.length-=f),e.length))break t;e.length=0,e.mode=Ew;case Ew:if(e.flags&2048){if(o===0)break t;f=0;do X=i[s+f++],e.head&&X&&e.length<65536&&(e.head.name+=String.fromCharCode(X));while(X&&f<o);if(e.flags&512&&e.wrap&4&&(e.check=ba(e.check,i,f,s)),o-=f,s+=f,X)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=kw;case kw:if(e.flags&4096){if(o===0)break t;f=0;do X=i[s+f++],e.head&&X&&e.length<65536&&(e.head.comment+=String.fromCharCode(X));while(X&&f<o);if(e.flags&512&&e.wrap&4&&(e.check=ba(e.check,i,f,s)),o-=f,s+=f,X)break t}else e.head&&(e.head.comment=null);e.mode=Pw;case Pw:if(e.flags&512){for(;u<16;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(e.wrap&4&&c!==(e.check&65535)){r.msg="header crc mismatch",e.mode=Ai;break}c=0,u=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),r.adler=e.check=0,e.mode=fo;break;case Nw:for(;u<32;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}r.adler=e.check=zw(c),c=0,u=0,e.mode=Jm;case Jm:if(e.havedict===0)return r.next_out=a,r.avail_out=h,r.next_in=s,r.avail_in=o,e.hold=c,e.bits=u,PL;r.adler=e.check=1,e.mode=fo;case fo:if(t===EL||t===X0)break t;case _5:if(e.last){c>>>=u&7,u-=u&7,e.mode=x5;break}for(;u<3;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}switch(e.last=c&1,c>>>=1,u-=1,c&3){case 0:e.mode=Tw;break;case 1:if(OL(e),e.mode=Y0,t===X0){c>>>=2,u-=2;break t}break;case 2:e.mode=Fw;break;case 3:r.msg="invalid block type",e.mode=Ai}c>>>=2,u-=2;break;case Tw:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){r.msg="invalid stored block lengths",e.mode=Ai;break}if(e.length=c&65535,c=0,u=0,e.mode=S5,t===X0)break t;case S5:e.mode=Iw;case Iw:if(f=e.length,f){if(f>o&&(f=o),f>h&&(f=h),f===0)break t;n.set(i.subarray(s,s+f),a),o-=f,s+=f,h-=f,a+=f,e.length-=f;break}e.mode=fo;break;case Fw:for(;u<14;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(e.nlen=(c&31)+257,c>>>=5,u-=5,e.ndist=(c&31)+1,c>>>=5,u-=5,e.ncode=(c&15)+4,c>>>=4,u-=4,e.nlen>286||e.ndist>30){r.msg="too many length or distance symbols",e.mode=Ai;break}e.have=0,e.mode=Mw;case Mw:for(;e.have<e.ncode;){for(;u<3;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}e.lens[j[e.have++]]=c&7,c>>>=3,u-=3}for(;e.have<19;)e.lens[j[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,Z={bits:e.lenbits},$=qp(LL,e.lens,0,19,e.lencode,0,e.work,Z),e.lenbits=Z.bits,$){r.msg="invalid code lengths set",e.mode=Ai;break}e.have=0,e.mode=Rw;case Rw:for(;e.have<e.nlen+e.ndist;){for(;S=e.lencode[c&(1<<e.lenbits)-1],w=S>>>24,k=S>>>16&255,L=S&65535,!(w<=u);){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(L<16)c>>>=w,u-=w,e.lens[e.have++]=L;else{if(L===16){for(I=w+2;u<I;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(c>>>=w,u-=w,e.have===0){r.msg="invalid bit length repeat",e.mode=Ai;break}X=e.lens[e.have-1],f=3+(c&3),c>>>=2,u-=2}else if(L===17){for(I=w+3;u<I;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}c>>>=w,u-=w,X=0,f=3+(c&7),c>>>=3,u-=3}else{for(I=w+7;u<I;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}c>>>=w,u-=w,X=0,f=11+(c&127),c>>>=7,u-=7}if(e.have+f>e.nlen+e.ndist){r.msg="invalid bit length repeat",e.mode=Ai;break}for(;f--;)e.lens[e.have++]=X}}if(e.mode===Ai)break;if(e.lens[256]===0){r.msg="invalid code -- missing end-of-block",e.mode=Ai;break}if(e.lenbits=9,Z={bits:e.lenbits},$=qp(o3,e.lens,0,e.nlen,e.lencode,0,e.work,Z),e.lenbits=Z.bits,$){r.msg="invalid literal/lengths set",e.mode=Ai;break}if(e.distbits=6,e.distcode=e.distdyn,Z={bits:e.distbits},$=qp(l3,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,Z),e.distbits=Z.bits,$){r.msg="invalid distances set",e.mode=Ai;break}if(e.mode=Y0,t===X0)break t;case Y0:e.mode=K0;case K0:if(o>=6&&h>=258){r.next_out=a,r.avail_out=h,r.next_in=s,r.avail_in=o,e.hold=c,e.bits=u,wL(r,g),a=r.next_out,n=r.output,h=r.avail_out,s=r.next_in,i=r.input,o=r.avail_in,c=e.hold,u=e.bits,e.mode===fo&&(e.back=-1);break}for(e.back=0;S=e.lencode[c&(1<<e.lenbits)-1],w=S>>>24,k=S>>>16&255,L=S&65535,!(w<=u);){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(k&&(k&240)===0){for(P=w,D=k,H=L;S=e.lencode[H+((c&(1<<P+D)-1)>>P)],w=S>>>24,k=S>>>16&255,L=S&65535,!(P+w<=u);){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}c>>>=P,u-=P,e.back+=P}if(c>>>=w,u-=w,e.back+=w,e.length=L,k===0){e.mode=Uw;break}if(k&32){e.back=-1,e.mode=fo;break}if(k&64){r.msg="invalid literal/length code",e.mode=Ai;break}e.extra=k&15,e.mode=Dw;case Dw:if(e.extra){for(I=e.extra;u<I;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Ow;case Ow:for(;S=e.distcode[c&(1<<e.distbits)-1],w=S>>>24,k=S>>>16&255,L=S&65535,!(w<=u);){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if((k&240)===0){for(P=w,D=k,H=L;S=e.distcode[H+((c&(1<<P+D)-1)>>P)],w=S>>>24,k=S>>>16&255,L=S&65535,!(P+w<=u);){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}c>>>=P,u-=P,e.back+=P}if(c>>>=w,u-=w,e.back+=w,k&64){r.msg="invalid distance code",e.mode=Ai;break}e.offset=L,e.extra=k&15,e.mode=Bw;case Bw:if(e.extra){for(I=e.extra;u<I;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){r.msg="invalid distance too far back",e.mode=Ai;break}e.mode=jw;case jw:if(h===0)break t;if(f=g-h,e.offset>f){if(f=e.offset-f,f>e.whave&&e.sane){r.msg="invalid distance too far back",e.mode=Ai;break}f>e.wnext?(f-=e.wnext,A=e.wsize-f):A=e.wnext-f,f>e.length&&(f=e.length),v=e.window}else v=n,A=a-e.offset,f=e.length;f>h&&(f=h),h-=f,e.length-=f;do n[a++]=v[A++];while(--f);e.length===0&&(e.mode=K0);break;case Uw:if(h===0)break t;n[a++]=e.length,h--,e.mode=K0;break;case x5:if(e.wrap){for(;u<32;){if(o===0)break t;o--,c|=i[s++]<<u,u+=8}if(g-=h,r.total_out+=g,e.total+=g,e.wrap&4&&g&&(r.adler=e.check=e.flags?ba(e.check,n,g,a-g):bv(e.check,n,g,a-g)),g=h,e.wrap&4&&(e.flags?c:zw(c))!==e.check){r.msg="incorrect data check",e.mode=Ai;break}c=0,u=0}e.mode=Hw;case Hw:if(e.wrap&&e.flags){for(;u<32;){if(o===0)break t;o--,c+=i[s++]<<u,u+=8}if(e.wrap&4&&c!==(e.total&4294967295)){r.msg="incorrect length check",e.mode=Ai;break}c=0,u=0}e.mode=qw;case qw:$=kL;break t;case Ai:$=h3;break t;case u3:return c3;case d3:default:return Nr}return r.next_out=a,r.avail_out=h,r.next_in=s,r.avail_in=o,e.hold=c,e.bits=u,(e.wsize||g!==r.avail_out&&e.mode<Ai&&(e.mode<x5||t!==ww))&&b3(r,r.output,r.next_out,g-r.avail_out),p-=r.avail_in,g-=r.avail_out,r.total_in+=p,r.total_out+=g,e.total+=g,e.wrap&4&&g&&(r.adler=e.check=e.flags?ba(e.check,n,g,r.next_out-g):bv(e.check,n,g,r.next_out-g)),r.data_type=e.bits+(e.last?64:0)+(e.mode===fo?128:0)+(e.mode===Y0||e.mode===S5?256:0),(p===0&&g===0||t===ww)&&$===yu&&($=NL),$},jL=r=>{if(_u(r))return Nr;let t=r.state;return t.window&&(t.window=null),r.state=null,yu},UL=(r,t)=>{if(_u(r))return Nr;const e=r.state;return(e.wrap&2)===0?Nr:(e.head=t,t.done=!1,yu)},HL=(r,t)=>{const e=t.length;let i,n,s;return _u(r)||(i=r.state,i.wrap!==0&&i.mode!==Jm)?Nr:i.mode===Jm&&(n=1,n=bv(n,t,e,0),n!==i.check)?h3:(s=b3(r,t,e,e),s?(i.mode=u3,c3):(i.havedict=1,yu))};var qL=p3,zL=g3,WL=f3,GL=DL,VL=m3,$L=BL,XL=jL,YL=UL,KL=HL,JL="pako inflate (from Nodeca project)",yo={inflateReset:qL,inflateReset2:zL,inflateResetKeep:WL,inflateInit:GL,inflateInit2:VL,inflate:$L,inflateEnd:XL,inflateGetHeader:YL,inflateSetDictionary:KL,inflateInfo:JL};function ZL(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var QL=ZL;const v3=Object.prototype.toString,{Z_NO_FLUSH:tE,Z_FINISH:eE,Z_OK:ig,Z_STREAM_END:E5,Z_NEED_DICT:k5,Z_STREAM_ERROR:iE,Z_DATA_ERROR:Gw,Z_MEM_ERROR:nE}=s3;function e0(r){this.options=r3.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(r&&r.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vL,this.strm.avail_out=0;let e=yo.inflateInit2(this.strm,t.windowBits);if(e!==ig)throw new Error(vv[e]);if(this.header=new QL,yo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=yv.string2buf(t.dictionary):v3.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=yo.inflateSetDictionary(this.strm,t.dictionary),e!==ig)))throw new Error(vv[e])}e0.prototype.push=function(r,t){const e=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?eE:tE,v3.call(r)==="[object ArrayBuffer]"?e.input=new Uint8Array(r):e.input=r,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),s=yo.inflate(e,a),s===k5&&n&&(s=yo.inflateSetDictionary(e,n),s===ig?s=yo.inflate(e,a):s===Gw&&(s=k5));e.avail_in>0&&s===E5&&e.state.wrap>0&&r[e.next_in]!==0;)yo.inflateReset(e),s=yo.inflate(e,a);switch(s){case iE:case Gw:case k5:case nE:return this.onEnd(s),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||s===E5))if(this.options.to==="string"){let h=yv.utf8border(e.output,e.next_out),c=e.next_out-h,u=yv.buf2string(e.output,h);e.next_out=c,e.avail_out=i-c,c&&e.output.set(e.output.subarray(h,h+c),0),this.onData(u)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(s===ig&&o===0)){if(s===E5)return s=yo.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};e0.prototype.onData=function(r){this.chunks.push(r)};e0.prototype.onEnd=function(r){r===ig&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r3.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function sE(r,t){const e=new e0(t);if(e.push(r),e.err)throw e.msg||vv[e.err];return e.result}var rE=e0,aE=sE,oE={Inflate:rE,inflate:aE};const{Inflate:lE,inflate:hE}=oE;var Vw=lE,cE=hE;const y3=[];for(let r=0;r<256;r++){let t=r;for(let e=0;e<8;e++)t&1?t=3988292384^t>>>1:t=t>>>1;y3[r]=t}const $w=4294967295;function uE(r,t,e){let i=r;for(let n=0;n<e;n++)i=y3[(i^t[n])&255]^i>>>8;return i}function dE(r,t){return(uE($w,r,t)^$w)>>>0}function Xw(r,t,e){const i=r.readUint32(),n=dE(new Uint8Array(r.buffer,r.byteOffset+r.offset-t-4,t),t);if(n!==i)throw new Error(`CRC mismatch for chunk ${e}. Expected ${i}, found ${n}`)}function w3(r,t,e){for(let i=0;i<e;i++)t[i]=r[i]}function A3(r,t,e,i){let n=0;for(;n<i;n++)t[n]=r[n];for(;n<e;n++)t[n]=r[n]+t[n-i]&255}function _3(r,t,e,i){let n=0;if(e.length===0)for(;n<i;n++)t[n]=r[n];else for(;n<i;n++)t[n]=r[n]+e[n]&255}function S3(r,t,e,i,n){let s=0;if(e.length===0){for(;s<n;s++)t[s]=r[s];for(;s<i;s++)t[s]=r[s]+(t[s-n]>>1)&255}else{for(;s<n;s++)t[s]=r[s]+(e[s]>>1)&255;for(;s<i;s++)t[s]=r[s]+(t[s-n]+e[s]>>1)&255}}function x3(r,t,e,i,n){let s=0;if(e.length===0){for(;s<n;s++)t[s]=r[s];for(;s<i;s++)t[s]=r[s]+t[s-n]&255}else{for(;s<n;s++)t[s]=r[s]+e[s]&255;for(;s<i;s++)t[s]=r[s]+fE(t[s-n],e[s],e[s-n])&255}}function fE(r,t,e){const i=r+t-e,n=Math.abs(i-r),s=Math.abs(i-t),a=Math.abs(i-e);return n<=s&&n<=a?r:s<=a?t:e}function pE(r,t,e,i,n,s){switch(r){case 0:w3(t,e,n);break;case 1:A3(t,e,n,s);break;case 2:_3(t,e,i,n);break;case 3:S3(t,e,i,n,s);break;case 4:x3(t,e,i,n,s);break;default:throw new Error(`Unsupported filter: ${r}`)}}const gE=new Uint16Array([255]),mE=new Uint8Array(gE.buffer),bE=mE[0]===255;function vE(r){const{data:t,width:e,height:i,channels:n,depth:s}=r,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*n,h=new Uint8Array(i*e*o);let c=0;for(let u=0;u<7;u++){const p=a[u],g=Math.ceil((e-p.x)/p.xStep),f=Math.ceil((i-p.y)/p.yStep);if(g<=0||f<=0)continue;const A=g*o,v=new Uint8Array(A);for(let S=0;S<f;S++){const w=t[c++],k=t.subarray(c,c+A);c+=A;const L=new Uint8Array(A);pE(w,k,L,v,A,o),v.set(L);for(let P=0;P<g;P++){const D=p.x+P*p.xStep,H=p.y+S*p.yStep;if(!(D>=e||H>=i))for(let X=0;X<o;X++)h[(H*e+D)*o+X]=L[P*o+X]}}}if(s===16){const u=new Uint16Array(h.buffer);if(bE)for(let p=0;p<u.length;p++)u[p]=yE(u[p]);return u}else return h}function yE(r){return(r&255)<<8|r>>8&255}const wE=new Uint16Array([255]),AE=new Uint8Array(wE.buffer),_E=AE[0]===255,SE=new Uint8Array(0);function Yw(r){const{data:t,width:e,height:i,channels:n,depth:s}=r,a=Math.ceil(s/8)*n,o=Math.ceil(s/8*n*e),h=new Uint8Array(i*o);let c=SE,u=0,p,g;for(let f=0;f<i;f++){switch(p=t.subarray(u+1,u+1+o),g=h.subarray(f*o,(f+1)*o),t[u]){case 0:w3(p,g,o);break;case 1:A3(p,g,o,a);break;case 2:_3(p,g,c,o);break;case 3:S3(p,g,c,o,a);break;case 4:x3(p,g,c,o,a);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}c=g,u+=o+1}if(s===16){const f=new Uint16Array(h.buffer);if(_E)for(let A=0;A<f.length;A++)f[A]=xE(f[A]);return f}else return h}function xE(r){return(r&255)<<8|r>>8&255}const Rm=Uint8Array.of(137,80,78,71,13,10,26,10);function Kw(r){if(!CE(r.readBytes(Rm.length)))throw new Error("wrong PNG signature")}function CE(r){if(r.length<Rm.length)return!1;for(let t=0;t<Rm.length;t++)if(r[t]!==Rm[t])return!1;return!0}const LE="tEXt",EE=0,C3=new TextDecoder("latin1");function kE(r){if(NE(r),r.length===0||r.length>79)throw new Error("keyword length must be between 1 and 79")}const PE=/^[\u0000-\u00FF]*$/;function NE(r){if(!PE.test(r))throw new Error("invalid latin1 text")}function TE(r,t,e){const i=L3(t);r[i]=IE(t,e-i.length-1)}function L3(r){for(r.mark();r.readByte()!==EE;);const t=r.offset;r.reset();const e=C3.decode(r.readBytes(t-r.offset-1));return r.skip(1),kE(e),e}function IE(r,t){return C3.decode(r.readBytes(t))}const Is={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},P5={UNKNOWN:-1,DEFLATE:0},Jw={UNKNOWN:-1,ADAPTIVE:0},N5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},J0={NONE:0,BACKGROUND:1,PREVIOUS:2},T5={SOURCE:0,OVER:1};class FE extends qv{constructor(e,i={}){super(e);bt(this,"_checkCrc");bt(this,"_inflator");bt(this,"_png");bt(this,"_apng");bt(this,"_end");bt(this,"_hasPalette");bt(this,"_palette");bt(this,"_hasTransparency");bt(this,"_transparency");bt(this,"_compressionMethod");bt(this,"_filterMethod");bt(this,"_interlaceMethod");bt(this,"_colorType");bt(this,"_isAnimated");bt(this,"_numberOfFrames");bt(this,"_numberOfPlays");bt(this,"_frames");bt(this,"_writingDataChunks");const{checkCrc:n=!1}=i;this._checkCrc=n,this._inflator=new Vw,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=P5.UNKNOWN,this._filterMethod=Jw.UNKNOWN,this._interlaceMethod=N5.UNKNOWN,this._colorType=Is.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Kw(this);!this._end;){const e=this.readUint32(),i=this.readChars(4);this.decodeChunk(e,i)}return this.decodeImage(),this._png}decodeApng(){for(Kw(this);!this._end;){const e=this.readUint32(),i=this.readChars(4);this.decodeApngChunk(e,i)}return this.decodeApngImage(),this._apng}decodeChunk(e,i){const n=this.offset;switch(i){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case LE:TE(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?Xw(this,e+4,i):this.skip(4)}decodeApngChunk(e,i){const n=this.offset;switch(i!=="fdAT"&&i!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),i){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,i),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?Xw(this,e+4,i):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=ME(this.readUint8());const i=this.readUint8();this._colorType=i;let n;switch(i){case Is.GREYSCALE:n=1;break;case Is.TRUECOLOUR:n=3;break;case Is.INDEXED_COLOUR:n=1;break;case Is.GREYSCALE_ALPHA:n=2;break;case Is.TRUECOLOUR_ALPHA:n=4;break;case Is.UNKNOWN:default:throw new Error(`Unknown color type: ${i}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==P5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const i=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let s=0;s<i;s++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const i=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let i=e,n=this.offset+this.byteOffset;if(n+=4,i-=4,this._inflator.push(new Uint8Array(this.buffer,n,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Is.GREYSCALE:case Is.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let i=0;i<e/2;i++)this._transparency[i]=this.readUint16();break}case Is.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let i=0;for(;i<e;i++){const n=this.readByte();this._palette[i].push(n)}for(;i<this._palette.length;i++)this._palette[i].push(255);break}case Is.UNKNOWN:case Is.GREYSCALE_ALPHA:case Is.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const i=L3(this),n=this.readUint8();if(n!==P5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const s=this.readBytes(e-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:cE(s)}}decodepHYs(){const e=this.readUint32(),i=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:i,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const i={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=Yw({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)i.data=n.data;else{const s=this._apng.frames.at(e-1);this.disposeFrame(n,s,i),this.addFrameDataToCanvas(i,n)}this._apng.frames.push(i)}}return this._apng}disposeFrame(e,i,n){switch(e.disposeOp){case J0.NONE:break;case J0.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let a=0;a<this._png.width;a++){const o=(s*e.width+a)*this._png.channels;for(let h=0;h<this._png.channels;h++)n.data[o+h]=0}break;case J0.PREVIOUS:n.data.set(i.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,i){const n=1<<this._png.depth,s=(a,o)=>{const h=((a+i.yOffset)*this._png.width+i.xOffset+o)*this._png.channels,c=(a*i.width+o)*this._png.channels;return{index:h,frameIndex:c}};switch(i.blendOp){case T5.SOURCE:for(let a=0;a<i.height;a++)for(let o=0;o<i.width;o++){const{index:h,frameIndex:c}=s(a,o);for(let u=0;u<this._png.channels;u++)e.data[h+u]=i.data[c+u]}break;case T5.OVER:for(let a=0;a<i.height;a++)for(let o=0;o<i.width;o++){const{index:h,frameIndex:c}=s(a,o);for(let u=0;u<this._png.channels;u++){const p=i.data[c+this._png.channels-1]/n,g=u%(this._png.channels-1)===0?1:i.data[c+u],f=Math.floor(p*g+(1-p)*e.data[h+u]);e.data[h+u]+=f}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var i;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?((i=this._frames)==null?void 0:i.at(0)).data:this._inflator.result;if(this._filterMethod!==Jw.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===N5.NO_INTERLACE)this._png.data=Yw({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===N5.ADAM7)this._png.data=vE({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,i=this._frames.at(-1);i?i.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:J0.NONE,blendOp:T5.SOURCE,data:e}),this._inflator=new Vw,this._writingDataChunks=!1}}function ME(r){if(r!==1&&r!==2&&r!==4&&r!==8&&r!==16)throw new Error(`invalid bit depth: ${r}`);return r}var Zw;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.METRE=1]="METRE"})(Zw||(Zw={}));function RE(r,t){return new FE(r,t).decode()}var re=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function I5(){re.console&&typeof re.console.log=="function"&&re.console.log.apply(re.console,arguments)}var oi={log:I5,warn:function(r){re.console&&(typeof re.console.warn=="function"?re.console.warn.apply(re.console,arguments):I5.call(null,arguments))},error:function(r){re.console&&(typeof re.console.error=="function"?re.console.error.apply(re.console,arguments):I5(r))}};function F5(r,t,e){var i=new XMLHttpRequest;i.open("GET",r),i.responseType="blob",i.onload=function(){$h(i.response,t,e)},i.onerror=function(){oi.error("could not download file")},i.send()}function Qw(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Z0(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}var $h=re.saveAs||((typeof window>"u"?"undefined":Ke(window))!=="object"||window!==re?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,e){var i=re.URL||re.webkitURL,n=document.createElement("a");t=t||r.name||"download",n.download=t,n.rel="noopener",typeof r=="string"?(n.href=r,n.origin!==location.origin?Qw(n.href)?F5(r,t,e):Z0(n,n.target="_blank"):Z0(n)):(n.href=i.createObjectURL(r),setTimeout(function(){i.revokeObjectURL(n.href)},4e4),setTimeout(function(){Z0(n)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,e){if(t=t||r.name||"download",typeof r=="string")if(Qw(r))F5(r,t,e);else{var i=document.createElement("a");i.href=r,i.target="_blank",setTimeout(function(){Z0(i)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:Ke(s)!=="object"&&(oi.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(r,e),t)}:function(r,t,e,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof r=="string")return F5(r,t,e);var n=r.type==="application/octet-stream",s=/constructor/i.test(re.HTMLElement)||re.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||n&&s)&&(typeof FileReader>"u"?"undefined":Ke(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=a?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=u:location=u,i=null},o.readAsDataURL(r)}else{var h=re.URL||re.webkitURL,c=h.createObjectURL(r);i?i.location=c:location.href=c,i=null,setTimeout(function(){h.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function E3(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],i=0;i<e.length;i++){var n=e[i].re,s=e[i].process,a=n.exec(r);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),h=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),h.length==1&&(h="0"+h),c.length==1&&(c="0"+c),"#"+o+h+c}}var Dm=re.atob.bind(re),tA=re.btoa.bind(re);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function M5(r,t){var e=r[0],i=r[1],n=r[2],s=r[3];e=qn(e,i,n,s,t[0],7,-680876936),s=qn(s,e,i,n,t[1],12,-389564586),n=qn(n,s,e,i,t[2],17,606105819),i=qn(i,n,s,e,t[3],22,-1044525330),e=qn(e,i,n,s,t[4],7,-176418897),s=qn(s,e,i,n,t[5],12,1200080426),n=qn(n,s,e,i,t[6],17,-1473231341),i=qn(i,n,s,e,t[7],22,-45705983),e=qn(e,i,n,s,t[8],7,1770035416),s=qn(s,e,i,n,t[9],12,-1958414417),n=qn(n,s,e,i,t[10],17,-42063),i=qn(i,n,s,e,t[11],22,-1990404162),e=qn(e,i,n,s,t[12],7,1804603682),s=qn(s,e,i,n,t[13],12,-40341101),n=qn(n,s,e,i,t[14],17,-1502002290),e=zn(e,i=qn(i,n,s,e,t[15],22,1236535329),n,s,t[1],5,-165796510),s=zn(s,e,i,n,t[6],9,-1069501632),n=zn(n,s,e,i,t[11],14,643717713),i=zn(i,n,s,e,t[0],20,-373897302),e=zn(e,i,n,s,t[5],5,-701558691),s=zn(s,e,i,n,t[10],9,38016083),n=zn(n,s,e,i,t[15],14,-660478335),i=zn(i,n,s,e,t[4],20,-405537848),e=zn(e,i,n,s,t[9],5,568446438),s=zn(s,e,i,n,t[14],9,-1019803690),n=zn(n,s,e,i,t[3],14,-187363961),i=zn(i,n,s,e,t[8],20,1163531501),e=zn(e,i,n,s,t[13],5,-1444681467),s=zn(s,e,i,n,t[2],9,-51403784),n=zn(n,s,e,i,t[7],14,1735328473),e=Wn(e,i=zn(i,n,s,e,t[12],20,-1926607734),n,s,t[5],4,-378558),s=Wn(s,e,i,n,t[8],11,-2022574463),n=Wn(n,s,e,i,t[11],16,1839030562),i=Wn(i,n,s,e,t[14],23,-35309556),e=Wn(e,i,n,s,t[1],4,-1530992060),s=Wn(s,e,i,n,t[4],11,1272893353),n=Wn(n,s,e,i,t[7],16,-155497632),i=Wn(i,n,s,e,t[10],23,-1094730640),e=Wn(e,i,n,s,t[13],4,681279174),s=Wn(s,e,i,n,t[0],11,-358537222),n=Wn(n,s,e,i,t[3],16,-722521979),i=Wn(i,n,s,e,t[6],23,76029189),e=Wn(e,i,n,s,t[9],4,-640364487),s=Wn(s,e,i,n,t[12],11,-421815835),n=Wn(n,s,e,i,t[15],16,530742520),e=Gn(e,i=Wn(i,n,s,e,t[2],23,-995338651),n,s,t[0],6,-198630844),s=Gn(s,e,i,n,t[7],10,1126891415),n=Gn(n,s,e,i,t[14],15,-1416354905),i=Gn(i,n,s,e,t[5],21,-57434055),e=Gn(e,i,n,s,t[12],6,1700485571),s=Gn(s,e,i,n,t[3],10,-1894986606),n=Gn(n,s,e,i,t[10],15,-1051523),i=Gn(i,n,s,e,t[1],21,-2054922799),e=Gn(e,i,n,s,t[8],6,1873313359),s=Gn(s,e,i,n,t[15],10,-30611744),n=Gn(n,s,e,i,t[6],15,-1560198380),i=Gn(i,n,s,e,t[13],21,1309151649),e=Gn(e,i,n,s,t[4],6,-145523070),s=Gn(s,e,i,n,t[11],10,-1120210379),n=Gn(n,s,e,i,t[2],15,718787259),i=Gn(i,n,s,e,t[9],21,-343485551),r[0]=wh(e,r[0]),r[1]=wh(i,r[1]),r[2]=wh(n,r[2]),r[3]=wh(s,r[3])}function k2(r,t,e,i,n,s){return t=wh(wh(t,r),wh(i,s)),wh(t<<n|t>>>32-n,e)}function qn(r,t,e,i,n,s,a){return k2(t&e|~t&i,r,t,n,s,a)}function zn(r,t,e,i,n,s,a){return k2(t&i|e&~i,r,t,n,s,a)}function Wn(r,t,e,i,n,s,a){return k2(t^e^i,r,t,n,s,a)}function Gn(r,t,e,i,n,s,a){return k2(e^(t|~i),r,t,n,s,a)}function k3(r){var t,e=r.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)M5(i,DE(r.substring(t-64,t)));r=r.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)n[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(M5(i,n),t=0;t<16;t++)n[t]=0;return n[14]=8*e,M5(i,n),i}function DE(r){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}var eA="0123456789abcdef".split("");function OE(r){for(var t="",e=0;e<4;e++)t+=eA[r>>8*e+4&15]+eA[r>>8*e&15];return t}function BE(r){return String.fromCharCode(255&r,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function wv(r){return k3(r).map(BE).join("")}var jE=(function(r){for(var t=0;t<r.length;t++)r[t]=OE(r[t]);return r.join("")})(k3("hello"))!="5d41402abc4b2a76b9719d911017c592";function wh(r,t){if(jE){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}return r+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Av(r,t){var e,i,n,s;if(r!==e){for(var a=(n=r,s=1+(256/r.length|0),new Array(s+1).join(n)),o=[],h=0;h<256;h++)o[h]=h;var c=0;for(h=0;h<256;h++){var u=o[h];c=(c+u+a.charCodeAt(h))%256,o[h]=o[c],o[c]=u}e=r,i=o}else o=i;var p=t.length,g=0,f=0,A="";for(h=0;h<p;h++)f=(f+(u=o[g=(g+1)%256]))%256,o[g]=o[f],o[f]=u,a=o[(o[g]+o[f])%256],A+=String.fromCharCode(t.charCodeAt(h)^a);return A}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var iA={print:4,modify:8,copy:16,"annot-forms":32};function Yu(r,t,e,i){this.v=1,this.r=2;var n=192;r.forEach(function(o){if(iA.perm!==void 0)throw new Error("Invalid permission: "+o);n+=iA[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),a=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^n)),this.encryptionKey=wv(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=Av(this.encryptionKey,this.padding)}function Ku(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",e=r.length,i=0;i<e;i++){var n=r.charCodeAt(i);t+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):r[i]}return t}function nA(r){if(Ke(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,i,n){if(n=n||!1,typeof e!="string"||typeof i!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[i,!!n],s},this.unsubscribe=function(e){for(var i in t)if(t[i][e])return delete t[i][e],Object.keys(t[i]).length===0&&delete t[i],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var i=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[e]){var a=t[e][s];try{a[0].apply(r,i)}catch(o){re.console&&oi.error("jsPDF PubSub Error",o.message,o)}a[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function ng(r){if(!(this instanceof ng))return new ng(r);var t="opacity,stroke-opacity".split(",");for(var e in r)r.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=r[e]);this.id="",this.objectNumber=-1}function P3(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function Pl(r,t,e,i,n){if(!(this instanceof Pl))return new Pl(r,t,e,i,n);this.type=r==="axial"?2:3,this.coords=t,this.colors=e,P3.call(this,i,n)}function Jh(r,t,e,i,n){if(!(this instanceof Jh))return new Jh(r,t,e,i,n);this.boundingBox=r,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,P3.call(this,i,n)}function Vt(r){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],n=arguments[2],s=arguments[3],a=[],o=1,h=16,c="S",u=null;Ke(r=r||{})==="object"&&(e=r.orientation,i=r.unit||i,n=r.format||n,s=r.compress||r.compressPdf||s,(u=r.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(h=r.floatPrecision),c=r.defaultPathOperation||"S"),a=r.filters||(s===!0?["FlateEncode"]:a),i=i||"mm",e=(""+(e||"P")).toLowerCase();var p=r.putOnlyUsedFonts||!1,g={},f={internal:{},__private__:{}};f.__private__.PubSub=nA;var A="1.3",v=f.__private__.getPdfVersion=function(){return A};f.__private__.setPdfVersion=function(b){A=b};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return S};var w=f.__private__.getPageFormat=function(b){return S[b]};n=n||"a4";var k="compat",L="advanced",P=k;function D(){this.saveGraphicsState(),q(new ne(me,0,0,-me,0,Mh()*me).toString()+" cm"),this.setFontSize(this.getFontSize()/me),c="n",P=L}function H(){this.restoreGraphicsState(),c="S",P=k}var X=f.__private__.combineFontStyleAndFontWeight=function(b,N){if(b=="bold"&&N=="normal"||b=="bold"&&N==400||b=="normal"&&N=="italic"||b=="bold"&&N=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return N&&(b=N==400||N==="normal"?b==="italic"?"italic":"normal":N!=700&&N!=="bold"||b!=="normal"?(N==700?"bold":N)+""+b:"bold"),b};f.advancedAPI=function(b){var N=P===k;return N&&D.call(this),typeof b!="function"||(b(this),N&&H.call(this)),this},f.compatAPI=function(b){var N=P===L;return N&&H.call(this),typeof b!="function"||(b(this),N&&D.call(this)),this},f.isAdvancedAPI=function(){return P===L};var $,B=function(b){if(P!==L)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Z=f.roundToPrecision=f.__private__.roundToPrecision=function(b,N){var V=t||N;if(isNaN(b)||isNaN(V))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed(V).replace(/0+$/,"")};$=f.hpf=f.__private__.hpf=typeof h=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(b,h)}:h==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(b,16)};var I=f.f2=f.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return Z(b,2)},j=f.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return Z(b,3)},K=f.scale=f.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return P===k?b*me:P===L?b:void 0},Y=function(b){return K((function(N){return P===k?Mh()-N:P===L?N:void 0})(b))};f.__private__.setPrecision=f.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(t=parseInt(b,10))};var ot,rt="00000000000000000000000000000000",lt=f.__private__.getFileId=function(){return rt},st=f.__private__.setFileId=function(b){return rt=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():rt.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(sn=new Yu(u.userPermissions,u.userPassword,u.ownerPassword,rt)),rt};f.setFileId=function(b){return st(b),this},f.getFileId=function(){return lt()};var ft=f.__private__.convertDateToPDFDate=function(b){var N=b.getTimezoneOffset(),V=N<0?"+":"-",tt=Math.floor(Math.abs(N/60)),ht=Math.abs(N%60),wt=[V,J(tt),"'",J(ht),"'"].join("");return["D:",b.getFullYear(),J(b.getMonth()+1),J(b.getDate()),J(b.getHours()),J(b.getMinutes()),J(b.getSeconds()),wt].join("")},Ct=f.__private__.convertPDFDateToDate=function(b){var N=parseInt(b.substr(2,4),10),V=parseInt(b.substr(6,2),10)-1,tt=parseInt(b.substr(8,2),10),ht=parseInt(b.substr(10,2),10),wt=parseInt(b.substr(12,2),10),St=parseInt(b.substr(14,2),10);return new Date(N,V,tt,ht,wt,St,0)},At=f.__private__.setCreationDate=function(b){var N;if(b===void 0&&(b=new Date),b instanceof Date)N=ft(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");N=b}return ot=N},F=f.__private__.getCreationDate=function(b){var N=ot;return b==="jsDate"&&(N=Ct(ot)),N};f.setCreationDate=function(b){return At(b),this},f.getCreationDate=function(b){return F(b)};var z,J=f.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},Q=f.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},it=0,at=[],pt=[],gt=0,yt=[],Lt=[],Tt=!1,It=pt;f.__private__.setCustomOutputDestination=function(b){Tt=!0,It=b};var Xt=function(b){Tt||(It=b)};f.__private__.resetCustomOutputDestination=function(){Tt=!1,It=pt};var q=f.__private__.out=function(b){return b=b.toString(),gt+=b.length+1,It.push(b),It},Ft=f.__private__.write=function(b){return q(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},Se=f.__private__.getArrayBuffer=function(b){for(var N=b.length,V=new ArrayBuffer(N),tt=new Uint8Array(V);N--;)tt[N]=b.charCodeAt(N);return V},Qt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Qt};var Et=r.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(b){return Et=P===L?b/me:b,this};var te,jt=f.__private__.getFontSize=f.getFontSize=function(){return P===k?Et:Et*me},Zt=r.R2L||!1;f.__private__.setR2L=f.setR2L=function(b){return Zt=b,this},f.__private__.getR2L=f.getR2L=function(){return Zt};var Kt,qe=f.__private__.setZoomMode=function(b){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))te=b;else if(isNaN(b)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');te=b}else te=parseInt(b,10)};f.__private__.getZoomMode=function(){return te};var ke,de=f.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');Kt=b};f.__private__.getPageMode=function(){return Kt};var Ie=f.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');ke=b};f.__private__.getLayoutMode=function(){return ke},f.__private__.setDisplayMode=f.setDisplayMode=function(b,N,V){return qe(b),Ie(N),de(V),this};var Pe={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(b){if(Object.keys(Pe).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Pe[b]},f.__private__.getDocumentProperties=function(){return Pe},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(b){for(var N in Pe)Pe.hasOwnProperty(N)&&b[N]&&(Pe[N]=b[N]);return this},f.__private__.setDocumentProperty=function(b,N){if(Object.keys(Pe).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Pe[b]=N};var Wt,me,Yt,ji,De,xe={},Ce={},yi=[],Jt={},ci={},se={},fe={},wi=null,Le=0,ie=[],ze=new nA(f),Lh=r.hotfixes||[],Un={},$a={},aa=[],ne=function b(N,V,tt,ht,wt,St){if(!(this instanceof b))return new b(N,V,tt,ht,wt,St);isNaN(N)&&(N=1),isNaN(V)&&(V=0),isNaN(tt)&&(tt=0),isNaN(ht)&&(ht=1),isNaN(wt)&&(wt=0),isNaN(St)&&(St=0),this._matrix=[N,V,tt,ht,wt,St]};Object.defineProperty(ne.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(ne.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(ne.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(ne.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(ne.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(ne.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(ne.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(ne.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(ne.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(ne.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(ne.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(ne.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(ne.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ne.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ne.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ne.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ne.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map($).join(b)},ne.prototype.multiply=function(b){var N=b.sx*this.sx+b.shy*this.shx,V=b.sx*this.shy+b.shy*this.sy,tt=b.shx*this.sx+b.sy*this.shx,ht=b.shx*this.shy+b.sy*this.sy,wt=b.tx*this.sx+b.ty*this.shx+this.tx,St=b.tx*this.shy+b.ty*this.sy+this.ty;return new ne(N,V,tt,ht,wt,St)},ne.prototype.decompose=function(){var b=this.sx,N=this.shy,V=this.shx,tt=this.sy,ht=this.tx,wt=this.ty,St=Math.sqrt(b*b+N*N),Ut=(b/=St)*V+(N/=St)*tt;V-=b*Ut,tt-=N*Ut;var Gt=Math.sqrt(V*V+tt*tt);return Ut/=Gt,b*(tt/=Gt)<N*(V/=Gt)&&(b=-b,N=-N,Ut=-Ut,St=-St),{scale:new ne(St,0,0,Gt,0,0),translate:new ne(1,0,0,1,ht,wt),rotate:new ne(b,N,-N,b,0,0),skew:new ne(1,0,Ut,1,0,0)}},ne.prototype.toString=function(b){return this.join(" ")},ne.prototype.inversed=function(){var b=this.sx,N=this.shy,V=this.shx,tt=this.sy,ht=this.tx,wt=this.ty,St=1/(b*tt-N*V),Ut=tt*St,Gt=-N*St,ae=-V*St,be=b*St;return new ne(Ut,Gt,ae,be,-Ut*ht-ae*wt,-Gt*ht-be*wt)},ne.prototype.applyToPoint=function(b){var N=b.x*this.sx+b.y*this.shx+this.tx,V=b.x*this.shy+b.y*this.sy+this.ty;return new to(N,V)},ne.prototype.applyToRectangle=function(b){var N=this.applyToPoint(b),V=this.applyToPoint(new to(b.x+b.w,b.y+b.h));return new Vf(N.x,N.y,V.x-N.x,V.y-N.y)},ne.prototype.clone=function(){var b=this.sx,N=this.shy,V=this.shx,tt=this.sy,ht=this.tx,wt=this.ty;return new ne(b,N,V,tt,ht,wt)},f.Matrix=ne;var Xa=f.matrixMult=function(b,N){return N.multiply(b)},Ya=new ne(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Ya;var rr=function(b,N){if(!ci[b]){var V=(N instanceof Pl?"Sh":"P")+(Object.keys(Jt).length+1).toString(10);N.id=V,ci[b]=V,Jt[V]=N,ze.publish("addPattern",N)}};f.ShadingPattern=Pl,f.TilingPattern=Jh,f.addShadingPattern=function(b,N){return B("addShadingPattern()"),rr(b,N),this},f.beginTilingPattern=function(b){B("beginTilingPattern()"),$f(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},f.endTilingPattern=function(b,N){B("endTilingPattern()"),N.stream=Lt[z].join(`
`),rr(b,N),ze.publish("endTilingPattern",N),aa.pop().restore()};var ar,Ni=f.__private__.newObject=function(){var b=bn();return Cn(b,!0),b},bn=f.__private__.newObjectDeferred=function(){return it++,at[it]=function(){return gt},it},Cn=function(b,N){return N=typeof N=="boolean"&&N,at[b]=gt,N&&q(b+" 0 obj"),b},Eh=f.__private__.newAdditionalObject=function(){var b={objId:bn(),content:""};return yt.push(b),b},cl=bn(),Tr=bn(),oa=f.__private__.decodeColorString=function(b){var N=b.split(" ");if(N.length!==2||N[1]!=="g"&&N[1]!=="G")N.length!==5||N[4]!=="k"&&N[4]!=="K"||(N=[(1-N[0])*(1-N[3]),(1-N[1])*(1-N[3]),(1-N[2])*(1-N[3]),"r"]);else{var V=parseFloat(N[0]);N=[V,V,V,"r"]}for(var tt="#",ht=0;ht<3;ht++)tt+=("0"+Math.floor(255*parseFloat(N[ht])).toString(16)).slice(-2);return tt},Ir=f.__private__.encodeColorString=function(b){var N;typeof b=="string"&&(b={ch1:b});var V=b.ch1,tt=b.ch2,ht=b.ch3,wt=b.ch4,St=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof V=="string"&&V.charAt(0)!=="#"){var Ut=new E3(V);if(Ut.ok)V=Ut.toHex();else if(!/^\d*\.?\d*$/.test(V))throw new Error('Invalid color "'+V+'" passed to jsPDF.encodeColorString.')}if(typeof V=="string"&&/^#[0-9A-Fa-f]{3}$/.test(V)&&(V="#"+V[1]+V[1]+V[2]+V[2]+V[3]+V[3]),typeof V=="string"&&/^#[0-9A-Fa-f]{6}$/.test(V)){var Gt=parseInt(V.substr(1),16);V=Gt>>16&255,tt=Gt>>8&255,ht=255&Gt}if(tt===void 0||wt===void 0&&V===tt&&tt===ht)N=typeof V=="string"?V+" "+St[0]:b.precision===2?I(V/255)+" "+St[0]:j(V/255)+" "+St[0];else if(wt===void 0||Ke(wt)==="object"){if(wt&&!isNaN(wt.a)&&wt.a===0)return["1.","1.","1.",St[1]].join(" ");N=typeof V=="string"?[V,tt,ht,St[1]].join(" "):b.precision===2?[I(V/255),I(tt/255),I(ht/255),St[1]].join(" "):[j(V/255),j(tt/255),j(ht/255),St[1]].join(" ")}else N=typeof V=="string"?[V,tt,ht,wt,St[2]].join(" "):b.precision===2?[I(V),I(tt),I(ht),I(wt),St[2]].join(" "):[j(V),j(tt),j(ht),j(wt),St[2]].join(" ");return N},Fr=f.__private__.getFilters=function(){return a},or=f.__private__.putStream=function(b){var N=(b=b||{}).data||"",V=b.filters||Fr(),tt=b.alreadyAppliedFilters||[],ht=b.addLength1||!1,wt=N.length,St=b.objectId,Ut=function(rn){return rn};if(u!==null&&St===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Ut=sn.encryptor(St,0));var Gt={};V===!0&&(V=["FlateEncode"]);var ae=b.additionalKeyValues||[],be=(Gt=Vt.API.processDataByFilters!==void 0?Vt.API.processDataByFilters(N,V):{data:N,reverseChain:[]}).reverseChain+(Array.isArray(tt)?tt.join(" "):tt.toString());if(Gt.data.length!==0&&(ae.push({key:"Length",value:Gt.data.length}),ht===!0&&ae.push({key:"Length1",value:wt})),be.length!=0)if(be.split("/").length-1==1)ae.push({key:"Filter",value:be});else{ae.push({key:"Filter",value:"["+be+"]"});for(var Oe=0;Oe<ae.length;Oe+=1)if(ae[Oe].key==="DecodeParms"){for(var Ci=[],Ji=0;Ji<Gt.reverseChain.split("/").length-1;Ji+=1)Ci.push("null");Ci.push(ae[Oe].value),ae[Oe].value="["+Ci.join(" ")+"]"}}q("<<");for(var ui=0;ui<ae.length;ui++)q("/"+ae[ui].key+" "+ae[ui].value);q(">>"),Gt.data.length!==0&&(q("stream"),q(Ut(Gt.data)),q("endstream"))},kh=f.__private__.putPage=function(b){var N=b.number,V=b.data,tt=b.objId,ht=b.contentsObjId;Cn(tt,!0),q("<</Type /Page"),q("/Parent "+b.rootDictionaryObjId+" 0 R"),q("/Resources "+b.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat($(b.mediaBox.bottomLeftX))+" "+parseFloat($(b.mediaBox.bottomLeftY))+" "+$(b.mediaBox.topRightX)+" "+$(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&q("/CropBox ["+$(b.cropBox.bottomLeftX)+" "+$(b.cropBox.bottomLeftY)+" "+$(b.cropBox.topRightX)+" "+$(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&q("/BleedBox ["+$(b.bleedBox.bottomLeftX)+" "+$(b.bleedBox.bottomLeftY)+" "+$(b.bleedBox.topRightX)+" "+$(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&q("/TrimBox ["+$(b.trimBox.bottomLeftX)+" "+$(b.trimBox.bottomLeftY)+" "+$(b.trimBox.topRightX)+" "+$(b.trimBox.topRightY)+"]"),b.artBox!==null&&q("/ArtBox ["+$(b.artBox.bottomLeftX)+" "+$(b.artBox.bottomLeftY)+" "+$(b.artBox.topRightX)+" "+$(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&q("/UserUnit "+b.userUnit),ze.publish("putPage",{objId:tt,pageContext:ie[N],pageNumber:N,page:V}),q("/Contents "+ht+" 0 R"),q(">>"),q("endobj");var wt=V.join(`
`);return P===L&&(wt+=`
Q`),Cn(ht,!0),or({data:wt,filters:Fr(),objectId:ht}),q("endobj"),tt},la=f.__private__.putPages=function(){var b,N,V=[];for(b=1;b<=Le;b++)ie[b].objId=bn(),ie[b].contentsObjId=bn();for(b=1;b<=Le;b++)V.push(kh({number:b,data:Lt[b],objId:ie[b].objId,contentsObjId:ie[b].contentsObjId,mediaBox:ie[b].mediaBox,cropBox:ie[b].cropBox,bleedBox:ie[b].bleedBox,trimBox:ie[b].trimBox,artBox:ie[b].artBox,userUnit:ie[b].userUnit,rootDictionaryObjId:cl,resourceDictionaryObjId:Tr}));Cn(cl,!0),q("<</Type /Pages");var tt="/Kids [";for(N=0;N<Le;N++)tt+=V[N]+" 0 R ";q(tt+"]"),q("/Count "+Le),q(">>"),q("endobj"),ze.publish("postPutPages")},Ph=function(b){ze.publish("putFont",{font:b,out:q,newObject:Ni,putStream:or}),b.isAlreadyPutted!==!0&&(b.objectNumber=Ni(),q("<<"),q("/Type /Font"),q("/BaseFont /"+Ku(b.postScriptName)),q("/Subtype /Type1"),typeof b.encoding=="string"&&q("/Encoding /"+b.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},xu=function(b){b.objectNumber=Ni();var N=[];N.push({key:"Type",value:"/XObject"}),N.push({key:"Subtype",value:"/Form"}),N.push({key:"BBox",value:"["+[$(b.x),$(b.y),$(b.x+b.width),$(b.y+b.height)].join(" ")+"]"}),N.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var V=b.pages[1].join(`
`);or({data:V,additionalKeyValues:N,objectId:b.objectNumber}),q("endobj")},Cu=function(b,N){N||(N=21);var V=Ni(),tt=(function(St,Ut){var Gt,ae=[],be=1/(Ut-1);for(Gt=0;Gt<1;Gt+=be)ae.push(Gt);if(ae.push(1),St[0].offset!=0){var Oe={offset:0,color:St[0].color};St.unshift(Oe)}if(St[St.length-1].offset!=1){var Ci={offset:1,color:St[St.length-1].color};St.push(Ci)}for(var Ji="",ui=0,rn=0;rn<ae.length;rn++){for(Gt=ae[rn];Gt>St[ui+1].offset;)ui++;var Zi=St[ui].offset,Ln=(Gt-Zi)/(St[ui+1].offset-Zi),no=St[ui].color,Rr=St[ui+1].color;Ji+=Q(Math.round((1-Ln)*no[0]+Ln*Rr[0]).toString(16))+Q(Math.round((1-Ln)*no[1]+Ln*Rr[1]).toString(16))+Q(Math.round((1-Ln)*no[2]+Ln*Rr[2]).toString(16))}return Ji.trim()})(b.colors,N),ht=[];ht.push({key:"FunctionType",value:"0"}),ht.push({key:"Domain",value:"[0.0 1.0]"}),ht.push({key:"Size",value:"["+N+"]"}),ht.push({key:"BitsPerSample",value:"8"}),ht.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ht.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),or({data:tt,additionalKeyValues:ht,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:V}),q("endobj"),b.objectNumber=Ni(),q("<< /ShadingType "+b.type),q("/ColorSpace /DeviceRGB");var wt="/Coords ["+$(parseFloat(b.coords[0]))+" "+$(parseFloat(b.coords[1]))+" ";b.type===2?wt+=$(parseFloat(b.coords[2]))+" "+$(parseFloat(b.coords[3])):wt+=$(parseFloat(b.coords[2]))+" "+$(parseFloat(b.coords[3]))+" "+$(parseFloat(b.coords[4]))+" "+$(parseFloat(b.coords[5])),q(wt+="]"),b.matrix&&q("/Matrix ["+b.matrix.toString()+"]"),q("/Function "+V+" 0 R"),q("/Extend [true true]"),q(">>"),q("endobj")},Lu=function(b,N){var V=bn(),tt=Ni();N.push({resourcesOid:V,objectOid:tt}),b.objectNumber=tt;var ht=[];ht.push({key:"Type",value:"/Pattern"}),ht.push({key:"PatternType",value:"1"}),ht.push({key:"PaintType",value:"1"}),ht.push({key:"TilingType",value:"1"}),ht.push({key:"BBox",value:"["+b.boundingBox.map($).join(" ")+"]"}),ht.push({key:"XStep",value:$(b.xStep)}),ht.push({key:"YStep",value:$(b.yStep)}),ht.push({key:"Resources",value:V+" 0 R"}),b.matrix&&ht.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),or({data:b.stream,additionalKeyValues:ht,objectId:b.objectNumber}),q("endobj")},N2=function(b){for(var N in b.objectNumber=Ni(),q("<<"),b)switch(N){case"opacity":q("/ca "+I(b[N]));break;case"stroke-opacity":q("/CA "+I(b[N]))}q(">>"),q("endobj")},Bf=function(b){Cn(b.resourcesOid,!0),q("<<"),q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var N in q("/Font <<"),xe)xe.hasOwnProperty(N)&&(p===!1||p===!0&&g.hasOwnProperty(N))&&q("/"+N+" "+xe[N].objectNumber+" 0 R");q(">>")})(),(function(){if(Object.keys(Jt).length>0){for(var N in q("/Shading <<"),Jt)Jt.hasOwnProperty(N)&&Jt[N]instanceof Pl&&Jt[N].objectNumber>=0&&q("/"+N+" "+Jt[N].objectNumber+" 0 R");ze.publish("putShadingPatternDict"),q(">>")}})(),(function(N){if(Object.keys(Jt).length>0){for(var V in q("/Pattern <<"),Jt)Jt.hasOwnProperty(V)&&Jt[V]instanceof f.TilingPattern&&Jt[V].objectNumber>=0&&Jt[V].objectNumber<N&&q("/"+V+" "+Jt[V].objectNumber+" 0 R");ze.publish("putTilingPatternDict"),q(">>")}})(b.objectOid),(function(){if(Object.keys(se).length>0){var N;for(N in q("/ExtGState <<"),se)se.hasOwnProperty(N)&&se[N].objectNumber>=0&&q("/"+N+" "+se[N].objectNumber+" 0 R");ze.publish("putGStateDict"),q(">>")}})(),(function(){for(var N in q("/XObject <<"),Un)Un.hasOwnProperty(N)&&Un[N].objectNumber>=0&&q("/"+N+" "+Un[N].objectNumber+" 0 R");ze.publish("putXobjectDict"),q(">>")})(),q(">>"),q("endobj")},i0=function(b){Ce[b.fontName]=Ce[b.fontName]||{},Ce[b.fontName][b.fontStyle]=b.id},n0=function(b,N,V,tt,ht){var wt={id:"F"+(Object.keys(xe).length+1).toString(10),postScriptName:b,fontName:N,fontStyle:V,encoding:tt,isStandardFont:ht||!1,metadata:{}};return ze.publish("addFont",{font:wt,instance:this}),xe[wt.id]=wt,i0(wt),wt.id},lr=f.__private__.pdfEscape=f.pdfEscape=function(b,N){return(function(V,tt){var ht,wt,St,Ut,Gt,ae,be,Oe,Ci;if(St=(tt=tt||{}).sourceEncoding||"Unicode",Gt=tt.outputEncoding,(tt.autoencode||Gt)&&xe[Wt].metadata&&xe[Wt].metadata[St]&&xe[Wt].metadata[St].encoding&&(Ut=xe[Wt].metadata[St].encoding,!Gt&&xe[Wt].encoding&&(Gt=xe[Wt].encoding),!Gt&&Ut.codePages&&(Gt=Ut.codePages[0]),typeof Gt=="string"&&(Gt=Ut[Gt]),Gt)){for(be=!1,ae=[],ht=0,wt=V.length;ht<wt;ht++)(Oe=Gt[V.charCodeAt(ht)])?ae.push(String.fromCharCode(Oe)):ae.push(V[ht]),ae[ht].charCodeAt(0)>>8&&(be=!0);V=ae.join("")}for(ht=V.length;be===void 0&&ht!==0;)V.charCodeAt(ht-1)>>8&&(be=!0),ht--;if(!be)return V;for(ae=tt.noBOM?[]:[254,255],ht=0,wt=V.length;ht<wt;ht++){if((Ci=(Oe=V.charCodeAt(ht))>>8)>>8)throw new Error("Character at position "+ht+" of string '"+V+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ae.push(Ci),ae.push(Oe-(Ci<<8))}return String.fromCharCode.apply(void 0,ae)})(b,N).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jf=f.__private__.beginPage=function(b){Lt[++Le]=[],ie[Le]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},r0(Le),Xt(Lt[z])},s0=function(b,N){var V,tt,ht;switch(e=N||e,typeof b=="string"&&(V=w(b.toLowerCase()),Array.isArray(V)&&(tt=V[0],ht=V[1])),Array.isArray(b)&&(tt=b[0]*me,ht=b[1]*me),isNaN(tt)&&(tt=n[0],ht=n[1]),(tt>14400||ht>14400)&&(oi.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),tt=Math.min(14400,tt),ht=Math.min(14400,ht)),n=[tt,ht],e.substr(0,1)){case"l":ht>tt&&(n=[ht,tt]);break;case"p":tt>ht&&(n=[ht,tt])}jf(n),oe(qf),q(Nu),Wf!==0&&q(Wf+" J"),Gf!==0&&q(Gf+" j"),ze.publish("addPage",{pageNumber:Le})},Uf=function(b){b>0&&b<=Le&&(Lt.splice(b,1),ie.splice(b,1),Le--,z>Le&&(z=Le),this.setPage(z))},r0=function(b){b>0&&b<=Le&&(z=b)},a0=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Lt.length-1},o0=function(b,N,V){var tt,ht=void 0;return V=V||{},b=b!==void 0?b:xe[Wt].fontName,N=N!==void 0?N:xe[Wt].fontStyle,tt=b.toLowerCase(),Ce[tt]!==void 0&&Ce[tt][N]!==void 0?ht=Ce[tt][N]:Ce[b]!==void 0&&Ce[b][N]!==void 0?ht=Ce[b][N]:V.disableWarning===!1&&oi.warn("Unable to look up font label for font '"+b+"', '"+N+"'. Refer to getFontList() for available fonts."),ht||V.noFallback||(ht=Ce.times[N])==null&&(ht=Ce.times.normal),ht},ha=f.__private__.putInfo=function(){var b=Ni(),N=function(tt){return tt};for(var V in u!==null&&(N=sn.encryptor(b,0)),q("<<"),q("/Producer ("+lr(N("jsPDF "+Vt.version))+")"),Pe)Pe.hasOwnProperty(V)&&Pe[V]&&q("/"+V.substr(0,1).toUpperCase()+V.substr(1)+" ("+lr(N(Pe[V]))+")");q("/CreationDate ("+lr(N(ot))+")"),q(">>"),q("endobj")},Eu=f.__private__.putCatalog=function(b){var N=(b=b||{}).rootDictionaryObjId||cl;switch(Ni(),q("<<"),q("/Type /Catalog"),q("/Pages "+N+" 0 R"),te||(te="fullwidth"),te){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var V=""+te;V.substr(V.length-1)==="%"&&(te=parseInt(te)/100),typeof te=="number"&&q("/OpenAction [3 0 R /XYZ null null "+I(te)+"]")}switch(ke||(ke="continuous"),ke){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}Kt&&q("/PageMode /"+Kt),ze.publish("putCatalog"),q(">>"),q("endobj")},T2=f.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+(it+1)),q("/Root "+it+" 0 R"),q("/Info "+(it-1)+" 0 R"),u!==null&&q("/Encrypt "+sn.oid+" 0 R"),q("/ID [ <"+rt+"> <"+rt+"> ]"),q(">>")},Ki=f.__private__.putHeader=function(){q("%PDF-"+A),q("%ºß¬à")},l0=f.__private__.putXRef=function(){var b="0000000000";q("xref"),q("0 "+(it+1)),q("0000000000 65535 f ");for(var N=1;N<=it;N++)typeof at[N]=="function"?q((b+at[N]()).slice(-10)+" 00000 n "):at[N]!==void 0?q((b+at[N]).slice(-10)+" 00000 n "):q("0000000000 00000 n ")},ca=f.__private__.buildDocument=function(){var b;it=0,gt=0,pt=[],at=[],yt=[],cl=bn(),Tr=bn(),Xt(pt),ze.publish("buildDocument"),Ki(),la(),(function(){ze.publish("putAdditionalObjects");for(var V=0;V<yt.length;V++){var tt=yt[V];Cn(tt.objId,!0),q(tt.content),q("endobj")}ze.publish("postPutAdditionalObjects")})(),b=[],(function(){for(var V in xe)xe.hasOwnProperty(V)&&(p===!1||p===!0&&g.hasOwnProperty(V))&&Ph(xe[V])})(),(function(){var V;for(V in se)se.hasOwnProperty(V)&&N2(se[V])})(),(function(){for(var V in Un)Un.hasOwnProperty(V)&&xu(Un[V])})(),(function(V){var tt;for(tt in Jt)Jt.hasOwnProperty(tt)&&(Jt[tt]instanceof Pl?Cu(Jt[tt]):Jt[tt]instanceof Jh&&Lu(Jt[tt],V))})(b),ze.publish("putResources"),b.forEach(Bf),Bf({resourcesOid:Tr,objectOid:Number.MAX_SAFE_INTEGER}),ze.publish("postPutResources"),u!==null&&(sn.oid=Ni(),q("<<"),q("/Filter /Standard"),q("/V "+sn.v),q("/R "+sn.r),q("/U <"+sn.toHexString(sn.U)+">"),q("/O <"+sn.toHexString(sn.O)+">"),q("/P "+sn.P),q(">>"),q("endobj")),ha(),Eu();var N=gt;return l0(),T2(),q("startxref"),q(""+N),q("%%EOF"),Xt(Lt[z]),pt.join(`
`)},ku=f.__private__.getBlob=function(b){return new Blob([Se(b)],{type:"application/pdf"})},h0=f.output=f.__private__.output=(ar=function(b,N){switch(typeof(N=N||{})=="string"?N={filename:N}:N.filename=N.filename||"generated.pdf",b){case void 0:return ca();case"save":f.save(N.filename);break;case"arraybuffer":return Se(ca());case"blob":return ku(ca());case"bloburi":case"bloburl":if(re.URL!==void 0&&typeof re.URL.createObjectURL=="function")return re.URL&&re.URL.createObjectURL(ku(ca()))||void 0;oi.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var V="",tt=ca();try{V=tA(tt)}catch{V=tA(unescape(encodeURIComponent(tt)))}return"data:application/pdf;filename="+N.filename+";base64,"+V;case"pdfobjectnewwindow":if(Object.prototype.toString.call(re)==="[object Window]"){var ht="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",wt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';N.pdfObjectUrl&&(ht=N.pdfObjectUrl,wt="");var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ht+'"'+wt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(N)+");<\/script></body></html>",Ut=re.open();return Ut!==null&&Ut.document.write(St),Ut}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(re)==="[object Window]"){var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(N.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+N.filename+'" width="500px" height="400px" /></body></html>',ae=re.open();if(ae!==null){ae.document.write(Gt);var be=this;ae.document.documentElement.querySelector("#pdfViewer").onload=function(){ae.document.title=N.filename,ae.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(be.output("bloburl"))}}return ae}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(re)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Oe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",N)+'"></iframe></body></html>',Ci=re.open();if(Ci!==null&&(Ci.document.write(Oe),Ci.document.title=N.filename),Ci||typeof safari>"u")return Ci;break;case"datauri":case"dataurl":return re.document.location.href=this.output("datauristring",N);default:return null}},ar.foo=function(){try{return ar.apply(this,arguments)}catch(V){var b=V.stack||"";~b.indexOf(" at ")&&(b=b.split(" at ")[1]);var N="Error in function "+b.split(`
`)[0].split("<")[0]+": "+V.message;if(!re.console)throw new Error(N);re.console.error(N,V),re.alert&&alert(N)}},ar.foo.bar=ar,ar.foo),hr=function(b){return Array.isArray(Lh)===!0&&Lh.indexOf(b)>-1};switch(i){case"pt":me=1;break;case"mm":me=72/25.4;break;case"cm":me=72/2.54;break;case"in":me=72;break;case"px":me=hr("px_scaling")==1?.75:96/72;break;case"pc":case"em":me=12;break;case"ex":me=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);me=i}var sn=null;At(),st();var Ka=f.__private__.getPageInfo=f.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ie[b].objId,pageNumber:b,pageContext:ie[b]}},c0=f.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var N in ie)if(ie[N].objId===b)break;return Ka(N)},I2=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:ie[z].objId,pageNumber:z,pageContext:ie[z]}};f.addPage=function(){return s0.apply(this,arguments),this},f.setPage=function(){return r0.apply(this,arguments),Xt.call(this,Lt[z]),this},f.insertPage=function(b){return this.addPage(),this.movePage(z,b),this},f.movePage=function(b,N){var V,tt;if(b>N){V=Lt[b],tt=ie[b];for(var ht=b;ht>N;ht--)Lt[ht]=Lt[ht-1],ie[ht]=ie[ht-1];Lt[N]=V,ie[N]=tt,this.setPage(N)}else if(b<N){V=Lt[b],tt=ie[b];for(var wt=b;wt<N;wt++)Lt[wt]=Lt[wt+1],ie[wt]=ie[wt+1];Lt[N]=V,ie[N]=tt,this.setPage(N)}return this},f.deletePage=function(){return Uf.apply(this,arguments),this},f.__private__.text=f.text=function(b,N,V,tt,ht){var wt,St,Ut,Gt,ae,be,Oe,Ci,Ji,ui=(tt=tt||{}).scope||this;if(typeof b=="number"&&typeof N=="number"&&(typeof V=="string"||Array.isArray(V))){var rn=V;V=N,N=b,b=rn}if(arguments[3]instanceof ne==0?(Ut=arguments[4],Gt=arguments[5],Ke(Oe=arguments[3])==="object"&&Oe!==null||(typeof Ut=="string"&&(Gt=Ut,Ut=null),typeof Oe=="string"&&(Gt=Oe,Oe=null),typeof Oe=="number"&&(Ut=Oe,Oe=null),tt={flags:Oe,angle:Ut,align:Gt})):(B("The transform parameter of text() with a Matrix value"),Ji=ht),isNaN(N)||isNaN(V)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return ui;var Zi,Ln="",no=typeof tt.lineHeightFactor=="number"?tt.lineHeightFactor:Th,Rr=ui.internal.scaleFactor;function so(We){return We=We.split("	").join(Array(tt.TabLen||9).join(" ")),lr(We,Oe)}function Yf(We){for(var ni,Hi=We.concat(),an=[],oo=Hi.length;oo--;)typeof(ni=Hi.shift())=="string"?an.push(ni):Array.isArray(We)&&(ni.length===1||ni[1]===void 0&&ni[2]===void 0)?an.push(ni[0]):an.push([ni[0],ni[1],ni[2]]);return an}function Iu(We,ni){var Hi;if(typeof We=="string")Hi=ni(We)[0];else if(Array.isArray(We)){for(var an,oo,rp=We.concat(),Ru=[],A0=rp.length;A0--;)typeof(an=rp.shift())=="string"?Ru.push(ni(an)[0]):Array.isArray(an)&&typeof an[0]=="string"&&(oo=ni(an[0],an[1],an[2]),Ru.push([oo[0],oo[1],oo[2]]));Hi=Ru}return Hi}var ul=!1,Rh=!0;if(typeof b=="string")ul=!0;else if(Array.isArray(b)){var Dh=b.concat();St=[];for(var dl,En=Dh.length;En--;)(typeof(dl=Dh.shift())!="string"||Array.isArray(dl)&&typeof dl[0]!="string")&&(Rh=!1);ul=Rh}if(ul===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var Oh=Et/ui.internal.scaleFactor,Bh=Oh*(no-1);switch(tt.baseline){case"bottom":V-=Bh;break;case"top":V+=Oh-Bh;break;case"hanging":V+=Oh-2*Bh;break;case"middle":V+=Oh/2-Bh}if((be=tt.maxWidth||0)>0&&(typeof b=="string"?b=ui.splitTextToSize(b,be):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(We,ni){return We.concat(ui.splitTextToSize(ni,be))},[]))),wt={text:b,x:N,y:V,options:tt,mutex:{pdfEscape:lr,activeFontKey:Wt,fonts:xe,activeFontSize:Et}},ze.publish("preProcessText",wt),b=wt.text,Ut=(tt=wt.options).angle,Ji instanceof ne==0&&Ut&&typeof Ut=="number"){Ut*=Math.PI/180,tt.rotationDirection===0&&(Ut=-Ut),P===L&&(Ut=-Ut);var Kf=Math.cos(Ut),Jf=Math.sin(Ut);Ji=new ne(Kf,Jf,-Jf,Kf,0,0)}else Ut&&Ut instanceof ne&&(Ji=Ut);P!==L||Ji||(Ji=Ya),(ae=tt.charSpace||Qa)!==void 0&&(Ln+=$(K(ae))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ci=tt.horizontalScale)!==void 0&&(Ln+=$(100*Ci)+` Tz
`),tt.lang;var ts=-1,ro=tt.renderingMode!==void 0?tt.renderingMode:tt.stroke,Fu=ui.internal.getCurrentPageInfo().pageContext;switch(ro){case 0:case!1:case"fill":ts=0;break;case 1:case!0:case"stroke":ts=1;break;case 2:case"fillThenStroke":ts=2;break;case 3:case"invisible":ts=3;break;case 4:case"fillAndAddForClipping":ts=4;break;case 5:case"strokeAndAddPathForClipping":ts=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ts=6;break;case 7:case"addToPathForClipping":ts=7}var y0=Fu.usedRenderingMode!==void 0?Fu.usedRenderingMode:-1;ts!==-1?Ln+=ts+` Tr
`:y0!==-1&&(Ln+=`0 Tr
`),ts!==-1&&(Fu.usedRenderingMode=ts),Gt=tt.align||"left";var cr,jh=Et*no,Zf=ui.internal.pageSize.getWidth(),Qf=xe[Wt];ae=tt.charSpace||Qa,be=tt.maxWidth||0,Oe=Object.assign({autoencode:!0,noBOM:!0},tt.flags);var fl=[],Uh=function(We){return ui.getStringUnitWidth(We,{font:Qf,charSpace:ae,fontSize:Et,doKerning:!1})*Et/Rr};if(Object.prototype.toString.call(b)==="[object Array]"){var xs;St=Yf(b),Gt!=="left"&&(cr=St.map(Uh));var Cs,pl=0;if(Gt==="right"){N-=cr[0],b=[],En=St.length;for(var ao=0;ao<En;ao++)ao===0?(Cs=Ja(N),xs=Za(V)):(Cs=K(pl-cr[ao]),xs=-jh),b.push([St[ao],Cs,xs]),pl=cr[ao]}else if(Gt==="center"){N-=cr[0]/2,b=[],En=St.length;for(var gl=0;gl<En;gl++)gl===0?(Cs=Ja(N),xs=Za(V)):(Cs=K((pl-cr[gl])/2),xs=-jh),b.push([St[gl],Cs,xs]),pl=cr[gl]}else if(Gt==="left"){b=[],En=St.length;for(var tp=0;tp<En;tp++)b.push(St[tp])}else if(Gt==="justify"&&Qf.encoding==="Identity-H"){b=[],En=St.length,be=be!==0?be:Zf;for(var Mu=0,Ui=0;Ui<En;Ui++)if(xs=Ui===0?Za(V):-jh,Cs=Ui===0?Ja(N):Mu,Ui<En-1){var w0=K((be-cr[Ui])/(St[Ui].split(" ").length-1)),da=St[Ui].split(" ");b.push([da[0]+" ",Cs,xs]),Mu=0;for(var fa=1;fa<da.length;fa++){var ep=(Uh(da[fa-1]+" "+da[fa])-Uh(da[fa]))*Rr+w0;fa==da.length-1?b.push([da[fa],ep,0]):b.push([da[fa]+" ",ep,0]),Mu-=ep}}else b.push([St[Ui],Cs,xs]);b.push(["",Mu,0])}else{if(Gt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],En=St.length,be=be!==0?be:Zf,Ui=0;Ui<En;Ui++){xs=Ui===0?Za(V):-jh,Cs=Ui===0?Ja(N):0;var ip=St[Ui].split(" ").length-1,np=ip>0?(be-cr[Ui])/ip:0;Ui<En-1?fl.push($(K(np))):fl.push(0),b.push([St[Ui],Cs,xs])}}}(typeof tt.R2L=="boolean"?tt.R2L:Zt)===!0&&(b=Iu(b,function(We,ni,Hi){return[We.split("").reverse().join(""),ni,Hi]})),wt={text:b,x:N,y:V,options:tt,mutex:{pdfEscape:lr,activeFontKey:Wt,fonts:xe,activeFontSize:Et}},ze.publish("postProcessText",wt),b=wt.text,Zi=wt.mutex.isHex||!1;var sp=xe[Wt].encoding;sp!=="WinAnsiEncoding"&&sp!=="StandardEncoding"||(b=Iu(b,function(We,ni,Hi){return[so(We),ni,Hi]})),St=Yf(b),b=[];for(var ml,bl,vl,Hh=Array.isArray(St[0])?1:0,yl="",qh=function(We,ni,Hi){var an="";return Hi instanceof ne?(Hi=typeof tt.angle=="number"?Xa(Hi,new ne(1,0,0,1,We,ni)):Xa(new ne(1,0,0,1,We,ni),Hi),P===L&&(Hi=Xa(new ne(1,0,0,-1,0,0),Hi)),an=Hi.join(" ")+` Tm
`):an=$(We)+" "+$(ni)+` Td
`,an},ur=0;ur<St.length;ur++){switch(yl="",Hh){case 1:vl=(Zi?"<":"(")+St[ur][0]+(Zi?">":")"),ml=parseFloat(St[ur][1]),bl=parseFloat(St[ur][2]);break;case 0:vl=(Zi?"<":"(")+St[ur]+(Zi?">":")"),ml=Ja(N),bl=Za(V)}fl!==void 0&&fl[ur]!==void 0&&(yl=fl[ur]+` Tw
`),ur===0?b.push(yl+qh(ml,bl,Ji)+vl):Hh===0?b.push(yl+vl):Hh===1&&b.push(yl+qh(ml,bl,Ji)+vl)}b=Hh===0?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var pa=`BT
/`;return pa+=Wt+" "+Et+` Tf
`,pa+=$(Et*no)+` TL
`,pa+=Ih+`
`,pa+=Ln,pa+=b,q(pa+="ET"),g[Wt]=!0,ui};var F2=f.__private__.clip=f.clip=function(b){return q(b==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return F2("evenodd")},f.__private__.discardPath=f.discardPath=function(){return q("n"),this};var ua=f.__private__.isValidStyle=function(b){var N=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(N=!0),N};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(b){return ua(b)&&(c=b),this};var u0=f.__private__.getStyle=f.getStyle=function(b){var N=c;switch(b){case"D":case"S":N="S";break;case"F":N="f";break;case"FD":case"DF":N="B";break;case"f":case"f*":case"B":case"B*":N=b}return N},d0=f.close=function(){return q("h"),this};f.stroke=function(){return q("S"),this},f.fill=function(b){return Pu("f",b),this},f.fillEvenOdd=function(b){return Pu("f*",b),this},f.fillStroke=function(b){return Pu("B",b),this},f.fillStrokeEvenOdd=function(b){return Pu("B*",b),this};var Pu=function(b,N){Ke(N)==="object"?R2(N,b):q(b)},Nh=function(b){b===null||P===L&&b===void 0||(b=u0(b),q(b))};function M2(b,N,V,tt,ht){var wt=new Jh(N||this.boundingBox,V||this.xStep,tt||this.yStep,this.gState,ht||this.matrix);wt.stream=this.stream;var St=b+"$$"+this.cloneIndex+++"$$";return rr(St,wt),wt}var R2=function(b,N){var V=ci[b.key],tt=Jt[V];if(tt instanceof Pl)q("q"),q(D2(N)),tt.gState&&f.setGState(tt.gState),q(b.matrix.toString()+" cm"),q("/"+V+" sh"),q("Q");else if(tt instanceof Jh){var ht=new ne(1,0,0,-1,0,Mh());b.matrix&&(ht=ht.multiply(b.matrix||Ya),V=M2.call(tt,b.key,b.boundingBox,b.xStep,b.yStep,ht).id),q("q"),q("/Pattern cs"),q("/"+V+" scn"),tt.gState&&f.setGState(tt.gState),q(N),q("Q")}},D2=function(b){switch(b){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Hf=f.moveTo=function(b,N){return q($(K(b))+" "+$(Y(N))+" m"),this},f0=f.lineTo=function(b,N){return q($(K(b))+" "+$(Y(N))+" l"),this},Mr=f.curveTo=function(b,N,V,tt,ht,wt){return q([$(K(b)),$(Y(N)),$(K(V)),$(Y(tt)),$(K(ht)),$(Y(wt)),"c"].join(" ")),this};f.__private__.line=f.line=function(b,N,V,tt,ht){if(isNaN(b)||isNaN(N)||isNaN(V)||isNaN(tt)||!ua(ht))throw new Error("Invalid arguments passed to jsPDF.line");return P===k?this.lines([[V-b,tt-N]],b,N,[1,1],ht||"S"):this.lines([[V-b,tt-N]],b,N,[1,1]).stroke()},f.__private__.lines=f.lines=function(b,N,V,tt,ht,wt){var St,Ut,Gt,ae,be,Oe,Ci,Ji,ui,rn,Zi,Ln;if(typeof b=="number"&&(Ln=V,V=N,N=b,b=Ln),tt=tt||[1,1],wt=wt||!1,isNaN(N)||isNaN(V)||!Array.isArray(b)||!Array.isArray(tt)||!ua(ht)||typeof wt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Hf(N,V),St=tt[0],Ut=tt[1],ae=b.length,rn=N,Zi=V,Gt=0;Gt<ae;Gt++)(be=b[Gt]).length===2?(rn=be[0]*St+rn,Zi=be[1]*Ut+Zi,f0(rn,Zi)):(Oe=be[0]*St+rn,Ci=be[1]*Ut+Zi,Ji=be[2]*St+rn,ui=be[3]*Ut+Zi,rn=be[4]*St+rn,Zi=be[5]*Ut+Zi,Mr(Oe,Ci,Ji,ui,rn,Zi));return wt&&d0(),Nh(ht),this},f.path=function(b){for(var N=0;N<b.length;N++){var V=b[N],tt=V.c;switch(V.op){case"m":Hf(tt[0],tt[1]);break;case"l":f0(tt[0],tt[1]);break;case"c":Mr.apply(this,tt);break;case"h":d0()}}return this},f.__private__.rect=f.rect=function(b,N,V,tt,ht){if(isNaN(b)||isNaN(N)||isNaN(V)||isNaN(tt)||!ua(ht))throw new Error("Invalid arguments passed to jsPDF.rect");return P===k&&(tt=-tt),q([$(K(b)),$(Y(N)),$(K(V)),$(K(tt)),"re"].join(" ")),Nh(ht),this},f.__private__.triangle=f.triangle=function(b,N,V,tt,ht,wt,St){if(isNaN(b)||isNaN(N)||isNaN(V)||isNaN(tt)||isNaN(ht)||isNaN(wt)||!ua(St))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[V-b,tt-N],[ht-V,wt-tt],[b-ht,N-wt]],b,N,[1,1],St,!0),this},f.__private__.roundedRect=f.roundedRect=function(b,N,V,tt,ht,wt,St){if(isNaN(b)||isNaN(N)||isNaN(V)||isNaN(tt)||isNaN(ht)||isNaN(wt)||!ua(St))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ut=4/3*(Math.SQRT2-1);return ht=Math.min(ht,.5*V),wt=Math.min(wt,.5*tt),this.lines([[V-2*ht,0],[ht*Ut,0,ht,wt-wt*Ut,ht,wt],[0,tt-2*wt],[0,wt*Ut,-ht*Ut,wt,-ht,wt],[2*ht-V,0],[-ht*Ut,0,-ht,-wt*Ut,-ht,-wt],[0,2*wt-tt],[0,-wt*Ut,ht*Ut,-wt,ht,-wt]],b+ht,N,[1,1],St,!0),this},f.__private__.ellipse=f.ellipse=function(b,N,V,tt,ht){if(isNaN(b)||isNaN(N)||isNaN(V)||isNaN(tt)||!ua(ht))throw new Error("Invalid arguments passed to jsPDF.ellipse");var wt=4/3*(Math.SQRT2-1)*V,St=4/3*(Math.SQRT2-1)*tt;return Hf(b+V,N),Mr(b+V,N-St,b+wt,N-tt,b,N-tt),Mr(b-wt,N-tt,b-V,N-St,b-V,N),Mr(b-V,N+St,b-wt,N+tt,b,N+tt),Mr(b+wt,N+tt,b+V,N+St,b+V,N),Nh(ht),this},f.__private__.circle=f.circle=function(b,N,V,tt){if(isNaN(b)||isNaN(N)||isNaN(V)||!ua(tt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,N,V,V,tt)},f.setFont=function(b,N,V){return V&&(N=X(N,V)),Wt=o0(b,N,{disableWarning:!1}),this};var O2=f.__private__.getFont=f.getFont=function(){return xe[o0.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var b,N,V={};for(b in Ce)if(Ce.hasOwnProperty(b))for(N in V[b]=[],Ce[b])Ce[b].hasOwnProperty(N)&&V[b].push(N);return V},f.addFont=function(b,N,V,tt,ht){var wt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&wt.indexOf(arguments[3])!==-1?ht=arguments[3]:arguments[3]&&wt.indexOf(arguments[3])==-1&&(V=X(V,tt)),n0.call(this,b,N,V,ht=ht||"Identity-H")};var Th,qf=r.lineWidth||.200025,B2=f.__private__.getLineWidth=f.getLineWidth=function(){return qf},oe=f.__private__.setLineWidth=f.setLineWidth=function(b){return qf=b,q($(K(b))+" w"),this};f.__private__.setLineDash=Vt.API.setLineDash=Vt.API.setLineDashPattern=function(b,N){if(b=b||[],N=N||0,isNaN(N)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function(V){return $(K(V))}).join(" "),N=$(K(N)),q("["+b+"] "+N+" d"),this};var j2=f.__private__.getLineHeight=f.getLineHeight=function(){return Et*Th};f.__private__.getLineHeight=f.getLineHeight=function(){return Et*Th};var U2=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(Th=b),this},H2=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Th};U2(r.lineHeight);var Ja=f.__private__.getHorizontalCoordinate=function(b){return K(b)},Za=f.__private__.getVerticalCoordinate=function(b){return P===L?b:ie[z].mediaBox.topRightY-ie[z].mediaBox.bottomLeftY-K(b)},q2=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(b){return $(Ja(b))},z2=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(b){return $(Za(b))},Nu=r.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return oa(Nu)},f.__private__.setStrokeColor=f.setDrawColor=function(b,N,V,tt){return Nu=Ir({ch1:b,ch2:N,ch3:V,ch4:tt,pdfColorType:"draw",precision:2}),q(Nu),this};var zf=r.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return oa(zf)},f.__private__.setFillColor=f.setFillColor=function(b,N,V,tt){return zf=Ir({ch1:b,ch2:N,ch3:V,ch4:tt,pdfColorType:"fill",precision:2}),q(zf),this};var Ih=r.textColor||"0 g",W2=f.__private__.getTextColor=f.getTextColor=function(){return oa(Ih)};f.__private__.setTextColor=f.setTextColor=function(b,N,V,tt){return Ih=Ir({ch1:b,ch2:N,ch3:V,ch4:tt,pdfColorType:"text",precision:3}),this};var Qa=r.charSpace,G2=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Qa||0)};f.__private__.setCharSpace=f.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Qa=b,this};var Wf=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(b){var N=f.CapJoinStyles[b];if(N===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wf=N,q(N+" J"),this};var Gf=0;f.__private__.setLineJoin=f.setLineJoin=function(b){var N=f.CapJoinStyles[b];if(N===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gf=N,q(N+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return q($(K(b))+" M"),this},f.GState=ng,f.setGState=function(b){(b=typeof b=="string"?se[fe[b]]:p0(null,b)).equals(wi)||(q("/"+b.id+" gs"),wi=b)};var p0=function(b,N){if(!b||!fe[b]){var V=!1;for(var tt in se)if(se.hasOwnProperty(tt)&&se[tt].equals(N)){V=!0;break}if(V)N=se[tt];else{var ht="GS"+(Object.keys(se).length+1).toString(10);se[ht]=N,N.id=ht}return b&&(fe[b]=N.id),ze.publish("addGState",N),N}};f.addGState=function(b,N){return p0(b,N),this},f.saveGraphicsState=function(){return q("q"),yi.push({key:Wt,size:Et,color:Ih}),this},f.restoreGraphicsState=function(){q("Q");var b=yi.pop();return Wt=b.key,Et=b.size,Ih=b.color,wi=null,this},f.setCurrentTransformationMatrix=function(b){return q(b.toString()+" cm"),this},f.comment=function(b){return q("#"+b),this};var to=function(b,N){var V=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return V},set:function(wt){isNaN(wt)||(V=parseFloat(wt))}});var tt=N||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return tt},set:function(wt){isNaN(wt)||(tt=parseFloat(wt))}});var ht="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ht},set:function(wt){ht=wt.toString()}}),this},Vf=function(b,N,V,tt){to.call(this,b,N),this.type="rect";var ht=V||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ht},set:function(St){isNaN(St)||(ht=parseFloat(St))}});var wt=tt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return wt},set:function(St){isNaN(St)||(wt=parseFloat(St))}}),this},Tu=function(){this.page=Le,this.currentPage=z,this.pages=Lt.slice(0),this.pagesContext=ie.slice(0),this.x=Yt,this.y=ji,this.matrix=De,this.width=Xf(z),this.height=m0(z),this.outputDestination=It,this.id="",this.objectNumber=-1};Tu.prototype.restore=function(){Le=this.page,z=this.currentPage,ie=this.pagesContext,Lt=this.pages,Yt=this.x,ji=this.y,De=this.matrix,g0(z,this.width),eo(z,this.height),It=this.outputDestination};var $f=function(b,N,V,tt,ht){aa.push(new Tu),Le=z=0,Lt=[],Yt=b,ji=N,De=ht,jf([V,tt])};for(var Fh in f.beginFormObject=function(b,N,V,tt,ht){return $f(b,N,V,tt,ht),this},f.endFormObject=function(b){return(function(N){if($a[N])aa.pop().restore();else{var V=new Tu,tt="Xo"+(Object.keys(Un).length+1).toString(10);V.id=tt,$a[N]=tt,Un[tt]=V,ze.publish("addFormObject",V),aa.pop().restore()}})(b),this},f.doFormObject=function(b,N){var V=Un[$a[b]];return q("q"),q(N.toString()+" cm"),q("/"+V.id+" Do"),q("Q"),this},f.getFormObject=function(b){var N=Un[$a[b]];return{x:N.x,y:N.y,width:N.width,height:N.height,matrix:N.matrix}},f.save=function(b,N){return b=b||"generated.pdf",(N=N||{}).returnPromise=N.returnPromise||!1,N.returnPromise===!1?($h(ku(ca()),b),typeof $h.unload=="function"&&re.setTimeout&&setTimeout($h.unload,911),this):new Promise(function(V,tt){try{var ht=$h(ku(ca()),b);typeof $h.unload=="function"&&re.setTimeout&&setTimeout($h.unload,911),V(ht)}catch(wt){tt(wt.message)}})},Vt.API)Vt.API.hasOwnProperty(Fh)&&(Fh==="events"&&Vt.API.events.length?(function(b,N){var V,tt,ht;for(ht=N.length-1;ht!==-1;ht--)V=N[ht][0],tt=N[ht][1],b.subscribe.apply(b,[V].concat(typeof tt=="function"?[tt]:tt))})(ze,Vt.API.events):f[Fh]=Vt.API[Fh]);function Xf(b){return ie[b].mediaBox.topRightX-ie[b].mediaBox.bottomLeftX}function g0(b,N){ie[b].mediaBox.topRightX=N+ie[b].mediaBox.bottomLeftX}function m0(b){return ie[b].mediaBox.topRightY-ie[b].mediaBox.bottomLeftY}function eo(b,N){ie[b].mediaBox.topRightY=N+ie[b].mediaBox.bottomLeftY}var io=f.getPageWidth=function(b){return Xf(b=b||z)/me},b0=f.setPageWidth=function(b,N){g0(b,N*me)},Mh=f.getPageHeight=function(b){return m0(b=b||z)/me},v0=f.setPageHeight=function(b,N){eo(b,N*me)};return f.internal={pdfEscape:lr,getStyle:u0,getFont:O2,getFontSize:jt,getCharSpace:G2,getTextColor:W2,getLineHeight:j2,getLineHeightFactor:H2,getLineWidth:B2,write:Ft,getHorizontalCoordinate:Ja,getVerticalCoordinate:Za,getCoordinateString:q2,getVerticalCoordinateString:z2,collections:{},newObject:Ni,newAdditionalObject:Eh,newObjectDeferred:bn,newObjectDeferredBegin:Cn,getFilters:Fr,putStream:or,events:ze,scaleFactor:me,pageSize:{getWidth:function(){return io(z)},setWidth:function(b){b0(z,b)},getHeight:function(){return Mh(z)},setHeight:function(b){v0(z,b)}},encryptionOptions:u,encryption:sn,getEncryptor:function(b){return u!==null?sn.encryptor(b,0):function(N){return N}},output:h0,getNumberOfPages:a0,get pages(){return Lt},out:q,f2:I,f3:j,getPageInfo:Ka,getPageInfoByObjId:c0,getCurrentPageInfo:I2,getPDFVersion:v,Point:to,Rectangle:Vf,Matrix:ne,hasHotfix:hr},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return io(z)},set:function(b){b0(z,b)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Mh(z)},set:function(b){v0(z,b)},enumerable:!0,configurable:!0}),(function(b){for(var N=0,V=Qt.length;N<V;N++){var tt=n0.call(this,b[N][0],b[N][1],b[N][2],Qt[N][3],!0);p===!1&&(g[tt]=!0);var ht=b[N][0].split("-");i0({id:tt,fontName:ht[0],fontStyle:ht[1]||""})}ze.publish("addFonts",{fonts:xe,dictionary:Ce})}).call(f,Qt),Wt="F1",s0(n,e),ze.publish("initialized"),f}Yu.prototype.lsbFirstWord=function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)},Yu.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Yu.prototype.hexToBytes=function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(String.fromCharCode(parseInt(r.substr(e,2),16)));return t.join("")},Yu.prototype.processOwnerPassword=function(r,t){return Av(wv(t).substr(0,5),r)},Yu.prototype.encryptor=function(r,t){var e=wv(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(i){return Av(e,i)}},ng.prototype.equals=function(r){var t,e="id,objectNumber,equals";if(!r||Ke(r)!==Ke(this))return!1;var i=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;i++}for(t in r)r.hasOwnProperty(t)&&e.indexOf(t)<0&&i--;return i===0},Vt.API={events:[]},Vt.version="4.0.0";var Oi=Vt.API,zv=1,Su=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ju=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},he=function(r){return r.toFixed(2)},El=function(r){return r.toFixed(5)};Oi.__acroform__={};var Ss=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},sA=function(r){return r*zv},ya=function(r){var t=new T3,e=Bt.internal.getHeight(r)||0,i=Bt.internal.getWidth(r)||0;return t.BBox=[0,0,Number(he(i)),Number(he(e))],t},UE=Oi.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|1<<t},HE=Oi.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&~(1<<t)},qE=Oi.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<t?1:0},$i=Oi.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qE(r,t-1)},Xi=Oi.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return UE(r,t-1)},Yi=Oi.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return HE(r,t-1)},zE=Oi.__acroform__.calculateCoordinates=function(r,t){var e=t.internal.getHorizontalCoordinate,i=t.internal.getVerticalCoordinate,n=r[0],s=r[1],a=r[2],o=r[3],h={};return h.lowerLeft_X=e(n)||0,h.lowerLeft_Y=i(s+o)||0,h.upperRight_X=e(n+a)||0,h.upperRight_Y=i(s)||0,[Number(he(h.lowerLeft_X)),Number(he(h.lowerLeft_Y)),Number(he(h.upperRight_X)),Number(he(h.upperRight_Y))]},WE=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],e=r._V||r.DV,i=_v(r,e),n=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+n+" "+he(i.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=ya(r);return s.scope=r.scope,s.stream=t.join(`
`),s}},_v=function(r,t){var e=r.fontSize===0?r.maxFontSize:r.fontSize,i={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=r.multiline?n.map(function(I){return I.split(`
`)}):n.map(function(I){return[I]});var s=e,a=Bt.internal.getHeight(r)||0;a=a<0?-a:a;var o=Bt.internal.getWidth(r)||0;o=o<0?-o:o;var h=function(I,j,K){if(I+1<n.length){var Y=j+" "+n[I+1][0];return Q0(Y,r,K).width<=o-4}return!1};s++;t:for(;s>0;){t="",s--;var c,u,p=Q0("3",r,s).height,g=r.multiline?a-s:(a-p)/2,f=g+=2,A=0,v=0,S=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Q0(t,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var w="",k=0,L=0;L<n.length;L++)if(n.hasOwnProperty(L)){var P=!1;if(n[L].length!==1&&S!==n[L].length-1){if((p+2)*(k+2)+2>a)continue t;w+=n[L][S],P=!0,v=L,L--}else{w=(w+=n[L][S]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var D=parseInt(L),H=h(D,w,s),X=L>=n.length-1;if(H&&!X){w+=" ",S=0;continue}if(H||X){if(X)v=D;else if(r.multiline&&(p+2)*(k+2)+2>a)continue t}else{if(!r.multiline||(p+2)*(k+2)+2>a)continue t;v=D}}for(var $="",B=A;B<=v;B++){var Z=n[B];if(r.multiline){if(B===v){$+=Z[S]+" ",S=(S+1)%Z.length;continue}if(B===A){$+=Z[Z.length-1]+" ";continue}}$+=Z[0]+" "}switch($=$.substr($.length-1)==" "?$.substr(0,$.length-1):$,u=Q0($,r,s).width,r.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}t+=he(c)+" "+he(f)+` Td
`,t+="("+Su($)+`) Tj
`,t+=-he(c)+` 0 Td
`,f=-(s+2),u=0,A=P?v:v+1,k++,w=""}break}return i.text=t,i.fontSize=s,i},Q0=function(r,t,e){var i=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(r,{font:i,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:n}},GE={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},VE=function(r,t){var e={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(i){return i.type===e.type&&i.object===e.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(e)},$E=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(sa.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(GE)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");zv=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new I3,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.objId=void 0,s.hasAnnotation&&VE(s,e)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(e){(function(i,n){var s=!i;for(var a in i||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(a)){var o=i[a],h=[],c=o.Rect;if(o.Rect&&(o.Rect=zE(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Bt.createDefaultAppearanceStream(o),Ke(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(h=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=WE(o);h.push({key:"AP",value:"<</N "+u+">>"}),n.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var p="";for(var g in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(g)){var f=o.appearanceStreamContent[g];if(p+="/"+g+" ",p+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var a in f)if(f.hasOwnProperty(a)){var A=f[a];typeof A=="function"&&(A=A.call(n,o)),p+="/"+a+" "+A+" ",n.internal.acroformPlugin.xForms.indexOf(A)>=0||n.internal.acroformPlugin.xForms.push(A)}}else typeof(A=f)=="function"&&(A=A.call(n,o)),p+="/"+a+" "+A,n.internal.acroformPlugin.xForms.indexOf(A)>=0||n.internal.acroformPlugin.xForms.push(A);p+=">>"}h.push({key:"AP",value:`<<
`+p+">>"})}n.internal.putStream({additionalKeyValues:h,objectId:o.objId}),n.internal.out("endobj")}s&&(function(v,S){for(var w in v)if(v.hasOwnProperty(w)){var k=w,L=v[w];S.internal.newObjectDeferredBegin(L.objId,!0),Ke(L)==="object"&&typeof L.putStream=="function"&&L.putStream(),delete v[k]}})(n.internal.acroformPlugin.xForms,n)})(e,r)}),r.internal.acroformPlugin.isInitialized=!0}},N3=Oi.__acroform__.arrayToPdfArray=function(r,t,e){var i=function(a){return a};if(Array.isArray(r)){for(var n="[",s=0;s<r.length;s++)switch(s!==0&&(n+=" "),Ke(r[s])){case"boolean":case"number":case"object":n+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(t!==void 0&&e&&(i=e.internal.getEncryptor(t)),n+="("+Su(i(r[s].toString()))+")"):n+=r[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},R5=function(r,t,e){var i=function(n){return n};return t!==void 0&&e&&(i=e.internal.getEncryptor(t)),(r=r||"").toString(),"("+Su(i(r))+")"},Wa=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Wa.prototype.toString=function(){return this.objId+" 0 R"},Wa.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Wa.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var i=t[e],n=this[i];n&&(Array.isArray(n)?r.push({key:i,value:N3(n,this.objId,this.scope)}):n instanceof Wa?(n.scope=this.scope,r.push({key:i,value:n.objId+" 0 R"})):typeof n!="function"&&r.push({key:i,value:n}))}return r};var T3=function(){Wa.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){r=e.trim()},get:function(){return r||null}})};Ss(T3,Wa);var I3=function(){Wa.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var e=function(i){return i};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+Su(e(r))+")"}},set:function(e){r=e}})};Ss(I3,Wa);var sa=function r(){Wa.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');t=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!$i(t,3)},set:function(w){w?this.F=Xi(t,3):this.F=Yi(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');e=w}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(w){i=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(w){i[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(w){i[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(w){i[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(w){i[3]=w}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Zm)return;s="FieldObject"+r.FieldNum++}var w=function(k){return k};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Su(w(s))+")"},set:function(w){s=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(w){s=w}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var h=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return h},set:function(w){h=w}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/zv:c},set:function(w){c=w}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Zm||this instanceof Ah))return R5(p,this.objId,this.scope)},set:function(w){w=w.toString(),p=w}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof gn==0?R5(g,this.objId,this.scope):g},set:function(w){w=w.toString(),g=this instanceof gn==0?w.substr(0,1)==="("?ju(w.substr(1,w.length-2)):ju(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof gn==1?ju(g.substr(1,g.length-1)):g},set:function(w){w=w.toString(),g=this instanceof gn==1?"/"+w:w}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof gn==0?R5(f,this.objId,this.scope):f},set:function(w){w=w.toString(),f=this instanceof gn==0?w.substr(0,1)==="("?ju(w.substr(1,w.length-2)):ju(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof gn==1?ju(f.substr(1,f.length-1)):f},set:function(w){w=w.toString(),f=this instanceof gn==1?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var A,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(w){w=!!w,v=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(A)return A},set:function(w){A=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,1)},set:function(w){w?this.Ff=Xi(this.Ff,1):this.Ff=Yi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,2)},set:function(w){w?this.Ff=Xi(this.Ff,2):this.Ff=Yi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,3)},set:function(w){w?this.Ff=Xi(this.Ff,3):this.Ff=Yi(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');S=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(S){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:S=2;break;case"center":case 1:S=1;break;default:S=0}}})};Ss(sa,Wa);var fu=function(){sa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){r=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return N3(t,this.objId,this.scope)},set:function(e){var i,n;n=[],typeof(i=e)=="string"&&(n=(function(s,a,o){o||(o=1);for(var h,c=[];h=a.exec(s);)c.push(h[o]);return c})(i,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,i){for(i=i||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,18)},set:function(e){e?this.Ff=Xi(this.Ff,18):this.Ff=Yi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=Xi(this.Ff,19):this.Ff=Yi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,20)},set:function(e){e?(this.Ff=Xi(this.Ff,20),t.sort()):this.Ff=Yi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,22)},set:function(e){e?this.Ff=Xi(this.Ff,22):this.Ff=Yi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,23)},set:function(e){e?this.Ff=Xi(this.Ff,23):this.Ff=Yi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,27)},set:function(e){e?this.Ff=Xi(this.Ff,27):this.Ff=Yi(this.Ff,27)}}),this.hasAppearanceStream=!1};Ss(fu,sa);var pu=function(){fu.call(this),this.fontName="helvetica",this.combo=!1};Ss(pu,fu);var gu=function(){pu.call(this),this.combo=!0};Ss(gu,pu);var zp=function(){gu.call(this),this.edit=!0};Ss(zp,gu);var gn=function(){sa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,15)},set:function(e){e?this.Ff=Xi(this.Ff,15):this.Ff=Yi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,16)},set:function(e){e?this.Ff=Xi(this.Ff,16):this.Ff=Yi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,17)},set:function(e){e?this.Ff=Xi(this.Ff,17):this.Ff=Yi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,26)},set:function(e){e?this.Ff=Xi(this.Ff,26):this.Ff=Yi(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(s){return s};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var i,n=[];for(i in n.push("<<"),t)n.push("/"+i+" ("+Su(e(t[i]))+")");return n.push(">>"),n.join(`
`)}},set:function(e){Ke(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}})};Ss(gn,sa);var Wp=function(){gn.call(this),this.pushButton=!0};Ss(Wp,gn);var mu=function(){gn.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};Ss(mu,gn);var Zm=function(){var r,t;sa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var e,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),i)a.push("/"+s+" ("+Su(n(i[s]))+")");return a.push(">>"),a.join(`
`)},set:function(n){Ke(n)==="object"&&(i=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(n){typeof n=="string"&&(i.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Bt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ss(Zm,sa),mu.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=r.createAppearanceStream(e.optionName),e.caption=r.getCA()}},mu.prototype.createOption=function(r){var t=new Zm;return t.Parent=this,t.optionName=r,this.Kids.push(t),XE.call(this.scope,t),t};var Gp=function(){gn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Bt.CheckBox.createAppearanceStream()};Ss(Gp,gn);var Ah=function(){sa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,13)},set:function(t){t?this.Ff=Xi(this.Ff,13):this.Ff=Yi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,21)},set:function(t){t?this.Ff=Xi(this.Ff,21):this.Ff=Yi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,23)},set:function(t){t?this.Ff=Xi(this.Ff,23):this.Ff=Yi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,24)},set:function(t){t?this.Ff=Xi(this.Ff,24):this.Ff=Yi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,25)},set:function(t){t?this.Ff=Xi(this.Ff,25):this.Ff=Yi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,26)},set:function(t){t?this.Ff=Xi(this.Ff,26):this.Ff=Yi(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ss(Ah,sa);var Vp=function(){Ah.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,14)},set:function(r){r?this.Ff=Xi(this.Ff,14):this.Ff=Yi(this.Ff,14)}}),this.password=!0};Ss(Vp,Ah);var Bt={CheckBox:{createAppearanceStream:function(){return{N:{On:Bt.CheckBox.YesNormal},D:{On:Bt.CheckBox.YesPushDown,Off:Bt.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=ya(r);t.scope=r.scope;var e=[],i=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),s=_v(r,r.caption);return e.push("0.749023 g"),e.push("0 0 "+he(Bt.internal.getWidth(r))+" "+he(Bt.internal.getHeight(r))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+i+" "+he(s.fontSize)+" Tf "+n),e.push("BT"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(r){var t=ya(r);t.scope=r.scope;var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),n=[],s=Bt.internal.getHeight(r),a=Bt.internal.getWidth(r),o=_v(r,r.caption);return n.push("1 g"),n.push("0 0 "+he(a)+" "+he(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+he(a-1)+" "+he(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+e+" "+he(o.fontSize)+" Tf "+i),n.push(o.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(r){var t=ya(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+he(Bt.internal.getWidth(r))+" "+he(Bt.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:Bt.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=Bt.RadioButton.Circle.YesNormal,t.D[r]=Bt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=ya(r);t.scope=r.scope;var e=[],i=Bt.internal.getWidth(r)<=Bt.internal.getHeight(r)?Bt.internal.getWidth(r)/4:Bt.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Bt.internal.Bezier_C,s=Number((i*n).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+El(Bt.internal.getWidth(r)/2)+" "+El(Bt.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=ya(r);t.scope=r.scope;var e=[],i=Bt.internal.getWidth(r)<=Bt.internal.getHeight(r)?Bt.internal.getWidth(r)/4:Bt.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*Bt.internal.Bezier_C).toFixed(5)),a=Number((i*Bt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+El(Bt.internal.getWidth(r)/2)+" "+El(Bt.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+El(Bt.internal.getWidth(r)/2)+" "+El(Bt.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),e.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),e.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),e.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(r){var t=ya(r);t.scope=r.scope;var e=[],i=Bt.internal.getWidth(r)<=Bt.internal.getHeight(r)?Bt.internal.getWidth(r)/4:Bt.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*Bt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+El(Bt.internal.getWidth(r)/2)+" "+El(Bt.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:Bt.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=Bt.RadioButton.Cross.YesNormal,t.D[r]=Bt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=ya(r);t.scope=r.scope;var e=[],i=Bt.internal.calculateCross(r);return e.push("q"),e.push("1 1 "+he(Bt.internal.getWidth(r)-2)+" "+he(Bt.internal.getHeight(r)-2)+" re"),e.push("W"),e.push("n"),e.push(he(i.x1.x)+" "+he(i.x1.y)+" m"),e.push(he(i.x2.x)+" "+he(i.x2.y)+" l"),e.push(he(i.x4.x)+" "+he(i.x4.y)+" m"),e.push(he(i.x3.x)+" "+he(i.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=ya(r);t.scope=r.scope;var e=Bt.internal.calculateCross(r),i=[];return i.push("0.749023 g"),i.push("0 0 "+he(Bt.internal.getWidth(r))+" "+he(Bt.internal.getHeight(r))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+he(Bt.internal.getWidth(r)-2)+" "+he(Bt.internal.getHeight(r)-2)+" re"),i.push("W"),i.push("n"),i.push(he(e.x1.x)+" "+he(e.x1.y)+" m"),i.push(he(e.x2.x)+" "+he(e.x2.y)+" l"),i.push(he(e.x4.x)+" "+he(e.x4.y)+" m"),i.push(he(e.x3.x)+" "+he(e.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(r){var t=ya(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+he(Bt.internal.getWidth(r))+" "+he(Bt.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,e=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+e}};Bt.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=Bt.internal.getWidth(r),e=Bt.internal.getHeight(r),i=Math.min(t,e);return{x1:{x:(t-i)/2,y:(e-i)/2+i},x2:{x:(t-i)/2+i,y:(e-i)/2},x3:{x:(t-i)/2,y:(e-i)/2},x4:{x:(t-i)/2+i,y:(e-i)/2+i}}}},Bt.internal.getWidth=function(r){var t=0;return Ke(r)==="object"&&(t=sA(r.Rect[2])),t},Bt.internal.getHeight=function(r){var t=0;return Ke(r)==="object"&&(t=sA(r.Rect[3])),t};var XE=Oi.addField=function(r){if($E(this,r),!(r instanceof sa))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Oi.AcroFormChoiceField=fu,Oi.AcroFormListBox=pu,Oi.AcroFormComboBox=gu,Oi.AcroFormEditBox=zp,Oi.AcroFormButton=gn,Oi.AcroFormPushButton=Wp,Oi.AcroFormRadioButton=mu,Oi.AcroFormCheckBox=Gp,Oi.AcroFormTextField=Ah,Oi.AcroFormPasswordField=Vp,Oi.AcroFormAppearance=Bt,Oi.AcroForm={ChoiceField:fu,ListBox:pu,ComboBox:gu,EditBox:zp,Button:gn,PushButton:Wp,RadioButton:mu,CheckBox:Gp,TextField:Ah,PasswordField:Vp,Appearance:Bt},Vt.AcroForm={ChoiceField:fu,ListBox:pu,ComboBox:gu,EditBox:zp,Button:gn,PushButton:Wp,RadioButton:mu,CheckBox:Gp,TextField:Ah,PasswordField:Vp,Appearance:Bt};Vt.AcroForm;function F3(r){return r.reduce(function(t,e,i){return t[e]=i,t},{})}(function(r){var t="addImage_";r.__addimage__={};var e="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(I,j){var K,Y,ot,rt,lt,st=e;if((j=j||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(H(I))for(lt in i)for(ot=i[lt],K=0;K<ot.length;K+=1){for(rt=!0,Y=0;Y<ot[K].length;Y+=1)if(ot[K][Y]!==void 0&&ot[K][Y]!==I[Y]){rt=!1;break}if(rt===!0){st=lt;break}}else for(lt in i)for(ot=i[lt],K=0;K<ot.length;K+=1){for(rt=!0,Y=0;Y<ot[K].length;Y+=1)if(ot[K][Y]!==void 0&&ot[K][Y]!==I.charCodeAt(Y)){rt=!1;break}if(rt===!0){st=lt;break}}return st===e&&j!==e&&(st=j),st},s=function I(j){for(var K=this.internal.write,Y=this.internal.putStream,ot=(0,this.internal.getFilters)();ot.indexOf("FlateEncode")!==-1;)ot.splice(ot.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var rt=[];if(rt.push({key:"Type",value:"/XObject"}),rt.push({key:"Subtype",value:"/Image"}),rt.push({key:"Width",value:j.width}),rt.push({key:"Height",value:j.height}),j.colorSpace===w.INDEXED?rt.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(rt.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===w.DEVICE_CMYK&&rt.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),rt.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&rt.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)&&j.transparency.length>0){for(var lt="",st=0,ft=j.transparency.length;st<ft;st++)lt+=j.transparency[st]+" "+j.transparency[st]+" ";rt.push({key:"Mask",value:"["+lt+"]"})}j.sMask!==void 0&&rt.push({key:"SMask",value:j.objectId+1+" 0 R"});var Ct=j.filter!==void 0?["/"+j.filter]:void 0;if(Y({data:j.data,additionalKeyValues:rt,alreadyAppliedFilters:Ct,objectId:j.objectId}),K("endobj"),"sMask"in j&&j.sMask!==void 0){var At,F=(At=j.sMaskBitsPerComponent)!==null&&At!==void 0?At:j.bitsPerComponent,z={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:j.sMask};"filter"in j&&(z.decodeParameters="/Predictor ".concat(j.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(j.width),z.filter=j.filter),I.call(this,z)}if(j.colorSpace===w.INDEXED){var J=this.internal.newObject();Y({data:$(new Uint8Array(j.palette)),objectId:J}),K("endobj")}},a=function(){var I=this.internal.collections[t+"images"];for(var j in I)s.call(this,I[j])},o=function(){var I,j=this.internal.collections[t+"images"],K=this.internal.write;for(var Y in j)K("/I"+(I=j[Y]).index,I.objectId,"0","R")},h=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var I=this.internal.collections[t+"images"];return h.call(this),I},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},p=function(I){return typeof r["process"+I.toUpperCase()]=="function"},g=function(I){return Ke(I)==="object"&&I.nodeType===1},f=function(I,j){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var K=""+I.getAttribute("src");if(K.indexOf("data:image/")===0)return Dm(unescape(K).split("base64,").pop());var Y=r.loadFile(K,!0);if(Y!==void 0)return Y}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var ot;switch(j){case"PNG":ot="image/png";break;case"WEBP":ot="image/webp";break;default:ot="image/jpeg"}return Dm(I.toDataURL(ot,1).split("base64,").pop())}},A=function(I){var j=this.internal.collections[t+"images"];if(j){for(var K in j)if(I===j[K].alias)return j[K]}},v=function(I,j,K){return I||j||(I=-96,j=-96),I<0&&(I=-1*K.width*72/I/this.internal.scaleFactor),j<0&&(j=-1*K.height*72/j/this.internal.scaleFactor),I===0&&(I=j*K.width/K.height),j===0&&(j=I*K.height/K.width),[I,j]},S=function(I,j,K,Y,ot,rt){var lt=v.call(this,K,Y,ot),st=this.internal.getCoordinateString,ft=this.internal.getVerticalCoordinateString,Ct=c.call(this);if(K=lt[0],Y=lt[1],Ct[ot.index]=ot,rt){rt*=Math.PI/180;var At=Math.cos(rt),F=Math.sin(rt),z=function(Q){return Q.toFixed(4)},J=[z(At),z(F),z(-1*F),z(At),0,0,"cm"]}this.internal.write("q"),rt?(this.internal.write([1,"0","0",1,st(I),ft(j+Y),"cm"].join(" ")),this.internal.write(J.join(" ")),this.internal.write([st(K),"0","0",st(Y),"0","0","cm"].join(" "))):this.internal.write([st(K),"0","0",st(Y),st(I),ft(j+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ot.index+" Do"),this.internal.write("Q")},w=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},L=r.__addimage__.sHashCode=function(I){var j,K,Y=0;if(typeof I=="string")for(K=I.length,j=0;j<K;j++)Y=(Y<<5)-Y+I.charCodeAt(j),Y|=0;else if(H(I))for(K=I.byteLength/2,j=0;j<K;j++)Y=(Y<<5)-Y+I[j],Y|=0;return Y},P=r.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var j=!0;return I.length===0&&(j=!1),I.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(j=!1),j},D=r.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var j=I.indexOf(",");return j<0?null:I.substring(0,j).trim().endsWith("base64")?I.substring(j+1):null};r.__addimage__.isArrayBuffer=function(I){return I instanceof ArrayBuffer};var H=r.__addimage__.isArrayBufferView=function(I){return I instanceof Int8Array||I instanceof Uint8Array||I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array},X=r.__addimage__.binaryStringToUint8Array=function(I){for(var j=I.length,K=new Uint8Array(j),Y=0;Y<j;Y++)K[Y]=I.charCodeAt(Y);return K},$=r.__addimage__.arrayBufferToBinaryString=function(I){for(var j="",K=H(I)?I:new Uint8Array(I),Y=0;Y<K.length;Y+=8192)j+=String.fromCharCode.apply(null,K.subarray(Y,Y+8192));return j};r.addImage=function(){var I,j,K,Y,ot,rt,lt,st,ft;if(typeof arguments[1]=="number"?(j=e,K=arguments[1],Y=arguments[2],ot=arguments[3],rt=arguments[4],lt=arguments[5],st=arguments[6],ft=arguments[7]):(j=arguments[1],K=arguments[2],Y=arguments[3],ot=arguments[4],rt=arguments[5],lt=arguments[6],st=arguments[7],ft=arguments[8]),Ke(I=arguments[0])==="object"&&!g(I)&&"imageData"in I){var Ct=I;I=Ct.imageData,j=Ct.format||j||e,K=Ct.x||K||0,Y=Ct.y||Y||0,ot=Ct.w||Ct.width||ot,rt=Ct.h||Ct.height||rt,lt=Ct.alias||lt,st=Ct.compression||st,ft=Ct.rotation||Ct.angle||ft}var At=this.internal.getFilters();if(st===void 0&&At.indexOf("FlateEncode")!==-1&&(st="SLOW"),isNaN(K)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var F=B.call(this,I,j,lt,st);return S.call(this,K,Y,ot,rt,F,ft),this};var B=function(I,j,K,Y){var ot,rt,lt;if(typeof I=="string"&&n(I)===e){I=unescape(I);var st=Z(I,!1);(st!==""||(st=r.loadFile(I,!0))!==void 0)&&(I=st)}if(g(I)&&(I=f(I,j)),j=n(I,j),!p(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((lt=K)==null||lt.length===0)&&(K=(function(ft){return typeof ft=="string"||H(ft)?L(ft):H(ft.data)?L(ft.data):null})(I)),(ot=A.call(this,K))||(I instanceof Uint8Array||j==="RGBA"||(rt=I,I=X(I)),ot=this["process"+j.toUpperCase()](I,u.call(this),K,(function(ft){return ft&&typeof ft=="string"&&(ft=ft.toUpperCase()),ft in r.image_compression?ft:k.NONE})(Y),rt)),!ot)throw new Error("An unknown error occurred whilst processing the image.");return ot},Z=r.__addimage__.convertBase64ToBinaryString=function(I,j){j=typeof j!="boolean"||j;var K,Y="";if(typeof I=="string"){var ot;K=(ot=D(I))!==null&&ot!==void 0?ot:I;try{Y=Dm(K)}catch(rt){if(j)throw P(K)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+rt.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};r.getImageProperties=function(I){var j,K,Y="";if(g(I)&&(I=f(I)),typeof I=="string"&&n(I)===e&&((Y=Z(I,!1))===""&&(Y=r.loadFile(I)||""),I=Y),K=n(I),!p(K))throw new Error("addImage does not support files of type '"+K+"', please ensure that a plugin for '"+K+"' support is added.");if(I instanceof Uint8Array||(I=X(I)),!(j=this["process"+K.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=K,j}})(Vt.API),(function(r){var t=function(e){if(e!==void 0&&e!="")return!0};Vt.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(e){for(var i,n,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,h=this.internal.getPageInfoByObjId(e.objId),c=e.pageContext.annotations,u=!1,p=0;p<c.length&&!u;p++)switch((i=c[p]).type){case"link":(t(i.options.url)||t(i.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var g=0;g<c.length;g++){i=c[g];var f=this.internal.pdfEscape,A=this.internal.getEncryptor(e.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(v.objId),k=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y)+"] ")+"/Contents ("+f(w(i.contents))+")",s+=" /Popup "+S.objId+" 0 R",s+=" /P "+h.objId+" 0 R",s+=" /T ("+f(w(k))+") >>",v.content=s;var L=v.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+a(i.bounds.x+30)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w+30)+" "+o(i.bounds.y)+"] ")+" /Parent "+L,i.open&&(s+=" /Open true"),s+=" >>",S.content=s,this.internal.write(v.objId,"0 R",S.objId,"0 R");break;case"freetext":n="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y+i.bounds.h)+"] ";var P=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(A(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+P+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var D=this.annotations._nameMap[i.options.name];i.options.pageNumber=D.page,i.options.top=D.y}else i.options.top||(i.options.top=0);if(n="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(A(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var H=o(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+H+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(e){var i=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":i.pageContext.annotations.push(e)}},r.link=function(e,i,n,s,a){var o=this.internal.getCurrentPageInfo(),h=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:h(e),y:c(i),w:h(e+n),h:c(i+s)},options:a,type:"link"})},r.textWithLink=function(e,i,n,s){var a,o,h=this.getTextWidth(e),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var u=this.splitTextToSize(e,o).length;a=Math.ceil(c*u)}else o=h,a=c;return this.text(e,i,n,s),n+=.2*c,s.align==="center"&&(i-=h/2),s.align==="right"&&(i-=h),this.link(i,n-c,o,a,s),h},r.getTextWidth=function(e){var i=this.internal.getFontSize();return this.getStringUnitWidth(e)*i/this.internal.scaleFactor}})(Vt.API),(function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(v){return t[v.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},o=r.__arabicParser__.isArabicEndLetter=function(v){return a(v)&&s(v)&&t[v.charCodeAt(0)].length<=2},h=r.__arabicParser__.isArabicAlfLetter=function(v){return a(v)&&n.indexOf(v.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return a(v)&&s(v)&&t[v.charCodeAt(0)].length>=1};var c=r.__arabicParser__.arabicLetterHasFinalForm=function(v){return a(v)&&s(v)&&t[v.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(v){return a(v)&&s(v)&&t[v.charCodeAt(0)].length>=3};var u=r.__arabicParser__.arabicLetterHasMedialForm=function(v){return a(v)&&s(v)&&t[v.charCodeAt(0)].length==4},p=r.__arabicParser__.resolveLigatures=function(v){var S=0,w=e,k="",L=0;for(S=0;S<v.length;S+=1)w[v.charCodeAt(S)]!==void 0?(L++,typeof(w=w[v.charCodeAt(S)])=="number"&&(k+=String.fromCharCode(w),w=e,L=0),S===v.length-1&&(w=e,k+=v.charAt(S-(L-1)),S-=L-1,L=0)):(w=e,k+=v.charAt(S-L),S-=L,L=0);return k};r.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&i[v.charCodeAt(0)]!==void 0};var g=r.__arabicParser__.getCorrectForm=function(v,S,w){return a(v)?s(v)===!1?-1:!c(v)||!a(S)&&!a(w)||!a(w)&&o(S)||o(v)&&!a(S)||o(v)&&h(S)||o(v)&&o(S)?0:u(v)&&a(S)&&!o(S)&&a(w)&&c(w)?3:o(v)||!a(w)?1:2:-1},f=function(v){var S=0,w=0,k=0,L="",P="",D="",H=(v=v||"").split("\\s+"),X=[];for(S=0;S<H.length;S+=1){for(X.push(""),w=0;w<H[S].length;w+=1)L=H[S][w],P=H[S][w-1],D=H[S][w+1],a(L)?(k=g(L,P,D),X[S]+=k!==-1?String.fromCharCode(t[L.charCodeAt(0)][k]):L):X[S]+=L;X[S]=p(X[S])}return X.join(" ")},A=r.__arabicParser__.processArabic=r.processArabic=function(){var v,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(S)){var k=0;for(w=[],k=0;k<S.length;k+=1)Array.isArray(S[k])?w.push([f(S[k][0]),S[k][1],S[k][2]]):w.push([f(S[k])]);v=w}else v=f(S);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};r.events.push(["preProcessText",A])})(Vt.API),Vt.API.autoPrint=function(r){var t;return(r=r||{}).variant=r.variant||"non-conform",r.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(r){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,i){var n;if((e=e||"2d")!=="2d")return null;for(n in i)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=i[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(Vt.API),(function(r){var t={left:0,top:0,bottom:0,right:0},e=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var h=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var A=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return A},set:function(v){A=v}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(h){return i.call(this),this.internal.__cell__.headerFunction=typeof h=="function"?h:void 0,this},r.getTextDimensions=function(h,c){i.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),p=c.font||this.getFont(),g=c.scaleFactor||this.internal.scaleFactor,f=0,A=0,v=0,S=this;if(!Array.isArray(h)&&typeof h!="string"){if(typeof h!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");h=String(h)}var w=c.maxWidth;w>0?typeof h=="string"?h=this.splitTextToSize(h,w):Object.prototype.toString.call(h)==="[object Array]"&&(h=h.reduce(function(L,P){return L.concat(S.splitTextToSize(P,w))},[])):h=Array.isArray(h)?h:[h];for(var k=0;k<h.length;k++)f<(v=this.getStringUnitWidth(h[k],{font:p})*u)&&(f=v);return f!==0&&(A=h.length),{w:f/=g,h:Math.max((A*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/g,0)}},r.cellAddPage=function(){i.call(this),this.addPage();var h=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(h.left,h.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var h;h=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,g=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===h.lineNumber?(h.x=(c.x||0)+(c.width||0),h.y=c.y||0):c.y+c.height+h.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),h.y=p.top,f&&g&&(this.printHeaderRow(h.lineNumber,!0),h.y+=g[0].height)):h.y=c.y+c.height||h.y),h.text[0]!==void 0&&(this.rect(h.x,h.y,h.width,h.height,e===!0?"FD":void 0),h.align==="right"?this.text(h.text,h.x+h.width-u,h.y+u,{align:"right",baseline:"top"}):h.align==="center"?this.text(h.text,h.x+h.width/2,h.y+u,{align:"center",baseline:"top",maxWidth:h.width-u-u}):this.text(h.text,h.x+u,h.y+u,{align:"left",baseline:"top",maxWidth:h.width-u-u})),this.internal.__cell__.lastCell=h,this};r.table=function(h,c,u,p,g){if(i.call(this),!u)throw new Error("No data for PDF table.");var f,A,v,S,w=[],k=[],L=[],P={},D={},H=[],X=[],$=(g=g||{}).autoSize||!1,B=g.printHeaders!==!1,Z=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,I=g.margins||Object.assign({width:this.getPageWidth()},t),j=typeof g.padding=="number"?g.padding:3,K=g.headerBackgroundColor||"#c8c8c8",Y=g.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=Z,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=K,this.internal.__cell__.headerTextColor=Y,this.setFontSize(Z),p==null)k=w=Object.keys(u[0]),L=w.map(function(){return"left"});else if(Array.isArray(p)&&Ke(p[0])==="object")for(w=p.map(function(Ct){return Ct.name}),k=p.map(function(Ct){return Ct.prompt||Ct.name||""}),L=p.map(function(Ct){return Ct.align||"left"}),f=0;f<p.length;f+=1)D[p[f].name]=.7499990551181103*p[f].width;else Array.isArray(p)&&typeof p[0]=="string"&&(k=w=p,L=w.map(function(){return"left"}));if($||Array.isArray(p)&&typeof p[0]=="string")for(f=0;f<w.length;f+=1){for(P[S=w[f]]=u.map(function(Ct){return Ct[S]}),this.setFont(void 0,"bold"),H.push(this.getTextDimensions(k[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),A=P[S],this.setFont(void 0,"normal"),v=0;v<A.length;v+=1)H.push(this.getTextDimensions(A[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[S]=Math.max.apply(null,H)+j+j,H=[]}if(B){var ot={};for(f=0;f<w.length;f+=1)ot[w[f]]={},ot[w[f]].text=k[f],ot[w[f]].align=L[f];var rt=o.call(this,ot,D);X=w.map(function(Ct){return new s(h,c,D[Ct],rt,ot[Ct].text,void 0,ot[Ct].align)}),this.setTableHeaderRow(X),this.printHeaderRow(1,!1)}var lt=p.reduce(function(Ct,At){return Ct[At.name]=At.align,Ct},{});for(f=0;f<u.length;f+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:f,data:u[f]},this);var st=o.call(this,u[f],D);for(v=0;v<w.length;v+=1){var ft=u[f][w[v]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:f,col:v,data:ft},this),a.call(this,new s(h,c,D[w[v]],st,ft,f+2,lt[w[v]]))}}return this.internal.__cell__.table_x=h,this.internal.__cell__.table_y=c,this};var o=function(h,c){var u=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(h).map(function(f){var A=h[f];return this.splitTextToSize(A.hasOwnProperty("text")?A.text:A,c[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*p/g+u+u},this).reduce(function(f,A){return Math.max(f,A)},0)};r.setTableHeaderRow=function(h){i.call(this),this.internal.__cell__.tableHeaderRow=h},r.printHeaderRow=function(h,c){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,g.push(u)),u.lineNumber=h;var A=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,u),this.setTextColor(A)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),e=!1}})(Vt.API);var M3={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},R3=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Sv=F3(R3),D3=[100,200,300,400,500,600,700,800,900],YE=F3(D3);function D5(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),e=(function(s){return M3[s=s||"normal"]?s:"normal"})(r.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(r.weight),n=(function(s){return typeof Sv[s=s||"normal"]=="number"?s:"normal"})(r.stretch);return{family:t,style:e,weight:i,stretch:n,src:r.src||[],ref:r.ref||{name:t,style:[n,e,i].join(" ")}}}function rA(r,t,e,i){var n;for(n=e;n>=0&&n<t.length;n+=i)if(r[t[n]])return r[t[n]];for(n=e;n>=0&&n<t.length;n-=i)if(r[t[n]])return r[t[n]]}var KE={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},aA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function oA(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function lA(r){return r.trimLeft()}function JE(r,t){for(var e=0;e<r.length;){if(r.charAt(e)===t)return[r.substring(0,e),r.substring(e+1)];e+=1}return null}function ZE(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}var tm,hA,cA,Uu,em,uA,dA,fA,O5=["times"];function pA(r,t,e,i,n){var s=4,a=mA;switch(n){case Vt.API.image_compression.FAST:s=1,a=gA;break;case Vt.API.image_compression.MEDIUM:s=6,a=bA;break;case Vt.API.image_compression.SLOW:s=9,a=vA}r=(function(h,c,u,p){for(var g,f=h.length/c,A=new Uint8Array(h.length+f),v=[QE,gA,mA,bA,vA],S=0;S<f;S+=1){var w=S*c,k=h.subarray(w,w+c);if(p)A.set(p(k,u,g),w+S);else{for(var L=v.length,P=[],D=0;D<L;D+=1)P[D]=v[D](k,u,g);var H=e6(P.concat());A.set(P[H],w+S)}g=k}return A})(r,t,Math.ceil(e*i/8),a);var o=mv(r,{level:s});return Vt.API.__addimage__.arrayBufferToBinaryString(o)}function QE(r){var t=Array.apply([],r);return t.unshift(0),t}function gA(r,t){var e=r.length,i=[];i[0]=1;for(var n=0;n<e;n+=1){var s=r[n-t]||0;i[n+1]=r[n]-s+256&255}return i}function mA(r,t,e){var i=r.length,n=[];n[0]=2;for(var s=0;s<i;s+=1){var a=e&&e[s]||0;n[s+1]=r[s]-a+256&255}return n}function bA(r,t,e){var i=r.length,n=[];n[0]=3;for(var s=0;s<i;s+=1){var a=r[s-t]||0,o=e&&e[s]||0;n[s+1]=r[s]+256-(a+o>>>1)&255}return n}function vA(r,t,e){var i=r.length,n=[];n[0]=4;for(var s=0;s<i;s+=1){var a=t6(r[s-t]||0,e&&e[s]||0,e&&e[s-t]||0);n[s+1]=r[s]-a+256&255}return n}function t6(r,t,e){if(r===t&&t===e)return r;var i=Math.abs(t-e),n=Math.abs(r-e),s=Math.abs(r+t-e-e);return i<=n&&i<=s?r:n<=s?t:e}function e6(r){var t=r.map(function(e){return e.reduce(function(i,n){return i+Math.abs(n)},0)});return t.indexOf(Math.min.apply(null,t))}function B5(r,t,e){var i=t*e,n=Math.floor(i/8),s=16-(i-8*n+e),a=(1<<e)-1;return O3(r,n)>>s&a}function yA(r,t,e,i){var n=e*i,s=Math.floor(n/8),a=16-(n-8*s+i),o=(1<<i)-1,h=(t&o)<<a;(function(c,u,p){if(u+1<c.byteLength)c.setUint16(u,p,!1);else{var g=p>>8&255;c.setUint8(u,g)}})(r,s,O3(r,s)&~(o<<a)&65535|h)}function O3(r,t){return t+1<r.byteLength?r.getUint16(t,!1):r.getUint8(t)<<8}function i6(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=r[t++]|r[t++]<<8,i=r[t++]|r[t++]<<8,n=r[t++],s=n>>7,a=1<<1+(7&n);r[t++],r[t++];var o=null,h=null;s&&(o=t,h=a,t+=3*a);var c=!0,u=[],p=0,g=null,f=0,A=null;for(this.width=e,this.height=i;c&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,A=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((I=r[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var v=r[t++];p=r[t++]|r[t++]<<8,g=r[t++],1&v||(g=null),f=v>>2&7,t++;break;case 254:for(;;){if(!((I=r[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var S=r[t++]|r[t++]<<8,w=r[t++]|r[t++]<<8,k=r[t++]|r[t++]<<8,L=r[t++]|r[t++]<<8,P=r[t++],D=P>>6&1,H=1<<1+(7&P),X=o,$=h,B=!1;P>>7&&(B=!0,X=t,$=H,t+=3*H);var Z=t;for(t++;;){var I;if(!((I=r[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}u.push({x:S,y:w,width:k,height:L,has_local_palette:B,palette_offset:X,palette_size:$,data_offset:Z,data_length:t-Z,transparent_index:g,interlaced:!!D,delay:p,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return A},this.frameInfo=function(j){if(j<0||j>=u.length)throw new Error("Frame index out of range.");return u[j]},this.decodeAndBlitFrameBGRA=function(j,K){var Y=this.frameInfo(j),ot=Y.width*Y.height,rt=new Uint8Array(ot);wA(r,Y.data_offset,rt,ot);var lt=Y.palette_offset,st=Y.transparent_index;st===null&&(st=256);var ft=Y.width,Ct=e-ft,At=ft,F=4*(Y.y*e+Y.x),z=4*((Y.y+Y.height)*e+Y.x),J=F,Q=4*Ct;Y.interlaced===!0&&(Q+=4*e*7);for(var it=8,at=0,pt=rt.length;at<pt;++at){var gt=rt[at];if(At===0&&(At=ft,(J+=Q)>=z&&(Q=4*Ct+4*e*(it-1),J=F+(ft+Ct)*(it<<1),it>>=1)),gt===st)J+=4;else{var yt=r[lt+3*gt],Lt=r[lt+3*gt+1],Tt=r[lt+3*gt+2];K[J++]=Tt,K[J++]=Lt,K[J++]=yt,K[J++]=255}--At}},this.decodeAndBlitFrameRGBA=function(j,K){var Y=this.frameInfo(j),ot=Y.width*Y.height,rt=new Uint8Array(ot);wA(r,Y.data_offset,rt,ot);var lt=Y.palette_offset,st=Y.transparent_index;st===null&&(st=256);var ft=Y.width,Ct=e-ft,At=ft,F=4*(Y.y*e+Y.x),z=4*((Y.y+Y.height)*e+Y.x),J=F,Q=4*Ct;Y.interlaced===!0&&(Q+=4*e*7);for(var it=8,at=0,pt=rt.length;at<pt;++at){var gt=rt[at];if(At===0&&(At=ft,(J+=Q)>=z&&(Q=4*Ct+4*e*(it-1),J=F+(ft+Ct)*(it<<1),it>>=1)),gt===st)J+=4;else{var yt=r[lt+3*gt],Lt=r[lt+3*gt+1],Tt=r[lt+3*gt+2];K[J++]=yt,K[J++]=Lt,K[J++]=Tt,K[J++]=255}--At}}}function wA(r,t,e,i){for(var n=r[t++],s=1<<n,a=s+1,o=a+1,h=n+1,c=(1<<h)-1,u=0,p=0,g=0,f=r[t++],A=new Int32Array(4096),v=null;;){for(;u<16&&f!==0;)p|=r[t++]<<u,u+=8,f===1?f=r[t++]:--f;if(u<h)break;var S=p&c;if(p>>=h,u-=h,S!==s){if(S===a)break;for(var w=S<o?S:v,k=0,L=w;L>s;)L=A[L]>>8,++k;var P=L;if(g+k+(w!==S?1:0)>i)return void oi.log("Warning, gif stream longer than expected.");e[g++]=P;var D=g+=k;for(w!==S&&(e[g++]=P),L=w;k--;)L=A[L],e[--D]=255&L,L>>=8;v!==null&&o<4096&&(A[o++]=v<<8|P,o>=c+1&&h<12&&(++h,c=c<<1|1)),v=S}else o=a+1,c=(1<<(h=n+1))-1,v=null}return g!==i&&oi.log("Warning, gif stream shorter than expected."),e}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function j5(r){var t,e,i,n,s,a=Math.floor,o=new Array(64),h=new Array(64),c=new Array(64),u=new Array(64),p=new Array(65535),g=new Array(65535),f=new Array(64),A=new Array(64),v=[],S=0,w=7,k=new Array(64),L=new Array(64),P=new Array(64),D=new Array(256),H=new Array(2048),X=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],$=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],Z=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],K=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ot=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function rt(F,z){for(var J=0,Q=0,it=new Array,at=1;at<=16;at++){for(var pt=1;pt<=F[at];pt++)it[z[Q]]=[],it[z[Q]][0]=J,it[z[Q]][1]=at,Q++,J++;J*=2}return it}function lt(F){for(var z=F[0],J=F[1]-1;J>=0;)z&1<<J&&(S|=1<<w),J--,--w<0&&(S==255?(st(255),st(0)):st(S),w=7,S=0)}function st(F){v.push(F)}function ft(F){st(F>>8&255),st(255&F)}function Ct(F,z,J,Q,it){for(var at,pt=it[0],gt=it[240],yt=(function(Et,te){var jt,Zt,Kt,qe,ke,de,Ie,Pe,Wt,me,Yt=0;for(Wt=0;Wt<8;++Wt){jt=Et[Yt],Zt=Et[Yt+1],Kt=Et[Yt+2],qe=Et[Yt+3],ke=Et[Yt+4],de=Et[Yt+5],Ie=Et[Yt+6];var ji=jt+(Pe=Et[Yt+7]),De=jt-Pe,xe=Zt+Ie,Ce=Zt-Ie,yi=Kt+de,Jt=Kt-de,ci=qe+ke,se=qe-ke,fe=ji+ci,wi=ji-ci,Le=xe+yi,ie=xe-yi;Et[Yt]=fe+Le,Et[Yt+4]=fe-Le;var ze=.707106781*(ie+wi);Et[Yt+2]=wi+ze,Et[Yt+6]=wi-ze;var Lh=.382683433*((fe=se+Jt)-(ie=Ce+De)),Un=.5411961*fe+Lh,$a=1.306562965*ie+Lh,aa=.707106781*(Le=Jt+Ce),ne=De+aa,Xa=De-aa;Et[Yt+5]=Xa+Un,Et[Yt+3]=Xa-Un,Et[Yt+1]=ne+$a,Et[Yt+7]=ne-$a,Yt+=8}for(Yt=0,Wt=0;Wt<8;++Wt){jt=Et[Yt],Zt=Et[Yt+8],Kt=Et[Yt+16],qe=Et[Yt+24],ke=Et[Yt+32],de=Et[Yt+40],Ie=Et[Yt+48];var Ya=jt+(Pe=Et[Yt+56]),rr=jt-Pe,ar=Zt+Ie,Ni=Zt-Ie,bn=Kt+de,Cn=Kt-de,Eh=qe+ke,cl=qe-ke,Tr=Ya+Eh,oa=Ya-Eh,Ir=ar+bn,Fr=ar-bn;Et[Yt]=Tr+Ir,Et[Yt+32]=Tr-Ir;var or=.707106781*(Fr+oa);Et[Yt+16]=oa+or,Et[Yt+48]=oa-or;var kh=.382683433*((Tr=cl+Cn)-(Fr=Ni+rr)),la=.5411961*Tr+kh,Ph=1.306562965*Fr+kh,xu=.707106781*(Ir=Cn+Ni),Cu=rr+xu,Lu=rr-xu;Et[Yt+40]=Lu+la,Et[Yt+24]=Lu-la,Et[Yt+8]=Cu+Ph,Et[Yt+56]=Cu-Ph,Yt++}for(Wt=0;Wt<64;++Wt)me=Et[Wt]*te[Wt],f[Wt]=me>0?me+.5|0:me-.5|0;return f})(F,z),Lt=0;Lt<64;++Lt)A[X[Lt]]=yt[Lt];var Tt=A[0]-J;J=A[0],Tt==0?lt(Q[0]):(lt(Q[g[at=32767+Tt]]),lt(p[at]));for(var It=63;It>0&&A[It]==0;)It--;if(It==0)return lt(pt),J;for(var Xt,q=1;q<=It;){for(var Ft=q;A[q]==0&&q<=It;)++q;var Se=q-Ft;if(Se>=16){Xt=Se>>4;for(var Qt=1;Qt<=Xt;++Qt)lt(gt);Se&=15}at=32767+A[q],lt(it[(Se<<4)+g[at]]),lt(p[at]),q++}return It!=63&&lt(pt),J}function At(F){F=Math.min(Math.max(F,1),100),s!=F&&((function(z){for(var J=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Q=0;Q<64;Q++){var it=a((J[Q]*z+50)/100);it=Math.min(Math.max(it,1),255),o[X[Q]]=it}for(var at=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pt=0;pt<64;pt++){var gt=a((at[pt]*z+50)/100);gt=Math.min(Math.max(gt,1),255),h[X[pt]]=gt}for(var yt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Lt=0,Tt=0;Tt<8;Tt++)for(var It=0;It<8;It++)c[Lt]=1/(o[X[Lt]]*yt[Tt]*yt[It]*8),u[Lt]=1/(h[X[Lt]]*yt[Tt]*yt[It]*8),Lt++})(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),s=F)}this.encode=function(F,z){z&&At(z),v=new Array,S=0,w=7,ft(65496),ft(65504),ft(16),st(74),st(70),st(73),st(70),st(0),st(1),st(1),st(0),ft(1),ft(1),st(0),st(0),(function(){ft(65499),ft(132),st(0);for(var Zt=0;Zt<64;Zt++)st(o[Zt]);st(1);for(var Kt=0;Kt<64;Kt++)st(h[Kt])})(),(function(Zt,Kt){ft(65472),ft(17),st(8),ft(Kt),ft(Zt),st(3),st(1),st(17),st(0),st(2),st(17),st(1),st(3),st(17),st(1)})(F.width,F.height),(function(){ft(65476),ft(418),st(0);for(var Zt=0;Zt<16;Zt++)st($[Zt+1]);for(var Kt=0;Kt<=11;Kt++)st(B[Kt]);st(16);for(var qe=0;qe<16;qe++)st(Z[qe+1]);for(var ke=0;ke<=161;ke++)st(I[ke]);st(1);for(var de=0;de<16;de++)st(j[de+1]);for(var Ie=0;Ie<=11;Ie++)st(K[Ie]);st(17);for(var Pe=0;Pe<16;Pe++)st(Y[Pe+1]);for(var Wt=0;Wt<=161;Wt++)st(ot[Wt])})(),ft(65498),ft(12),st(3),st(1),st(0),st(2),st(17),st(3),st(17),st(0),st(63),st(0);var J=0,Q=0,it=0;S=0,w=7,this.encode.displayName="_encode_";for(var at,pt,gt,yt,Lt,Tt,It,Xt,q,Ft=F.data,Se=F.width,Qt=F.height,Et=4*Se,te=0;te<Qt;){for(at=0;at<Et;){for(Lt=Et*te+at,It=-1,Xt=0,q=0;q<64;q++)Tt=Lt+(Xt=q>>3)*Et+(It=4*(7&q)),te+Xt>=Qt&&(Tt-=Et*(te+1+Xt-Qt)),at+It>=Et&&(Tt-=at+It-Et+4),pt=Ft[Tt++],gt=Ft[Tt++],yt=Ft[Tt++],k[q]=(H[pt]+H[gt+256|0]+H[yt+512|0]>>16)-128,L[q]=(H[pt+768|0]+H[gt+1024|0]+H[yt+1280|0]>>16)-128,P[q]=(H[pt+1280|0]+H[gt+1536|0]+H[yt+1792|0]>>16)-128;J=Ct(k,c,J,t,i),Q=Ct(L,u,Q,e,n),it=Ct(P,u,it,e,n),at+=32}te+=8}if(w>=0){var jt=[];jt[1]=w+1,jt[0]=(1<<w+1)-1,lt(jt)}return ft(65497),new Uint8Array(v)},r=r||50,(function(){for(var F=String.fromCharCode,z=0;z<256;z++)D[z]=F(z)})(),t=rt($,B),e=rt(j,K),i=rt(Z,I),n=rt(Y,ot),(function(){for(var F=1,z=2,J=1;J<=15;J++){for(var Q=F;Q<z;Q++)g[32767+Q]=J,p[32767+Q]=[],p[32767+Q][1]=J,p[32767+Q][0]=Q;for(var it=-(z-1);it<=-F;it++)g[32767+it]=J,p[32767+it]=[],p[32767+it][1]=J,p[32767+it][0]=z-1+it;F<<=1,z<<=1}})(),(function(){for(var F=0;F<256;F++)H[F]=19595*F,H[F+256|0]=38470*F,H[F+512|0]=7471*F+32768,H[F+768|0]=-11059*F,H[F+1024|0]=-21709*F,H[F+1280|0]=32768*F+8421375,H[F+1536|0]=-27439*F,H[F+1792|0]=-5329*F})(),At(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function jr(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function AA(r){function t(B){if(!B)throw Error("assert :P")}function e(B,Z,I){for(var j=0;4>j;j++)if(B[Z+j]!=I.charCodeAt(j))return!0;return!1}function i(B,Z,I,j,K){for(var Y=0;Y<K;Y++)B[Z+Y]=I[j+Y]}function n(B,Z,I,j){for(var K=0;K<j;K++)B[Z+K]=I}function s(B){return new Int32Array(B)}function a(B,Z){for(var I=[],j=0;j<B;j++)I.push(new Z);return I}function o(B,Z){var I=[];return(function j(K,Y,ot){for(var rt=ot[Y],lt=0;lt<rt&&(K.push(ot.length>Y+1?[]:new Z),!(ot.length<Y+1));lt++)j(K[lt],Y+1,ot)})(I,0,B),I}var h=function(){var B=this;function Z(d,m){for(var y=1<<m-1>>>0;d&y;)y>>>=1;return y?(d&y-1)+y:d}function I(d,m,y,x,T){t(!(x%y));do d[m+(x-=y)]=T;while(0<x)}function j(d,m,y,x,T){if(t(2328>=T),512>=T)var M=s(512);else if((M=s(T))==null)return 0;return(function(R,O,U,W,et,dt){var G,nt,ct=O,mt=1<<U,ut=s(16),vt=s(16);for(t(et!=0),t(W!=null),t(R!=null),t(0<U),nt=0;nt<et;++nt){if(15<W[nt])return 0;++ut[W[nt]]}if(ut[0]==et)return 0;for(vt[1]=0,G=1;15>G;++G){if(ut[G]>1<<G)return 0;vt[G+1]=vt[G]+ut[G]}for(nt=0;nt<et;++nt)G=W[nt],0<W[nt]&&(dt[vt[G]++]=nt);if(vt[15]==1)return(W=new K).g=0,W.value=dt[0],I(R,ct,1,mt,W),mt;var _t,kt=-1,xt=mt-1,$t=0,Ot=1,ye=1,Ht=1<<U;for(nt=0,G=1,et=2;G<=U;++G,et<<=1){if(Ot+=ye<<=1,0>(ye-=ut[G]))return 0;for(;0<ut[G];--ut[G])(W=new K).g=G,W.value=dt[nt++],I(R,ct+$t,et,Ht,W),$t=Z($t,G)}for(G=U+1,et=2;15>=G;++G,et<<=1){if(Ot+=ye<<=1,0>(ye-=ut[G]))return 0;for(;0<ut[G];--ut[G]){if(W=new K,($t&xt)!=kt){for(ct+=Ht,_t=1<<(kt=G)-U;15>kt&&!(0>=(_t-=ut[kt]));)++kt,_t<<=1;mt+=Ht=1<<(_t=kt-U),R[O+(kt=$t&xt)].g=_t+U,R[O+kt].value=ct-O-kt}W.g=G-U,W.value=dt[nt++],I(R,ct+($t>>U),et,Ht,W),$t=Z($t,G)}}return Ot!=2*vt[15]-1?0:mt})(d,m,y,x,T,M)}function K(){this.value=this.g=0}function Y(){this.value=this.g=0}function ot(){this.G=a(5,K),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Uh,Y)}function rt(d,m,y,x){t(d!=null),t(m!=null),t(2147483648>x),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=m,d.pa=y,d.Jd=m,d.Yc=y+x,d.Zc=4<=x?y+x-4+1:y,pt(d)}function lt(d,m){for(var y=0;0<m--;)y|=yt(d,128)<<m;return y}function st(d,m){var y=lt(d,m);return gt(d)?-y:y}function ft(d,m,y,x){var T,M=0;for(t(d!=null),t(m!=null),t(4294967288>x),d.Sb=x,d.Ra=0,d.u=0,d.h=0,4<x&&(x=4),T=0;T<x;++T)M+=m[y+T]<<8*T;d.Ra=M,d.bb=x,d.oa=m,d.pa=y}function Ct(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<pl-8>>>0,++d.bb,d.u-=8;Q(d)&&(d.h=1,d.u=0)}function At(d,m){if(t(0<=m),!d.h&&m<=Cs){var y=J(d)&xs[m];return d.u+=m,Ct(d),y}return d.h=1,d.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function J(d){return d.Ra>>>(d.u&pl-1)>>>0}function Q(d){return t(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>pl}function it(d,m){d.u=m,d.h=Q(d)}function at(d){d.u>=ao&&(t(d.u>=ao),Ct(d))}function pt(d){t(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(t(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function gt(d){return lt(d,1)}function yt(d,m){var y=d.Ca;0>d.b&&pt(d);var x=d.b,T=y*m>>>8,M=(d.I>>>x>T)+0;for(M?(y-=T,d.I-=T+1<<x>>>0):y=T+1,x=y,T=0;256<=x;)T+=8,x>>=8;return x=7^T+gl[x],d.b-=x,d.Ca=(y<<x)-1,M}function Lt(d,m,y){d[m+0]=y>>24&255,d[m+1]=y>>16&255,d[m+2]=y>>8&255,d[m+3]=255&y}function Tt(d,m){return d[m+0]|d[m+1]<<8}function It(d,m){return Tt(d,m)|d[m+2]<<16}function Xt(d,m){return Tt(d,m)|Tt(d,m+2)<<16}function q(d,m){var y=1<<m;return t(d!=null),t(0<m),d.X=s(y),d.X==null?0:(d.Mb=32-m,d.Xa=m,1)}function Ft(d,m){t(d!=null),t(m!=null),t(d.Xa==m.Xa),i(m.X,0,d.X,0,1<<m.Xa)}function Se(){this.X=[],this.Xa=this.Mb=0}function Qt(d,m,y,x){t(y!=null),t(x!=null);var T=y[0],M=x[0];return T==0&&(T=(d*M+m/2)/m),M==0&&(M=(m*T+d/2)/d),0>=T||0>=M?0:(y[0]=T,x[0]=M,1)}function Et(d,m){return d+(1<<m)-1>>>m}function te(d,m){return((4278255360&d)+(4278255360&m)>>>0&4278255360)+((16711935&d)+(16711935&m)>>>0&16711935)>>>0}function jt(d,m){B[m]=function(y,x,T,M,R,O,U){var W;for(W=0;W<R;++W){var et=B[d](O[U+W-1],T,M+W);O[U+W]=te(y[x+W],et)}}}function Zt(){this.ud=this.hd=this.jd=0}function Kt(d,m){return((4278124286&(d^m))>>>1)+(d&m)>>>0}function qe(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function ke(d,m){return qe(d+(d-m+.5>>1))}function de(d,m,y){return Math.abs(m-y)-Math.abs(d-y)}function Ie(d,m,y,x,T,M,R){for(x=M[R-1],y=0;y<T;++y)M[R+y]=x=te(d[m+y],x)}function Pe(d,m,y,x,T){var M;for(M=0;M<y;++M){var R=d[m+M],O=R>>8&255,U=16711935&(U=(U=16711935&R)+((O<<16)+O));x[T+M]=(4278255360&R)+U>>>0}}function Wt(d,m){m.jd=255&d,m.hd=d>>8&255,m.ud=d>>16&255}function me(d,m,y,x,T,M){var R;for(R=0;R<x;++R){var O=m[y+R],U=O>>>8,W=O,et=255&(et=(et=O>>>16)+((d.jd<<24>>24)*(U<<24>>24)>>>5));W=255&(W=(W+=(d.hd<<24>>24)*(U<<24>>24)>>>5)+((d.ud<<24>>24)*(et<<24>>24)>>>5)),T[M+R]=(4278255360&O)+(et<<16)+W}}function Yt(d,m,y,x,T){B[m]=function(M,R,O,U,W,et,dt,G,nt){for(U=dt;U<G;++U)for(dt=0;dt<nt;++dt)W[et++]=T(O[x(M[R++])])},B[d]=function(M,R,O,U,W,et,dt){var G=8>>M.b,nt=M.Ea,ct=M.K[0],mt=M.w;if(8>G)for(M=(1<<M.b)-1,mt=(1<<G)-1;R<O;++R){var ut,vt=0;for(ut=0;ut<nt;++ut)ut&M||(vt=x(U[W++])),et[dt++]=T(ct[vt&mt]),vt>>=G}else B["VP8LMapColor"+y](U,W,ct,mt,et,dt,R,O,nt)}}function ji(d,m,y,x,T){for(y=m+y;m<y;){var M=d[m++];x[T++]=M>>16&255,x[T++]=M>>8&255,x[T++]=255&M}}function De(d,m,y,x,T){for(y=m+y;m<y;){var M=d[m++];x[T++]=M>>16&255,x[T++]=M>>8&255,x[T++]=255&M,x[T++]=M>>24&255}}function xe(d,m,y,x,T){for(y=m+y;m<y;){var M=(R=d[m++])>>16&240|R>>12&15,R=240&R|R>>28&15;x[T++]=M,x[T++]=R}}function Ce(d,m,y,x,T){for(y=m+y;m<y;){var M=(R=d[m++])>>16&248|R>>13&7,R=R>>5&224|R>>3&31;x[T++]=M,x[T++]=R}}function yi(d,m,y,x,T){for(y=m+y;m<y;){var M=d[m++];x[T++]=255&M,x[T++]=M>>8&255,x[T++]=M>>16&255}}function Jt(d,m,y,x,T,M){if(M==0)for(y=m+y;m<y;)Lt(x,((M=d[m++])[0]>>24|M[1]>>8&65280|M[2]<<8&16711680|M[3]<<24)>>>0),T+=32;else i(x,T,d,m,y)}function ci(d,m){B[m][0]=B[d+"0"],B[m][1]=B[d+"1"],B[m][2]=B[d+"2"],B[m][3]=B[d+"3"],B[m][4]=B[d+"4"],B[m][5]=B[d+"5"],B[m][6]=B[d+"6"],B[m][7]=B[d+"7"],B[m][8]=B[d+"8"],B[m][9]=B[d+"9"],B[m][10]=B[d+"10"],B[m][11]=B[d+"11"],B[m][12]=B[d+"12"],B[m][13]=B[d+"13"],B[m][14]=B[d+"0"],B[m][15]=B[d+"0"]}function se(d){return d==X2||d==Y2||d==E0||d==K2}function fe(){this.eb=[],this.size=this.A=this.fb=0}function wi(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Le(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new fe,this.f.kb=new wi,this.sd=null}function ie(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ze(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Lh(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Un(d,m){var y=d.T,x=m.ba.f.RGBA,T=x.eb,M=x.fb+d.ka*x.A,R=fr[m.ba.S],O=d.y,U=d.O,W=d.f,et=d.N,dt=d.ea,G=d.W,nt=m.cc,ct=m.dc,mt=m.Mc,ut=m.Nc,vt=d.ka,_t=d.ka+d.T,kt=d.U,xt=kt+1>>1;for(vt==0?R(O,U,null,null,W,et,dt,G,W,et,dt,G,T,M,null,null,kt):(R(m.ec,m.fc,O,U,nt,ct,mt,ut,W,et,dt,G,T,M-x.A,T,M,kt),++y);vt+2<_t;vt+=2)nt=W,ct=et,mt=dt,ut=G,et+=d.Rc,G+=d.Rc,M+=2*x.A,R(O,(U+=2*d.fa)-d.fa,O,U,nt,ct,mt,ut,W,et,dt,G,T,M-x.A,T,M,kt);return U+=d.fa,d.j+_t<d.o?(i(m.ec,m.fc,O,U,kt),i(m.cc,m.dc,W,et,xt),i(m.Mc,m.Nc,dt,G,xt),y--):1&_t||R(O,U,null,null,W,et,dt,G,W,et,dt,G,T,M+x.A,null,null,kt),y}function $a(d,m,y){var x=d.F,T=[d.J];if(x!=null){var M=d.U,R=m.ba.S,O=R==L0||R==E0;m=m.ba.f.RGBA;var U=[0],W=d.ka;U[0]=d.T,d.Kb&&(W==0?--U[0]:(--W,T[0]-=d.width),d.j+d.ka+d.T==d.o&&(U[0]=d.o-d.j-W));var et=m.eb;W=m.fb+W*m.A,d=ry(x,T[0],d.width,M,U,et,W+(O?0:3),m.A),t(y==U),d&&se(R)&&ap(et,W,O,M,U,m.A)}return 0}function aa(d){var m=d.ma,y=m.ba.S,x=11>y,T=y==x0||y==C0||y==L0||y==$2||y==12||se(y);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!Zf(m.Oa,d,T?11:12))return 0;if(T&&se(y)&&Yf(),d.da)alert("todo:use_scaling");else{if(x){if(m.Ib=Lh,d.Kb){if(y=d.U+1>>1,m.memory=s(d.U+2*y),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+d.U,m.Mc=m.cc,m.Nc=m.dc+y,m.Ib=Un,Yf()}}else alert("todo:EmitYUV");T&&(m.Jb=$a,x&&Rr())}if(x&&!Ay){for(d=0;256>d;++d)Ax[d]=89858*(d-128)+P0>>k0,xx[d]=-22014*(d-128)+P0,Sx[d]=-45773*(d-128),_x[d]=113618*(d-128)+P0>>k0;for(d=lp;d<Q2;++d)m=76283*(d-16)+P0>>k0,Cx[d-lp]=ha(m,255),Lx[d-lp]=ha(m+8>>4,15);Ay=1}return 1}function ne(d){var m=d.ma,y=d.U,x=d.T;return t(!(1&d.ka)),0>=y||0>=x?0:(y=m.Ib(d,m),m.Jb!=null&&m.Jb(d,m,y),m.Dc+=y,1)}function Xa(d){d.ma.memory=null}function Ya(d,m,y,x){return At(d,8)!=47?0:(m[0]=At(d,14)+1,y[0]=At(d,14)+1,x[0]=At(d,1),At(d,3)!=0?0:!d.h)}function rr(d,m){if(4>d)return d+1;var y=d-2>>1;return(2+(1&d)<<y)+At(m,y)+1}function ar(d,m){return 120<m?m-120:1<=(y=((y=ox[m-1])>>4)*d+(8-(15&y)))?y:1;var y}function Ni(d,m,y){var x=J(y),T=d[m+=255&x].g-8;return 0<T&&(it(y,y.u+8),x=J(y),m+=d[m].value,m+=x&(1<<T)-1),it(y,y.u+d[m].g),d[m].value}function bn(d,m,y){return y.g+=d.g,y.value+=d.value<<m>>>0,t(8>=y.g),d.g}function Cn(d,m,y){var x=d.xc;return t((m=x==0?0:d.vc[d.md*(y>>x)+(m>>x)])<d.Wb),d.Ya[m]}function Eh(d,m,y,x){var T=d.ab,M=d.c*m,R=d.C;m=R+m;var O=y,U=x;for(x=d.Ta,y=d.Ua;0<T--;){var W=d.gc[T],et=R,dt=m,G=O,nt=U,ct=(U=x,O=y,W.Ea);switch(t(et<dt),t(dt<=W.nc),W.hc){case 2:Ui(G,nt,(dt-et)*ct,U,O);break;case 0:var mt=et,ut=dt,vt=U,_t=O,kt=(Ht=W).Ea;mt==0&&(tp(G,nt,null,null,1,vt,_t),Ie(G,nt+1,0,0,kt-1,vt,_t+1),nt+=kt,_t+=kt,++mt);for(var xt=1<<Ht.b,$t=xt-1,Ot=Et(kt,Ht.b),ye=Ht.K,Ht=Ht.w+(mt>>Ht.b)*Ot;mt<ut;){var Fe=ye,on=Ht,we=1;for(Mu(G,nt,vt,_t-kt,1,vt,_t);we<kt;){var qt=(we&~$t)+xt;qt>kt&&(qt=kt),(0,ip[Fe[on++]>>8&15])(G,nt+ +we,vt,_t+we-kt,qt-we,vt,_t+we),we=qt}nt+=kt,_t+=kt,++mt&$t||(Ht+=Ot)}dt!=W.nc&&i(U,O-ct,U,O+(dt-et-1)*ct,ct);break;case 1:for(ct=G,ut=nt,kt=(G=W.Ea)-(_t=G&~(vt=(nt=1<<W.b)-1)),mt=Et(G,W.b),xt=W.K,W=W.w+(et>>W.b)*mt;et<dt;){for($t=xt,Ot=W,ye=new Zt,Ht=ut+_t,Fe=ut+G;ut<Ht;)Wt($t[Ot++],ye),np(ye,ct,ut,nt,U,O),ut+=nt,O+=nt;ut<Fe&&(Wt($t[Ot++],ye),np(ye,ct,ut,kt,U,O),ut+=kt,O+=kt),++et&vt||(W+=mt)}break;case 3:if(G==U&&nt==O&&0<W.b){for(ut=U,G=ct=O+(dt-et)*ct-(_t=(dt-et)*Et(W.Ea,W.b)),nt=U,vt=O,mt=[],_t=(kt=_t)-1;0<=_t;--_t)mt[_t]=nt[vt+_t];for(_t=kt-1;0<=_t;--_t)ut[G+_t]=mt[_t];w0(W,et,dt,U,ct,U,O)}else w0(W,et,dt,G,nt,U,O)}O=x,U=y}U!=y&&i(x,y,O,U,M)}function cl(d,m){var y=d.V,x=d.Ba+d.c*d.C,T=m-d.C;if(t(m<=d.l.o),t(16>=T),0<T){var M=d.l,R=d.Ta,O=d.Ua,U=M.width;if(Eh(d,T,y,x),T=O=[O],t((y=d.C)<(x=m)),t(M.v<M.va),x>M.o&&(x=M.o),y<M.j){var W=M.j-y;y=M.j,T[0]+=W*U}if(y>=x?y=0:(T[0]+=4*M.v,M.ka=y-M.j,M.U=M.va-M.v,M.T=x-y,y=1),y){if(O=O[0],11>(y=d.ca).S){var et=y.f.RGBA,dt=(x=y.S,T=M.U,M=M.T,W=et.eb,et.A),G=M;for(et=et.fb+d.Ma*et.A;0<G--;){var nt=R,ct=O,mt=T,ut=W,vt=et;switch(x){case S0:sp(nt,ct,mt,ut,vt);break;case x0:ml(nt,ct,mt,ut,vt);break;case X2:ml(nt,ct,mt,ut,vt),ap(ut,vt,0,mt,1,0);break;case dy:Hh(nt,ct,mt,ut,vt);break;case C0:Jt(nt,ct,mt,ut,vt,1);break;case Y2:Jt(nt,ct,mt,ut,vt,1),ap(ut,vt,0,mt,1,0);break;case L0:Jt(nt,ct,mt,ut,vt,0);break;case E0:Jt(nt,ct,mt,ut,vt,0),ap(ut,vt,1,mt,1,0);break;case $2:bl(nt,ct,mt,ut,vt);break;case K2:bl(nt,ct,mt,ut,vt),sy(ut,vt,mt,1,0);break;case fy:vl(nt,ct,mt,ut,vt);break;default:t(0)}O+=U,et+=dt}d.Ma+=M}else alert("todo:EmitRescaledRowsYUVA");t(d.Ma<=y.height)}}d.C=m,t(d.C<=d.i)}function Tr(d){var m;if(0<d.ua)return 0;for(m=0;m<d.Wb;++m){var y=d.Ya[m].G,x=d.Ya[m].H;if(0<y[1][x[1]+0].g||0<y[2][x[2]+0].g||0<y[3][x[3]+0].g)return 0}return 1}function oa(d,m,y,x,T,M){if(d.Z!=0){var R=d.qd,O=d.rd;for(t(Al[d.Z]!=null);m<y;++m)Al[d.Z](R,O,x,T,x,T,M),R=x,O=T,T+=M;d.qd=R,d.rd=O}}function Ir(d,m){var y=d.l.ma,x=y.Z==0||y.Z==1?d.l.j:d.C;if(x=d.C<x?x:d.C,t(m<=d.l.o),m>x){var T=d.l.width,M=y.ca,R=y.tb+T*x,O=d.V,U=d.Ba+d.c*x,W=d.gc;t(d.ab==1),t(W[0].hc==3),fa(W[0],x,m,O,U,M,R),oa(y,x,m,M,R,T)}d.C=d.Ma=m}function Fr(d,m,y,x,T,M,R){var O=d.$/x,U=d.$%x,W=d.m,et=d.s,dt=y+d.$,G=dt;T=y+x*T;var nt=y+x*M,ct=280+et.ua,mt=d.Pb?O:16777216,ut=0<et.ua?et.Wa:null,vt=et.wc,_t=dt<nt?Cn(et,U,O):null;t(d.C<M),t(nt<=T);var kt=!1;t:for(;;){for(;kt||dt<nt;){var xt=0;if(O>=mt){var $t=dt-y;t((mt=d).Pb),mt.wd=mt.m,mt.xd=$t,0<mt.s.ua&&Ft(mt.s.Wa,mt.s.vb),mt=O+hx}if(U&vt||(_t=Cn(et,U,O)),t(_t!=null),_t.Qb&&(m[dt]=_t.qb,kt=!0),!kt)if(at(W),_t.jc){xt=W,$t=m;var Ot=dt,ye=_t.pd[J(xt)&Uh-1];t(_t.jc),256>ye.g?(it(xt,xt.u+ye.g),$t[Ot]=ye.value,xt=0):(it(xt,xt.u+ye.g-256),t(256<=ye.value),xt=ye.value),xt==0&&(kt=!0)}else xt=Ni(_t.G[0],_t.H[0],W);if(W.h)break;if(kt||256>xt){if(!kt)if(_t.nd)m[dt]=(_t.qb|xt<<8)>>>0;else{if(at(W),kt=Ni(_t.G[1],_t.H[1],W),at(W),$t=Ni(_t.G[2],_t.H[2],W),Ot=Ni(_t.G[3],_t.H[3],W),W.h)break;m[dt]=(Ot<<24|kt<<16|xt<<8|$t)>>>0}if(kt=!1,++dt,++U>=x&&(U=0,++O,R!=null&&O<=M&&!(O%16)&&R(d,O),ut!=null))for(;G<dt;)xt=m[G++],ut.X[(506832829*xt&4294967295)>>>ut.Mb]=xt}else if(280>xt){if(xt=rr(xt-256,W),$t=Ni(_t.G[4],_t.H[4],W),at(W),$t=ar(x,$t=rr($t,W)),W.h)break;if(dt-y<$t||T-dt<xt)break t;for(Ot=0;Ot<xt;++Ot)m[dt+Ot]=m[dt+Ot-$t];for(dt+=xt,U+=xt;U>=x;)U-=x,++O,R!=null&&O<=M&&!(O%16)&&R(d,O);if(t(dt<=T),U&vt&&(_t=Cn(et,U,O)),ut!=null)for(;G<dt;)xt=m[G++],ut.X[(506832829*xt&4294967295)>>>ut.Mb]=xt}else{if(!(xt<ct))break t;for(kt=xt-280,t(ut!=null);G<dt;)xt=m[G++],ut.X[(506832829*xt&4294967295)>>>ut.Mb]=xt;xt=dt,t(!(kt>>>($t=ut).Xa)),m[xt]=$t.X[kt],kt=!0}kt||t(W.h==Q(W))}if(d.Pb&&W.h&&dt<T)t(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&Ft(d.s.vb,d.s.Wa);else{if(W.h)break t;R!=null&&R(d,O>M?M:O),d.a=0,d.$=dt-y}return 1}return d.a=3,0}function or(d){t(d!=null),d.vc=null,d.yc=null,d.Ya=null;var m=d.Wa;m!=null&&(m.X=null),d.vb=null,t(d!=null)}function kh(){var d=new ae;return d==null?null:(d.a=0,d.xb=my,ci("Predictor","VP8LPredictors"),ci("Predictor","VP8LPredictors_C"),ci("PredictorAdd","VP8LPredictorsAdd"),ci("PredictorAdd","VP8LPredictorsAdd_C"),Ui=Pe,np=me,sp=ji,ml=De,bl=xe,vl=Ce,Hh=yi,B.VP8LMapColor32b=da,B.VP8LMapColor8b=ep,d)}function la(d,m,y,x,T){var M=1,R=[d],O=[m],U=x.m,W=x.s,et=null,dt=0;t:for(;;){if(y)for(;M&&At(U,1);){var G=R,nt=O,ct=x,mt=1,ut=ct.m,vt=ct.gc[ct.ab],_t=At(ut,2);if(ct.Oc&1<<_t)M=0;else{switch(ct.Oc|=1<<_t,vt.hc=_t,vt.Ea=G[0],vt.nc=nt[0],vt.K=[null],++ct.ab,t(4>=ct.ab),_t){case 0:case 1:vt.b=At(ut,3)+2,mt=la(Et(vt.Ea,vt.b),Et(vt.nc,vt.b),0,ct,vt.K),vt.K=vt.K[0];break;case 3:var kt,xt=At(ut,8)+1,$t=16<xt?0:4<xt?1:2<xt?2:3;if(G[0]=Et(vt.Ea,$t),vt.b=$t,kt=mt=la(xt,1,0,ct,vt.K)){var Ot,ye=xt,Ht=vt,Fe=1<<(8>>Ht.b),on=s(Fe);if(on==null)kt=0;else{var we=Ht.K[0],qt=Ht.w;for(on[0]=Ht.K[0][0],Ot=1;Ot<1*ye;++Ot)on[Ot]=te(we[qt+Ot],on[Ot-1]);for(;Ot<4*Fe;++Ot)on[Ot]=0;Ht.K[0]=null,Ht.K[0]=on,kt=1}}mt=kt;break;case 2:break;default:t(0)}M=mt}}if(R=R[0],O=O[0],M&&At(U,1)&&!(M=1<=(dt=At(U,4))&&11>=dt)){x.a=3;break t}var Pt;if(Pt=M)e:{var qi,pe,Re,mi=x,kn=R,es=O,Ti=dt,Hn=y,is=mi.m,ln=mi.s,Be=[null],Ve=1,Ii=0,$e=lx[Ti];i:for(;;){if(Hn&&At(is,1)){var Pn=At(is,3)+2,Or=Et(kn,Pn),zi=Et(es,Pn),ds=Or*zi;if(!la(Or,zi,0,mi,Be))break i;for(Be=Be[0],ln.xc=Pn,qi=0;qi<ds;++qi){var si=Be[qi]>>8&65535;Be[qi]=si,si>=Ve&&(Ve=si+1)}}if(is.h)break i;for(pe=0;5>pe;++pe){var hn=py[pe];!pe&&0<Ti&&(hn+=1<<Ti),Ii<hn&&(Ii=hn)}var Es=a(Ve*$e,K),ns=Ve,ks=a(ns,ot);if(ks==null)var Ps=null;else t(65536>=ns),Ps=ks;var fs=s(Ii);if(Ps==null||fs==null||Es==null){mi.a=1;break i}var Ns=Es;for(qi=Re=0;qi<Ve;++qi){var di=Ps[qi],Ts=di.G,Br=di.H,zh=0,ho=1,Nn=0;for(pe=0;5>pe;++pe){hn=py[pe],Ts[pe]=Ns,Br[pe]=Re,!pe&&0<Ti&&(hn+=1<<Ti);s:{var T0,t5=hn,I0=mi,hp=fs,Px=Ns,Nx=Re,e5=0,_l=I0.m,Tx=At(_l,1);if(n(hp,0,0,t5),Tx){var Ix=At(_l,1)+1,Fx=At(_l,1),xy=At(_l,Fx==0?1:8);hp[xy]=1,Ix==2&&(hp[xy=At(_l,8)]=1);var F0=1}else{var Cy=s(19),Ly=At(_l,4)+4;if(19<Ly){I0.a=3;var M0=0;break s}for(T0=0;T0<Ly;++T0)Cy[ax[T0]]=At(_l,3);var i5=void 0,cp=void 0,Ey=I0,Mx=Cy,R0=t5,ky=hp,n5=0,Sl=Ey.m,Py=8,Ny=a(128,K);n:for(;j(Ny,0,7,Mx,19);){if(At(Sl,1)){var Rx=2+2*At(Sl,3);if((i5=2+At(Sl,Rx))>R0)break n}else i5=R0;for(cp=0;cp<R0&&i5--;){at(Sl);var Ty=Ny[0+(127&J(Sl))];it(Sl,Sl.u+Ty.g);var Du=Ty.value;if(16>Du)ky[cp++]=Du,Du!=0&&(Py=Du);else{var Dx=Du==16,Iy=Du-16,Ox=sx[Iy],Fy=At(Sl,nx[Iy])+Ox;if(cp+Fy>R0)break n;for(var Bx=Dx?Py:0;0<Fy--;)ky[cp++]=Bx}}n5=1;break n}n5||(Ey.a=3),F0=n5}(F0=F0&&!_l.h)&&(e5=j(Px,Nx,8,hp,t5)),F0&&e5!=0?M0=e5:(I0.a=3,M0=0)}if(M0==0)break i;if(ho&&rx[pe]==1&&(ho=Ns[Re].g==0),zh+=Ns[Re].g,Re+=M0,3>=pe){var up,s5=fs[0];for(up=1;up<hn;++up)fs[up]>s5&&(s5=fs[up]);Nn+=s5}}if(di.nd=ho,di.Qb=0,ho&&(di.qb=(Ts[3][Br[3]+0].value<<24|Ts[1][Br[1]+0].value<<16|Ts[2][Br[2]+0].value)>>>0,zh==0&&256>Ts[0][Br[0]+0].value&&(di.Qb=1,di.qb+=Ts[0][Br[0]+0].value<<8)),di.jc=!di.Qb&&6>Nn,di.jc){var D0,co=di;for(D0=0;D0<Uh;++D0){var xl=D0,Cl=co.pd[xl],O0=co.G[0][co.H[0]+xl];256<=O0.value?(Cl.g=O0.g+256,Cl.value=O0.value):(Cl.g=0,Cl.value=0,xl>>=bn(O0,8,Cl),xl>>=bn(co.G[1][co.H[1]+xl],16,Cl),xl>>=bn(co.G[2][co.H[2]+xl],0,Cl),bn(co.G[3][co.H[3]+xl],24,Cl))}}}ln.vc=Be,ln.Wb=Ve,ln.Ya=Ps,ln.yc=Es,Pt=1;break e}Pt=0}if(!(M=Pt)){x.a=3;break t}if(0<dt){if(W.ua=1<<dt,!q(W.Wa,dt)){x.a=1,M=0;break t}}else W.ua=0;var r5=x,My=R,jx=O,a5=r5.s,o5=a5.xc;if(r5.c=My,r5.i=jx,a5.md=Et(My,o5),a5.wc=o5==0?-1:(1<<o5)-1,y){x.xb=mx;break t}if((et=s(R*O))==null){x.a=1,M=0;break t}M=(M=Fr(x,et,0,R,O,O,null))&&!U.h;break t}return M?(T!=null?T[0]=et:(t(et==null),t(y)),x.$=0,y||or(W)):or(W),M}function Ph(d,m){var y=d.c*d.i,x=y+m+16*m;return t(d.c<=m),d.V=s(x),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+y+m,1)}function xu(d,m){var y=d.C,x=m-y,T=d.V,M=d.Ba+d.c*y;for(t(m<=d.l.o);0<x;){var R=16<x?16:x,O=d.l.ma,U=d.l.width,W=U*R,et=O.ca,dt=O.tb+U*y,G=d.Ta,nt=d.Ua;Eh(d,R,T,M),ay(G,nt,et,dt,W),oa(O,y,y+R,et,dt,U),x-=R,T+=R*d.c,y+=R}t(y==m),d.C=d.Ma=m}function Cu(){this.ub=this.yd=this.td=this.Rb=0}function Lu(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function N2(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Bf(){this.Yb=(function(){var d=[];return(function m(y,x,T){for(var M=T[x],R=0;R<M&&(y.push(T.length>x+1?[]:0),!(T.length<x+1));R++)m(y[R],x+1,T)})(d,0,[3,11]),d})()}function i0(){this.jb=s(3),this.Wc=o([4,8],Bf),this.Xc=o([4,17],Bf)}function n0(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function lr(){this.ld=this.La=this.dd=this.tc=0}function jf(){this.Na=this.la=0}function s0(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Uf(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function r0(){this.uc=this.M=this.Nb=0,this.wa=Array(new lr),this.Y=0,this.ya=Array(new Uf),this.aa=0,this.l=new Eu}function a0(){this.y=s(16),this.f=s(8),this.ea=s(8)}function o0(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new Cu,this.Kc=new Lu,this.ed=new n0,this.Qa=new N2,this.Ic=this.$c=this.Aa=0,this.D=new r0,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,F),this.ia=0,this.pb=a(4,s0),this.Pa=new i0,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new a0),this.Hd=0,this.rb=Array(new jf),this.sb=0,this.wa=Array(new lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Uf),this.L=this.aa=0,this.gd=o([4,2],lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ha(d,m){return 0>d?0:d>m?m:d}function Eu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function T2(){var d=new o0;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,op||(op=ku)),d}function Ki(d,m,y){return d.a==0&&(d.a=m,d.sc=y,d.cb=0),0}function l0(d,m,y){return 3<=y&&d[m+0]==157&&d[m+1]==1&&d[m+2]==42}function ca(d,m){if(d==null)return 0;if(d.a=0,d.sc="OK",m==null)return Ki(d,2,"null VP8Io passed to VP8GetHeaders()");var y=m.data,x=m.w,T=m.ha;if(4>T)return Ki(d,7,"Truncated header.");var M=y[x+0]|y[x+1]<<8|y[x+2]<<16,R=d.Od;if(R.Rb=!(1&M),R.td=M>>1&7,R.yd=M>>4&1,R.ub=M>>5,3<R.td)return Ki(d,3,"Incorrect keyframe parameters.");if(!R.yd)return Ki(d,4,"Frame not displayable.");x+=3,T-=3;var O=d.Kc;if(R.Rb){if(7>T)return Ki(d,7,"cannot parse picture header");if(!l0(y,x,T))return Ki(d,3,"Bad code word");O.c=16383&(y[x+4]<<8|y[x+3]),O.Td=y[x+4]>>6,O.i=16383&(y[x+6]<<8|y[x+5]),O.Ud=y[x+6]>>6,x+=7,T-=7,d.za=O.c+15>>4,d.Ub=O.i+15>>4,m.width=O.c,m.height=O.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,n((M=d.Pa).jb,0,255,M.jb.length),t((M=d.Qa)!=null),M.Cb=0,M.Bb=0,M.Fb=1,n(M.Zb,0,0,M.Zb.length),n(M.Lb,0,0,M.Lb)}if(R.ub>T)return Ki(d,7,"bad partition length");rt(M=d.m,y,x,R.ub),x+=R.ub,T-=R.ub,R.Rb&&(O.Ld=gt(M),O.Kd=gt(M)),O=d.Qa;var U,W=d.Pa;if(t(M!=null),t(O!=null),O.Cb=gt(M),O.Cb){if(O.Bb=gt(M),gt(M)){for(O.Fb=gt(M),U=0;4>U;++U)O.Zb[U]=gt(M)?st(M,7):0;for(U=0;4>U;++U)O.Lb[U]=gt(M)?st(M,6):0}if(O.Bb)for(U=0;3>U;++U)W.jb[U]=gt(M)?lt(M,8):255}else O.Bb=0;if(M.Ka)return Ki(d,3,"cannot parse segment header");if((O=d.ed).zd=gt(M),O.Tb=lt(M,6),O.wb=lt(M,3),O.Pc=gt(M),O.Pc&&gt(M)){for(W=0;4>W;++W)gt(M)&&(O.vd[W]=st(M,6));for(W=0;4>W;++W)gt(M)&&(O.od[W]=st(M,6))}if(d.L=O.Tb==0?0:O.zd?1:2,M.Ka)return Ki(d,3,"cannot parse filter header");var et=T;if(T=U=x,x=U+et,O=et,d.Xb=(1<<lt(d.m,2))-1,et<3*(W=d.Xb))y=7;else{for(U+=3*W,O-=3*W,et=0;et<W;++et){var dt=y[T+0]|y[T+1]<<8|y[T+2]<<16;dt>O&&(dt=O),rt(d.Jc[+et],y,U,dt),U+=dt,O-=dt,T+=3}rt(d.Jc[+W],y,U,O),y=U<x?0:5}if(y!=0)return Ki(d,y,"cannot parse partitions");for(y=lt(U=d.m,7),T=gt(U)?st(U,4):0,x=gt(U)?st(U,4):0,O=gt(U)?st(U,4):0,W=gt(U)?st(U,4):0,U=gt(U)?st(U,4):0,et=d.Qa,dt=0;4>dt;++dt){if(et.Cb){var G=et.Zb[dt];et.Fb||(G+=y)}else{if(0<dt){d.pb[dt]=d.pb[0];continue}G=y}var nt=d.pb[dt];nt.Sc[0]=J2[ha(G+T,127)],nt.Sc[1]=Z2[ha(G+0,127)],nt.Eb[0]=2*J2[ha(G+x,127)],nt.Eb[1]=101581*Z2[ha(G+O,127)]>>16,8>nt.Eb[1]&&(nt.Eb[1]=8),nt.Qc[0]=J2[ha(G+W,117)],nt.Qc[1]=Z2[ha(G+U,127)],nt.lc=G+U}if(!R.Rb)return Ki(d,4,"Not a key frame.");for(gt(M),R=d.Pa,y=0;4>y;++y){for(T=0;8>T;++T)for(x=0;3>x;++x)for(O=0;11>O;++O)W=yt(M,px[y][T][x][O])?lt(M,8):dx[y][T][x][O],R.Wc[y][T].Yb[x][O]=W;for(T=0;17>T;++T)R.Xc[y][T]=R.Wc[y][gx[T]]}return d.kc=gt(M),d.kc&&(d.Bd=lt(M,8)),d.cb=1}function ku(d,m,y,x,T,M,R){var O=m[T].Yb[y];for(y=0;16>T;++T){if(!yt(d,O[y+0]))return T;for(;!yt(d,O[y+1]);)if(O=m[++T].Yb[0],y=0,T==16)return 16;var U=m[T+1].Yb;if(yt(d,O[y+2])){var W=d,et=0;if(yt(W,(G=O)[(dt=y)+3]))if(yt(W,G[dt+6])){for(O=0,dt=2*(et=yt(W,G[dt+8]))+(G=yt(W,G[dt+9+et])),et=0,G=cx[dt];G[O];++O)et+=et+yt(W,G[O]);et+=3+(8<<dt)}else yt(W,G[dt+7])?(et=7+2*yt(W,165),et+=yt(W,145)):et=5+yt(W,159);else et=yt(W,G[dt+4])?3+yt(W,G[dt+5]):2;O=U[2]}else et=1,O=U[1];U=R+ux[T],0>(W=d).b&&pt(W);var dt,G=W.b,nt=(dt=W.Ca>>1)-(W.I>>G)>>31;--W.b,W.Ca+=nt,W.Ca|=1,W.I-=(dt+1&nt)<<G,M[U]=((et^nt)-nt)*x[(0<T)+0]}return 16}function h0(d){var m=d.rb[d.sb-1];m.la=0,m.Na=0,n(d.zc,0,0,d.zc.length),d.ja=0}function hr(d,m,y,x,T){T=d[m+y+32*x]+(T>>3),d[m+y+32*x]=-256&T?0>T?0:255:T}function sn(d,m,y,x,T,M){hr(d,m,0,y,x+T),hr(d,m,1,y,x+M),hr(d,m,2,y,x-M),hr(d,m,3,y,x-T)}function Ka(d){return(20091*d>>16)+d}function c0(d,m,y,x){var T,M=0,R=s(16);for(T=0;4>T;++T){var O=d[m+0]+d[m+8],U=d[m+0]-d[m+8],W=(35468*d[m+4]>>16)-Ka(d[m+12]),et=Ka(d[m+4])+(35468*d[m+12]>>16);R[M+0]=O+et,R[M+1]=U+W,R[M+2]=U-W,R[M+3]=O-et,M+=4,m++}for(T=M=0;4>T;++T)O=(d=R[M+0]+4)+R[M+8],U=d-R[M+8],W=(35468*R[M+4]>>16)-Ka(R[M+12]),hr(y,x,0,0,O+(et=Ka(R[M+4])+(35468*R[M+12]>>16))),hr(y,x,1,0,U+W),hr(y,x,2,0,U-W),hr(y,x,3,0,O-et),M++,x+=32}function I2(d,m,y,x){var T=d[m+0]+4,M=35468*d[m+4]>>16,R=Ka(d[m+4]),O=35468*d[m+1]>>16;sn(y,x,0,T+R,d=Ka(d[m+1]),O),sn(y,x,1,T+M,d,O),sn(y,x,2,T-M,d,O),sn(y,x,3,T-R,d,O)}function F2(d,m,y,x,T){c0(d,m,y,x),T&&c0(d,m+16,y,x+4)}function ua(d,m,y,x){qh(d,m+0,y,x,1),qh(d,m+32,y,x+128,1)}function u0(d,m,y,x){var T;for(d=d[m+0]+4,T=0;4>T;++T)for(m=0;4>m;++m)hr(y,x,m,T,d)}function d0(d,m,y,x){d[m+0]&&We(d,m+0,y,x),d[m+16]&&We(d,m+16,y,x+4),d[m+32]&&We(d,m+32,y,x+128),d[m+48]&&We(d,m+48,y,x+128+4)}function Pu(d,m,y,x){var T,M=s(16);for(T=0;4>T;++T){var R=d[m+0+T]+d[m+12+T],O=d[m+4+T]+d[m+8+T],U=d[m+4+T]-d[m+8+T],W=d[m+0+T]-d[m+12+T];M[0+T]=R+O,M[8+T]=R-O,M[4+T]=W+U,M[12+T]=W-U}for(T=0;4>T;++T)R=(d=M[0+4*T]+3)+M[3+4*T],O=M[1+4*T]+M[2+4*T],U=M[1+4*T]-M[2+4*T],W=d-M[3+4*T],y[x+0]=R+O>>3,y[x+16]=W+U>>3,y[x+32]=R-O>>3,y[x+48]=W-U>>3,x+=64}function Nh(d,m,y){var x,T=m-32,M=Ls,R=255-d[T-1];for(x=0;x<y;++x){var O,U=M,W=R+d[m-1];for(O=0;O<y;++O)d[m+O]=U[W+d[T+O]];m+=32}}function M2(d,m){Nh(d,m,4)}function R2(d,m){Nh(d,m,8)}function D2(d,m){Nh(d,m,16)}function Hf(d,m){var y;for(y=0;16>y;++y)i(d,m+32*y,d,m-32,16)}function f0(d,m){var y;for(y=16;0<y;--y)n(d,m,d[m-1],16),m+=32}function Mr(d,m,y){var x;for(x=0;16>x;++x)n(m,y+32*x,d,16)}function O2(d,m){var y,x=16;for(y=0;16>y;++y)x+=d[m-1+32*y]+d[m+y-32];Mr(x>>5,d,m)}function Th(d,m){var y,x=8;for(y=0;16>y;++y)x+=d[m-1+32*y];Mr(x>>4,d,m)}function qf(d,m){var y,x=8;for(y=0;16>y;++y)x+=d[m+y-32];Mr(x>>4,d,m)}function B2(d,m){Mr(128,d,m)}function oe(d,m,y){return d+2*m+y+2>>2}function j2(d,m){var y,x=m-32;for(x=new Uint8Array([oe(d[x-1],d[x+0],d[x+1]),oe(d[x+0],d[x+1],d[x+2]),oe(d[x+1],d[x+2],d[x+3]),oe(d[x+2],d[x+3],d[x+4])]),y=0;4>y;++y)i(d,m+32*y,x,0,x.length)}function U2(d,m){var y=d[m-1],x=d[m-1+32],T=d[m-1+64],M=d[m-1+96];Lt(d,m+0,16843009*oe(d[m-1-32],y,x)),Lt(d,m+32,16843009*oe(y,x,T)),Lt(d,m+64,16843009*oe(x,T,M)),Lt(d,m+96,16843009*oe(T,M,M))}function H2(d,m){var y,x=4;for(y=0;4>y;++y)x+=d[m+y-32]+d[m-1+32*y];for(x>>=3,y=0;4>y;++y)n(d,m+32*y,x,4)}function Ja(d,m){var y=d[m-1+0],x=d[m-1+32],T=d[m-1+64],M=d[m-1-32],R=d[m+0-32],O=d[m+1-32],U=d[m+2-32],W=d[m+3-32];d[m+0+96]=oe(x,T,d[m-1+96]),d[m+1+96]=d[m+0+64]=oe(y,x,T),d[m+2+96]=d[m+1+64]=d[m+0+32]=oe(M,y,x),d[m+3+96]=d[m+2+64]=d[m+1+32]=d[m+0+0]=oe(R,M,y),d[m+3+64]=d[m+2+32]=d[m+1+0]=oe(O,R,M),d[m+3+32]=d[m+2+0]=oe(U,O,R),d[m+3+0]=oe(W,U,O)}function Za(d,m){var y=d[m+1-32],x=d[m+2-32],T=d[m+3-32],M=d[m+4-32],R=d[m+5-32],O=d[m+6-32],U=d[m+7-32];d[m+0+0]=oe(d[m+0-32],y,x),d[m+1+0]=d[m+0+32]=oe(y,x,T),d[m+2+0]=d[m+1+32]=d[m+0+64]=oe(x,T,M),d[m+3+0]=d[m+2+32]=d[m+1+64]=d[m+0+96]=oe(T,M,R),d[m+3+32]=d[m+2+64]=d[m+1+96]=oe(M,R,O),d[m+3+64]=d[m+2+96]=oe(R,O,U),d[m+3+96]=oe(O,U,U)}function q2(d,m){var y=d[m-1+0],x=d[m-1+32],T=d[m-1+64],M=d[m-1-32],R=d[m+0-32],O=d[m+1-32],U=d[m+2-32],W=d[m+3-32];d[m+0+0]=d[m+1+64]=M+R+1>>1,d[m+1+0]=d[m+2+64]=R+O+1>>1,d[m+2+0]=d[m+3+64]=O+U+1>>1,d[m+3+0]=U+W+1>>1,d[m+0+96]=oe(T,x,y),d[m+0+64]=oe(x,y,M),d[m+0+32]=d[m+1+96]=oe(y,M,R),d[m+1+32]=d[m+2+96]=oe(M,R,O),d[m+2+32]=d[m+3+96]=oe(R,O,U),d[m+3+32]=oe(O,U,W)}function z2(d,m){var y=d[m+0-32],x=d[m+1-32],T=d[m+2-32],M=d[m+3-32],R=d[m+4-32],O=d[m+5-32],U=d[m+6-32],W=d[m+7-32];d[m+0+0]=y+x+1>>1,d[m+1+0]=d[m+0+64]=x+T+1>>1,d[m+2+0]=d[m+1+64]=T+M+1>>1,d[m+3+0]=d[m+2+64]=M+R+1>>1,d[m+0+32]=oe(y,x,T),d[m+1+32]=d[m+0+96]=oe(x,T,M),d[m+2+32]=d[m+1+96]=oe(T,M,R),d[m+3+32]=d[m+2+96]=oe(M,R,O),d[m+3+64]=oe(R,O,U),d[m+3+96]=oe(O,U,W)}function Nu(d,m){var y=d[m-1+0],x=d[m-1+32],T=d[m-1+64],M=d[m-1+96];d[m+0+0]=y+x+1>>1,d[m+2+0]=d[m+0+32]=x+T+1>>1,d[m+2+32]=d[m+0+64]=T+M+1>>1,d[m+1+0]=oe(y,x,T),d[m+3+0]=d[m+1+32]=oe(x,T,M),d[m+3+32]=d[m+1+64]=oe(T,M,M),d[m+3+64]=d[m+2+64]=d[m+0+96]=d[m+1+96]=d[m+2+96]=d[m+3+96]=M}function zf(d,m){var y=d[m-1+0],x=d[m-1+32],T=d[m-1+64],M=d[m-1+96],R=d[m-1-32],O=d[m+0-32],U=d[m+1-32],W=d[m+2-32];d[m+0+0]=d[m+2+32]=y+R+1>>1,d[m+0+32]=d[m+2+64]=x+y+1>>1,d[m+0+64]=d[m+2+96]=T+x+1>>1,d[m+0+96]=M+T+1>>1,d[m+3+0]=oe(O,U,W),d[m+2+0]=oe(R,O,U),d[m+1+0]=d[m+3+32]=oe(y,R,O),d[m+1+32]=d[m+3+64]=oe(x,y,R),d[m+1+64]=d[m+3+96]=oe(T,x,y),d[m+1+96]=oe(M,T,x)}function Ih(d,m){var y;for(y=0;8>y;++y)i(d,m+32*y,d,m-32,8)}function W2(d,m){var y;for(y=0;8>y;++y)n(d,m,d[m-1],8),m+=32}function Qa(d,m,y){var x;for(x=0;8>x;++x)n(m,y+32*x,d,8)}function G2(d,m){var y,x=8;for(y=0;8>y;++y)x+=d[m+y-32]+d[m-1+32*y];Qa(x>>4,d,m)}function Wf(d,m){var y,x=4;for(y=0;8>y;++y)x+=d[m+y-32];Qa(x>>3,d,m)}function Gf(d,m){var y,x=4;for(y=0;8>y;++y)x+=d[m-1+32*y];Qa(x>>3,d,m)}function p0(d,m){Qa(128,d,m)}function to(d,m,y){var x=d[m-y],T=d[m+0],M=3*(T-x)+V2[1020+d[m-2*y]-d[m+y]],R=_0[112+(M+4>>3)];d[m-y]=Ls[255+x+_0[112+(M+3>>3)]],d[m+0]=Ls[255+T-R]}function Vf(d,m,y,x){var T=d[m+0],M=d[m+y];return dr[255+d[m-2*y]-d[m-y]]>x||dr[255+M-T]>x}function Tu(d,m,y,x){return 4*dr[255+d[m-y]-d[m+0]]+dr[255+d[m-2*y]-d[m+y]]<=x}function $f(d,m,y,x,T){var M=d[m-3*y],R=d[m-2*y],O=d[m-y],U=d[m+0],W=d[m+y],et=d[m+2*y],dt=d[m+3*y];return 4*dr[255+O-U]+dr[255+R-W]>x?0:dr[255+d[m-4*y]-M]<=T&&dr[255+M-R]<=T&&dr[255+R-O]<=T&&dr[255+dt-et]<=T&&dr[255+et-W]<=T&&dr[255+W-U]<=T}function Fh(d,m,y,x){var T=2*x+1;for(x=0;16>x;++x)Tu(d,m+x,y,T)&&to(d,m+x,y)}function Xf(d,m,y,x){var T=2*x+1;for(x=0;16>x;++x)Tu(d,m+x*y,1,T)&&to(d,m+x*y,1)}function g0(d,m,y,x){var T;for(T=3;0<T;--T)Fh(d,m+=4*y,y,x)}function m0(d,m,y,x){var T;for(T=3;0<T;--T)Xf(d,m+=4,y,x)}function eo(d,m,y,x,T,M,R,O){for(M=2*M+1;0<T--;){if($f(d,m,y,M,R))if(Vf(d,m,y,O))to(d,m,y);else{var U=d,W=m,et=y,dt=U[W-2*et],G=U[W-et],nt=U[W+0],ct=U[W+et],mt=U[W+2*et],ut=27*(_t=V2[1020+3*(nt-G)+V2[1020+dt-ct]])+63>>7,vt=18*_t+63>>7,_t=9*_t+63>>7;U[W-3*et]=Ls[255+U[W-3*et]+_t],U[W-2*et]=Ls[255+dt+vt],U[W-et]=Ls[255+G+ut],U[W+0]=Ls[255+nt-ut],U[W+et]=Ls[255+ct-vt],U[W+2*et]=Ls[255+mt-_t]}m+=x}}function io(d,m,y,x,T,M,R,O){for(M=2*M+1;0<T--;){if($f(d,m,y,M,R))if(Vf(d,m,y,O))to(d,m,y);else{var U=d,W=m,et=y,dt=U[W-et],G=U[W+0],nt=U[W+et],ct=_0[112+(4+(mt=3*(G-dt))>>3)],mt=_0[112+(mt+3>>3)],ut=ct+1>>1;U[W-2*et]=Ls[255+U[W-2*et]+ut],U[W-et]=Ls[255+dt+mt],U[W+0]=Ls[255+G-ct],U[W+et]=Ls[255+nt-ut]}m+=x}}function b0(d,m,y,x,T,M){eo(d,m,y,1,16,x,T,M)}function Mh(d,m,y,x,T,M){eo(d,m,1,y,16,x,T,M)}function v0(d,m,y,x,T,M){var R;for(R=3;0<R;--R)io(d,m+=4*y,y,1,16,x,T,M)}function b(d,m,y,x,T,M){var R;for(R=3;0<R;--R)io(d,m+=4,1,y,16,x,T,M)}function N(d,m,y,x,T,M,R,O){eo(d,m,T,1,8,M,R,O),eo(y,x,T,1,8,M,R,O)}function V(d,m,y,x,T,M,R,O){eo(d,m,1,T,8,M,R,O),eo(y,x,1,T,8,M,R,O)}function tt(d,m,y,x,T,M,R,O){io(d,m+4*T,T,1,8,M,R,O),io(y,x+4*T,T,1,8,M,R,O)}function ht(d,m,y,x,T,M,R,O){io(d,m+4,1,T,8,M,R,O),io(y,x+4,1,T,8,M,R,O)}function wt(){this.ba=new Le,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ze,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function St(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ut(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gt(){this.ua=0,this.Wa=new Se,this.vb=new Se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ot,this.yc=new K}function ae(){this.xb=this.a=0,this.l=new Eu,this.ca=new Le,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gt,this.ab=0,this.gc=a(4,Ut),this.Oc=0}function be(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Eu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Oe(d,m,y,x,T,M,R){for(d=d==null?0:d[m+0],m=0;m<R;++m)T[M+m]=d+y[x+m]&255,d=T[M+m]}function Ci(d,m,y,x,T,M,R){var O;if(d==null)Oe(null,null,y,x,T,M,R);else for(O=0;O<R;++O)T[M+O]=d[m+O]+y[x+O]&255}function Ji(d,m,y,x,T,M,R){if(d==null)Oe(null,null,y,x,T,M,R);else{var O,U=d[m+0],W=U,et=U;for(O=0;O<R;++O)W=et+(U=d[m+O])-W,et=y[x+O]+(-256&W?0>W?0:255:W)&255,W=U,T[M+O]=et}}function ui(d,m,y,x){var T=m.width,M=m.o;if(t(d!=null&&m!=null),0>y||0>=x||y+x>M)return null;if(!d.Cc){if(d.ga==null){var R;if(d.ga=new be,(R=d.ga==null)||(R=m.width*m.o,t(d.Gb.length==0),d.Gb=s(R),d.Uc=0,d.Gb==null?R=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,R=1),R=!R),!R){R=d.ga;var O=d.Fa,U=d.P,W=d.qc,et=d.mb,dt=d.nb,G=U+1,nt=W-1,ct=R.l;if(t(O!=null&&et!=null&&m!=null),Al[0]=null,Al[1]=Oe,Al[2]=Ci,Al[3]=Ji,R.ca=et,R.tb=dt,R.c=m.width,R.i=m.height,t(0<R.c&&0<R.i),1>=W)m=0;else if(R.$a=3&O[U+0],R.Z=O[U+0]>>2&3,R.Lc=O[U+0]>>4&3,U=O[U+0]>>6&3,0>R.$a||1<R.$a||4<=R.Z||1<R.Lc||U)m=0;else if(ct.put=ne,ct.ac=aa,ct.bc=Xa,ct.ma=R,ct.width=m.width,ct.height=m.height,ct.Da=m.Da,ct.v=m.v,ct.va=m.va,ct.j=m.j,ct.o=m.o,R.$a)t:{t(R.$a==1),m=kh();e:for(;;){if(m==null){m=0;break t}if(t(R!=null),R.mc=m,m.c=R.c,m.i=R.i,m.l=R.l,m.l.ma=R,m.l.width=R.c,m.l.height=R.i,m.a=0,ft(m.m,O,G,nt),!la(R.c,R.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Tr(m.s)?(R.ic=1,O=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(O),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(R.ic=0,m=Ph(m,R.c)),!m))break e;m=1;break t}R.mc=null,m=0}else m=nt>=R.c*R.i;R=!m}if(R)return null;d.ga.Lc!=1?d.Ga=0:x=M-y}t(d.ga!=null),t(y+x<=M);t:{if(m=(O=d.ga).c,M=O.l.o,O.$a==0){if(G=d.rc,nt=d.Vc,ct=d.Fa,U=d.P+1+y*m,W=d.mb,et=d.nb+y*m,t(U<=d.P+d.qc),O.Z!=0)for(t(Al[O.Z]!=null),R=0;R<x;++R)Al[O.Z](G,nt,ct,U,W,et,m),G=W,nt=et,et+=m,U+=m;else for(R=0;R<x;++R)i(W,et,ct,U,m),G=W,nt=et,et+=m,U+=m;d.rc=G,d.Vc=nt}else{if(t(O.mc!=null),m=y+x,t((R=O.mc)!=null),t(m<=R.i),R.C>=m)m=1;else if(O.ic||Rr(),O.ic){O=R.V,G=R.Ba,nt=R.c;var mt=R.i,ut=(ct=1,U=R.$/nt,W=R.$%nt,et=R.m,dt=R.s,R.$),vt=nt*mt,_t=nt*m,kt=dt.wc,xt=ut<_t?Cn(dt,W,U):null;t(ut<=vt),t(m<=mt),t(Tr(dt));e:for(;;){for(;!et.h&&ut<_t;){if(W&kt||(xt=Cn(dt,W,U)),t(xt!=null),at(et),256>(mt=Ni(xt.G[0],xt.H[0],et)))O[G+ut]=mt,++ut,++W>=nt&&(W=0,++U<=m&&!(U%16)&&Ir(R,U));else{if(!(280>mt)){ct=0;break e}mt=rr(mt-256,et);var $t,Ot=Ni(xt.G[4],xt.H[4],et);if(at(et),!(ut>=(Ot=ar(nt,Ot=rr(Ot,et)))&&vt-ut>=mt)){ct=0;break e}for($t=0;$t<mt;++$t)O[G+ut+$t]=O[G+ut+$t-Ot];for(ut+=mt,W+=mt;W>=nt;)W-=nt,++U<=m&&!(U%16)&&Ir(R,U);ut<_t&&W&kt&&(xt=Cn(dt,W,U))}t(et.h==Q(et))}Ir(R,U>m?m:U);break e}!ct||et.h&&ut<vt?(ct=0,R.a=et.h?5:3):R.$=ut,m=ct}else m=Fr(R,R.V,R.Ba,R.c,R.i,m,xu);if(!m){x=0;break t}}y+x>=M&&(d.Cc=1),x=1}if(!x)return null;if(d.Cc&&((x=d.ga)!=null&&(x.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+y*T}function rn(d,m,y,x,T,M){for(;0<T--;){var R,O=d,U=m+(y?1:0),W=d,et=m+(y?0:3);for(R=0;R<x;++R){var dt=W[et+4*R];dt!=255&&(dt*=32897,O[U+4*R+0]=O[U+4*R+0]*dt>>23,O[U+4*R+1]=O[U+4*R+1]*dt>>23,O[U+4*R+2]=O[U+4*R+2]*dt>>23)}m+=M}}function Zi(d,m,y,x,T){for(;0<x--;){var M;for(M=0;M<y;++M){var R=d[m+2*M+0],O=15&(W=d[m+2*M+1]),U=4369*O,W=(240&W|W>>4)*U>>16;d[m+2*M+0]=(240&R|R>>4)*U>>16&240|(15&R|R<<4)*U>>16>>4&15,d[m+2*M+1]=240&W|O}m+=T}}function Ln(d,m,y,x,T,M,R,O){var U,W,et=255;for(W=0;W<T;++W){for(U=0;U<x;++U){var dt=d[m+U];M[R+4*U]=dt,et&=dt}m+=y,R+=O}return et!=255}function no(d,m,y,x,T){var M;for(M=0;M<T;++M)y[x+M]=d[m+M]>>8}function Rr(){ap=rn,sy=Zi,ry=Ln,ay=no}function so(d,m,y){B[d]=function(x,T,M,R,O,U,W,et,dt,G,nt,ct,mt,ut,vt,_t,kt){var xt,$t=kt-1>>1,Ot=O[U+0]|W[et+0]<<16,ye=dt[G+0]|nt[ct+0]<<16;t(x!=null);var Ht=3*Ot+ye+131074>>2;for(m(x[T+0],255&Ht,Ht>>16,mt,ut),M!=null&&(Ht=3*ye+Ot+131074>>2,m(M[R+0],255&Ht,Ht>>16,vt,_t)),xt=1;xt<=$t;++xt){var Fe=O[U+xt]|W[et+xt]<<16,on=dt[G+xt]|nt[ct+xt]<<16,we=Ot+Fe+ye+on+524296,qt=we+2*(Fe+ye)>>3;Ht=qt+Ot>>1,Ot=(we=we+2*(Ot+on)>>3)+Fe>>1,m(x[T+2*xt-1],255&Ht,Ht>>16,mt,ut+(2*xt-1)*y),m(x[T+2*xt-0],255&Ot,Ot>>16,mt,ut+(2*xt-0)*y),M!=null&&(Ht=we+ye>>1,Ot=qt+on>>1,m(M[R+2*xt-1],255&Ht,Ht>>16,vt,_t+(2*xt-1)*y),m(M[R+2*xt+0],255&Ot,Ot>>16,vt,_t+(2*xt+0)*y)),Ot=Fe,ye=on}1&kt||(Ht=3*Ot+ye+131074>>2,m(x[T+kt-1],255&Ht,Ht>>16,mt,ut+(kt-1)*y),M!=null&&(Ht=3*ye+Ot+131074>>2,m(M[R+kt-1],255&Ht,Ht>>16,vt,_t+(kt-1)*y)))}}function Yf(){fr[S0]=bx,fr[x0]=by,fr[dy]=vx,fr[C0]=vy,fr[L0]=yy,fr[$2]=wy,fr[fy]=yx,fr[X2]=by,fr[Y2]=vy,fr[E0]=yy,fr[K2]=wy}function Iu(d){return d&-16384?0>d?0:255:d>>wx}function ul(d,m){return Iu((19077*d>>8)+(26149*m>>8)-14234)}function Rh(d,m,y){return Iu((19077*d>>8)-(6419*m>>8)-(13320*y>>8)+8708)}function Dh(d,m){return Iu((19077*d>>8)+(33050*m>>8)-17685)}function dl(d,m,y,x,T){x[T+0]=ul(d,y),x[T+1]=Rh(d,m,y),x[T+2]=Dh(d,m)}function En(d,m,y,x,T){x[T+0]=Dh(d,m),x[T+1]=Rh(d,m,y),x[T+2]=ul(d,y)}function Oh(d,m,y,x,T){var M=Rh(d,m,y);m=M<<3&224|Dh(d,m)>>3,x[T+0]=248&ul(d,y)|M>>5,x[T+1]=m}function Bh(d,m,y,x,T){var M=240&Dh(d,m)|15;x[T+0]=240&ul(d,y)|Rh(d,m,y)>>4,x[T+1]=M}function Kf(d,m,y,x,T){x[T+0]=255,dl(d,m,y,x,T+1)}function Jf(d,m,y,x,T){En(d,m,y,x,T),x[T+3]=255}function ts(d,m,y,x,T){dl(d,m,y,x,T),x[T+3]=255}function ro(d,m,y){B[d]=function(x,T,M,R,O,U,W,et,dt){for(var G=et+(-2&dt)*y;et!=G;)m(x[T+0],M[R+0],O[U+0],W,et),m(x[T+1],M[R+0],O[U+0],W,et+y),T+=2,++R,++U,et+=2*y;1&dt&&m(x[T+0],M[R+0],O[U+0],W,et)}}function Fu(d,m,y){return y==0?d==0?m==0?6:5:m==0?4:0:y}function y0(d,m,y,x,T){switch(d>>>30){case 3:qh(m,y,x,T,0);break;case 2:ur(m,y,x,T);break;case 1:We(m,y,x,T)}}function cr(d,m){var y,x,T=m.M,M=m.Nb,R=d.oc,O=d.pc+40,U=d.oc,W=d.pc+584,et=d.oc,dt=d.pc+600;for(y=0;16>y;++y)R[O+32*y-1]=129;for(y=0;8>y;++y)U[W+32*y-1]=129,et[dt+32*y-1]=129;for(0<T?R[O-1-32]=U[W-1-32]=et[dt-1-32]=129:(n(R,O-32-1,127,21),n(U,W-32-1,127,9),n(et,dt-32-1,127,9)),x=0;x<d.za;++x){var G=m.ya[m.aa+x];if(0<x){for(y=-1;16>y;++y)i(R,O+32*y-4,R,O+32*y+12,4);for(y=-1;8>y;++y)i(U,W+32*y-4,U,W+32*y+4,4),i(et,dt+32*y-4,et,dt+32*y+4,4)}var nt=d.Gd,ct=d.Hd+x,mt=G.ad,ut=G.Hc;if(0<T&&(i(R,O-32,nt[ct].y,0,16),i(U,W-32,nt[ct].f,0,8),i(et,dt-32,nt[ct].ea,0,8)),G.Za){var vt=R,_t=O-32+16;for(0<T&&(x>=d.za-1?n(vt,_t,nt[ct].y[15],4):i(vt,_t,nt[ct+1].y,0,4)),y=0;4>y;y++)vt[_t+128+y]=vt[_t+256+y]=vt[_t+384+y]=vt[_t+0+y];for(y=0;16>y;++y,ut<<=2)vt=R,_t=O+_y[y],Dr[G.Ob[y]](vt,_t),y0(ut,mt,16*+y,vt,_t)}else if(vt=Fu(x,T,G.Ob[0]),wl[vt](R,O),ut!=0)for(y=0;16>y;++y,ut<<=2)y0(ut,mt,16*+y,R,O+_y[y]);for(y=G.Gc,vt=Fu(x,T,G.Dd),lo[vt](U,W),lo[vt](et,dt),ut=mt,vt=U,_t=W,255&(G=0|y)&&(170&G?pa(ut,256,vt,_t):ni(ut,256,vt,_t)),G=et,ut=dt,255&(y>>=8)&&(170&y?pa(mt,320,G,ut):ni(mt,320,G,ut)),T<d.Ub-1&&(i(nt[ct].y,0,R,O+480,16),i(nt[ct].f,0,U,W+224,8),i(nt[ct].ea,0,et,dt+224,8)),y=8*M*d.B,nt=d.sa,ct=d.ta+16*x+16*M*d.R,mt=d.qa,G=d.ra+8*x+y,ut=d.Ha,vt=d.Ia+8*x+y,y=0;16>y;++y)i(nt,ct+y*d.R,R,O+32*y,16);for(y=0;8>y;++y)i(mt,G+y*d.B,U,W+32*y,8),i(ut,vt+y*d.B,et,dt+32*y,8)}}function jh(d,m,y,x,T,M,R,O,U){var W=[0],et=[0],dt=0,G=U!=null?U.kd:0,nt=U??new St;if(d==null||12>y)return 7;nt.data=d,nt.w=m,nt.ha=y,m=[m],y=[y],nt.gb=[nt.gb];t:{var ct=m,mt=y,ut=nt.gb;if(t(d!=null),t(mt!=null),t(ut!=null),ut[0]=0,12<=mt[0]&&!e(d,ct[0],"RIFF")){if(e(d,ct[0]+8,"WEBP")){ut=3;break t}var vt=Xt(d,ct[0]+4);if(12>vt||4294967286<vt){ut=3;break t}if(G&&vt>mt[0]-8){ut=7;break t}ut[0]=vt,ct[0]+=12,mt[0]-=12}ut=0}if(ut!=0)return ut;for(vt=0<nt.gb[0],y=y[0];;){t:{var _t=d;mt=m,ut=y;var kt=W,xt=et,$t=ct=[0];if((Ht=dt=[dt])[0]=0,8>ut[0])ut=7;else{if(!e(_t,mt[0],"VP8X")){if(Xt(_t,mt[0]+4)!=10){ut=3;break t}if(18>ut[0]){ut=7;break t}var Ot=Xt(_t,mt[0]+8),ye=1+It(_t,mt[0]+12);if(2147483648<=ye*(_t=1+It(_t,mt[0]+15))){ut=3;break t}$t!=null&&($t[0]=Ot),kt!=null&&(kt[0]=ye),xt!=null&&(xt[0]=_t),mt[0]+=18,ut[0]-=18,Ht[0]=1}ut=0}}if(dt=dt[0],ct=ct[0],ut!=0)return ut;if(mt=!!(2&ct),!vt&&dt)return 3;if(M!=null&&(M[0]=!!(16&ct)),R!=null&&(R[0]=mt),O!=null&&(O[0]=0),R=W[0],ct=et[0],dt&&mt&&U==null){ut=0;break}if(4>y){ut=7;break}if(vt&&dt||!vt&&!dt&&!e(d,m[0],"ALPH")){y=[y],nt.na=[nt.na],nt.P=[nt.P],nt.Sa=[nt.Sa];t:{Ot=d,ut=m,vt=y;var Ht=nt.gb;kt=nt.na,xt=nt.P,$t=nt.Sa,ye=22,t(Ot!=null),t(vt!=null),_t=ut[0];var Fe=vt[0];for(t(kt!=null),t($t!=null),kt[0]=null,xt[0]=null,$t[0]=0;;){if(ut[0]=_t,vt[0]=Fe,8>Fe){ut=7;break t}var on=Xt(Ot,_t+4);if(4294967286<on){ut=3;break t}var we=8+on+1&-2;if(ye+=we,0<Ht&&ye>Ht){ut=3;break t}if(!e(Ot,_t,"VP8 ")||!e(Ot,_t,"VP8L")){ut=0;break t}if(Fe[0]<we){ut=7;break t}e(Ot,_t,"ALPH")||(kt[0]=Ot,xt[0]=_t+8,$t[0]=on),_t+=we,Fe-=we}}if(y=y[0],nt.na=nt.na[0],nt.P=nt.P[0],nt.Sa=nt.Sa[0],ut!=0)break}y=[y],nt.Ja=[nt.Ja],nt.xa=[nt.xa];t:if(Ht=d,ut=m,vt=y,kt=nt.gb[0],xt=nt.Ja,$t=nt.xa,Ot=ut[0],_t=!e(Ht,Ot,"VP8 "),ye=!e(Ht,Ot,"VP8L"),t(Ht!=null),t(vt!=null),t(xt!=null),t($t!=null),8>vt[0])ut=7;else{if(_t||ye){if(Ht=Xt(Ht,Ot+4),12<=kt&&Ht>kt-12){ut=3;break t}if(G&&Ht>vt[0]-8){ut=7;break t}xt[0]=Ht,ut[0]+=8,vt[0]-=8,$t[0]=ye}else $t[0]=5<=vt[0]&&Ht[Ot+0]==47&&!(Ht[Ot+4]>>5),xt[0]=vt[0];ut=0}if(y=y[0],nt.Ja=nt.Ja[0],nt.xa=nt.xa[0],m=m[0],ut!=0)break;if(4294967286<nt.Ja)return 3;if(O==null||mt||(O[0]=nt.xa?2:1),R=[R],ct=[ct],nt.xa){if(5>y){ut=7;break}O=R,G=ct,mt=M,d==null||5>y?d=0:5<=y&&d[m+0]==47&&!(d[m+4]>>5)?(vt=[0],Ht=[0],kt=[0],ft(xt=new z,d,m,y),Ya(xt,vt,Ht,kt)?(O!=null&&(O[0]=vt[0]),G!=null&&(G[0]=Ht[0]),mt!=null&&(mt[0]=kt[0]),d=1):d=0):d=0}else{if(10>y){ut=7;break}O=ct,d==null||10>y||!l0(d,m+3,y-3)?d=0:(G=d[m+0]|d[m+1]<<8|d[m+2]<<16,mt=16383&(d[m+7]<<8|d[m+6]),d=16383&(d[m+9]<<8|d[m+8]),1&G||3<(G>>1&7)||!(G>>4&1)||G>>5>=nt.Ja||!mt||!d?d=0:(R&&(R[0]=mt),O&&(O[0]=d),d=1))}if(!d||(R=R[0],ct=ct[0],dt&&(W[0]!=R||et[0]!=ct)))return 3;U!=null&&(U[0]=nt,U.offset=m-U.w,t(4294967286>m-U.w),t(U.offset==U.ha-y));break}return ut==0||ut==7&&dt&&U==null?(M!=null&&(M[0]|=nt.na!=null&&0<nt.na.length),x!=null&&(x[0]=R),T!=null&&(T[0]=ct),0):ut}function Zf(d,m,y){var x=m.width,T=m.height,M=0,R=0,O=x,U=T;if(m.Da=d!=null&&0<d.Da,m.Da&&(O=d.cd,U=d.bd,M=d.v,R=d.j,11>y||(M&=-2,R&=-2),0>M||0>R||0>=O||0>=U||M+O>x||R+U>T))return 0;if(m.v=M,m.j=R,m.va=M+O,m.o=R+U,m.U=O,m.T=U,m.da=d!=null&&0<d.da,m.da){if(!Qt(O,U,y=[d.ib],M=[d.hb]))return 0;m.ib=y[0],m.hb=M[0]}return m.ob=d!=null&&d.ob,m.Kb=d==null||!d.Sd,m.da&&(m.ob=m.ib<3*x/4&&m.hb<3*T/4,m.Kb=0),1}function Qf(d){if(d==null)return 2;if(11>d.S){var m=d.f.RGBA;m.fb+=(d.height-1)*m.A,m.A=-m.A}else m=d.f.kb,d=d.height,m.O+=(d-1)*m.fa,m.fa=-m.fa,m.N+=(d-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(d-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(d-1)*m.lb,m.lb=-m.lb);return 0}function fl(d,m,y,x){if(x==null||0>=d||0>=m)return 2;if(y!=null){if(y.Da){var T=y.cd,M=y.bd,R=-2&y.v,O=-2&y.j;if(0>R||0>O||0>=T||0>=M||R+T>d||O+M>m)return 2;d=T,m=M}if(y.da){if(!Qt(d,m,T=[y.ib],M=[y.hb]))return 2;d=T[0],m=M[0]}}x.width=d,x.height=m;t:{var U=x.width,W=x.height;if(d=x.S,0>=U||0>=W||!(d>=S0&&13>d))d=2;else{if(0>=x.Rd&&x.sd==null){R=M=T=m=0;var et=(O=U*Sy[d])*W;if(11>d||(M=(W+1)/2*(m=(U+1)/2),d==12&&(R=(T=U)*W)),(W=s(et+2*M+R))==null){d=1;break t}x.sd=W,11>d?((U=x.f.RGBA).eb=W,U.fb=0,U.A=O,U.size=et):((U=x.f.kb).y=W,U.O=0,U.fa=O,U.Fd=et,U.f=W,U.N=0+et,U.Ab=m,U.Cd=M,U.ea=W,U.W=0+et+M,U.Db=m,U.Ed=M,d==12&&(U.F=W,U.J=0+et+2*M),U.Tc=R,U.lb=T)}if(m=1,T=x.S,M=x.width,R=x.height,T>=S0&&13>T)if(11>T)d=x.f.RGBA,m&=(O=Math.abs(d.A))*(R-1)+M<=d.size,m&=O>=M*Sy[T],m&=d.eb!=null;else{d=x.f.kb,O=(M+1)/2,et=(R+1)/2,U=Math.abs(d.fa),W=Math.abs(d.Ab);var dt=Math.abs(d.Db),G=Math.abs(d.lb),nt=G*(R-1)+M;m&=U*(R-1)+M<=d.Fd,m&=W*(et-1)+O<=d.Cd,m=(m&=dt*(et-1)+O<=d.Ed)&U>=M&W>=O&dt>=O,m&=d.y!=null,m&=d.f!=null,m&=d.ea!=null,T==12&&(m&=G>=M,m&=nt<=d.Tc,m&=d.F!=null)}else m=0;d=m?0:2}}return d!=0||y!=null&&y.fd&&(d=Qf(x)),d}var Uh=64,xs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Cs=24,pl=32,ao=8,gl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];jt("Predictor0","PredictorAdd0"),B.Predictor0=function(){return 4278190080},B.Predictor1=function(d){return d},B.Predictor2=function(d,m,y){return m[y+0]},B.Predictor3=function(d,m,y){return m[y+1]},B.Predictor4=function(d,m,y){return m[y-1]},B.Predictor5=function(d,m,y){return Kt(Kt(d,m[y+1]),m[y+0])},B.Predictor6=function(d,m,y){return Kt(d,m[y-1])},B.Predictor7=function(d,m,y){return Kt(d,m[y+0])},B.Predictor8=function(d,m,y){return Kt(m[y-1],m[y+0])},B.Predictor9=function(d,m,y){return Kt(m[y+0],m[y+1])},B.Predictor10=function(d,m,y){return Kt(Kt(d,m[y-1]),Kt(m[y+0],m[y+1]))},B.Predictor11=function(d,m,y){var x=m[y+0];return 0>=de(x>>24&255,d>>24&255,(m=m[y-1])>>24&255)+de(x>>16&255,d>>16&255,m>>16&255)+de(x>>8&255,d>>8&255,m>>8&255)+de(255&x,255&d,255&m)?x:d},B.Predictor12=function(d,m,y){var x=m[y+0];return(qe((d>>24&255)+(x>>24&255)-((m=m[y-1])>>24&255))<<24|qe((d>>16&255)+(x>>16&255)-(m>>16&255))<<16|qe((d>>8&255)+(x>>8&255)-(m>>8&255))<<8|qe((255&d)+(255&x)-(255&m)))>>>0},B.Predictor13=function(d,m,y){var x=m[y-1];return(ke((d=Kt(d,m[y+0]))>>24&255,x>>24&255)<<24|ke(d>>16&255,x>>16&255)<<16|ke(d>>8&255,x>>8&255)<<8|ke(255&d,255&x))>>>0};var tp=B.PredictorAdd0;B.PredictorAdd1=Ie,jt("Predictor2","PredictorAdd2"),jt("Predictor3","PredictorAdd3"),jt("Predictor4","PredictorAdd4"),jt("Predictor5","PredictorAdd5"),jt("Predictor6","PredictorAdd6"),jt("Predictor7","PredictorAdd7"),jt("Predictor8","PredictorAdd8"),jt("Predictor9","PredictorAdd9"),jt("Predictor10","PredictorAdd10"),jt("Predictor11","PredictorAdd11"),jt("Predictor12","PredictorAdd12"),jt("Predictor13","PredictorAdd13");var Mu=B.PredictorAdd2;Yt("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Yt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var Ui,w0=B.ColorIndexInverseTransform,da=B.MapARGB,fa=B.VP8LColorIndexInverseTransformAlpha,ep=B.MapAlpha,ip=B.VP8LPredictorsAdd=[];ip.length=16,(B.VP8LPredictors=[]).length=16,(B.VP8LPredictorsAdd_C=[]).length=16,(B.VP8LPredictors_C=[]).length=16;var np,sp,ml,bl,vl,Hh,yl,qh,ur,pa,We,ni,Hi,an,oo,rp,Ru,A0,Zv,Qv,ty,ey,iy,ny,ap,sy,ry,ay,oy=s(511),ly=s(2041),hy=s(225),cy=s(767),uy=0,V2=ly,_0=hy,Ls=cy,dr=oy,S0=0,x0=1,dy=2,C0=3,L0=4,$2=5,fy=6,X2=7,Y2=8,E0=9,K2=10,nx=[2,3,7],sx=[3,3,11],py=[280,256,256,256,40],rx=[0,1,1,1,0],ax=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ox=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],lx=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hx=8,J2=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Z2=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],op=null,cx=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ux=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gy=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],dx=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],fx=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],px=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],gx=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],wl=[],Dr=[],lo=[],mx=1,my=2,Al=[],fr=[];so("UpsampleRgbLinePair",dl,3),so("UpsampleBgrLinePair",En,3),so("UpsampleRgbaLinePair",ts,4),so("UpsampleBgraLinePair",Jf,4),so("UpsampleArgbLinePair",Kf,4),so("UpsampleRgba4444LinePair",Bh,2),so("UpsampleRgb565LinePair",Oh,2);var bx=B.UpsampleRgbLinePair,vx=B.UpsampleBgrLinePair,by=B.UpsampleRgbaLinePair,vy=B.UpsampleBgraLinePair,yy=B.UpsampleArgbLinePair,wy=B.UpsampleRgba4444LinePair,yx=B.UpsampleRgb565LinePair,k0=16,P0=1<<k0-1,lp=-227,Q2=482,wx=6,Ay=0,Ax=s(256),_x=s(256),Sx=s(256),xx=s(256),Cx=s(Q2-lp),Lx=s(Q2-lp);ro("YuvToRgbRow",dl,3),ro("YuvToBgrRow",En,3),ro("YuvToRgbaRow",ts,4),ro("YuvToBgraRow",Jf,4),ro("YuvToArgbRow",Kf,4),ro("YuvToRgba4444Row",Bh,2),ro("YuvToRgb565Row",Oh,2);var _y=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],N0=[0,2,8],Ex=[8,7,6,4,4,2,2,2,1,1,1,1],kx=1;this.WebPDecodeRGBA=function(d,m,y,x,T){var M=x0,R=new wt,O=new Le;R.ba=O,O.S=M,O.width=[O.width],O.height=[O.height];var U=O.width,W=O.height,et=new ie;if(et==null||d==null)var dt=2;else t(et!=null),dt=jh(d,m,y,et.width,et.height,et.Pd,et.Qd,et.format,null);if(dt!=0?U=0:(U!=null&&(U[0]=et.width[0]),W!=null&&(W[0]=et.height[0]),U=1),U){O.width=O.width[0],O.height=O.height[0],x!=null&&(x[0]=O.width),T!=null&&(T[0]=O.height);t:{if(x=new Eu,(T=new St).data=d,T.w=m,T.ha=y,T.kd=1,m=[0],t(T!=null),((d=jh(T.data,T.w,T.ha,null,null,null,m,null,T))==0||d==7)&&m[0]&&(d=4),(m=d)==0){if(t(R!=null),x.data=T.data,x.w=T.w+T.offset,x.ha=T.ha-T.offset,x.put=ne,x.ac=aa,x.bc=Xa,x.ma=R,T.xa){if((d=kh())==null){R=1;break t}if((function(G,nt){var ct=[0],mt=[0],ut=[0];e:for(;;){if(G==null)return 0;if(nt==null)return G.a=2,0;if(G.l=nt,G.a=0,ft(G.m,nt.data,nt.w,nt.ha),!Ya(G.m,ct,mt,ut)){G.a=3;break e}if(G.xb=my,nt.width=ct[0],nt.height=mt[0],!la(ct[0],mt[0],1,G,null))break e;return 1}return t(G.a!=0),0})(d,x)){if(x=(m=fl(x.width,x.height,R.Oa,R.ba))==0){e:{x=d;i:for(;;){if(x==null){x=0;break e}if(t(x.s.yc!=null),t(x.s.Ya!=null),t(0<x.s.Wb),t((y=x.l)!=null),t((T=y.ma)!=null),x.xb!=0){if(x.ca=T.ba,x.tb=T.tb,t(x.ca!=null),!Zf(T.Oa,y,C0)){x.a=2;break i}if(!Ph(x,y.width)||y.da)break i;if((y.da||se(x.ca.S))&&Rr(),11>x.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),x.ca.f.kb.F!=null&&Rr()),x.Pb&&0<x.s.ua&&x.s.vb.X==null&&!q(x.s.vb,x.s.Wa.Xa)){x.a=1;break i}x.xb=0}if(!Fr(x,x.V,x.Ba,x.c,x.i,y.o,cl))break i;T.Dc=x.Ma,x=1;break e}t(x.a!=0),x=0}x=!x}x&&(m=d.a)}else m=d.a}else{if((d=new T2)==null){R=1;break t}if(d.Fa=T.na,d.P=T.P,d.qc=T.Sa,ca(d,x)){if((m=fl(x.width,x.height,R.Oa,R.ba))==0){if(d.Aa=0,y=R.Oa,t((T=d)!=null),y!=null){if(0<(U=0>(U=y.Md)?0:100<U?255:255*U/100)){for(W=et=0;4>W;++W)12>(dt=T.pb[W]).lc&&(dt.ia=U*Ex[0>dt.lc?0:dt.lc]>>3),et|=dt.ia;et&&(alert("todo:VP8InitRandom"),T.ia=1)}T.Ga=y.Id,100<T.Ga?T.Ga=100:0>T.Ga&&(T.Ga=0)}(function(G,nt){if(G==null)return 0;if(nt==null)return Ki(G,2,"NULL VP8Io parameter in VP8Decode().");if(!G.cb&&!ca(G,nt))return 0;if(t(G.cb),nt.ac==null||nt.ac(nt)){nt.ob&&(G.L=0);var ct=N0[G.L];if(G.L==2?(G.yb=0,G.zb=0):(G.yb=nt.v-ct>>4,G.zb=nt.j-ct>>4,0>G.yb&&(G.yb=0),0>G.zb&&(G.zb=0)),G.Va=nt.o+15+ct>>4,G.Hb=nt.va+15+ct>>4,G.Hb>G.za&&(G.Hb=G.za),G.Va>G.Ub&&(G.Va=G.Ub),0<G.L){var mt=G.ed;for(ct=0;4>ct;++ct){var ut;if(G.Qa.Cb){var vt=G.Qa.Lb[ct];G.Qa.Fb||(vt+=mt.Tb)}else vt=mt.Tb;for(ut=0;1>=ut;++ut){var _t=G.gd[ct][ut],kt=vt;if(mt.Pc&&(kt+=mt.vd[0],ut&&(kt+=mt.od[0])),0<(kt=0>kt?0:63<kt?63:kt)){var xt=kt;0<mt.wb&&(xt=4<mt.wb?xt>>2:xt>>1)>9-mt.wb&&(xt=9-mt.wb),1>xt&&(xt=1),_t.dd=xt,_t.tc=2*kt+xt,_t.ld=40<=kt?2:15<=kt?1:0}else _t.tc=0;_t.La=ut}}}ct=0}else Ki(G,6,"Frame setup failed"),ct=G.a;if(ct=ct==0){if(ct){G.$c=0,0<G.Aa||(G.Ic=kx);e:{ct=G.Ic,mt=4*(xt=G.za);var $t=32*xt,Ot=xt+1,ye=0<G.L?xt*(0<G.Aa?2:1):0,Ht=(G.Aa==2?2:1)*xt;if((_t=mt+832+(ut=3*(16*ct+N0[G.L])/2*$t)+(vt=G.Fa!=null&&0<G.Fa.length?G.Kc.c*G.Kc.i:0))!=_t)ct=0;else{if(_t>G.Vb){if(G.Vb=0,G.Ec=s(_t),G.Fc=0,G.Ec==null){ct=Ki(G,1,"no memory during frame initialization.");break e}G.Vb=_t}_t=G.Ec,kt=G.Fc,G.Ac=_t,G.Bc=kt,kt+=mt,G.Gd=a($t,a0),G.Hd=0,G.rb=a(Ot+1,jf),G.sb=1,G.wa=ye?a(ye,lr):null,G.Y=0,G.D.Nb=0,G.D.wa=G.wa,G.D.Y=G.Y,0<G.Aa&&(G.D.Y+=xt),t(!0),G.oc=_t,G.pc=kt,kt+=832,G.ya=a(Ht,Uf),G.aa=0,G.D.ya=G.ya,G.D.aa=G.aa,G.Aa==2&&(G.D.aa+=xt),G.R=16*xt,G.B=8*xt,xt=($t=N0[G.L])*G.R,$t=$t/2*G.B,G.sa=_t,G.ta=kt+xt,G.qa=G.sa,G.ra=G.ta+16*ct*G.R+$t,G.Ha=G.qa,G.Ia=G.ra+8*ct*G.B+$t,G.$c=0,kt+=ut,G.mb=vt?_t:null,G.nb=vt?kt:null,t(kt+vt<=G.Fc+G.Vb),h0(G),n(G.Ac,G.Bc,0,mt),ct=1}}if(ct){if(nt.ka=0,nt.y=G.sa,nt.O=G.ta,nt.f=G.qa,nt.N=G.ra,nt.ea=G.Ha,nt.Vd=G.Ia,nt.fa=G.R,nt.Rc=G.B,nt.F=null,nt.J=0,!uy){for(ct=-255;255>=ct;++ct)oy[255+ct]=0>ct?-ct:ct;for(ct=-1020;1020>=ct;++ct)ly[1020+ct]=-128>ct?-128:127<ct?127:ct;for(ct=-112;112>=ct;++ct)hy[112+ct]=-16>ct?-16:15<ct?15:ct;for(ct=-255;510>=ct;++ct)cy[255+ct]=0>ct?0:255<ct?255:ct;uy=1}yl=Pu,qh=F2,pa=ua,We=u0,ni=d0,ur=I2,Hi=b0,an=Mh,oo=N,rp=V,Ru=v0,A0=b,Zv=tt,Qv=ht,ty=Fh,ey=Xf,iy=g0,ny=m0,Dr[0]=H2,Dr[1]=M2,Dr[2]=j2,Dr[3]=U2,Dr[4]=Ja,Dr[5]=q2,Dr[6]=Za,Dr[7]=z2,Dr[8]=zf,Dr[9]=Nu,wl[0]=O2,wl[1]=D2,wl[2]=Hf,wl[3]=f0,wl[4]=Th,wl[5]=qf,wl[6]=B2,lo[0]=G2,lo[1]=R2,lo[2]=Ih,lo[3]=W2,lo[4]=Gf,lo[5]=Wf,lo[6]=p0,ct=1}else ct=0}ct&&(ct=(function(Fe,on){for(Fe.M=0;Fe.M<Fe.Va;++Fe.M){var we,qt=Fe.Jc[Fe.M&Fe.Xb],Pt=Fe.m,qi=Fe;for(we=0;we<qi.za;++we){var pe=Pt,Re=qi,mi=Re.Ac,kn=Re.Bc+4*we,es=Re.zc,Ti=Re.ya[Re.aa+we];if(Re.Qa.Bb?Ti.$b=yt(pe,Re.Pa.jb[0])?2+yt(pe,Re.Pa.jb[2]):yt(pe,Re.Pa.jb[1]):Ti.$b=0,Re.kc&&(Ti.Ad=yt(pe,Re.Bd)),Ti.Za=!yt(pe,145)+0,Ti.Za){var Hn=Ti.Ob,is=0;for(Re=0;4>Re;++Re){var ln,Be=es[0+Re];for(ln=0;4>ln;++ln){Be=fx[mi[kn+ln]][Be];for(var Ve=gy[yt(pe,Be[0])];0<Ve;)Ve=gy[2*Ve+yt(pe,Be[Ve])];Be=-Ve,mi[kn+ln]=Be}i(Hn,is,mi,kn,4),is+=4,es[0+Re]=Be}}else Be=yt(pe,156)?yt(pe,128)?1:3:yt(pe,163)?2:0,Ti.Ob[0]=Be,n(mi,kn,Be,4),n(es,0,Be,4);Ti.Dd=yt(pe,142)?yt(pe,114)?yt(pe,183)?1:3:2:0}if(qi.m.Ka)return Ki(Fe,7,"Premature end-of-partition0 encountered.");for(;Fe.ja<Fe.za;++Fe.ja){if(qi=qt,pe=(Pt=Fe).rb[Pt.sb-1],mi=Pt.rb[Pt.sb+Pt.ja],we=Pt.ya[Pt.aa+Pt.ja],kn=Pt.kc?we.Ad:0)pe.la=mi.la=0,we.Za||(pe.Na=mi.Na=0),we.Hc=0,we.Gc=0,we.ia=0;else{var Ii,$e;if(pe=mi,mi=qi,kn=Pt.Pa.Xc,es=Pt.ya[Pt.aa+Pt.ja],Ti=Pt.pb[es.$b],Re=es.ad,Hn=0,is=Pt.rb[Pt.sb-1],Be=ln=0,n(Re,Hn,0,384),es.Za)var Pn=0,Or=kn[3];else{Ve=s(16);var zi=pe.Na+is.Na;if(zi=op(mi,kn[1],zi,Ti.Eb,0,Ve,0),pe.Na=is.Na=(0<zi)+0,1<zi)yl(Ve,0,Re,Hn);else{var ds=Ve[0]+3>>3;for(Ve=0;256>Ve;Ve+=16)Re[Hn+Ve]=ds}Pn=1,Or=kn[0]}var si=15&pe.la,hn=15&is.la;for(Ve=0;4>Ve;++Ve){var Es=1&hn;for(ds=$e=0;4>ds;++ds)si=si>>1|(Es=(zi=op(mi,Or,zi=Es+(1&si),Ti.Sc,Pn,Re,Hn))>Pn)<<7,$e=$e<<2|(3<zi?3:1<zi?2:Re[Hn+0]!=0),Hn+=16;si>>=4,hn=hn>>1|Es<<7,ln=(ln<<8|$e)>>>0}for(Or=si,Pn=hn>>4,Ii=0;4>Ii;Ii+=2){for($e=0,si=pe.la>>4+Ii,hn=is.la>>4+Ii,Ve=0;2>Ve;++Ve){for(Es=1&hn,ds=0;2>ds;++ds)zi=Es+(1&si),si=si>>1|(Es=0<(zi=op(mi,kn[2],zi,Ti.Qc,0,Re,Hn)))<<3,$e=$e<<2|(3<zi?3:1<zi?2:Re[Hn+0]!=0),Hn+=16;si>>=2,hn=hn>>1|Es<<5}Be|=$e<<4*Ii,Or|=si<<4<<Ii,Pn|=(240&hn)<<Ii}pe.la=Or,is.la=Pn,es.Hc=ln,es.Gc=Be,es.ia=43690&Be?0:Ti.ia,kn=!(ln|Be)}if(0<Pt.L&&(Pt.wa[Pt.Y+Pt.ja]=Pt.gd[we.$b][we.Za],Pt.wa[Pt.Y+Pt.ja].La|=!kn),qi.Ka)return Ki(Fe,7,"Premature end-of-file encountered.")}if(h0(Fe),Pt=on,qi=1,we=(qt=Fe).D,pe=0<qt.L&&qt.M>=qt.zb&&qt.M<=qt.Va,qt.Aa==0)e:{if(we.M=qt.M,we.uc=pe,cr(qt,we),qi=1,we=($e=qt.D).Nb,pe=(Be=N0[qt.L])*qt.R,mi=Be/2*qt.B,Ve=16*we*qt.R,ds=8*we*qt.B,kn=qt.sa,es=qt.ta-pe+Ve,Ti=qt.qa,Re=qt.ra-mi+ds,Hn=qt.Ha,is=qt.Ia-mi+ds,hn=(si=$e.M)==0,ln=si>=qt.Va-1,qt.Aa==2&&cr(qt,$e),$e.uc)for(Es=(zi=qt).D.M,t(zi.D.uc),$e=zi.yb;$e<zi.Hb;++$e){Pn=$e,Or=Es;var ns=(ks=(Nn=zi).D).Nb;Ii=Nn.R;var ks=ks.wa[ks.Y+Pn],Ps=Nn.sa,fs=Nn.ta+16*ns*Ii+16*Pn,Ns=ks.dd,di=ks.tc;if(di!=0)if(t(3<=di),Nn.L==1)0<Pn&&ey(Ps,fs,Ii,di+4),ks.La&&ny(Ps,fs,Ii,di),0<Or&&ty(Ps,fs,Ii,di+4),ks.La&&iy(Ps,fs,Ii,di);else{var Ts=Nn.B,Br=Nn.qa,zh=Nn.ra+8*ns*Ts+8*Pn,ho=Nn.Ha,Nn=Nn.Ia+8*ns*Ts+8*Pn;ns=ks.ld,0<Pn&&(an(Ps,fs,Ii,di+4,Ns,ns),rp(Br,zh,ho,Nn,Ts,di+4,Ns,ns)),ks.La&&(A0(Ps,fs,Ii,di,Ns,ns),Qv(Br,zh,ho,Nn,Ts,di,Ns,ns)),0<Or&&(Hi(Ps,fs,Ii,di+4,Ns,ns),oo(Br,zh,ho,Nn,Ts,di+4,Ns,ns)),ks.La&&(Ru(Ps,fs,Ii,di,Ns,ns),Zv(Br,zh,ho,Nn,Ts,di,Ns,ns))}}if(qt.ia&&alert("todo:DitherRow"),Pt.put!=null){if($e=16*si,si=16*(si+1),hn?(Pt.y=qt.sa,Pt.O=qt.ta+Ve,Pt.f=qt.qa,Pt.N=qt.ra+ds,Pt.ea=qt.Ha,Pt.W=qt.Ia+ds):($e-=Be,Pt.y=kn,Pt.O=es,Pt.f=Ti,Pt.N=Re,Pt.ea=Hn,Pt.W=is),ln||(si-=Be),si>Pt.o&&(si=Pt.o),Pt.F=null,Pt.J=null,qt.Fa!=null&&0<qt.Fa.length&&$e<si&&(Pt.J=ui(qt,Pt,$e,si-$e),Pt.F=qt.mb,Pt.F==null&&Pt.F.length==0)){qi=Ki(qt,3,"Could not decode alpha data.");break e}$e<Pt.j&&(Be=Pt.j-$e,$e=Pt.j,t(!(1&Be)),Pt.O+=qt.R*Be,Pt.N+=qt.B*(Be>>1),Pt.W+=qt.B*(Be>>1),Pt.F!=null&&(Pt.J+=Pt.width*Be)),$e<si&&(Pt.O+=Pt.v,Pt.N+=Pt.v>>1,Pt.W+=Pt.v>>1,Pt.F!=null&&(Pt.J+=Pt.v),Pt.ka=$e-Pt.j,Pt.U=Pt.va-Pt.v,Pt.T=si-$e,qi=Pt.put(Pt))}we+1!=qt.Ic||ln||(i(qt.sa,qt.ta-pe,kn,es+16*qt.R,pe),i(qt.qa,qt.ra-mi,Ti,Re+8*qt.B,mi),i(qt.Ha,qt.Ia-mi,Hn,is+8*qt.B,mi))}if(!qi)return Ki(Fe,6,"Output aborted.")}return 1})(G,nt)),nt.bc!=null&&nt.bc(nt),ct&=1}return ct?(G.cb=0,ct):0})(d,x)||(m=d.a)}}else m=d.a}m==0&&R.Oa!=null&&R.Oa.fd&&(m=Qf(R.ba))}R=m}M=R!=0?null:11>M?O.f.RGBA.eb:O.f.kb.y}else M=null;return M};var Sy=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(B,Z){for(var I="",j=0;j<4;j++)I+=String.fromCharCode(B[Z++]);return I}function u(B,Z){return B[Z+0]|B[Z+1]<<8}function p(B,Z){return(B[Z+0]|B[Z+1]<<8|B[Z+2]<<16)>>>0}function g(B,Z){return(B[Z+0]|B[Z+1]<<8|B[Z+2]<<16|B[Z+3]<<24)>>>0}new h;var f=[0],A=[0],v=[],S=new h,w=r,k=(function(B,Z){var I={},j=0,K=!1,Y=0,ot=0;if(I.frames=[],!(function(F,z){for(var J=0;J<4;J++)if(F[z+J]!="RIFF".charCodeAt(J))return!0;return!1})(B,Z)){for(g(B,Z+=4),Z+=8;Z<B.length;){var rt=c(B,Z),lt=g(B,Z+=4);Z+=4;var st=lt+(1&lt);switch(rt){case"VP8 ":case"VP8L":I.frames[j]===void 0&&(I.frames[j]={}),(At=I.frames[j]).src_off=K?ot:Z-8,At.src_size=Y+lt+8,j++,K&&(K=!1,Y=0,ot=0);break;case"VP8X":(At=I.header={}).feature_flags=B[Z];var ft=Z+4;At.canvas_width=1+p(B,ft),ft+=3,At.canvas_height=1+p(B,ft),ft+=3;break;case"ALPH":K=!0,Y=st+8,ot=Z-8;break;case"ANIM":(At=I.header).bgcolor=g(B,Z),ft=Z+4,At.loop_count=u(B,ft),ft+=2;break;case"ANMF":var Ct,At;(At=I.frames[j]={}).offset_x=2*p(B,Z),Z+=3,At.offset_y=2*p(B,Z),Z+=3,At.width=1+p(B,Z),Z+=3,At.height=1+p(B,Z),Z+=3,At.duration=p(B,Z),Z+=3,Ct=B[Z++],At.dispose=1&Ct,At.blend=Ct>>1&1}rt!="ANMF"&&(Z+=st)}return I}})(w,0);k.response=w,k.rgbaoutput=!0,k.dataurl=!1;var L=k.header?k.header:null,P=k.frames?k.frames:null;if(L){L.loop_counter=L.loop_count,f=[L.canvas_height],A=[L.canvas_width];for(var D=0;D<P.length&&P[D].blend!=0;D++);}var H=P[0],X=S.WebPDecodeRGBA(w,H.src_off,H.src_size,A,f);H.rgba=X,H.imgwidth=A[0],H.imgheight=f[0];for(var $=0;$<A[0]*f[0]*4;$++)v[$]=X[$];return this.width=A,this.height=f,this.data=v,this}(function(r){var t,e,i,n,s,a,o,h,c,u=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new h,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new a,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new a,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,e=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,h=this.internal.Matrix,c=new u}]);var p=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=F;Object.defineProperty(this,"pdf",{get:function(){return z}});var J=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return J},set:function(q){J=!!q}});var Q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Q},set:function(q){Q=!!q}});var it=0;Object.defineProperty(this,"posX",{get:function(){return it},set:function(q){isNaN(q)||(it=q)}});var at=0;Object.defineProperty(this,"posY",{get:function(){return at},set:function(q){isNaN(q)||(at=q)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(q){var Ft;typeof q=="number"?Ft=[q,q,q,q]:((Ft=new Array(4))[0]=q[0],Ft[1]=q.length>=2?q[1]:Ft[0],Ft[2]=q.length>=3?q[2]:Ft[0],Ft[3]=q.length>=4?q[3]:Ft[1]),c.margin=Ft}});var pt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pt},set:function(q){pt=q}});var gt=0;Object.defineProperty(this,"lastBreak",{get:function(){return gt},set:function(q){gt=q}});var yt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return yt},set:function(q){yt=q}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(q){q instanceof u&&(c=q)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(q){c.path=q}});var Lt=[];Object.defineProperty(this,"ctxStack",{get:function(){return Lt},set:function(q){Lt=q}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(q){var Ft;Ft=g(q),this.ctx.fillStyle=Ft.style,this.ctx.isFillTransparent=Ft.a===0,this.ctx.fillOpacity=Ft.a,this.pdf.setFillColor(Ft.r,Ft.g,Ft.b,{a:Ft.a}),this.pdf.setTextColor(Ft.r,Ft.g,Ft.b,{a:Ft.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(q){var Ft=g(q);this.ctx.strokeStyle=Ft.style,this.ctx.isStrokeTransparent=Ft.a===0,this.ctx.strokeOpacity=Ft.a,Ft.a===0?this.pdf.setDrawColor(255,255,255):(Ft.a,this.pdf.setDrawColor(Ft.r,Ft.g,Ft.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(q){["butt","round","square"].indexOf(q)!==-1&&(this.ctx.lineCap=q,this.pdf.setLineCap(q))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(q){isNaN(q)||(this.ctx.lineWidth=q,this.pdf.setLineWidth(q))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(q){["bevel","round","miter"].indexOf(q)!==-1&&(this.ctx.lineJoin=q,this.pdf.setLineJoin(q))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(q){isNaN(q)||(this.ctx.miterLimit=q,this.pdf.setMiterLimit(q))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(q){this.ctx.textBaseline=q}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(q){["right","end","center","left","start"].indexOf(q)!==-1&&(this.ctx.textAlign=q)}});var Tt=null,It=null,Xt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Xt},set:function(q){Tt=null,It=null,Xt=q}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(q){var Ft;if(this.ctx.font=q,(Ft=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(q))!==null){var Se=Ft[1];Ft[2];var Qt=Ft[3],Et=Ft[4];Ft[5];var te=Ft[6],jt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Et)[2];Et=Math.floor(jt==="px"?parseFloat(Et)*this.pdf.internal.scaleFactor:jt==="em"?parseFloat(Et)*this.pdf.getFontSize():parseFloat(Et)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Et);var Zt=(function(Yt){var ji,De,xe=[],Ce=Yt.trim();if(Ce==="")return O5;if(Ce in aA)return[aA[Ce]];for(;Ce!=="";){switch(De=null,ji=(Ce=lA(Ce)).charAt(0)){case'"':case"'":De=JE(Ce.substring(1),ji);break;default:De=ZE(Ce)}if(De===null||(xe.push(De[0]),(Ce=lA(De[1]))!==""&&Ce.charAt(0)!==","))return O5;Ce=Ce.replace(/^,/,"")}return xe})(te);if(this.fontFaces){var Kt=(function(Yt,ji){var De=Yt.getFontList(),xe=JSON.stringify(De);if(Tt===null||It!==xe){var Ce=(function(yi){var Jt=[];return Object.keys(yi).forEach(function(ci){yi[ci].forEach(function(se){var fe=null;switch(se){case"bold":fe={family:ci,weight:"bold"};break;case"italic":fe={family:ci,style:"italic"};break;case"bolditalic":fe={family:ci,weight:"bold",style:"italic"};break;case"":case"normal":fe={family:ci}}fe!==null&&(fe.ref={name:ci,style:se},Jt.push(fe))})}),Jt})(De);Tt=(function(yi){for(var Jt={},ci=0;ci<yi.length;++ci){var se=D5(yi[ci]),fe=se.family,wi=se.stretch,Le=se.style,ie=se.weight;Jt[fe]=Jt[fe]||{},Jt[fe][wi]=Jt[fe][wi]||{},Jt[fe][wi][Le]=Jt[fe][wi][Le]||{},Jt[fe][wi][Le][ie]=se}return Jt})(Ce.concat(ji)),It=xe}return Tt})(this.pdf,this.fontFaces),qe=Zt.map(function(Yt){return{family:Yt,stretch:"normal",weight:Qt,style:Se}}),ke=(function(Yt,ji,De){for(var xe=(De=De||{}).defaultFontFamily||"times",Ce=Object.assign({},KE,De.genericFontFamilies||{}),yi=null,Jt=null,ci=0;ci<ji.length;++ci)if(Ce[(yi=D5(ji[ci])).family]&&(yi.family=Ce[yi.family]),Yt.hasOwnProperty(yi.family)){Jt=Yt[yi.family];break}if(!(Jt=Jt||Yt[xe]))throw new Error("Could not find a font-family for the rule '"+oA(yi)+"' and default family '"+xe+"'.");if(Jt=(function(se,fe){if(fe[se])return fe[se];var wi=Sv[se],Le=wi<=Sv.normal?-1:1,ie=rA(fe,R3,wi,Le);if(!ie)throw new Error("Could not find a matching font-stretch value for "+se);return ie})(yi.stretch,Jt),Jt=(function(se,fe){if(fe[se])return fe[se];for(var wi=M3[se],Le=0;Le<wi.length;++Le)if(fe[wi[Le]])return fe[wi[Le]];throw new Error("Could not find a matching font-style for "+se)})(yi.style,Jt),!(Jt=(function(se,fe){if(fe[se])return fe[se];if(se===400&&fe[500])return fe[500];if(se===500&&fe[400])return fe[400];var wi=YE[se],Le=rA(fe,D3,wi,se<400?-1:1);if(!Le)throw new Error("Could not find a matching font-weight for value "+se);return Le})(yi.weight,Jt)))throw new Error("Failed to resolve a font for the rule '"+oA(yi)+"'.");return Jt})(Kt,qe);this.pdf.setFont(ke.ref.name,ke.ref.style)}else{var de="";(Qt==="bold"||parseInt(Qt,10)>=700||Se==="bold")&&(de="bold"),Se==="italic"&&(de+="italic"),de.length===0&&(de="normal");for(var Ie="",Pe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Wt=0;Wt<Zt.length;Wt++){if(this.pdf.internal.getFont(Zt[Wt],de,{noFallback:!0,disableWarning:!0})!==void 0){Ie=Zt[Wt];break}if(de==="bolditalic"&&this.pdf.internal.getFont(Zt[Wt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ie=Zt[Wt],de="bold";else if(this.pdf.internal.getFont(Zt[Wt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ie=Zt[Wt],de="normal";break}}if(Ie===""){for(var me=0;me<Zt.length;me++)if(Pe[Zt[me]]){Ie=Pe[Zt[me]];break}}Ie=Ie===""?"Times":Ie,this.pdf.setFont(Ie,de)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(q){this.ctx.globalCompositeOperation=q}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(q){this.ctx.globalAlpha=q}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(q){this.ctx.lineDashOffset=q,At.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(q){this.ctx.lineDash=q,At.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(q){this.ctx.ignoreClearRect=!!q}})};p.prototype.setLineDash=function(F){this.lineDash=F},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){P.call(this,"fill",!1)},p.prototype.stroke=function(){P.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(F,z){if(isNaN(F)||isNaN(z))throw oi.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var J=this.ctx.transform.applyToPoint(new a(F,z));this.path.push({type:"mt",x:J.x,y:J.y}),this.ctx.lastPoint=new a(F,z)},p.prototype.closePath=function(){var F=new a(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&Ke(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){F=new a(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(F.x,F.y)},p.prototype.lineTo=function(F,z){if(isNaN(F)||isNaN(z))throw oi.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var J=this.ctx.transform.applyToPoint(new a(F,z));this.path.push({type:"lt",x:J.x,y:J.y}),this.ctx.lastPoint=new a(J.x,J.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),P.call(this,null,!0)},p.prototype.quadraticCurveTo=function(F,z,J,Q){if(isNaN(J)||isNaN(Q)||isNaN(F)||isNaN(z))throw oi.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var it=this.ctx.transform.applyToPoint(new a(J,Q)),at=this.ctx.transform.applyToPoint(new a(F,z));this.path.push({type:"qct",x1:at.x,y1:at.y,x:it.x,y:it.y}),this.ctx.lastPoint=new a(it.x,it.y)},p.prototype.bezierCurveTo=function(F,z,J,Q,it,at){if(isNaN(it)||isNaN(at)||isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q))throw oi.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pt=this.ctx.transform.applyToPoint(new a(it,at)),gt=this.ctx.transform.applyToPoint(new a(F,z)),yt=this.ctx.transform.applyToPoint(new a(J,Q));this.path.push({type:"bct",x1:gt.x,y1:gt.y,x2:yt.x,y2:yt.y,x:pt.x,y:pt.y}),this.ctx.lastPoint=new a(pt.x,pt.y)},p.prototype.arc=function(F,z,J,Q,it,at){if(isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q)||isNaN(it))throw oi.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(at=!!at,!this.ctx.transform.isIdentity){var pt=this.ctx.transform.applyToPoint(new a(F,z));F=pt.x,z=pt.y;var gt=this.ctx.transform.applyToPoint(new a(0,J)),yt=this.ctx.transform.applyToPoint(new a(0,0));J=Math.sqrt(Math.pow(gt.x-yt.x,2)+Math.pow(gt.y-yt.y,2))}Math.abs(it-Q)>=2*Math.PI&&(Q=0,it=2*Math.PI),this.path.push({type:"arc",x:F,y:z,radius:J,startAngle:Q,endAngle:it,counterclockwise:at})},p.prototype.arcTo=function(F,z,J,Q,it){throw new Error("arcTo not implemented.")},p.prototype.rect=function(F,z,J,Q){if(isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q))throw oi.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,z),this.lineTo(F+J,z),this.lineTo(F+J,z+Q),this.lineTo(F,z+Q),this.lineTo(F,z),this.lineTo(F+J,z),this.lineTo(F,z)},p.prototype.fillRect=function(F,z,J,Q){if(isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q))throw oi.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var it={};this.lineCap!=="butt"&&(it.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(it.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,z,J,Q),this.fill(),it.hasOwnProperty("lineCap")&&(this.lineCap=it.lineCap),it.hasOwnProperty("lineJoin")&&(this.lineJoin=it.lineJoin)}},p.prototype.strokeRect=function(F,z,J,Q){if(isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q))throw oi.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");A.call(this)||(this.beginPath(),this.rect(F,z,J,Q),this.stroke())},p.prototype.clearRect=function(F,z,J,Q){if(isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q))throw oi.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,z,J,Q))},p.prototype.save=function(F){F=typeof F!="boolean"||F;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,J=0;J<this.pdf.internal.getNumberOfPages();J++)this.pdf.setPage(J+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var Q=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Q}},p.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,J=0;J<this.pdf.internal.getNumberOfPages();J++)this.pdf.setPage(J+1),this.pdf.internal.out("Q");this.pdf.setPage(z),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(F){var z,J,Q,it;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))z=0,J=0,Q=0,it=0;else{var at=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(at!==null)z=parseInt(at[1]),J=parseInt(at[2]),Q=parseInt(at[3]),it=1;else if((at=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)z=parseInt(at[1]),J=parseInt(at[2]),Q=parseInt(at[3]),it=parseFloat(at[4]);else{if(it=1,typeof F=="string"&&F.charAt(0)!=="#"){var pt=new E3(F);F=pt.ok?pt.toHex():"#000000"}F.length===4?(z=F.substring(1,2),z+=z,J=F.substring(2,3),J+=J,Q=F.substring(3,4),Q+=Q):(z=F.substring(1,3),J=F.substring(3,5),Q=F.substring(5,7)),z=parseInt(z,16),J=parseInt(J,16),Q=parseInt(Q,16)}}return{r:z,g:J,b:Q,a:it,style:F}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},A=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(F,z,J,Q){if(isNaN(z)||isNaN(J)||typeof F!="string")throw oi.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Q=isNaN(Q)?void 0:Q,!f.call(this)){var it=st(this.ctx.transform.rotation),at=this.ctx.transform.scaleX;j.call(this,{text:F,x:z,y:J,scale:at,angle:it,align:this.textAlign,maxWidth:Q})}},p.prototype.strokeText=function(F,z,J,Q){if(isNaN(z)||isNaN(J)||typeof F!="string")throw oi.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!A.call(this)){Q=isNaN(Q)?void 0:Q;var it=st(this.ctx.transform.rotation),at=this.ctx.transform.scaleX;j.call(this,{text:F,x:z,y:J,scale:at,renderingMode:"stroke",angle:it,align:this.textAlign,maxWidth:Q})}},p.prototype.measureText=function(F){if(typeof F!="string")throw oi.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,J=this.pdf.internal.scaleFactor,Q=z.internal.getFontSize(),it=z.getStringUnitWidth(F)*Q/z.internal.scaleFactor;return new function(at){var pt=(at=at||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pt}}),this}({width:it*=Math.round(96*J/72*1e4)/1e4})},p.prototype.scale=function(F,z){if(isNaN(F)||isNaN(z))throw oi.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var J=new h(F,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(J)},p.prototype.rotate=function(F){if(isNaN(F))throw oi.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new h(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},p.prototype.translate=function(F,z){if(isNaN(F)||isNaN(z))throw oi.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var J=new h(1,0,0,1,F,z);this.ctx.transform=this.ctx.transform.multiply(J)},p.prototype.transform=function(F,z,J,Q,it,at){if(isNaN(F)||isNaN(z)||isNaN(J)||isNaN(Q)||isNaN(it)||isNaN(at))throw oi.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pt=new h(F,z,J,Q,it,at);this.ctx.transform=this.ctx.transform.multiply(pt)},p.prototype.setTransform=function(F,z,J,Q,it,at){F=isNaN(F)?1:F,z=isNaN(z)?0:z,J=isNaN(J)?0:J,Q=isNaN(Q)?1:Q,it=isNaN(it)?0:it,at=isNaN(at)?0:at,this.ctx.transform=new h(F,z,J,Q,it,at)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(F,z,J,Q,it,at,pt,gt,yt){var Lt=this.pdf.getImageProperties(F),Tt=1,It=1,Xt=1,q=1;Q!==void 0&&gt!==void 0&&(Xt=gt/Q,q=yt/it,Tt=Lt.width/Q*gt/Q,It=Lt.height/it*yt/it),at===void 0&&(at=z,pt=J,z=0,J=0),Q!==void 0&&gt===void 0&&(gt=Q,yt=it),Q===void 0&&gt===void 0&&(gt=Lt.width,yt=Lt.height);var Ft=this.ctx.transform.decompose(),Se=st(Ft.rotate.shx),Qt=new h,Et=(Qt=(Qt=(Qt=Qt.multiply(Ft.translate)).multiply(Ft.skew)).multiply(Ft.scale)).applyToRectangle(new o(at-z*Xt,pt-J*q,Q*Tt,it*It));if(this.autoPaging){for(var te,jt=S.call(this,Et),Zt=[],Kt=0;Kt<jt.length;Kt+=1)Zt.indexOf(jt[Kt])===-1&&Zt.push(jt[Kt]);L(Zt);for(var qe=Zt[0],ke=Zt[Zt.length-1],de=qe;de<ke+1;de++){this.pdf.setPage(de);var Ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pe=de===1?this.posY+this.margin[0]:this.margin[0],Wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],me=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Yt=de===1?0:Wt+(de-2)*me;if(this.ctx.clip_path.length!==0){var ji=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(te,this.posX+this.margin[3],-Yt+Pe+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=ji}var De=JSON.parse(JSON.stringify(Et));De=k([De],this.posX+this.margin[3],-Yt+Pe+this.ctx.prevPageLastElemOffset)[0];var xe=(de>qe||de<ke)&&v.call(this);xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ie,me,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",De.x,De.y,De.w,De.h,null,null,Se),xe&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",Et.x,Et.y,Et.w,Et.h,null,null,Se)};var S=function(F,z,J){var Q=[];z=z||this.pdf.internal.pageSize.width,J=J||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var it=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":Q.push(Math.floor((F.y+it)/J)+1);break;case"arc":Q.push(Math.floor((F.y+it-F.radius)/J)+1),Q.push(Math.floor((F.y+it+F.radius)/J)+1);break;case"qct":var at=ft(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);Q.push(Math.floor((at.y+it)/J)+1),Q.push(Math.floor((at.y+at.h+it)/J)+1);break;case"bct":var pt=Ct(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);Q.push(Math.floor((pt.y+it)/J)+1),Q.push(Math.floor((pt.y+pt.h+it)/J)+1);break;case"rect":Q.push(Math.floor((F.y+it)/J)+1),Q.push(Math.floor((F.y+F.h+it)/J)+1)}for(var gt=0;gt<Q.length;gt+=1)for(;this.pdf.internal.getNumberOfPages()<Q[gt];)w.call(this);return Q},w=function(){var F=this.fillStyle,z=this.strokeStyle,J=this.font,Q=this.lineCap,it=this.lineWidth,at=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=z,this.font=J,this.lineCap=Q,this.lineWidth=it,this.lineJoin=at},k=function(F,z,J){for(var Q=0;Q<F.length;Q++)switch(F[Q].type){case"bct":F[Q].x2+=z,F[Q].y2+=J;case"qct":F[Q].x1+=z,F[Q].y1+=J;default:F[Q].x+=z,F[Q].y+=J}return F},L=function(F){return F.sort(function(z,J){return z-J})},P=function(F,z){var J=this.fillStyle,Q=this.strokeStyle,it=this.lineCap,at=this.lineWidth,pt=Math.abs(at*this.ctx.transform.scaleX),gt=this.lineJoin;if(this.autoPaging){for(var yt,Lt,Tt=JSON.parse(JSON.stringify(this.path)),It=JSON.parse(JSON.stringify(this.path)),Xt=[],q=0;q<It.length;q++)if(It[q].x!==void 0)for(var Ft=S.call(this,It[q]),Se=0;Se<Ft.length;Se+=1)Xt.indexOf(Ft[Se])===-1&&Xt.push(Ft[Se]);for(var Qt=0;Qt<Xt.length;Qt++)for(;this.pdf.internal.getNumberOfPages()<Xt[Qt];)w.call(this);L(Xt);for(var Et=Xt[0],te=Xt[Xt.length-1],jt=Et;jt<te+1;jt++){this.pdf.setPage(jt),this.fillStyle=J,this.strokeStyle=Q,this.lineCap=it,this.lineWidth=pt,this.lineJoin=gt;var Zt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Kt=jt===1?this.posY+this.margin[0]:this.margin[0],qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ke=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],de=jt===1?0:qe+(jt-2)*ke;if(this.ctx.clip_path.length!==0){var Ie=this.path;yt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(yt,this.posX+this.margin[3],-de+Kt+this.ctx.prevPageLastElemOffset),D.call(this,F,!0),this.path=Ie}if(Lt=JSON.parse(JSON.stringify(Tt)),this.path=k(Lt,this.posX+this.margin[3],-de+Kt+this.ctx.prevPageLastElemOffset),z===!1||jt===0){var Pe=(jt>Et||jt<te)&&v.call(this);Pe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Zt,ke,null).clip().discardPath()),D.call(this,F,z),Pe&&this.pdf.restoreGraphicsState()}this.lineWidth=at}this.path=Tt}else this.lineWidth=pt,D.call(this,F,z),this.lineWidth=at},D=function(F,z){if((F!=="stroke"||z||!A.call(this))&&(F==="stroke"||z||!f.call(this))){for(var J,Q,it=[],at=this.path,pt=0;pt<at.length;pt++){var gt=at[pt];switch(gt.type){case"begin":it.push({begin:!0});break;case"close":it.push({close:!0});break;case"mt":it.push({start:gt,deltas:[],abs:[]});break;case"lt":var yt=it.length;if(at[pt-1]&&!isNaN(at[pt-1].x)&&(J=[gt.x-at[pt-1].x,gt.y-at[pt-1].y],yt>0)){for(;yt>=0;yt--)if(it[yt-1].close!==!0&&it[yt-1].begin!==!0){it[yt-1].deltas.push(J),it[yt-1].abs.push(gt);break}}break;case"bct":J=[gt.x1-at[pt-1].x,gt.y1-at[pt-1].y,gt.x2-at[pt-1].x,gt.y2-at[pt-1].y,gt.x-at[pt-1].x,gt.y-at[pt-1].y],it[it.length-1].deltas.push(J);break;case"qct":var Lt=at[pt-1].x+2/3*(gt.x1-at[pt-1].x),Tt=at[pt-1].y+2/3*(gt.y1-at[pt-1].y),It=gt.x+2/3*(gt.x1-gt.x),Xt=gt.y+2/3*(gt.y1-gt.y),q=gt.x,Ft=gt.y;J=[Lt-at[pt-1].x,Tt-at[pt-1].y,It-at[pt-1].x,Xt-at[pt-1].y,q-at[pt-1].x,Ft-at[pt-1].y],it[it.length-1].deltas.push(J);break;case"arc":it.push({deltas:[],abs:[],arc:!0}),Array.isArray(it[it.length-1].abs)&&it[it.length-1].abs.push(gt)}}Q=z?null:F==="stroke"?"stroke":"fill";for(var Se=!1,Qt=0;Qt<it.length;Qt++)if(it[Qt].arc)for(var Et=it[Qt].abs,te=0;te<Et.length;te++){var jt=Et[te];jt.type==="arc"?$.call(this,jt.x,jt.y,jt.radius,jt.startAngle,jt.endAngle,jt.counterclockwise,void 0,z,!Se):K.call(this,jt.x,jt.y),Se=!0}else if(it[Qt].close===!0)this.pdf.internal.out("h"),Se=!1;else if(it[Qt].begin!==!0){var Zt=it[Qt].start.x,Kt=it[Qt].start.y;Y.call(this,it[Qt].deltas,Zt,Kt),Se=!0}Q&&B.call(this,Q),z&&Z.call(this)}},H=function(F){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,J=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-J;case"top":return F+z-J;case"hanging":return F+z-2*J;case"middle":return F+z/2-J;default:return F}},X=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(z,J){this.colorStops.push([z,J])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var $=function(F,z,J,Q,it,at,pt,gt,yt){for(var Lt=rt.call(this,J,Q,it,at),Tt=0;Tt<Lt.length;Tt++){var It=Lt[Tt];Tt===0&&(yt?I.call(this,It.x1+F,It.y1+z):K.call(this,It.x1+F,It.y1+z)),ot.call(this,F,z,It.x2,It.y2,It.x3,It.y3,It.x4,It.y4)}gt?Z.call(this):B.call(this,pt)},B=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Z=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(F,z){this.pdf.internal.out(e(F)+" "+i(z)+" m")},j=function(F){var z;switch(F.align){case"right":case"end":z="right";break;case"center":z="center";break;default:z="left"}var J,Q,it,at=this.pdf.getTextDimensions(F.text),pt=H.call(this,F.y),gt=X.call(this,pt)-at.h,yt=this.ctx.transform.applyToPoint(new a(F.x,pt));if(this.autoPaging){var Lt=this.ctx.transform.decompose(),Tt=new h;Tt=(Tt=(Tt=Tt.multiply(Lt.translate)).multiply(Lt.skew)).multiply(Lt.scale);for(var It=this.ctx.transform.applyToRectangle(new o(F.x,pt,at.w,at.h)),Xt=Tt.applyToRectangle(new o(F.x,gt,at.w,at.h)),q=S.call(this,Xt),Ft=[],Se=0;Se<q.length;Se+=1)Ft.indexOf(q[Se])===-1&&Ft.push(q[Se]);L(Ft);for(var Qt=Ft[0],Et=Ft[Ft.length-1],te=Qt;te<Et+1;te++){this.pdf.setPage(te);var jt=te===1?this.posY+this.margin[0]:this.margin[0],Zt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Kt=this.pdf.internal.pageSize.height-this.margin[2],qe=Kt-this.margin[0],ke=this.pdf.internal.pageSize.width-this.margin[1],de=ke-this.margin[3],Ie=te===1?0:Zt+(te-2)*qe;if(this.ctx.clip_path.length!==0){var Pe=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(J,this.posX+this.margin[3],-1*Ie+jt),D.call(this,"fill",!0),this.path=Pe}var Wt=k([JSON.parse(JSON.stringify(Xt))],this.posX+this.margin[3],-Ie+jt+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(Q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Q*F.scale),it=this.lineWidth,this.lineWidth=it*F.scale);var me=this.autoPaging!=="text";if(me||Wt.y+Wt.h<=Kt){if(me||Wt.y>=jt&&Wt.x<=ke){var Yt=me?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||ke-Wt.x)[0],ji=k([JSON.parse(JSON.stringify(It))],this.posX+this.margin[3],-Ie+jt+this.ctx.prevPageLastElemOffset)[0],De=me&&(te>Qt||te<Et)&&v.call(this);De&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],de,qe,null).clip().discardPath()),this.pdf.text(Yt,ji.x,ji.y,{angle:F.angle,align:z,renderingMode:F.renderingMode}),De&&this.pdf.restoreGraphicsState()}}else Wt.y<Kt&&(this.ctx.prevPageLastElemOffset+=Kt-Wt.y);F.scale>=.01&&(this.pdf.setFontSize(Q),this.lineWidth=it)}}else F.scale>=.01&&(Q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Q*F.scale),it=this.lineWidth,this.lineWidth=it*F.scale),this.pdf.text(F.text,yt.x+this.posX,yt.y+this.posY,{angle:F.angle,align:z,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(Q),this.lineWidth=it)},K=function(F,z,J,Q){J=J||0,Q=Q||0,this.pdf.internal.out(e(F+J)+" "+i(z+Q)+" l")},Y=function(F,z,J){return this.pdf.lines(F,z,J,null,null)},ot=function(F,z,J,Q,it,at,pt,gt){this.pdf.internal.out([t(n(J+F)),t(s(Q+z)),t(n(it+F)),t(s(at+z)),t(n(pt+F)),t(s(gt+z)),"c"].join(" "))},rt=function(F,z,J,Q){for(var it=2*Math.PI,at=Math.PI/2;z>J;)z-=it;var pt=Math.abs(J-z);pt<it&&Q&&(pt=it-pt);for(var gt=[],yt=Q?-1:1,Lt=z;pt>1e-5;){var Tt=Lt+yt*Math.min(pt,at);gt.push(lt.call(this,F,Lt,Tt)),pt-=Math.abs(Tt-Lt),Lt=Tt}return gt},lt=function(F,z,J){var Q=(J-z)/2,it=F*Math.cos(Q),at=F*Math.sin(Q),pt=it,gt=-at,yt=pt*pt+gt*gt,Lt=yt+pt*it+gt*at,Tt=4/3*(Math.sqrt(2*yt*Lt)-Lt)/(pt*at-gt*it),It=pt-Tt*gt,Xt=gt+Tt*pt,q=It,Ft=-Xt,Se=Q+z,Qt=Math.cos(Se),Et=Math.sin(Se);return{x1:F*Math.cos(z),y1:F*Math.sin(z),x2:It*Qt-Xt*Et,y2:It*Et+Xt*Qt,x3:q*Qt-Ft*Et,y3:q*Et+Ft*Qt,x4:F*Math.cos(J),y4:F*Math.sin(J)}},st=function(F){return 180*F/Math.PI},ft=function(F,z,J,Q,it,at){var pt=F+.5*(J-F),gt=z+.5*(Q-z),yt=it+.5*(J-it),Lt=at+.5*(Q-at),Tt=Math.min(F,it,pt,yt),It=Math.max(F,it,pt,yt),Xt=Math.min(z,at,gt,Lt),q=Math.max(z,at,gt,Lt);return new o(Tt,Xt,It-Tt,q-Xt)},Ct=function(F,z,J,Q,it,at,pt,gt){var yt,Lt,Tt,It,Xt,q,Ft,Se,Qt,Et,te,jt,Zt,Kt,qe=J-F,ke=Q-z,de=it-J,Ie=at-Q,Pe=pt-it,Wt=gt-at;for(Lt=0;Lt<41;Lt++)Qt=(Ft=(Tt=F+(yt=Lt/40)*qe)+yt*((Xt=J+yt*de)-Tt))+yt*(Xt+yt*(it+yt*Pe-Xt)-Ft),Et=(Se=(It=z+yt*ke)+yt*((q=Q+yt*Ie)-It))+yt*(q+yt*(at+yt*Wt-q)-Se),Lt==0?(te=Qt,jt=Et,Zt=Qt,Kt=Et):(te=Math.min(te,Qt),jt=Math.min(jt,Et),Zt=Math.max(Zt,Qt),Kt=Math.max(Kt,Et));return new o(Math.round(te),Math.round(jt),Math.round(Zt-te),Math.round(Kt-jt))},At=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,z,J=(F=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:z}));this.prevLineDash!==J&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=J)}}})(Vt.API),(function(r){var t=function(a){var o,h,c,u,p,g,f,A,v,S;for(h=[],c=0,u=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;u>c;c+=4)(p=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(g=(p=((p=((p=((p=(p-(S=p%85))/85)-(v=p%85))/85)-(A=p%85))/85)-(f=p%85))/85)%85,h.push(g+33,f+33,A+33,v+33,S+33)):h.push(122);return(function(w,k){for(var L=k;L>0;L--)w.pop()})(h,o.length),String.fromCharCode.apply(String,h)+"~>"},e=function(a){var o,h,c,u,p,g=String,f="length",A=255,v="charCodeAt",S="slice",w="replace";for(a[S](-2),a=a[S](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,p=(a+=o="uuuuu"[S](a[f]%5||5))[f];p>u;u+=5)h=52200625*(a[v](u)-33)+614125*(a[v](u+1)-33)+7225*(a[v](u+2)-33)+85*(a[v](u+3)-33)+(a[v](u+4)-33),c.push(A&h>>24,A&h>>16,A&h>>8,A&h);return(function(k,L){for(var P=L;P>0;P--)k.pop()})(c,o[f]),g.fromCharCode.apply(g,c)},i=function(a){return a.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var h="",c=0;c<a.length;c+=2)h+=String.fromCharCode("0x"+(a[c]+a[c+1]));return h},s=function(a){for(var o=new Uint8Array(a.length),h=a.length;h--;)o[h]=a.charCodeAt(h);return(o=mv(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};r.processDataByFilters=function(a,o){var h=0,c=a||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),h=0;h<o.length;h+=1)switch(o[h]){case"ASCII85Decode":case"/ASCII85Decode":c=e(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=i(c),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[h]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}})(Vt.API),(function(r){r.loadFile=function(t,e,i){return(function(n,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(h,c,u){var p=new XMLHttpRequest,g=0,f=function(A){var v=A.length,S=[],w=String.fromCharCode;for(g=0;g<v;g+=1)S.push(w(255&A.charCodeAt(g)));return S.join("")};if(p.open("GET",h,!c),p.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(p.onload=function(){p.status===200?u(f(this.responseText)):u(void 0)}),p.send(null),c&&p.status===200)return f(p.responseText)})(n,s,a)}catch{}return o})(t,e,i)},r.allowFsRead=void 0,r.loadImageFile=r.loadFile})(Vt.API),(function(r){function t(){return(re.html2canvas?Promise.resolve(re.html2canvas):h5(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function e(){return(re.DOMPurify?Promise.resolve(re.DOMPurify):h5(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var i=function(o){var h=Ke(o);return h==="undefined"?"undefined":h==="string"||o instanceof String?"string":h==="number"||o instanceof Number?"number":h==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":h==="object"?"object":"unknown"},n=function(o,h){var c=document.createElement(o);for(var u in h.className&&(c.className=h.className),h.innerHTML&&h.dompurify&&(c.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)c.style[u]=h.style[u];return c},s=function o(h,c){for(var u=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),p=h.firstChild;p;p=p.nextSibling)c!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||u.appendChild(o(p,c));return h.nodeType===1&&(h.nodeName==="CANVAS"?(u.width=h.width,u.height=h.height,u.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(u.value=h.value),u.addEventListener("load",function(){u.scrollTop=h.scrollTop,u.scrollLeft=h.scrollLeft},!0)),u},a=function o(h){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return(u=u.setProgress(1,o,1,[o])).set(h)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,h){return o.__proto__=h||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,h){return this.then(function(){switch(h=h||(function(c){switch(i(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),h){case"string":return this.then(e).then(function(c){return this.set({src:n("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(h){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,h(this.prop.container,c)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(h){var c=this.opt.jsPDF,u=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var f=0;f<u.length;++f){var A=u[f],v=A.src.find(function(S){return S.format==="truetype"});v&&c.addFont(v.url,A.ref.name,A.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,c.context2d.save(!0),h(this.prop.container,g)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,h,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,h):this.outputPdf(o,h)},a.prototype.outputPdf=function(o,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,h)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(i(o)!=="object")return this;var h=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(h)})},a.prototype.get=function(o,h){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return h?h(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(i(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function h(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||Vt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:h(o.inner.width,o.k),height:h(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,h,c,u){return o!=null&&(this.progress.val=o),h!=null&&(this.progress.state=h),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,h,c,u){return this.setProgress(o?this.progress.val+o:null,h||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},a.prototype.then=function(o,h){var c=this;return this.thenCore(o,h,function(u,p){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(g){return c.updateProgress(null,u),g}).then(u,p).then(function(g){return c.updateProgress(1),g})})},a.prototype.thenCore=function(o,h,c){c=c||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),h&&(h=h.bind(u));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:a.convert(Object.assign({},u),Promise.prototype),g=c.call(p,o,h);return a.convert(g,u.__proto__)},a.prototype.thenExternal=function(o,h){return Promise.prototype.then.call(this,o,h)},a.prototype.thenList=function(o){var h=this;return o.forEach(function(c){h=h.thenCore(c)}),h},a.prototype.catch=function(o){o&&(o=o.bind(this));var h=Promise.prototype.catch.call(this,o);return a.convert(h,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Vt.getPageSize=function(o,h,c){if(Ke(o)==="object"){var u=o;o=u.orientation,h=u.unit||h,c=u.format||c}h=h||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var p,g=(""+c).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+h}var A,v=0,S=0;if(f.hasOwnProperty(g))v=f[g][1]/p,S=f[g][0]/p;else try{v=c[1],S=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",S>v&&(A=S,S=v,v=A);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",v>S&&(A=S,S=v,v=A)}return{width:S,height:v,unit:h,k:p,orientation:o}},r.html=function(o,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(D5):null;var c=new a(h);return h.worker?c:c.from(o).doCallback()}})(Vt.API),Vt.API.addJS=function(r){return cA=r,this.internal.events.subscribe("postPutResources",function(){tm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(tm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),hA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+cA+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){tm!==void 0&&hA!==void 0&&this.internal.out("/Names <</JavaScript "+tm+" 0 R>>")}),this},(function(r){var t;r.events.push(["postPutResources",function(){var e=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=e.outline.render().split(/\r\n/),s=0;s<n.length;s++){var a=n[s],o=i.exec(a);if(o!=null){var h=o[1];e.internal.newObjectDeferredBegin(h,!1)}e.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(s=0;s<c;s++){var p=e.internal.newObject();u.push(p);var g=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var f=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<u.length;s++)e.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+f+" 0 R"),e.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(i,n,s){var a={title:n,options:s,children:[]};return i==null&&(i=this.root),i.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(i){i.id=e.internal.newObjectDeferred();for(var n=0;n<i.children.length;n++)this.genIds_r(i.children[n])},e.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},e.outline.renderItems=function(i){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var a=i.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var h=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+h.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var c=0;c<i.children.length;c++)this.renderItems(i.children[c])},e.outline.line=function(i){this.ctx.val+=i+`\r
`},e.outline.makeRef=function(i){return i.id+" 0 R"},e.outline.makeString=function(i){return"("+e.internal.pdfEscape(i)+")"},e.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(i,n){for(var s=0;s<n.children.length;s++)i.count++,this.count_r(i,n.children[s]);return i.count}}])})(Vt.API),(function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(e,i,n,s,a,o){var h,c=this.decode.DCT_DECODE,u=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=a||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,h=(function(p){for(var g,f=256*p.charCodeAt(4)+p.charCodeAt(5),A=p.length,v={width:0,height:0,numcomponents:1},S=4;S<A;S+=2){if(S+=f,t.indexOf(p.charCodeAt(S+1))!==-1){g=256*p.charCodeAt(S+5)+p.charCodeAt(S+6),v={width:256*p.charCodeAt(S+7)+p.charCodeAt(S+8),height:g,numcomponents:p.charCodeAt(S+9)};break}f=256*p.charCodeAt(S+2)+p.charCodeAt(S+3)}return v})(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),h.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:e,width:h.width,height:h.height,colorSpace:o,bitsPerComponent:8,filter:c,index:i,alias:n}}return u}})(Vt.API),Vt.API.processPNG=function(r,t,e,i){if(this.__addimage__.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.__addimage__.isArrayBufferView(r)){var n,s=RE(r,{checkCrc:!0}),a=s.width,o=s.height,h=s.channels,c=s.palette,u=s.depth;n=c&&h===1?(function($){for(var B=$.width,Z=$.height,I=$.data,j=$.palette,K=$.depth,Y=!1,ot=[],rt=[],lt=void 0,st=!1,ft=0,Ct=0;Ct<j.length;Ct++){var At=pw(j[Ct],4),F=At[0],z=At[1],J=At[2],Q=At[3];ot.push(F,z,J),Q!=null&&(Q===0?(ft++,rt.length<1&&rt.push(Ct)):Q<255&&(st=!0))}if(st||ft>1){Y=!0,rt=void 0;var it=B*Z;lt=new Uint8Array(it);for(var at=new DataView(I.buffer),pt=0;pt<it;pt++){var gt=B5(at,pt,K),yt=pw(j[gt],4)[3];lt[pt]=yt}}else ft===0&&(rt=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Y?8:void 0,colorBytes:I,alphaBytes:lt,needSMask:Y,palette:ot,mask:rt}})(s):h===2||h===4?(function($){for(var B=$.data,Z=$.width,I=$.height,j=$.channels,K=$.depth,Y=j===2?"DeviceGray":"DeviceRGB",ot=j-1,rt=Z*I,lt=ot,st=rt*lt,ft=1*rt,Ct=Math.ceil(st*K/8),At=Math.ceil(ft*K/8),F=new Uint8Array(Ct),z=new Uint8Array(At),J=new DataView(B.buffer),Q=new DataView(F.buffer),it=new DataView(z.buffer),at=!1,pt=0;pt<rt;pt++){for(var gt=pt*j,yt=0;yt<lt;yt++)yA(Q,B5(J,gt+yt,K),pt*lt+yt,K);var Lt=B5(J,gt+lt,K);Lt<(1<<K)-1&&(at=!0),yA(it,Lt,1*pt,K)}return{colorSpace:Y,colorsPerPixel:ot,sMaskBitsPerComponent:at?K:void 0,colorBytes:F,alphaBytes:z,needSMask:at}})(s):(function($){var B=$.data,Z=$.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Z,colorsPerPixel:Z==="DeviceGray"?1:3,colorBytes:B instanceof Uint16Array?(function(I){for(var j=I.length,K=new Uint8Array(2*j),Y=new DataView(K.buffer,K.byteOffset,K.byteLength),ot=0;ot<j;ot++)Y.setUint16(2*ot,I[ot],!1);return K})(B):B,needSMask:!1}})(s);var p,g,f,A=n,v=A.colorSpace,S=A.colorsPerPixel,w=A.sMaskBitsPerComponent,k=A.colorBytes,L=A.alphaBytes,P=A.needSMask,D=A.palette,H=A.mask,X=null;return i!==Vt.API.image_compression.NONE&&typeof mv=="function"?(X=(function($){var B;switch($){case Vt.API.image_compression.FAST:B=11;break;case Vt.API.image_compression.MEDIUM:B=13;break;case Vt.API.image_compression.SLOW:B=14;break;default:B=12}return B})(i),p=this.decode.FLATE_DECODE,g="/Predictor ".concat(X," /Colors ").concat(S," /BitsPerComponent ").concat(u," /Columns ").concat(a),r=pA(k,Math.ceil(a*S*u/8),S,u,i),P&&(f=pA(L,Math.ceil(a*w/8),1,w,i))):(p=void 0,g=void 0,r=k,P&&(f=L)),(this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r))&&(r=this.__addimage__.arrayBufferToBinaryString(r)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:e,data:r,index:t,filter:p,decodeParameters:g,transparency:H,palette:D,sMask:f,predictor:X,width:a,height:o,bitsPerComponent:u,sMaskBitsPerComponent:w,colorSpace:v}}},(function(r){r.processGIF89A=function(t,e,i,n){var s=new i6(t),a=s.width,o=s.height,h=[];s.decodeAndBlitFrameRGBA(0,h);var c={data:h,width:a,height:o},u=new j5(100).encode(c,100);return r.processJPEG.call(this,u,e,i,n)},r.processGIF87A=r.processGIF89A})(Vt.API),jr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var e=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:i,blue:e,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},jr.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(e){oi.log("bit decode error:"+e)}},jr.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),e=t%4;for(r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var h=this.palette[s>>7-o&1];this.data[a+4*o]=h.blue,this.data[a+4*o+1]=h.green,this.data[a+4*o+2]=h.red,this.data[a+4*o+3]=255}e!==0&&(this.pos+=4-e)}},jr.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,n=0;n<r;n++){var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+2*n*4,o=s>>4,h=15&s,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*n+1>=this.width)break;c=this.palette[h],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},jr.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*i;if(n<this.palette.length){var a=this.palette[n];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},jr.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,h=(s>>10&t)/t*255|0,c=s>>15?255:0,u=i*this.width*4+4*n;this.data[u]=h,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=c}this.pos+=r}},jr.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,h=(a>>5&e)/e*255|0,c=(a>>11)/t*255|0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=h,this.data[u+2]=o,this.data[u+3]=255}this.pos+=r}},jr.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=s,this.data[a+1]=n,this.data[a+2]=i,this.data[a+3]=255}this.pos+=this.width%4}},jr.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=i,this.data[o+3]=a}},jr.prototype.getData=function(){return this.data},(function(r){r.processBMP=function(t,e,i,n){var s=new jr(t,!1),a=s.width,o=s.height,h={data:s.getData(),width:a,height:o},c=new j5(100).encode(h,100);return r.processJPEG.call(this,c,e,i,n)}})(Vt.API),AA.prototype.getData=function(){return this.data},(function(r){r.processWEBP=function(t,e,i,n){var s=new AA(t),a=s.width,o=s.height,h={data:s.getData(),width:a,height:o},c=new j5(100).encode(h,100);return r.processJPEG.call(this,c,e,i,n)}})(Vt.API),Vt.API.processRGBA=function(r,t,e){for(var i=r.data,n=i.length,s=new Uint8Array(n/4*3),a=new Uint8Array(n/4),o=0,h=0,c=0;c<n;c+=4){var u=i[c],p=i[c+1],g=i[c+2],f=i[c+3];s[o++]=u,s[o++]=p,s[o++]=g,a[h++]=f}var A=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:A,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},Vt.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Uu=Vt.API,em=Uu.getCharWidthsArray=function(r,t){var e,i,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:n.metadata.Unicode.widths,h=o.fof?o.fof:1,c=t.kerning?t.kerning:n.metadata.Unicode.kerning,u=c.fof?c.fof:1,p=t.doKerning!==!1,g=0,f=r.length,A=0,v=o[0]||h,S=[];for(e=0;e<f;e++)i=r.charCodeAt(e),typeof n.metadata.widthOfString=="function"?S.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(i))+a*(1e3/s)||0)/1e3):(g=p&&Ke(c[i])==="object"&&!isNaN(parseInt(c[i][A],10))?c[i][A]/u:0,S.push((o[i]||v)/h+g)),A=i;return S},uA=Uu.getStringUnitWidth=function(r,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),i=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Uu.processArabic&&(r=Uu.processArabic(r)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(r,e,n)/e:em.apply(this,arguments).reduce(function(s,a){return s+a},0)},dA=function(r,t,e,i){for(var n=[],s=0,a=r.length,o=0;s!==a&&o+t[s]<e;)o+=t[s],s++;n.push(r.slice(0,s));var h=s;for(o=0;s!==a;)o+t[s]>i&&(n.push(r.slice(h,s)),o=0,h=s),o+=t[s],s++;return h!==s&&n.push(r.slice(h,s)),n},fA=function(r,t,e){e||(e={});var i,n,s,a,o,h,c,u=[],p=[u],g=e.textIndent||0,f=0,A=0,v=r.split(" "),S=em.apply(this,[" ",e])[0];if(h=e.lineIndent===-1?v[0].length+2:e.lineIndent||0){var w=Array(h).join(" "),k=[];v.map(function(P){(P=P.split(/\s*\n/)).length>1?k=k.concat(P.map(function(D,H){return(H&&D.length?`
`:"")+D})):k.push(P[0])}),v=k,h=uA.apply(this,[w,e])}for(s=0,a=v.length;s<a;s++){var L=0;if(i=v[s],h&&i[0]==`
`&&(i=i.substr(1),L=1),g+f+(A=(n=em.apply(this,[i,e])).reduce(function(P,D){return P+D},0))>t||L){if(A>t){for(o=dA.apply(this,[i,n,t-(g+f),t]),u.push(o.shift()),u=[o.pop()];o.length;)p.push([o.shift()]);A=n.slice(i.length-(u[0]?u[0].length:0)).reduce(function(P,D){return P+D},0)}else u=[i];p.push(u),g=A+h,f=S}else u.push(i),g+=f+A,f=S}return c=h?function(P,D){return(D?w:"")+P.join(" ")}:function(P){return P.join(" ")},p.map(c)},Uu.splitTextToSize=function(r,t,e){var i,n=(e=e||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var p=this.internal.getFont(u.fontName,u.fontStyle),g="Unicode";return p.metadata[g]?{widths:p.metadata[g].widths||{0:1},kerning:p.metadata[g].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);i=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/n;s.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=e.lineIndent;var o,h,c=[];for(o=0,h=i.length;o<h;o++)c=c.concat(fA.apply(this,[i[o],a,s]));return c},(function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="0123456789abcdef",e="klmnopqrstuvwxyz",i={},n={},s=0;s<16;s++)i[e[s]]=t[s],n[t[s]]=e[s];var a=function(g){return"0x"+parseInt(g,10).toString(16)},o=r.__fontmetrics__.compress=function(g){var f,A,v,S,w=["{"];for(var k in g){if(f=g[k],isNaN(parseInt(k,10))?A="'"+k+"'":(k=parseInt(k,10),A=(A=a(k).slice(2)).slice(0,-1)+n[A.slice(-1)]),typeof f=="number")f<0?(v=a(f).slice(3),S="-"):(v=a(f).slice(2),S=""),v=S+v.slice(0,-1)+n[v.slice(-1)];else{if(Ke(f)!=="object")throw new Error("Don't know what to do with value type "+Ke(f)+".");v=o(f)}w.push(A+v)}return w.push("}"),w.join("")},h=r.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,A,v,S,w={},k=1,L=w,P=[],D="",H="",X=g.length-1,$=1;$<X;$+=1)(S=g[$])=="'"?f?(v=f.join(""),f=void 0):f=[]:f?f.push(S):S=="{"?(P.push([L,v]),L={},v=void 0):S=="}"?((A=P.pop())[0][A[1]]=L,v=void 0,L=A[0]):S=="-"?k=-1:v===void 0?i.hasOwnProperty(S)?(D+=i[S],v=parseInt(D,16)*k,k=1,D=""):D+=S:i.hasOwnProperty(S)?(H+=i[S],L[v]=parseInt(H,16)*k,k=1,v=void 0,H=""):H+=S;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},p={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(g){var f=g.font,A=p.Unicode[f.postScriptName];A&&(f.metadata.Unicode={},f.metadata.Unicode.widths=A.widths,f.metadata.Unicode.kerning=A.kerning);var v=u.Unicode[f.postScriptName];v&&(f.metadata.Unicode.encoding=v,f.encoding=v.codePages[0])}])})(Vt.API),(function(r){var t=function(e){for(var i=e.length,n=new Uint8Array(i),s=0;s<i;s++)n[s]=e.charCodeAt(s);return n};r.API.events.push(["addFont",function(e){var i=void 0,n=e.font,s=e.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(i=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Dm(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(n,i)}}])})(Vt),Vt.API.addSvgAsImage=function(r,t,e,i,n,s,a,o){if(isNaN(t)||isNaN(e))throw oi.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(n))throw oi.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=i,h.height=n;var c=h.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,h.width,h.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(re.canvg?Promise.resolve(re.canvg):h5(()=>import("./index.es-Cxktuana.js"),__vite__mapDeps([0,1]))).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g}).then(function(g){return g.fromString(c,r,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(u)}).then(function(){p.addImage(h.toDataURL("image/jpeg",1),t,e,i,n,a,o)})},Vt.API.putTotalPages=function(r){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var n=0;n<this.internal.pages[i].length;n++)this.internal.pages[i][n]=this.internal.pages[i][n].replace(t,e);return this},Vt.API.viewerPreferences=function(r,t){var e;r=r||{},t=t||!1;var i,n,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),h=[],c=0,u=0,p=0;function g(A,v){var S,w=!1;for(S=0;S<A.length;S+=1)A[S]===v&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var f=o.length;for(p=0;p<f;p+=1)e[o[p]].value=e[o[p]].defaultValue,e[o[p]].explicitSet=!1}if(Ke(r)==="object"){for(n in r)if(s=r[n],g(o,n)&&s!==void 0){if(e[n].type==="boolean"&&typeof s=="boolean")e[n].value=s;else if(e[n].type==="name"&&g(e[n].valueSet,s))e[n].value=s;else if(e[n].type==="integer"&&Number.isInteger(s))e[n].value=s;else if(e[n].type==="array"){for(c=0;c<s.length;c+=1)if(i=!0,s[c].length===1&&typeof s[c][0]=="number")h.push(String(s[c]-1));else if(s[c].length>1){for(u=0;u<s[c].length;u+=1)typeof s[c][u]!="number"&&(i=!1);i===!0&&h.push([s[c][0]-1,s[c][1]-1].join(" "))}e[n].value="["+h.join(" ")+"]"}else e[n].value=e[n].defaultValue;e[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var A,v=[];for(A in e)e[A].explicitSet===!0&&(e[A].type==="name"?v.push("/"+A+" /"+e[A].value):v.push("/"+A+" "+e[A].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},(function(r){var t=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(i)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),h=unescape(encodeURIComponent("</x:xmpmeta>")),c=s.length+a.length+o.length+n.length+h.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(n+s+a+o+h),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(i,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}})(Vt.API),(function(r){var t=r.API,e=t.pdfEscape16=function(s,a){for(var o,h=a.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],p=0,g=s.length;p<g;++p){if(o=a.metadata.characterToGlyph(s.charCodeAt(p)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(p),h.indexOf(o)==-1&&(h.push(o),h.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},i=function(s){var a,o,h,c,u,p,g;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,h=[],p=0,g=(o=Object.keys(s).sort(function(f,A){return f-A})).length;p<g;p++)a=o[p],h.length>=100&&(u+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar`,h=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(c=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),h.push("<"+a+"><"+c+">"));return h.length&&(u+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,h=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var p=o.metadata.Unicode.widths,g=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",A=0;A<g.length;A++)f+=String.fromCharCode(g[A]);var v=c();u({data:f,addLength1:!0,objectId:v}),h("endobj");var S=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:S}),h("endobj");var w=c();h("<<"),h("/Type /FontDescriptor"),h("/FontName /"+Ku(o.fontName)),h("/FontFile2 "+v+" 0 R"),h("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),h("/Flags "+o.metadata.flags),h("/StemV "+o.metadata.stemV),h("/ItalicAngle "+o.metadata.italicAngle),h("/Ascent "+o.metadata.ascender),h("/Descent "+o.metadata.decender),h("/CapHeight "+o.metadata.capHeight),h(">>"),h("endobj");var k=c();h("<<"),h("/Type /Font"),h("/BaseFont /"+Ku(o.fontName)),h("/FontDescriptor "+w+" 0 R"),h("/W "+r.API.PDFObject.convert(p)),h("/CIDToGIDMap /Identity"),h("/DW 1000"),h("/Subtype /CIDFontType2"),h("/CIDSystemInfo"),h("<<"),h("/Supplement 0"),h("/Registry (Adobe)"),h("/Ordering ("+o.encoding+")"),h(">>"),h(">>"),h("endobj"),o.objectNumber=c(),h("<<"),h("/Type /Font"),h("/Subtype /Type0"),h("/ToUnicode "+S+" 0 R"),h("/BaseFont /"+Ku(o.fontName)),h("/Encoding /"+o.encoding),h("/DescendantFonts ["+k+" 0 R]"),h(">>"),h("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,h=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var p=o.metadata.rawData,g="",f=0;f<p.length;f++)g+=String.fromCharCode(p[f]);var A=c();u({data:g,addLength1:!0,objectId:A}),h("endobj");var v=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:v}),h("endobj");var S=c();h("<<"),h("/Descent "+o.metadata.decender),h("/CapHeight "+o.metadata.capHeight),h("/StemV "+o.metadata.stemV),h("/Type /FontDescriptor"),h("/FontFile2 "+A+" 0 R"),h("/Flags 96"),h("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),h("/FontName /"+Ku(o.fontName)),h("/ItalicAngle "+o.metadata.italicAngle),h("/Ascent "+o.metadata.ascender),h(">>"),h("endobj"),o.objectNumber=c();for(var w=0;w<o.metadata.hmtx.widths.length;w++)o.metadata.hmtx.widths[w]=parseInt(o.metadata.hmtx.widths[w]*(1e3/o.metadata.head.unitsPerEm));h("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Ku(o.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),h("endobj"),o.isAlreadyPutted=!0}})(s)}]);var n=function(s){var a,o=s.text||"",h=s.x,c=s.y,u=s.options||{},p=s.mutex||{},g=p.pdfEscape,f=p.activeFontKey,A=p.fonts,v=f,S="",w=0,k="",L=A[v].encoding;if(A[v].encoding!=="Identity-H")return{text:o,x:h,y:c,options:u,mutex:p};for(k=o,v=f,Array.isArray(o)&&(k=o[0]),w=0;w<k.length;w+=1)A[v].metadata.hasOwnProperty("cmap")&&(a=A[v].metadata.cmap.unicode.codeMap[k[w].charCodeAt(0)]),a||k[w].charCodeAt(0)<256&&A[v].metadata.hasOwnProperty("Unicode")?S+=k[w]:S+="";var P="";return parseInt(v.slice(1))<14||L==="WinAnsiEncoding"?P=g(S,v).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):L==="Identity-H"&&(P=e(S,A[v])),p.isHex=!0,{text:P,x:h,y:c,options:u,mutex:p}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],h={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([n(Object.assign({},h,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(n(Object.assign({},h,{text:a[c]})).text);s.text=o}else s.text=n(Object.assign({},h,{text:a})).text}])})(Vt),(function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},r.addFileToVFS=function(e,i){return t.call(this),this.internal.vFS[e]=i,this},r.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}})(Vt.API),(function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(i){var n,s,a,o,h,c,u,p=t,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],A={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,L=0;this.__bidiEngine__={};var P=function(I){var j=I.charCodeAt(),K=j>>8,Y=v[K];return Y!==void 0?p[256*Y+(255&j)]:K===252||K===253?"AL":w.test(K)?"L":K===8?"R":"N"},D=function(I){for(var j,K=0;K<I.length;K++){if((j=P(I.charAt(K)))==="L")return!1;if(j==="R")return!0}return!1},H=function(I,j,K,Y){var ot,rt,lt,st,ft=j[Y];switch(ft){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(ft="AN");break;case"AL":k=!0,ft="R";break;case"WS":case"BN":ft="N";break;case"CS":Y<1||Y+1>=j.length||(ot=K[Y-1])!=="EN"&&ot!=="AN"||(rt=j[Y+1])!=="EN"&&rt!=="AN"?ft="N":k&&(rt="AN"),ft=rt===ot?rt:"N";break;case"ES":ft=(ot=Y>0?K[Y-1]:"B")==="EN"&&Y+1<j.length&&j[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&K[Y-1]==="EN"){ft="EN";break}if(k){ft="N";break}for(lt=Y+1,st=j.length;lt<st&&j[lt]==="ET";)lt++;ft=lt<st&&j[lt]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(st=j.length,lt=Y+1;lt<st&&j[lt]==="NSM";)lt++;if(lt<st){var Ct=I[Y],At=Ct>=1425&&Ct<=2303||Ct===64286;if(ot=j[lt],At&&(ot==="R"||ot==="AL")){ft="R";break}}}ft=Y<1||(ot=j[Y-1])==="B"?"N":K[Y-1];break;case"B":k=!1,n=!0,ft=L;break;case"S":s=!0,ft="N"}return ft},X=function(I,j,K){var Y=I.split("");return K&&$(Y,K,{hiLevel:L}),Y.reverse(),j&&j.reverse(),Y.join("")},$=function(I,j,K){var Y,ot,rt,lt,st,ft=-1,Ct=I.length,At=0,F=[],z=L?f:g,J=[];for(k=!1,n=!1,s=!1,ot=0;ot<Ct;ot++)J[ot]=P(I[ot]);for(rt=0;rt<Ct;rt++){if(st=At,F[rt]=H(I,J,F,rt),Y=240&(At=z[st][A[F[rt]]]),At&=15,j[rt]=lt=z[At][5],Y>0)if(Y===16){for(ot=ft;ot<rt;ot++)j[ot]=1;ft=-1}else ft=-1;if(z[At][6])ft===-1&&(ft=rt);else if(ft>-1){for(ot=ft;ot<rt;ot++)j[ot]=lt;ft=-1}J[rt]==="B"&&(j[rt]=0),K.hiLevel|=lt}s&&(function(Q,it,at){for(var pt=0;pt<at;pt++)if(Q[pt]==="S"){it[pt]=L;for(var gt=pt-1;gt>=0&&Q[gt]==="WS";gt--)it[gt]=L}})(J,j,Ct)},B=function(I,j,K,Y,ot){if(!(ot.hiLevel<I)){if(I===1&&L===1&&!n)return j.reverse(),void(K&&K.reverse());for(var rt,lt,st,ft,Ct=j.length,At=0;At<Ct;){if(Y[At]>=I){for(st=At+1;st<Ct&&Y[st]>=I;)st++;for(ft=At,lt=st-1;ft<lt;ft++,lt--)rt=j[ft],j[ft]=j[lt],j[lt]=rt,K&&(rt=K[ft],K[ft]=K[lt],K[lt]=rt);At=st}At++}}},Z=function(I,j,K){var Y=I.split(""),ot={hiLevel:L};return K||(K=[]),$(Y,K,ot),(function(rt,lt,st){if(st.hiLevel!==0&&u)for(var ft,Ct=0;Ct<rt.length;Ct++)lt[Ct]===1&&(ft=S.indexOf(rt[Ct]))>=0&&(rt[Ct]=S[ft+1])})(Y,K,ot),B(2,Y,j,K,ot),B(1,Y,j,K,ot),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(I,j,K){if((function(ot,rt){if(rt)for(var lt=0;lt<ot.length;lt++)rt[lt]=lt;o===void 0&&(o=D(ot)),c===void 0&&(c=D(ot))})(I,j),a||!h||c)if(a&&h&&o^c)L=o?1:0,I=X(I,j,K);else if(!a&&h&&c)L=o?1:0,I=Z(I,j,K),I=X(I,j);else if(!a||o||h||c){if(a&&!h&&o^c)I=X(I,j),o?(L=0,I=Z(I,j,K)):(L=1,I=Z(I,j,K),I=X(I,j));else if(a&&o&&!h&&c)L=1,I=Z(I,j,K),I=X(I,j);else if(!a&&!h&&o^c){var Y=u;o?(L=1,I=Z(I,j,K),L=0,u=!1,I=Z(I,j,K),u=Y):(L=0,I=Z(I,j,K),I=X(I,j),L=1,u=!1,I=Z(I,j,K),u=Y,I=X(I,j))}}else L=0,I=Z(I,j,K);else L=o?1:0,I=Z(I,j,K);return I},this.__bidiEngine__.setOptions=function(I){I&&(a=I.isInputVisual,h=I.isOutputVisual,o=I.isInputRtl,c=I.isOutputRtl,u=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(i){var n=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var a=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,e.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(a=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?a.push([e.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):a.push([e.doBidiReorder(n[o])]);i.text=a}else i.text=e.doBidiReorder(n);e.setOptions({isInputVisual:!0})}])})(Vt),Vt.API.TTFFont=(function(){function r(t){var e;if(this.rawData=t,e=this.contents=new xh(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new b6(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new n6(this.contents),this.head=new r6(this),this.name=new c6(this),this.cmap=new B3(this),this.toUnicode={},this.hhea=new a6(this),this.maxp=new u6(this),this.hmtx=new d6(this),this.post=new l6(this),this.os2=new o6(this),this.loca=new m6(this),this.glyf=new f6(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,e,i,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,h,c;for(c=[],a=0,o=(h=this.bbox).length;a<o;a++)t=h[a],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(i=255&(n=this.post.italic_angle),32768&(e=n>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},r.prototype.widthOfString=function(t,e,i){var n,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)n=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(n))+i*(1e3/e)||0;return a*(e/1e3)},r.prototype.lineHeight=function(t,e){var i;return e==null&&(e=!1),i=e?this.lineGap:0,(this.ascender+i-this.decender)/1e3*t},r})();var ra,xh=(function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)i[e]=String.fromCharCode(this.readByte());return i.join("")},r.prototype.writeString=function(t){var e,i,n;for(n=[],e=0,i=t.length;0<=i?e<i:e>i;e=0<=i?++e:--e)n.push(this.writeByte(t.charCodeAt(e)));return n},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,e,i,n,s,a,o,h;return t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),h=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^i)+4294967296*(255^n)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^h)+1):72057594037927940*t+281474976710656*e+1099511627776*i+4294967296*n+16777216*s+65536*a+256*o+h},r.prototype.writeLongLong=function(t){var e,i;return e=Math.floor(t/4294967296),i=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var e,i;for(e=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)e.push(this.readByte());return e},r.prototype.write=function(t){var e,i,n,s;for(s=[],i=0,n=t.length;i<n;i++)e=t[i],s.push(this.writeByte(e));return s},r})(),n6=(function(){var r;function t(e){var i,n,s;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)i={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[i.tag]=i}return t.prototype.encode=function(e){var i,n,s,a,o,h,c,u,p,g,f,A,v;for(v in f=Object.keys(e).length,h=Math.log(2),p=16*Math.floor(Math.log(f)/h),a=Math.floor(p/h),u=16*f-p,(n=new xh).writeInt(this.scalarType),n.writeShort(f),n.writeShort(p),n.writeShort(a),n.writeShort(u),s=16*f,c=n.pos+s,o=null,A=[],e)for(g=e[v],n.writeString(v),n.writeInt(r(g)),n.writeInt(c),n.writeInt(g.length),A=A.concat(g),v==="head"&&(o=c),c+=g.length;c%4;)A.push(0),c++;return n.write(A),i=2981146554-r(n.data),n.pos=o+8,n.writeUInt32(i),n.data},r=function(e){var i,n,s,a;for(e=j3.call(e);e.length%4;)e.push(0);for(s=new xh(e),n=0,i=0,a=e.length;i<a;i=i+=4)n+=s.readUInt32();return 4294967295&n},t})(),s6={}.hasOwnProperty,Va=function(r,t){for(var e in t)s6.call(t,e)&&(r[e]=t[e]);function i(){this.constructor=r}return i.prototype=t.prototype,r.prototype=new i,r.__super__=t.prototype,r};ra=(function(){function r(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r})();var r6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="head",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},r.prototype.encode=function(t){var e;return(e=new xh).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},r})(),_A=(function(){function r(t,e){var i,n,s,a,o,h,c,u,p,g,f,A,v,S,w,k,L;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(h=0;h<256;++h)this.codeMap[h]=t.readByte();break;case 4:for(f=t.readUInt16(),g=f/2,t.pos+=6,s=(function(){var P,D;for(D=[],h=P=0;0<=g?P<g:P>g;h=0<=g?++P:--P)D.push(t.readUInt16());return D})(),t.pos+=2,v=(function(){var P,D;for(D=[],h=P=0;0<=g?P<g:P>g;h=0<=g?++P:--P)D.push(t.readUInt16());return D})(),c=(function(){var P,D;for(D=[],h=P=0;0<=g?P<g:P>g;h=0<=g?++P:--P)D.push(t.readUInt16());return D})(),u=(function(){var P,D;for(D=[],h=P=0;0<=g?P<g:P>g;h=0<=g?++P:--P)D.push(t.readUInt16());return D})(),n=(this.length-t.pos+this.offset)/2,o=(function(){var P,D;for(D=[],h=P=0;0<=n?P<n:P>n;h=0<=n?++P:--P)D.push(t.readUInt16());return D})(),h=w=0,L=s.length;w<L;h=++w)for(S=s[h],i=k=A=v[h];A<=S?k<=S:k>=S;i=A<=S?++k:--k)u[h]===0?a=i+c[h]:(a=o[u[h]/2+(i-A)-(g-h)]||0)!==0&&(a+=c[h]),this.codeMap[i]=65535&a}t.pos=p}return r.encode=function(t,e){var i,n,s,a,o,h,c,u,p,g,f,A,v,S,w,k,L,P,D,H,X,$,B,Z,I,j,K,Y,ot,rt,lt,st,ft,Ct,At,F,z,J,Q,it,at,pt,gt,yt,Lt,Tt;switch(Y=new xh,a=Object.keys(t).sort(function(It,Xt){return It-Xt}),e){case"macroman":for(v=0,S=(function(){var It=[];for(A=0;A<256;++A)It.push(0);return It})(),k={0:0},s={},ot=0,ft=a.length;ot<ft;ot++)k[gt=t[n=a[ot]]]==null&&(k[gt]=++v),s[n]={old:t[n],new:k[t[n]]},S[n]=k[t[n]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(S),{charMap:s,subtable:Y.data,maxGlyphID:v+1};case"unicode":for(j=[],p=[],L=0,k={},i={},w=c=null,rt=0,Ct=a.length;rt<Ct;rt++)k[D=t[n=a[rt]]]==null&&(k[D]=++L),i[n]={old:D,new:k[D]},o=k[D]-n,w!=null&&o===c||(w&&p.push(w),j.push(n),c=o),w=n;for(w&&p.push(w),p.push(65535),j.push(65535),Z=2*(B=j.length),$=2*Math.pow(Math.log(B)/Math.LN2,2),g=Math.log($/2)/Math.LN2,X=2*B-$,h=[],H=[],f=[],A=lt=0,At=j.length;lt<At;A=++lt){if(I=j[A],u=p[A],I===65535){h.push(0),H.push(0);break}if(I-(K=i[I].new)>=32768)for(h.push(0),H.push(2*(f.length+B-A)),n=st=I;I<=u?st<=u:st>=u;n=I<=u?++st:--st)f.push(i[n].new);else h.push(K-I),H.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*B+2*f.length),Y.writeUInt16(0),Y.writeUInt16(Z),Y.writeUInt16($),Y.writeUInt16(g),Y.writeUInt16(X),at=0,F=p.length;at<F;at++)n=p[at],Y.writeUInt16(n);for(Y.writeUInt16(0),pt=0,z=j.length;pt<z;pt++)n=j[pt],Y.writeUInt16(n);for(yt=0,J=h.length;yt<J;yt++)o=h[yt],Y.writeUInt16(o);for(Lt=0,Q=H.length;Lt<Q;Lt++)P=H[Lt],Y.writeUInt16(P);for(Tt=0,it=f.length;Tt<it;Tt++)v=f[Tt],Y.writeUInt16(v);return{charMap:i,subtable:Y.data,maxGlyphID:L+1}}},r})(),B3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="cmap",r.prototype.parse=function(t){var e,i,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)e=new _A(t,this.offset),this.tables.push(e),e.isUnicode&&this.unicode==null&&(this.unicode=e);return!0},r.encode=function(t,e){var i,n;return e==null&&(e="macroman"),i=_A.encode(t,e),(n=new xh).writeUInt16(0),n.writeUInt16(1),i.table=n.data.concat(i.subtable),i},r})(),a6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="hhea",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},r})(),o6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="OS/2",r.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var e,i;for(i=[],e=0;e<10;++e)i.push(t.readByte());return i})(),this.charRange=(function(){var e,i;for(i=[],e=0;e<4;++e)i.push(t.readInt());return i})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var e,i;for(i=[],e=0;e<2;e=++e)i.push(t.readInt());return i})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},r})(),l6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="post",r.prototype.parse=function(t){var e,i,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)e=t.readByte(),n.push(this.names.push(t.readString(e)));return n;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 262144:return this.map=(function(){var a,o,h;for(h=[],s=a=0,o=this.file.maxp.numGlyphs;0<=o?a<o:a>o;s=0<=o?++a:--a)h.push(t.readUInt32());return h}).call(this)}},r})(),h6=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},c6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="name",r.prototype.parse=function(t){var e,i,n,s,a,o,h,c,u,p,g;for(t.pos=this.offset,t.readShort(),e=t.readShort(),o=t.readShort(),i=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(h={},s=u=0,p=i.length;u<p;s=++u)n=i[s],t.pos=n.offset,c=t.readString(n.length),a=new h6(c,n),h[g=n.nameID]==null&&(h[g]=[]),h[n.nameID].push(a);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},r})(),u6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="maxp",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},r})(),d6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="hmtx",r.prototype.parse=function(t){var e,i,n,s,a,o,h;for(t.pos=this.offset,this.metrics=[],e=0,o=this.file.hhea.numberOfMetrics;0<=o?e<o:e>o;e=0<=o?++e:--e)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,u;for(u=[],e=c=0;0<=n?c<n:c>n;e=0<=n?++c:--c)u.push(t.readInt16());return u})(),this.widths=(function(){var c,u,p,g;for(g=[],c=0,u=(p=this.metrics).length;c<u;c++)s=p[c],g.push(s.advance);return g}).call(this),i=this.widths[this.widths.length-1],h=[],e=a=0;0<=n?a<n:a>n;e=0<=n?++a:--a)h.push(this.widths.push(i));return h},r.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},r})(),j3=[].slice,f6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(t){var e,i,n,s,a,o,h,c,u,p;return t in this.cache?this.cache[t]:(s=this.file.loca,e=this.file.contents,i=s.indexOf(t),(n=s.lengthOf(t))===0?this.cache[t]=null:(e.pos=this.offset+i,a=(o=new xh(e.read(n))).readShort(),c=o.readShort(),p=o.readShort(),h=o.readShort(),u=o.readShort(),this.cache[t]=a===-1?new g6(o,c,p,h,u):new p6(o,a,c,p,h,u),this.cache[t]))},r.prototype.encode=function(t,e,i){var n,s,a,o,h;for(a=[],s=[],o=0,h=e.length;o<h;o++)n=t[e[o]],s.push(a.length),n&&(a=a.concat(n.encode(i)));return s.push(a.length),{table:a,offsets:s}},r})(),p6=(function(){function r(t,e,i,n,s,a){this.raw=t,this.numberOfContours=e,this.xMin=i,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r})(),g6=(function(){function r(t,e,i,n,s){var a,o;for(this.raw=t,this.xMin=e,this.yMin=i,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var t,e,i;for(e=new xh(j3.call(this.raw.data)),t=0,i=this.glyphIDs.length;t<i;++t)e.pos=this.glyphOffsets[t];return e.data},r})(),m6=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Va(r,ra),r.prototype.tag="loca",r.prototype.parse=function(t){var e,i;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=e===0?(function(){var n,s;for(s=[],i=0,n=this.length;i<n;i+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],i=0,n=this.length;i<n;i+=4)s.push(t.readUInt32());return s}).call(this)},r.prototype.indexOf=function(t){return this.offsets[t]},r.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},r.prototype.encode=function(t,e){for(var i=new Uint32Array(this.offsets.length),n=0,s=0,a=0;a<i.length;++a)if(i[a]=n,s<e.length&&e[s]==a){++s,i[a]=n;var o=this.offsets[a],h=this.offsets[a+1]-o;h>0&&(n+=h)}for(var c=new Array(4*i.length),u=0;u<i.length;++u)c[4*u+3]=255&i[u],c[4*u+2]=(65280&i[u])>>8,c[4*u+1]=(16711680&i[u])>>16,c[4*u]=(4278190080&i[u])>>24;return c},r})(),b6=(function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,e,i,n,s;for(e in n=this.font.cmap.tables[0].codeMap,t={},s=this.subset)i=s[e],t[e]=n[i];return t},r.prototype.glyphsFor=function(t){var e,i,n,s,a,o,h;for(n={},a=0,o=t.length;a<o;a++)n[s=t[a]]=this.font.glyf.glyphFor(s);for(s in e=[],n)(i=n[s])!=null&&i.compound&&e.push.apply(e,i.glyphIDs);if(e.length>0)for(s in h=this.glyphsFor(e))i=h[s],n[s]=i;return n},r.prototype.encode=function(t,e){var i,n,s,a,o,h,c,u,p,g,f,A,v,S,w;for(n in i=B3.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),f={0:0},w=i.charMap)f[(h=w[n]).old]=h.new;for(A in g=i.maxGlyphID,a)A in f||(f[A]=g++);return u=(function(k){var L,P;for(L in P={},k)P[k[L]]=L;return P})(f),p=Object.keys(u).sort(function(k,L){return k-L}),v=(function(){var k,L,P;for(P=[],k=0,L=p.length;k<L;k++)o=p[k],P.push(u[o]);return P})(),s=this.font.glyf.encode(a,v,f),c=this.font.loca.encode(s.offsets,v),S={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},r})();Vt.API.PDFObject=(function(){var r;function t(){}return r=function(e,i){return(Array(i+1).join("0")+e).slice(-i)},t.convert=function(e){var i,n,s,a;if(Array.isArray(e))return"["+(function(){var o,h,c;for(c=[],o=0,h=e.length;o<h;o++)i=e[o],c.push(t.convert(i));return c})().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+r(e.getUTCFullYear(),4)+r(e.getUTCMonth(),2)+r(e.getUTCDate(),2)+r(e.getUTCHours(),2)+r(e.getUTCMinutes(),2)+r(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(n in s=["<<"],e)a=e[n],s.push("/"+n+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+e},t})();const Q6=Object.freeze(Object.defineProperty({__proto__:null,AcroFormAppearance:Bt,AcroFormButton:gn,AcroFormCheckBox:Gp,AcroFormChoiceField:fu,AcroFormComboBox:gu,AcroFormEditBox:zp,AcroFormListBox:pu,AcroFormPasswordField:Vp,AcroFormPushButton:Wp,AcroFormRadioButton:mu,AcroFormTextField:Ah,GState:ng,ShadingPattern:Pl,TilingPattern:Jh,default:Vt,jsPDF:Vt},Symbol.toStringTag,{value:"Module"}));function U3(r,t,e,i,n){i=i||{};var s=1.15,a=n.internal.scaleFactor,o=n.internal.getFontSize()/a,h=n.getLineHeightFactor?n.getLineHeightFactor():s,c=o*h,u=/\r\n|\r|\n/g,p="",g=1;if((i.valign==="middle"||i.valign==="bottom"||i.halign==="center"||i.halign==="right")&&(p=typeof r=="string"?r.split(u):r,g=p.length||1),e+=o*(2-s),i.valign==="middle"?e-=g/2*c:i.valign==="bottom"&&(e-=g*c),i.halign==="center"||i.halign==="right"){var f=o;if(i.halign==="center"&&(f*=.5),p&&g>=1){for(var A=0;A<p.length;A++)n.text(p[A],t-n.getStringUnitWidth(p[A])*f,e),e+=c;return n}t-=n.getStringUnitWidth(r)*f}return i.halign==="justify"?n.text(r,t,e,{maxWidth:i.maxWidth||100,align:"justify"}):n.text(r,t,e),n}var SA={},sd=(function(){function r(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return r.setDefaults=function(t,e){e===void 0&&(e=null),e?e.__autoTableDocumentDefaults=t:SA=t},r.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},r.prototype.applyStyles=function(t,e){var i,n,s;e===void 0&&(e=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var a=this.jsPDFDocument.internal.getFont(),o=a.fontStyle,h=a.fontName;if(t.font&&(h=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[h];c&&c.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(h,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!e){var u=r.unifyColor(t.fillColor);u&&(i=this.jsPDFDocument).setFillColor.apply(i,u),u=r.unifyColor(t.textColor),u&&(n=this.jsPDFDocument).setTextColor.apply(n,u),u=r.unifyColor(t.lineColor),u&&(s=this.jsPDFDocument).setDrawColor.apply(s,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},r.prototype.splitTextToSize=function(t,e,i){return this.jsPDFDocument.splitTextToSize(t,e,i)},r.prototype.rect=function(t,e,i,n,s){return this.jsPDFDocument.rect(t,e,i,n,s)},r.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},r.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},r.prototype.getDocument=function(){return this.jsPDFDocument},r.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},r.prototype.addPage=function(){return this.jsPDFDocument.addPage()},r.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},r.prototype.getGlobalOptions=function(){return SA||{}},r.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},r.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},r.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},r.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},r.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},r.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},r})(),xv=function(r,t){return xv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])},xv(r,t)};function H3(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");xv(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var q3=(function(r){H3(t,r);function t(e){var i=r.call(this)||this;return i._element=e,i}return t})(Array);function v6(r){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/r,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function y6(r){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[r]}function Qm(r,t,e){e.applyStyles(t,!0);var i=Array.isArray(r)?r:[r],n=i.map(function(s){return e.getTextWidth(s)}).reduce(function(s,a){return Math.max(s,a)},0);return n}function z3(r,t,e,i){var n=t.settings.tableLineWidth,s=t.settings.tableLineColor;r.applyStyles({lineWidth:n,lineColor:s});var a=W3(n,!1);a&&r.rect(e.x,e.y,t.getWidth(r.pageSize().width),i.y-e.y,a)}function W3(r,t){var e=r>0,i=t||t===0;return e&&i?"DF":e?"S":i?"F":null}function P2(r,t){var e,i,n,s;if(r=r||t,Array.isArray(r)){if(r.length>=4)return{top:r[0],right:r[1],bottom:r[2],left:r[3]};if(r.length===3)return{top:r[0],right:r[1],bottom:r[2],left:r[1]};if(r.length===2)return{top:r[0],right:r[1],bottom:r[0],left:r[1]};r.length===1?r=r[0]:r=t}return typeof r=="object"?(typeof r.vertical=="number"&&(r.top=r.vertical,r.bottom=r.vertical),typeof r.horizontal=="number"&&(r.right=r.horizontal,r.left=r.horizontal),{left:(e=r.left)!==null&&e!==void 0?e:t,top:(i=r.top)!==null&&i!==void 0?i:t,right:(n=r.right)!==null&&n!==void 0?n:t,bottom:(s=r.bottom)!==null&&s!==void 0?s:t}):(typeof r!="number"&&(r=t),{top:r,right:r,bottom:r,left:r})}function G3(r,t){var e=P2(t.settings.margin,0);return r.pageSize().width-(e.left+e.right)}function w6(r,t,e,i,n){var s={},a=1.3333333333333333,o=U5(t,function(L){return n.getComputedStyle(L).backgroundColor});o!=null&&(s.fillColor=o);var h=U5(t,function(L){return n.getComputedStyle(L).color});h!=null&&(s.textColor=h);var c=_6(i,e);c&&(s.cellPadding=c);var u="borderTopColor",p=a*e,g=i.borderTopWidth;if(i.borderBottomWidth===g&&i.borderRightWidth===g&&i.borderLeftWidth===g){var f=(parseFloat(g)||0)/p;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(i.borderTopWidth)||0)/p,right:(parseFloat(i.borderRightWidth)||0)/p,bottom:(parseFloat(i.borderBottomWidth)||0)/p,left:(parseFloat(i.borderLeftWidth)||0)/p},s.lineWidth.top||(s.lineWidth.right?u="borderRightColor":s.lineWidth.bottom?u="borderBottomColor":s.lineWidth.left&&(u="borderLeftColor"));var A=U5(t,function(L){return n.getComputedStyle(L)[u]});A!=null&&(s.lineColor=A);var v=["left","right","center","justify"];v.indexOf(i.textAlign)!==-1&&(s.halign=i.textAlign),v=["middle","bottom","top"],v.indexOf(i.verticalAlign)!==-1&&(s.valign=i.verticalAlign);var S=parseInt(i.fontSize||"");isNaN(S)||(s.fontSize=S/a);var w=A6(i);w&&(s.fontStyle=w);var k=(i.fontFamily||"").toLowerCase();return r.indexOf(k)!==-1&&(s.font=k),s}function A6(r){var t="";return(r.fontWeight==="bold"||r.fontWeight==="bolder"||parseInt(r.fontWeight)>=700)&&(t="bold"),(r.fontStyle==="italic"||r.fontStyle==="oblique")&&(t+="italic"),t}function U5(r,t){var e=V3(r,t);if(!e)return null;var i=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!i||!Array.isArray(i))return null;var n=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],s=parseInt(i[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function V3(r,t){var e=t(r);return e==="rgba(0, 0, 0, 0)"||e==="transparent"||e==="initial"||e==="inherit"?r.parentElement==null?null:V3(r.parentElement,t):e}function _6(r,t){var e=[r.paddingTop,r.paddingRight,r.paddingBottom,r.paddingLeft],i=96/(72/t),n=(parseInt(r.lineHeight)-parseInt(r.fontSize))/t/2,s=e.map(function(o){return parseInt(o||"0")/i}),a=P2(s,0);return n>a.top&&(a.top=n),n>a.bottom&&(a.bottom=n),a}function $3(r,t,e,i,n){var s,a;i===void 0&&(i=!1),n===void 0&&(n=!1);var o;typeof t=="string"?o=e.document.querySelector(t):o=t;var h=Object.keys(r.getFontList()),c=r.scaleFactor(),u=[],p=[],g=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:u,body:p,foot:g};for(var f=0;f<o.rows.length;f++){var A=o.rows[f],v=(a=(s=A==null?void 0:A.parentElement)===null||s===void 0?void 0:s.tagName)===null||a===void 0?void 0:a.toLowerCase(),S=S6(h,c,e,A,i,n);S&&(v==="thead"?u.push(S):v==="tfoot"?g.push(S):p.push(S))}return{head:u,body:p,foot:g}}function S6(r,t,e,i,n,s){for(var a=new q3(i),o=0;o<i.cells.length;o++){var h=i.cells[o],c=e.getComputedStyle(h);if(n||c.display!=="none"){var u=void 0;s&&(u=w6(r,h,t,c,e)),a.push({rowSpan:h.rowSpan,colSpan:h.colSpan,styles:u,_element:h,content:x6(h)})}}var p=e.getComputedStyle(i);if(a.length>0&&(n||p.display!=="none"))return a}function x6(r){var t=r.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join(`
`),t.innerText||t.textContent||""}function C6(r,t,e){for(var i=0,n=[r,t,e];i<n.length;i++){var s=n[i];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function el(r,t,e,i,n){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(r),a=1;a<arguments.length;a++){var o=arguments[a];if(o!=null)for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(s[h]=o[h])}return s}function X3(r,t){var e=new sd(r),i=e.getDocumentOptions(),n=e.getGlobalOptions();C6(n,i,t);var s=el({},n,i,t),a;typeof window<"u"&&(a=window);var o=L6(n,i,t),h=E6(n,i,t),c=k6(e,s),u=N6(e,s,a);return{id:t.tableId,content:u,hooks:h,styles:o,settings:c}}function L6(r,t,e){for(var i={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(h){if(h==="columnStyles"){var c=r[h],u=t[h],p=e[h];i.columnStyles=el({},c,u,p)}else{var g=[r,t,e],f=g.map(function(A){return A[h]||{}});i[h]=el({},f[0],f[1],f[2])}},s=0,a=Object.keys(i);s<a.length;s++){var o=a[s];n(o)}return i}function E6(r,t,e){for(var i=[r,t,e],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,a=i;s<a.length;s++){var o=a[s];o.didParseCell&&n.didParseCell.push(o.didParseCell),o.willDrawCell&&n.willDrawCell.push(o.willDrawCell),o.didDrawCell&&n.didDrawCell.push(o.didDrawCell),o.willDrawPage&&n.willDrawPage.push(o.willDrawPage),o.didDrawPage&&n.didDrawPage.push(o.didDrawPage)}return n}function k6(r,t){var e,i,n,s,a,o,h,c,u,p,g,f,A=P2(t.margin,40/r.scaleFactor()),v=(e=P6(r,t.startY))!==null&&e!==void 0?e:A.top,S;t.showFoot===!0?S="everyPage":t.showFoot===!1?S="never":S=(i=t.showFoot)!==null&&i!==void 0?i:"everyPage";var w;t.showHead===!0?w="everyPage":t.showHead===!1?w="never":w=(n=t.showHead)!==null&&n!==void 0?n:"everyPage";var k=(s=t.useCss)!==null&&s!==void 0?s:!1,L=t.theme||(k?"plain":"striped"),P=!!t.horizontalPageBreak,D=(a=t.horizontalPageBreakRepeat)!==null&&a!==void 0?a:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:k,theme:L,startY:v,margin:A,pageBreak:(h=t.pageBreak)!==null&&h!==void 0?h:"auto",rowPageBreak:(c=t.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:w,showFoot:S,tableLineWidth:(p=t.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(g=t.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:P,horizontalPageBreakRepeat:D,horizontalPageBreakBehaviour:(f=t.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function P6(r,t){var e=r.getLastAutoTable(),i=r.scaleFactor(),n=r.pageNumber(),s=!1;if(e&&e.startPageNumber){var a=e.startPageNumber+e.pageNumber-1;s=a===n}return typeof t=="number"?t:(t==null||t===!1)&&s&&(e==null?void 0:e.finalY)!=null?e.finalY+20/i:null}function N6(r,t,e){var i=t.head||[],n=t.body||[],s=t.foot||[];if(t.html){var a=t.includeHiddenHtml;if(e){var o=$3(r,t.html,e,a,t.useCss)||{};i=o.head||i,n=o.body||i,s=o.foot||i}else console.error("Cannot parse html in non browser environment")}var h=t.columns||T6(i,n,s);return{columns:h,head:i,body:n,foot:s}}function T6(r,t,e){var i=r[0]||t[0]||e[0]||[],n=[];return Object.keys(i).filter(function(s){return s!=="_element"}).forEach(function(s){var a=1,o;Array.isArray(i)?o=i[parseInt(s)]:o=i[s],typeof o=="object"&&!Array.isArray(o)&&(a=(o==null?void 0:o.colSpan)||1);for(var h=0;h<a;h++){var c=void 0;Array.isArray(i)?c=n.length:c=s+(h>0?"_".concat(h):"");var u={dataKey:c};n.push(u)}}),n}var t2=(function(){function r(t,e,i){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=i,this.doc=t.getDocument()}return r})(),Y3=(function(r){H3(t,r);function t(e,i,n,s,a,o){var h=r.call(this,e,i,o)||this;return h.cell=n,h.row=s,h.column=a,h.section=s.section,h}return t})(t2),K3=(function(){function r(t,e){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return r.prototype.getHeadHeight=function(t){return this.head.reduce(function(e,i){return e+i.getMaxCellHeight(t)},0)},r.prototype.getFootHeight=function(t){return this.foot.reduce(function(e,i){return e+i.getMaxCellHeight(t)},0)},r.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},r.prototype.callCellHooks=function(t,e,i,n,s,a){for(var o=0,h=e;o<h.length;o++){var c=h[o],u=new Y3(t,this,i,n,s,a),p=c(u)===!1;if(i.text=Array.isArray(i.text)?i.text:[i.text],p)return!1}return!0},r.prototype.callEndPageHooks=function(t,e){t.applyStyles(t.userStyles);for(var i=0,n=this.hooks.didDrawPage;i<n.length;i++){var s=n[i];s(new t2(t,this,e))}},r.prototype.callWillDrawPageHooks=function(t,e){for(var i=0,n=this.hooks.willDrawPage;i<n.length;i++){var s=n[i];s(new t2(t,this,e))}},r.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var e=this.columns.reduce(function(n,s){return n+s.wrappedWidth},0);return e}else{var i=this.settings.margin;return t-i.left-i.right}},r})(),Wv=(function(){function r(t,e,i,n,s){s===void 0&&(s=!1),this.height=0,this.raw=t,t instanceof q3&&(this.raw=t._element,this.element=t._element),this.index=e,this.section=i,this.cells=n,this.spansMultiplePages=s}return r.prototype.getMaxCellHeight=function(t){var e=this;return t.reduce(function(i,n){var s;return Math.max(i,((s=e.cells[n.index])===null||s===void 0?void 0:s.height)||0)},0)},r.prototype.hasRowSpan=function(t){var e=this;return t.filter(function(i){var n=e.cells[i.index];return n?n.rowSpan>1:!1}).length>0},r.prototype.canEntireRowFit=function(t,e){return this.getMaxCellHeight(e)<=t},r.prototype.getMinimumRowHeight=function(t,e){var i=this;return t.reduce(function(n,s){var a=i.cells[s.index];if(!a)return 0;var o=e.getLineHeight(a.styles.fontSize),h=a.padding("vertical"),c=h+o;return c>n?c:n},0)},r})(),Gv=(function(){function r(t,e,i){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=i,this.raw=t;var s=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,s=(n=t.content)!==null&&n!==void 0?n:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var a=s!=null?""+s:"",o=/\r\n|\r|\n/g;this.text=a.split(o)}return r.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var e=this.height-this.padding("vertical");t=this.y+e/2+this.padding("top")}var i;if(this.styles.halign==="right")i=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");i=this.x+n/2+this.padding("left")}else i=this.x+this.padding("left");return{x:i,y:t}},r.prototype.getContentHeight=function(t,e){e===void 0&&(e=1.15);var i=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/t*e,s=i*n+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},r.prototype.padding=function(t){var e=P2(this.styles.cellPadding,0);return t==="vertical"?e.top+e.bottom:t==="horizontal"?e.left+e.right:e[t]},r})(),J3=(function(){function r(t,e,i){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=e,this.index=i}return r.prototype.getMaxCustomCellWidth=function(t){for(var e=0,i=0,n=t.allRows();i<n.length;i++){var s=n[i],a=s.cells[this.index];a&&typeof a.styles.cellWidth=="number"&&(e=Math.max(e,a.styles.cellWidth))}return e},r})();function I6(r,t){F6(r,t);var e=[],i=0;t.columns.forEach(function(s){var a=s.getMaxCustomCellWidth(t);a?s.width=a:(s.width=s.wrappedWidth,e.push(s)),i+=s.width});var n=t.getWidth(r.pageSize().width)-i;n&&(n=Cv(e,n,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),n&&(n=Cv(e,n,function(s){return s.minWidth})),n=Math.abs(n),!t.settings.horizontalPageBreak&&n>.1/r.scaleFactor()&&(n=n<1?n:Math.round(n),console.log("Of the table content, ".concat(n," units width could not fit page"))),R6(t),D6(t,r),M6(t)}function F6(r,t){var e=r.scaleFactor(),i=t.settings.horizontalPageBreak,n=G3(r,t);t.allRows().forEach(function(s){for(var a=0,o=t.columns;a<o.length;a++){var h=o[a],c=s.cells[h.index];if(c){var u=t.hooks.didParseCell;t.callCellHooks(r,u,c,s,h,null);var p=c.padding("horizontal");c.contentWidth=Qm(c.text,c.styles,r)+p;var g=Qm(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,r);if(c.minReadableWidth=g+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||i===!0)c.contentWidth>n?(c.minWidth=n,c.wrappedWidth=n):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var f=10/e;c.minWidth=c.styles.minCellWidth||f,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(s){for(var a=0,o=t.columns;a<o.length;a++){var h=o[a],c=s.cells[h.index];if(c&&c.colSpan===1)h.wrappedWidth=Math.max(h.wrappedWidth,c.wrappedWidth),h.minWidth=Math.max(h.minWidth,c.minWidth),h.minReadableWidth=Math.max(h.minReadableWidth,c.minReadableWidth);else{var u=t.styles.columnStyles[h.dataKey]||t.styles.columnStyles[h.index]||{},p=u.cellWidth||u.minCellWidth;p&&typeof p=="number"&&(h.minWidth=p,h.wrappedWidth=p)}c&&(c.colSpan>1&&!h.minWidth&&(h.minWidth=c.minWidth),c.colSpan>1&&!h.wrappedWidth&&(h.wrappedWidth=c.minWidth))}})}function Cv(r,t,e){for(var i=t,n=r.reduce(function(f,A){return f+A.wrappedWidth},0),s=0;s<r.length;s++){var a=r[s],o=a.wrappedWidth/n,h=i*o,c=a.width+h,u=e(a),p=c<u?u:c;t-=p-a.width,a.width=p}if(t=Math.round(t*1e10)/1e10,t){var g=r.filter(function(f){return t<0?f.width>e(f):!0});g.length&&(t=Cv(g,t,e))}return t}function M6(r){for(var t={},e=1,i=r.allRows(),n=0;n<i.length;n++)for(var s=i[n],a=0,o=r.columns;a<o.length;a++){var h=o[a],c=t[h.index];if(e>1)e--,delete s.cells[h.index];else if(c)c.cell.height+=s.height,e=c.cell.colSpan,delete s.cells[h.index],c.left--,c.left<=1&&delete t[h.index];else{var u=s.cells[h.index];if(!u)continue;if(u.height=s.height,u.rowSpan>1){var p=i.length-n,g=u.rowSpan>p?p:u.rowSpan;t[h.index]={cell:u,left:g,row:s}}}}}function R6(r){for(var t=r.allRows(),e=0;e<t.length;e++)for(var i=t[e],n=null,s=0,a=0,o=0;o<r.columns.length;o++){var h=r.columns[o];if(a-=1,a>1&&r.columns[o+1])s+=h.width,delete i.cells[h.index];else if(n){var c=n;delete i.cells[h.index],n=null,c.width=h.width+s}else{var c=i.cells[h.index];if(!c)continue;if(a=c.colSpan,s=0,c.colSpan>1){n=c,s+=h.width;continue}c.width=h.width+s}}}function D6(r,t){for(var e={count:0,height:0},i=0,n=r.allRows();i<n.length;i++){for(var s=n[i],a=0,o=r.columns;a<o.length;a++){var h=o[a],c=s.cells[h.index];if(c){t.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=t.splitTextToSize(c.text,u+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=xA(c.text,u,c.styles,t,"...");else if(c.styles.overflow==="hidden")c.text=xA(c.text,u,c.styles,t,"");else if(typeof c.styles.overflow=="function"){var p=c.styles.overflow(c.text,u);typeof p=="string"?c.text=[p]:c.text=p}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var g=c.contentHeight/c.rowSpan;c.rowSpan>1&&e.count*e.height<g*c.rowSpan?e={height:g,count:c.rowSpan}:e&&e.count>0&&e.height>g&&(g=e.height),g>s.height&&(s.height=g)}}e.count--}}function xA(r,t,e,i,n){return r.map(function(s){return O6(s,t,e,i,n)})}function O6(r,t,e,i,n){var s=1e4*i.scaleFactor();if(t=Math.ceil(t*s)/s,t>=Qm(r,e,i))return r;for(;t<Qm(r+n,e,i)&&!(r.length<=1);)r=r.substring(0,r.length-1);return r.trim()+n}function Z3(r,t){var e=new sd(r),i=B6(t,e.scaleFactor()),n=new K3(t,i);return I6(e,n),e.applyStyles(e.userStyles),n}function B6(r,t){var e=r.content,i=U6(e.columns);if(e.head.length===0){var n=CA(i,"head");n&&e.head.push(n)}if(e.foot.length===0){var n=CA(i,"foot");n&&e.foot.push(n)}var s=r.settings.theme,a=r.styles;return{columns:i,head:H5("head",e.head,i,a,s,t),body:H5("body",e.body,i,a,s,t),foot:H5("foot",e.foot,i,a,s,t)}}function H5(r,t,e,i,n,s){var a={},o=t.map(function(h,c){for(var u=0,p={},g=0,f=0,A=0,v=e;A<v.length;A++){var S=v[A];if(a[S.index]==null||a[S.index].left===0)if(f===0){var w=void 0;Array.isArray(h)?w=h[S.index-g-u]:w=h[S.dataKey];var k={};typeof w=="object"&&!Array.isArray(w)&&(k=(w==null?void 0:w.styles)||{});var L=H6(r,S,c,n,i,s,k),P=new Gv(w,L,r);p[S.dataKey]=P,p[S.index]=P,f=P.colSpan-1,a[S.index]={left:P.rowSpan-1,times:f}}else f--,g++;else a[S.index].left--,f=a[S.index].times,u++}return new Wv(h,c,r,p)});return o}function CA(r,t){var e={};return r.forEach(function(i){if(i.raw!=null){var n=j6(t,i.raw);n!=null&&(e[i.dataKey]=n)}}),Object.keys(e).length>0?e:null}function j6(r,t){if(r==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(r==="foot"&&typeof t=="object")return t.footer;return null}function U6(r){return r.map(function(t,e){var i,n;return typeof t=="object"?n=(i=t.dataKey)!==null&&i!==void 0?i:e:n=e,new J3(n,t,e)})}function H6(r,t,e,i,n,s,a){var o=y6(i),h;r==="head"?h=n.headStyles:r==="body"?h=n.bodyStyles:r==="foot"&&(h=n.footStyles);var c=el({},o.table,o[r],n.styles,h),u=n.columnStyles[t.dataKey]||n.columnStyles[t.index]||{},p=r==="body"?u:{},g=r==="body"&&e%2===0?el({},o.alternateRow,n.alternateRowStyles):{},f=v6(s),A=el({},f,c,g,p);return el(A,a)}function q6(r,t,e){var i;e===void 0&&(e={});var n=G3(r,t),s=new Map,a=[],o=[],h=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?h=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(h=[t.settings.horizontalPageBreakRepeat]),h.forEach(function(g){var f=t.columns.find(function(A){return A.dataKey===g||A.index===g});f&&!s.has(f.index)&&(s.set(f.index,!0),a.push(f.index),o.push(t.columns[f.index]),n-=f.wrappedWidth)});for(var c=!0,u=(i=e==null?void 0:e.start)!==null&&i!==void 0?i:0;u<t.columns.length;){if(s.has(u)){u++;continue}var p=t.columns[u].wrappedWidth;if(c||n>=p)c=!1,a.push(u),o.push(t.columns[u]),n-=p;else break;u++}return{colIndexes:a,columns:o,lastIndex:u-1}}function z6(r,t){for(var e=[],i=0;i<t.columns.length;i++){var n=q6(r,t,{start:i});n.columns.length&&(e.push(n),i=n.lastIndex)}return e}function Q3(r,t){var e=t.settings,i=e.startY,n=e.margin,s={x:n.left,y:i},a=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=i+n.bottom+a;if(e.pageBreak==="avoid"){var h=t.body,c=h.reduce(function(g,f){return g+f.height},0);o+=c}var u=new sd(r);(e.pageBreak==="always"||e.startY!=null&&o>u.pageSize().height)&&(ex(u),s.y=n.top),t.callWillDrawPageHooks(u,s);var p=el({},s);t.startPageNumber=u.pageNumber(),e.horizontalPageBreak?W6(u,t,p,s):(u.applyStyles(u.userStyles),(e.showHead==="firstPage"||e.showHead==="everyPage")&&t.head.forEach(function(g){return ol(u,t,g,s,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(g,f){var A=f===t.body.length-1;e2(u,t,g,A,p,s,t.columns)}),u.applyStyles(u.userStyles),(e.showFoot==="lastPage"||e.showFoot==="everyPage")&&t.foot.forEach(function(g){return ol(u,t,g,s,t.columns)})),z3(u,t,p,s),t.callEndPageHooks(u,s),t.finalY=s.y,r.lastAutoTable=t,u.applyStyles(u.userStyles)}function W6(r,t,e,i){var n=z6(r,t),s=t.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(c,u){r.applyStyles(r.userStyles),u>0?$p(r,t,e,i,c.columns,!0):LA(r,t,i,c.columns),G6(r,t,e,i,c.columns),q5(r,t,i,c.columns)});else for(var a=-1,o=n[0],h=function(){var c=a;if(o){r.applyStyles(r.userStyles);var u=o.columns;a>=0?$p(r,t,e,i,u,!0):LA(r,t,i,u),c=EA(r,t,a+1,i,u),q5(r,t,i,u)}var p=c-a;n.slice(1).forEach(function(g){r.applyStyles(r.userStyles),$p(r,t,e,i,g.columns,!0),EA(r,t,a+1,i,g.columns,p),q5(r,t,i,g.columns)}),a=c};a<t.body.length-1;)h()}function LA(r,t,e,i){var n=t.settings;r.applyStyles(r.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&t.head.forEach(function(s){return ol(r,t,s,e,i)})}function G6(r,t,e,i,n){r.applyStyles(r.userStyles),t.body.forEach(function(s,a){var o=a===t.body.length-1;e2(r,t,s,o,e,i,n)})}function EA(r,t,e,i,n,s){r.applyStyles(r.userStyles),s=s??t.body.length;var a=Math.min(e+s,t.body.length),o=-1;return t.body.slice(e,a).forEach(function(h,c){var u=e+c===t.body.length-1,p=tx(r,t,u,i);h.canEntireRowFit(p,n)&&(ol(r,t,h,i,n),o=e+c)}),o}function q5(r,t,e,i){var n=t.settings;r.applyStyles(r.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&t.foot.forEach(function(s){return ol(r,t,s,e,i)})}function V6(r,t,e){var i=e.getLineHeight(r.styles.fontSize),n=r.padding("vertical"),s=Math.floor((t-n)/i);return Math.max(0,s)}function $6(r,t,e,i){var n={};r.spansMultiplePages=!0,r.height=0;for(var s=0,a=0,o=e.columns;a<o.length;a++){var h=o[a],c=r.cells[h.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var u=new Gv(c.raw,c.styles,c.section);u=el(u,c),u.text=[];var p=V6(c,t,i);c.text.length>p&&(u.text=c.text.splice(p,c.text.length));var g=i.scaleFactor(),f=i.getLineHeightFactor();c.contentHeight=c.getContentHeight(g,f),c.contentHeight>=t&&(c.contentHeight=t,u.styles.minCellHeight-=t),c.contentHeight>r.height&&(r.height=c.contentHeight),u.contentHeight=u.getContentHeight(g,f),u.contentHeight>s&&(s=u.contentHeight),n[h.index]=u}}var A=new Wv(r.raw,-1,r.section,n,!0);A.height=s;for(var v=0,S=e.columns;v<S.length;v++){var h=S[v],u=A.cells[h.index];u&&(u.height=A.height);var c=r.cells[h.index];c&&(c.height=r.height)}return A}function X6(r,t,e,i){var n=r.pageSize().height,s=i.settings.margin,a=s.top+s.bottom,o=n-a;t.section==="body"&&(o-=i.getHeadHeight(i.columns)+i.getFootHeight(i.columns));var h=t.getMinimumRowHeight(i.columns,r),c=h<e;if(h>o)return console.log("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var u=t.hasRowSpan(i.columns),p=t.getMaxCellHeight(i.columns)>o;return p?(u&&console.log("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||i.settings.rowPageBreak==="avoid")}function e2(r,t,e,i,n,s,a){var o=tx(r,t,i,s);if(e.canEntireRowFit(o,a))ol(r,t,e,s,a);else if(X6(r,e,o,t)){var h=$6(e,o,t,r);ol(r,t,e,s,a),$p(r,t,n,s,a),e2(r,t,h,i,n,s,a)}else $p(r,t,n,s,a),e2(r,t,e,i,n,s,a)}function ol(r,t,e,i,n){i.x=t.settings.margin.left;for(var s=0,a=n;s<a.length;s++){var o=a[s],h=e.cells[o.index];if(!h){i.x+=o.width;continue}r.applyStyles(h.styles),h.x=i.x,h.y=i.y;var c=t.callCellHooks(r,t.hooks.willDrawCell,h,e,o,i);if(c===!1){i.x+=o.width;continue}Y6(r,h,i);var u=h.getTextPos();U3(h.text,u.x,u.y,{halign:h.styles.halign,valign:h.styles.valign,maxWidth:Math.ceil(h.width-h.padding("left")-h.padding("right"))},r.getDocument()),t.callCellHooks(r,t.hooks.didDrawCell,h,e,o,i),i.x+=o.width}i.y+=e.height}function Y6(r,t,e){var i=t.styles;if(r.getDocument().setFillColor(r.getDocument().getFillColor()),typeof i.lineWidth=="number"){var n=W3(i.lineWidth,i.fillColor);n&&r.rect(t.x,e.y,t.width,t.height,n)}else typeof i.lineWidth=="object"&&(i.fillColor&&r.rect(t.x,e.y,t.width,t.height,"F"),K6(r,t,e,i.lineWidth))}function K6(r,t,e,i){var n,s,a,o;i.top&&(n=e.x,s=e.y,a=e.x+t.width,o=e.y,i.right&&(a+=.5*i.right),i.left&&(n-=.5*i.left),h(i.top,n,s,a,o)),i.bottom&&(n=e.x,s=e.y+t.height,a=e.x+t.width,o=e.y+t.height,i.right&&(a+=.5*i.right),i.left&&(n-=.5*i.left),h(i.bottom,n,s,a,o)),i.left&&(n=e.x,s=e.y,a=e.x,o=e.y+t.height,i.top&&(s-=.5*i.top),i.bottom&&(o+=.5*i.bottom),h(i.left,n,s,a,o)),i.right&&(n=e.x+t.width,s=e.y,a=e.x+t.width,o=e.y+t.height,i.top&&(s-=.5*i.top),i.bottom&&(o+=.5*i.bottom),h(i.right,n,s,a,o));function h(c,u,p,g,f){r.getDocument().setLineWidth(c),r.getDocument().line(u,p,g,f,"S")}}function tx(r,t,e,i){var n=t.settings.margin.bottom,s=t.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&e)&&(n+=t.getFootHeight(t.columns)),r.pageSize().height-i.y-n}function $p(r,t,e,i,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1),r.applyStyles(r.userStyles),t.settings.showFoot==="everyPage"&&!s&&t.foot.forEach(function(o){return ol(r,t,o,i,n)}),t.callEndPageHooks(r,i);var a=t.settings.margin;z3(r,t,e,i),ex(r),t.pageNumber++,i.x=a.left,i.y=a.top,e.y=a.top,t.callWillDrawPageHooks(r,i),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return ol(r,t,o,i,n)}),r.applyStyles(r.userStyles))}function ex(r){var t=r.pageNumber();r.setPage(t+1);var e=r.pageNumber();return e===t?(r.addPage(),!0):!1}function ix(r){r.API.autoTable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=X3(this,i),s=Z3(this,n);return Q3(this,s),this},r.API.lastAutoTable=!1,r.API.autoTableText=function(t,e,i,n){U3(t,e,i,n,this)},r.API.autoTableSetDefaults=function(t){return sd.setDefaults(t,this),this},r.autoTableSetDefaults=function(t,e){sd.setDefaults(t,e)},r.API.autoTableHtmlToJson=function(t,e){var i;if(e===void 0&&(e=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new sd(this),s=$3(n,t,window,e,!1),a=s.head,o=s.body,h=((i=a[0])===null||i===void 0?void 0:i.map(function(c){return c.content}))||[];return{columns:h,rows:o,data:o}}}var z5;function kA(r,t){var e=X3(r,t),i=Z3(r,e);Q3(r,i)}try{if(typeof window<"u"&&window){var PA=window,NA=PA.jsPDF||((z5=PA.jspdf)===null||z5===void 0?void 0:z5.jsPDF);NA&&ix(NA)}}catch(r){console.error("Could not apply autoTable plugin",r)}const tk=Object.freeze(Object.defineProperty({__proto__:null,Cell:Gv,CellHookData:Y3,Column:J3,HookData:t2,Row:Wv,Table:K3,applyPlugin:ix,autoTable:kA,default:kA},Symbol.toStringTag,{value:"Module"}));export{Vt as E,qa as G,h5 as _,kA as a,Ke as b,tk as c,G_ as g,Q6 as j,Z6 as p};
